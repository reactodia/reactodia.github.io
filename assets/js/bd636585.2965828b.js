"use strict";(self.webpackChunk_reactodia_reactodia_github_io=self.webpackChunk_reactodia_reactodia_github_io||[]).push([[61446],{16593:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(77810);const a={},r=s.createContext(a);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:n},e.children)}},71120:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"components/canvas","title":"<Canvas />","description":"`` is a main component to display a scrollable canvas for the diagram with elements, links and additional widgets.","source":"@site/docs/components/canvas.md","sourceDirName":"components","slug":"/components/canvas","permalink":"/docs/components/canvas","draft":false,"unlisted":false,"editUrl":"https://github.com/reactodia/reactodia.github.io/tree/main/docs/components/canvas.md","tags":[],"version":"current","frontMatter":{"title":"<Canvas />"},"sidebar":"docs","previous":{"title":"Components","permalink":"/docs/category/components"},"next":{"title":"<ClassTree />","permalink":"/docs/components/class-tree"}}');var a=t(64922),r=t(16593);const i={title:"<Canvas />"},o="Canvas and widgets",c={},d=[{value:"Customizing element and link appearance",id:"customization",level:2},{value:"Element decorations",id:"element-decorations",level:3},{value:"Getting the canvas instance",id:"getting-the-canvas-instance",level:2},{value:"Canvas widgets",id:"canvas-widgets",level:2},{value:"Example: custom viewport widget",id:"example-custom-viewport-widget",level:3},{value:"Exporting the canvas",id:"exporting-the-canvas",level:2},{value:"Styles",id:"styles",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"canvas-and-widgets",children:"Canvas and widgets"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/Canvas",children:(0,a.jsx)(n.code,{children:"<Canvas />"})})," is a main component to display a scrollable canvas for the diagram with ",(0,a.jsx)(n.a,{href:"/docs/concepts/graph-model",children:"elements"}),", ",(0,a.jsx)(n.a,{href:"/docs/concepts/graph-model",children:"links"})," and additional widgets."]}),"\n",(0,a.jsx)(n.h2,{id:"customization",children:"Customizing element and link appearance"}),"\n",(0,a.jsxs)(n.p,{children:["It is possible to customize how elements (nodes) and links (edges) are rendered on the canvas by providing ",(0,a.jsx)(n.code,{children:"elementTemplateResolver"})," (",(0,a.jsx)(n.a,{href:"/docs/api/workspace/type-aliases/TypedElementResolver",children:(0,a.jsx)(n.code,{children:"TypedElementResolver"})}),") and/or ",(0,a.jsx)(n.code,{children:"linkTemplateResolver"})," (",(0,a.jsx)(n.a,{href:"/docs/api/workspace/type-aliases/LinkTemplateResolver",children:(0,a.jsx)(n.code,{children:"LinkTemplateResolver"})}),") props to the ",(0,a.jsx)(n.code,{children:"<Canvas />"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"An element or link template is an object with rendering function (returning a React component to display it) and additional rendering settings such as element shape, link markers, etc."}),"\n",(0,a.jsxs)(n.p,{children:["An ",(0,a.jsx)(n.strong,{children:"element template"})," is an ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/ElementTemplate",children:(0,a.jsx)(n.code,{children:"ElementTemplate"})})," object with rendering function (returning a React component to display the element) and additional settings, such as element shape (rectangular or elliptical)."]}),"\n",(0,a.jsxs)(n.p,{children:["A ",(0,a.jsx)(n.strong,{children:"link template"})," is a ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/LinkTemplate",children:(0,a.jsx)(n.code,{children:"LinkTemplate"})})," object with rendering function (returning a React component to display the link) and additional settings, such as link markers (mini-shapes on its endpoints, e.g. arrowheads) and path spline type (straight or smooth)."]}),"\n",(0,a.jsx)(n.p,{children:"The library provides the following built-in templates:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Template"}),(0,a.jsx)(n.th,{children:"Type"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/variables/StandardTemplate",children:(0,a.jsx)(n.code,{children:"StandardTemplate"})})}),(0,a.jsx)(n.td,{children:"element"}),(0,a.jsxs)(n.td,{children:["Default (fallback) template for an element; supports single entity elements and ",(0,a.jsx)(n.a,{href:"/docs/concepts/graph-model#data-graph",children:"entity groups"}),".",(0,a.jsx)("br",{}),"Uses ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/StandardEntity",children:(0,a.jsx)(n.code,{children:"StandardEntity"})})," and ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/StandardEntityGroup",children:(0,a.jsx)(n.code,{children:"StandardEntityGroup"})})," components to render elements."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/variables/ClassicTemplate",children:(0,a.jsx)(n.code,{children:"ClassicTemplate"})})}),(0,a.jsx)(n.td,{children:"element"}),(0,a.jsxs)(n.td,{children:['Element template component with classic "look and feel" which was used for elements before v0.8; does not support entity groups.',(0,a.jsx)("br",{}),"Uses ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/ClassicEntity",children:(0,a.jsx)(n.code,{children:"ClassicEntity"})})," component to render elements."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/variables/RoundTemplate",children:(0,a.jsx)(n.code,{children:"RoundTemplate"})})}),(0,a.jsx)(n.td,{children:"element"}),(0,a.jsxs)(n.td,{children:["Basic element template with an round (elliptical) shape; does not support entity groups.",(0,a.jsx)("br",{}),"Uses ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/RoundEntity",children:(0,a.jsx)(n.code,{children:"RoundEntity"})})," component to render elements."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/variables/DefaultLinkTemplate",children:(0,a.jsx)(n.code,{children:"DefaultLinkTemplate"})})}),(0,a.jsx)(n.td,{children:"link"}),(0,a.jsxs)(n.td,{children:["Default (fallback) template for a link; supports single relation links and ",(0,a.jsx)(n.a,{href:"/docs/concepts/graph-model#data-graph",children:"relation groups"}),".",(0,a.jsx)("br",{}),"Uses ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/DefaultLink",children:(0,a.jsx)(n.code,{children:"DefaultLink"})})," component to render links which uses ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/LinkPath",children:(0,a.jsx)(n.code,{children:"LinkPath"})}),", ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/LinkLabel",children:(0,a.jsx)(n.code,{children:"LinkLabel"})})," and ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/LinkVertices",children:(0,a.jsx)(n.code,{children:"LinkVertices"})})," components inside to display the link connection itself, the labels and vertices (to change link geometry)."]})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["Additionally, it is possible to override how the link are routed (how default path geometry is computed) on the canvas by providing ",(0,a.jsx)(n.code,{children:"linkRouter"})," (",(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/LinkRouter",children:(0,a.jsx)(n.code,{children:"LinkRouter"})}),") prop to the ",(0,a.jsx)(n.code,{children:"<Canvas />"}),". By default, the ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/classes/DefaultLinkRouter",children:(0,a.jsx)(n.code,{children:"DefaultLinkRouter"})})," is used which moves apart multiple links between same elements and displays self-links (where target is equal to source) as loops."]}),"\n",(0,a.jsx)(n.h3,{id:"element-decorations",children:"Element decorations"}),"\n",(0,a.jsxs)(n.p,{children:["To further customize element rendering the library provides ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/ElementDecoration",children:(0,a.jsx)(n.code,{children:"<ElementDecoration />"})})," component to display a decoration over a canvas element. These decorations are rendered outside the element template content itself and does not contribute to the measured size of an element."]}),"\n",(0,a.jsxs)(n.p,{children:["All decorations for a specific entity are rendered as children of a DOM element with ",(0,a.jsx)(n.code,{children:"reactodia-element-decorators"})," CSS class which immediately follows each target canvas element in the DOM. Such parent DOM elements for the decorations have ",(0,a.jsx)(n.code,{children:"transform: translate(...)"}),", ",(0,a.jsx)(n.code,{children:"width"})," and ",(0,a.jsx)(n.code,{children:"height"})," set to the same values as the target element to be able to layout decoration content via CSS:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-css",children:"/* Position decoration to the left of the target canvas element  */\r\n.my-custom-decoration {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: -10px;\r\n  transform: translate(-100%,-50%);\r\n}\r\n\r\n/* Show decoration on hover over it or target canvas element */\r\n.reactodia-overlaid-element:hover + .reactodia-element-decorations .my-custom-decoration,\r\n.my-custom-decoration:hover {\r\n  opacity: 1;\r\n}\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["See complete ",(0,a.jsx)(n.a,{href:"/docs/examples/style-customization",children:"style customization example"})," with custom element and link templates, element decorations and more."]})}),"\n",(0,a.jsx)(n.h2,{id:"getting-the-canvas-instance",children:"Getting the canvas instance"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/useCanvas",children:(0,a.jsx)(n.code,{children:"useCanvas()"})})," hook called from a canvas widget can be used to get the ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/CanvasApi",children:(0,a.jsx)(n.code,{children:"CanvasApi"})})," instance from a context to read or subscribe to the canvas state or perform viewport-related effects:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"function MyWidget() {\r\n  const {canvas} = Reactodia.useCanvas();\r\n  // Use canvas here\r\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Alternatively, with ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/classes/SharedCanvasState#findanycanvas",children:(0,a.jsx)(n.code,{children:"SharedCanvasState.findAnyCanvas()"})})," or ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/classes/SharedCanvasState#findallcanvases",children:(0,a.jsx)(n.code,{children:"SharedCanvasState.findAllCanvases()"})})," methods it is possible to get canvas instance outside the canvas component:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"function NonWidgetComponent {\r\n  const {view} = React.useWorkspace();\r\n\r\n  const canvas = view.findAnyCanvas();\r\n  if (canvas) {\r\n    // Use canvas here (could be any if there are several of them)\r\n  }\r\n\r\n  for (const canvas of view.findAllCanvases()) {\r\n    // Use each canvas mounted in the workspace\r\n  }\r\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"canvas-widgets",children:"Canvas widgets"}),"\n",(0,a.jsxs)(n.p,{children:["Canvas widget is an instance of any React component type which is marked by ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/defineCanvasWidget",children:"defineCanvasWidget()"})," function with metadata such as its attachment layer i.e. where the component should be displayed in relation to other canvas content."]}),"\n",(0,a.jsx)(n.p,{children:"There are multiple canvas layers to place widgets on, from top one to the bottom:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Layer name"}),(0,a.jsx)(n.th,{children:(0,a.jsx)(n.a,{href:"/docs/concepts/canvas-coordinates",children:"Coordinate type"})}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"viewport"})}),(0,a.jsx)(n.td,{children:"client (viewport)"}),(0,a.jsx)(n.td,{children:"Topmost layer, does not scale or scroll with the diagram."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"overElements"})}),(0,a.jsx)(n.td,{children:"paper"}),(0,a.jsx)(n.td,{children:"Displayed over both elements and links, scales and scrolls with the diagram."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"overLinks"})}),(0,a.jsx)(n.td,{children:"paper"}),(0,a.jsx)(n.td,{children:"Displayed under elements but over links, scales and scrolls with the diagram."})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"example-custom-viewport-widget",children:"Example: custom viewport widget"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"live noInline",live:!0,children:"function CustomSelectAllWidget() {\r\n  const {model} = Reactodia.useWorkspace();\r\n  return (\r\n    <Reactodia.ViewportDock dock='ne'>\r\n      <button type='button'\r\n        className='reactodia-btn reactodia-btn-default'\r\n        onClick={() => model.setSelection([...model.elements])}>\r\n        Select All\r\n      </button>\r\n    </Reactodia.ViewportDock>\r\n  );\r\n}\r\n\r\nReactodia.defineCanvasWidget(\r\n  CustomSelectAllWidget,\r\n  element => ({element, attachment: 'viewport'})\r\n);\r\n\r\nfunction Example() {\r\n  const {defaultLayout} = Reactodia.useWorker(Layouts);\r\n\r\n  const {onMount} = Reactodia.useLoadedWorkspace(async ({context, signal}) => {\r\n    const {model, view, performLayout} = context;\r\n    model.createElement('http://example.com/entity1');\r\n    model.createElement('http://example.com/entity2');\r\n    model.createLinks({\r\n      sourceId: 'http://example.com/entity1',\r\n      targetId: 'http://example.com/entity2',\r\n      linkTypeId: 'http://example.com/connectedTo',\r\n      properties: {},\r\n    });\r\n    await performLayout({signal});\r\n  }, []);\r\n\r\n  return (\r\n    <div className='reactodia-live-editor'>\r\n      <Reactodia.Workspace ref={onMount}\r\n        defaultLayout={defaultLayout}>\r\n        <Reactodia.DefaultWorkspace\r\n          search={null}\r\n          canvasWidgets={[<CustomSelectAllWidget key='select-all' />]}\r\n        />\r\n      </Reactodia.Workspace>\r\n    </div>\r\n  );\r\n}\r\n\r\nrender(<Example />);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"exporting-the-canvas",children:"Exporting the canvas"}),"\n",(0,a.jsx)(n.p,{children:'It is possible to export a "snapshot" of currently rendered canvas content into an SVG (with HTML parts) or a raster image:'}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Canvas API method"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/CanvasApi#exportsvg",children:(0,a.jsx)(n.code,{children:"exportSvg()"})})}),(0,a.jsxs)(n.td,{children:["Exports the diagram as a serialized into text SVG document with ",(0,a.jsx)(n.code,{children:"<foreignObject>"})," HTML layers inside. (Can be opened by the browser but not with a pure SVG image editor.)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/api/workspace/interfaces/CanvasApi#exportraster",children:(0,a.jsx)(n.code,{children:"exportRaster()"})})}),(0,a.jsxs)(n.td,{children:["Exports the diagram as a rendered raster image (e.g. PNG, JPEG, etc) serialized into base64-encoded ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/URI/Schemes/data",children:"data URL"}),"."]})]})]})]}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"When exporting into an SVG, the resulting document would include all diagram content as well as every CSS rule which applies to any DOM element inside the diagram content."}),(0,a.jsxs)(n.p,{children:["Diagram is always exported in the ",(0,a.jsx)(n.a,{href:"/docs/concepts/design-system",children:"light theme"}),"."]})]}),"\n",(0,a.jsxs)(n.p,{children:["To prevent being exported a DOM element can be marked with ",(0,a.jsx)(n.code,{children:"data-reactodia-no-export"})," attribute or additional CSS selectors can be provided via ",(0,a.jsx)(n.code,{children:"removeByCssSelectors"})," options to the export methods."]}),"\n",(0,a.jsx)(n.p,{children:"Printing the diagram can be achieved by exporting an SVG, writing it into a newly opened window and printing it:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const printWindow = window.open('', undefined, 'width=1280,height=720')!;\r\nconst svg = await canvas.exportSvg();\r\nprintWindow.document.write(svg);\r\nprintWindow.document.close();\r\nprintWindow.print();\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The library provides a built-in ",(0,a.jsx)(n.a,{href:"/docs/components/toolbar",children:(0,a.jsx)(n.code,{children:"toolbar"})})," action component ",(0,a.jsx)(n.a,{href:"/docs/api/workspace/functions/ToolbarActionExport",children:(0,a.jsx)(n.code,{children:"<ToolbarActionExport />"})})," as a convenient way to export or print the diagram from the UI."]}),"\n",(0,a.jsx)(n.h2,{id:"styles",children:"Styles"}),"\n",(0,a.jsxs)(n.p,{children:["The component look can be customized using the following CSS properties (see ",(0,a.jsx)(n.a,{href:"/docs/concepts/design-system",children:"design system"})," for more information):"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Property"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-canvas-background-color"})}),(0,a.jsx)(n.td,{children:"Background color for the canvas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-canvas-box-shadow"})}),(0,a.jsx)(n.td,{children:"Box shadow for the UI components layered on top of the canvas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-canvas-overlay-color"})}),(0,a.jsx)(n.td,{children:"Semi-transparent color to place over canvas content when displaying a modal on top."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-canvas-underlay-color"})}),(0,a.jsx)(n.td,{children:"Semi-transparent color to place under components for improved readability when they are placed on the canvas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-element-background-color"})}),(0,a.jsx)(n.td,{children:"Default background color for the graph elements displayed on the canvas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-link-stroke-color"})}),(0,a.jsx)(n.td,{children:"Default stroke color for the graph links displayed on the canvas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-monochrome-icon-filter"})}),(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/filter",children:"CSS filter"})," for the monochrome ",(0,a.jsx)(n.a,{href:"/docs/components/workspace#customize-type-styles",children:"type style"})," icons."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--reactodia-viewport-dock-margin"})}),(0,a.jsx)(n.td,{children:"Margin from the borders of the canvas for the viewport widgets."})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);