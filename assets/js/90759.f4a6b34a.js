/*! For license information please see 90759.f4a6b34a.js.LICENSE.txt */
(self.webpackChunk_reactodia_reactodia_github_io=self.webpackChunk_reactodia_reactodia_github_io||[]).push([[90759],{19738:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbortScope:()=>Ee,AsyncModel:()=>Ne,AuthoringKind:()=>je,AuthoringState:()=>Ce,BatchingScheduler:()=>Ae,BufferingQueue:()=>De,Canvas:()=>Pe,CanvasContext:()=>Oe,ClassTree:()=>ze,ClassicTemplate:()=>Re,Command:()=>Be,CompositeDataProvider:()=>Ue,ConnectionsMenu:()=>$e,DBPediaSettings:()=>We,DIAGRAM_CONTEXT_URL_V1:()=>Ye,Debouncer:()=>Fe,DecoratedDataProvider:()=>Qe,DefaultLinkPathTemplate:()=>Ze,DefaultLinkTemplate:()=>He,DefaultWorkspace:()=>Ve,DraggableHandle:()=>Ge,DropOnCanvas:()=>qe,Dropdown:()=>Xe,DropdownItem:()=>Je,EditorController:()=>Ke,Element:()=>et,EmbeddedLayer:()=>tt,EventObserver:()=>nt,EventSource:()=>it,GroupTemplate:()=>rt,Halo:()=>ot,HaloLink:()=>st,HashMap:()=>at,HashSet:()=>lt,HtmlSpinner:()=>ct,InMemoryHistory:()=>dt,IndexQuadBy:()=>ut,IndexedDbCachedProvider:()=>ht,InstancesSearch:()=>pt,KeyedObserver:()=>gt,LINK_STYLE_SHOW_IRI:()=>ft,Link:()=>mt,LinkAction:()=>yt,LinkActionDelete:()=>bt,LinkActionEdit:()=>xt,LinkActionMoveEndpoint:()=>wt,LinkActionRename:()=>vt,LinkActionSpinner:()=>kt,LinkLabel:()=>Lt,LinkPath:()=>_t,LinkTypesToolbox:()=>St,LinkVertex:()=>Mt,LinkVertices:()=>It,ListElementView:()=>Tt,MoveDirection:()=>Et,Navigator:()=>Nt,OntologyLinkTemplates:()=>jt,OrderedMap:()=>Ct,OverlayController:()=>At,OwlRdfsSettings:()=>Dt,OwlRdfsSettingsOverride:()=>Pt,OwlStatsSettings:()=>Ot,PLACEHOLDER_ELEMENT_TYPE:()=>zt,PLACEHOLDER_LINK_TYPE:()=>Rt,ProgressBar:()=>Bt,Rdf:()=>Ut,RdfDataProvider:()=>$t,RdfSettings:()=>Wt,Rect:()=>Yt,RenderingLayer:()=>Ft,RestoreGeometry:()=>Qt,SearchResults:()=>Zt,Selection:()=>Ht,SelectionAction:()=>Vt,SelectionActionAddToFilter:()=>Gt,SelectionActionAnchor:()=>qt,SelectionActionConnections:()=>Xt,SelectionActionEstablishLink:()=>Jt,SelectionActionExpand:()=>Kt,SelectionActionLayout:()=>en,SelectionActionRemove:()=>tn,SelectionActionSpinner:()=>nn,SelectionActionZoomToFit:()=>rn,SemanticTypeStyles:()=>on,SparqlDataProvider:()=>sn,Spinner:()=>an,StandardTemplate:()=>ln,TemplateProperties:()=>cn,TemporaryState:()=>dn,Toolbar:()=>un,ToolbarAction:()=>hn,ToolbarActionClearAll:()=>pn,ToolbarActionExport:()=>gn,ToolbarActionLayout:()=>fn,ToolbarActionOpen:()=>mn,ToolbarActionRedo:()=>yn,ToolbarActionSave:()=>bn,ToolbarActionUndo:()=>xn,ToolbarLanguageSelector:()=>wn,TransformedSvgCanvas:()=>vn,ValidationState:()=>kn,Vector:()=>Ln,WikidataSettings:()=>_n,WithFetchStatus:()=>Sn,Workspace:()=>Mn,WorkspaceContext:()=>In,WorkspaceEventKey:()=>Tn,WorkspaceLayoutColumn:()=>En,WorkspaceLayoutItem:()=>Nn,WorkspaceLayoutResizeContext:()=>jn,WorkspaceLayoutRow:()=>Cn,WorkspaceRoot:()=>An,ZoomControl:()=>Dn,animateInterval:()=>Pn,applyLayout:()=>On,blockingDefaultLayout:()=>zn,boundsOf:()=>Rn,calculateAveragePosition:()=>Bn,calculateLayout:()=>Un,colaFlowLayout:()=>$n,colaForceLayout:()=>Wn,colaRemoveOverlaps:()=>Yn,computeGrouping:()=>Fn,computePolyline:()=>Qn,computePolylineLength:()=>Zn,defineCanvasWidget:()=>Hn,defineLayoutWorker:()=>Vn,defineWorker:()=>Gn,delay:()=>qn,easeInOutBezier:()=>Xn,equalElements:()=>Jn,equalLinks:()=>Kn,equalSubtypeEdges:()=>ei,findElementAtPoint:()=>ti,findNearestSegmentIndex:()=>ni,getContentFittingBox:()=>ii,getContentFittingBoxForLayout:()=>ri,getOrCreateArrayInMap:()=>oi,getOrCreateSetInMap:()=>si,getPointAlongPolyline:()=>ai,hashLink:()=>li,hashSubtypeEdge:()=>ci,highlightSubstring:()=>di,isEncodedBlank:()=>ui,isLinkConnectedToElement:()=>hi,isPolylineEqual:()=>pi,layoutPadded:()=>gi,layoutPaddedBiasFree:()=>fi,makeDelayProviderDecorator:()=>mi,makeIndexedDataset:()=>yi,makeMoveComparator:()=>bi,makeSerializedDiagram:()=>xi,makeSerializedLayout:()=>wi,mapAbortedToNull:()=>vi,observeElementTypes:()=>ki,observeLinkTypes:()=>Li,observeProperties:()=>_i,paneTopLeft:()=>Si,pathFromPolyline:()=>Mi,placeElementsAround:()=>Ii,raceAbortSignal:()=>Ti,requestElementData:()=>Ei,restoreLinksBetweenElements:()=>Ni,setElementData:()=>ji,setElementExpanded:()=>Ci,setLinkData:()=>Ai,shallowArrayEqual:()=>Di,startDragElements:()=>Pi,totalPaneSize:()=>Oi,translateToPositiveQuadrant:()=>zi,uniformGrid:()=>Ri,useAuthoredEntity:()=>Bi,useCanvas:()=>Ui,useLinkActionContext:()=>$i,useLoadedWorkspace:()=>Wi,useObservedProperty:()=>Yi,useWorker:()=>Fi,useWorkspace:()=>Qi});var i={};function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function o(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function s(){}n.r(i),n.d(i,{color:()=>k,cubehelix:()=>me,gray:()=>q,hcl:()=>oe,hsl:()=>P,lab:()=>X,lch:()=>re,rgb:()=>M});var a=.7,l=1/a,c="\\s*([+-]?\\d+)\\s*",d="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,p=new RegExp(`^rgb\\(${c},${c},${c}\\)$`),g=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),f=new RegExp(`^rgba\\(${c},${c},${c},${d}\\)$`),m=new RegExp(`^rgba\\(${u},${u},${u},${d}\\)$`),y=new RegExp(`^hsl\\(${d},${u},${u}\\)$`),b=new RegExp(`^hsla\\(${d},${u},${u},${d}\\)$`),x={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function w(){return this.rgb().formatHex()}function v(){return this.rgb().formatRgb()}function k(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=h.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?L(t):3===n?new I(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?_(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=p.exec(e))?new I(t[1],t[2],t[3],1):(t=g.exec(e))?new I(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=f.exec(e))?_(t[1],t[2],t[3],t[4]):(t=m.exec(e))?_(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=y.exec(e))?A(t[1],t[2]/100,t[3]/100,1):(t=b.exec(e))?A(t[1],t[2]/100,t[3]/100,t[4]):x.hasOwnProperty(e)?L(x[e]):"transparent"===e?new I(NaN,NaN,NaN,0):null}function L(e){return new I(e>>16&255,e>>8&255,255&e,1)}function _(e,t,n,i){return i<=0&&(e=t=n=NaN),new I(e,t,n,i)}function S(e){return e instanceof s||(e=k(e)),e?new I((e=e.rgb()).r,e.g,e.b,e.opacity):new I}function M(e,t,n,i){return 1===arguments.length?S(e):new I(e,t,n,null==i?1:i)}function I(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function T(){return`#${C(this.r)}${C(this.g)}${C(this.b)}`}function E(){const e=N(this.opacity);return`${1===e?"rgb(":"rgba("}${j(this.r)}, ${j(this.g)}, ${j(this.b)}${1===e?")":`, ${e})`}`}function N(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function j(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function C(e){return((e=j(e))<16?"0":"")+e.toString(16)}function A(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new O(e,t,n,i)}function D(e){if(e instanceof O)return new O(e.h,e.s,e.l,e.opacity);if(e instanceof s||(e=k(e)),!e)return new O;if(e instanceof O)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,l=o-r,c=(o+r)/2;return l?(a=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=c<.5?o+r:2-o-r,a*=60):l=c>0&&c<1?0:a,new O(a,l,c,e.opacity)}function P(e,t,n,i){return 1===arguments.length?D(e):new O(e,t,n,null==i?1:i)}function O(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function z(e){return(e=(e||0)%360)<0?e+360:e}function R(e){return Math.max(0,Math.min(1,e||0))}function B(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r(s,k,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:w,formatHex:w,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return D(this).formatHsl()},formatRgb:v,toString:v}),r(I,M,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new I(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new I(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new I(j(this.r),j(this.g),j(this.b),N(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatHex8:function(){return`#${C(this.r)}${C(this.g)}${C(this.b)}${C(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:E,toString:E})),r(O,P,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new O(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new O(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new I(B(e>=240?e-240:e+120,r,i),B(e,r,i),B(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new O(z(this.h),R(this.s),R(this.l),N(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=N(this.opacity);return`${1===e?"hsl(":"hsla("}${z(this.h)}, ${100*R(this.s)}%, ${100*R(this.l)}%${1===e?")":`, ${e})`}`}}));const U=Math.PI/180,$=180/Math.PI,W=.96422,Y=1,F=.82521,Q=4/29,Z=6/29,H=3*Z*Z,V=Z*Z*Z;function G(e){if(e instanceof J)return new J(e.l,e.a,e.b,e.opacity);if(e instanceof se)return ae(e);e instanceof I||(e=S(e));var t,n,i=ne(e.r),r=ne(e.g),o=ne(e.b),s=K((.2225045*i+.7168786*r+.0606169*o)/Y);return i===r&&r===o?t=n=s:(t=K((.4360747*i+.3850649*r+.1430804*o)/W),n=K((.0139322*i+.0971045*r+.7141733*o)/F)),new J(116*s-16,500*(t-s),200*(s-n),e.opacity)}function q(e,t){return new J(e,0,0,null==t?1:t)}function X(e,t,n,i){return 1===arguments.length?G(e):new J(e,t,n,null==i?1:i)}function J(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function K(e){return e>V?Math.pow(e,1/3):e/H+Q}function ee(e){return e>Z?e*e*e:H*(e-Q)}function te(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ne(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ie(e){if(e instanceof se)return new se(e.h,e.c,e.l,e.opacity);if(e instanceof J||(e=G(e)),0===e.a&&0===e.b)return new se(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*$;return new se(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function re(e,t,n,i){return 1===arguments.length?ie(e):new se(n,t,e,null==i?1:i)}function oe(e,t,n,i){return 1===arguments.length?ie(e):new se(e,t,n,null==i?1:i)}function se(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function ae(e){if(isNaN(e.h))return new J(e.l,0,0,e.opacity);var t=e.h*U;return new J(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}r(J,X,o(s,{brighter(e){return new J(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new J(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new I(te(3.1338561*(t=W*ee(t))-1.6168667*(e=Y*ee(e))-.4906146*(n=F*ee(n))),te(-.9787684*t+1.9161415*e+.033454*n),te(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),r(se,oe,o(s,{brighter(e){return new se(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new se(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return ae(this).rgb()}}));var le=-.14861,ce=1.78277,de=-.29227,ue=-.90649,he=1.97294,pe=he*ue,ge=he*ce,fe=ce*de-ue*le;function me(e,t,n,i){return 1===arguments.length?function(e){if(e instanceof ye)return new ye(e.h,e.s,e.l,e.opacity);e instanceof I||(e=S(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(fe*i+pe*t-ge*n)/(fe+pe-ge),o=i-r,s=(he*(n-r)-de*o)/ue,a=Math.sqrt(s*s+o*o)/(he*r*(1-r)),l=a?Math.atan2(s,o)*$-120:NaN;return new ye(l<0?l+360:l,a,r,e.opacity)}(e):new ye(e,t,n,null==i?1:i)}function ye(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}r(ye,me,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new ye(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new ye(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*U,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new I(255*(t+n*(le*i+ce*r)),255*(t+n*(de*i+ue*r)),255*(t+n*(he*i)),this.opacity)}}));var be=n(4213),xe=n(48640),we=n(96540),ve=n.t(we,2),ke=n(40961),Le=n.t(ke,2),_e=n(78109),Se=[,(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(4),l=n.n(a),c=n(5),d=n.n(c),u=n(6),h=n.n(u),p=n(7),g=n.n(p),f=n(8),m={};m.styleTagTransform=g(),m.setAttributes=d(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=h();r()(f.default,m);const y=f.default&&f.default.locals?f.default.locals:void 0},e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=i.base?l[0]+i.base:l[0],d=o[c]||0,u="".concat(c," ").concat(d);o[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=r(p,i);i.byIndex=a,t.splice(a,0,{identifier:u,updater:g,references:1})}s.push(u)}return s}function r(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=i(e,r),c=0;c<o.length;c++){var d=n(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=l}}},e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(i){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},(e,t,n)=>{n.r(t),n.d(t,{default:()=>Oe});var i=n(9),r=n.n(i),o=n(10),s=n.n(o),a=n(11),l=n.n(a),c=new URL(n(12),n.b),d=new URL(n(13),n.b),u=new URL(n(14),n.b),h=new URL(n(15),n.b),p=new URL(n(16),n.b),g=new URL(n(17),n.b),f=new URL(n(18),n.b),m=new URL(n(19),n.b),y=new URL(n(20),n.b),b=new URL(n(21),n.b),x=new URL(n(22),n.b),w=new URL(n(23),n.b),v=new URL(n(24),n.b),k=new URL(n(25),n.b),L=new URL(n(26),n.b),_=new URL(n(27),n.b),S=new URL(n(28),n.b),M=new URL(n(29),n.b),I=new URL(n(30),n.b),T=new URL(n(31),n.b),E=new URL(n(32),n.b),N=new URL(n(33),n.b),j=new URL(n(34),n.b),C=new URL(n(35),n.b),A=new URL(n(36),n.b),D=new URL(n(37),n.b),P=new URL(n(38),n.b),O=new URL(n(39),n.b),z=new URL(n(40),n.b),R=new URL(n(41),n.b),B=new URL(n(42),n.b),U=new URL(n(43),n.b),$=new URL(n(44),n.b),W=new URL(n(45),n.b),Y=new URL(n(46),n.b),F=new URL(n(47),n.b),Q=new URL(n(48),n.b),Z=new URL(n(49),n.b),H=new URL(n(50),n.b),V=new URL(n(51),n.b),G=s()(r()),q=l()(c),X=l()(d),J=l()(u),K=l()(h),ee=l()(p),te=l()(g),ne=l()(f),ie=l()(m),re=l()(y),oe=l()(b),se=l()(x),ae=l()(w),le=l()(v),ce=l()(k),de=l()(L),ue=l()(_),he=l()(S),pe=l()(M),ge=l()(I),fe=l()(T),me=l()(E),ye=l()(N),be=l()(j),xe=l()(C),we=l()(A),ve=l()(D),ke=l()(P),Le=l()(O),_e=l()(z),Se=l()(R),Me=l()(B),Ie=l()(U),Te=l()($),Ee=l()(W),Ne=l()(Y),je=l()(F),Ce=l()(Q),Ae=l()(Z),De=l()(H),Pe=l()(V);G.push([e.id,`@charset "UTF-8";\n.reactodia-badge {\n  display: inline-block;\n  min-width: 10px;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 1;\n  color: rgb(255, 255, 255);\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  background-color: rgb(119, 119, 119);\n  padding: 3px 7px;\n  border-radius: 10px;\n}\n\n.reactodia-btn {\n  display: inline-block;\n  padding: 6px 12px;\n  margin-bottom: 0;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.42857143;\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  touch-action: manipulation;\n  cursor: pointer;\n  background-image: none;\n  border: 1px solid transparent;\n  text-transform: none;\n  transition: background-color 0.3s;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-btn[disabled] {\n  cursor: not-allowed;\n  opacity: 0.65;\n}\n\n.reactodia-btn-default {\n  background-color: #fff;\n  border-color: #ccc;\n  color: #333;\n}\n.reactodia-btn-default:hover {\n  background-color: #e0e0e0;\n}\n.reactodia-btn-default.active {\n  background-color: #e0e0e0;\n  border-color: #dbdbdb;\n}\n.reactodia-btn-default.active:hover {\n  background-color: #d4d4d4;\n  border-color: #8c8c8c;\n}\n.reactodia-btn-default[disabled], .reactodia-btn-default[disabled]:hover, .reactodia-btn-default[disabled].active, .reactodia-btn-default[disabled].active:hover {\n  background-color: #e0e0e0;\n}\n\n.reactodia-btn-primary {\n  color: rgb(255, 255, 255);\n  background-color: rgb(51, 122, 183);\n  border-color: #245580;\n}\n.reactodia-btn-primary:hover, .reactodia-btn-primary:focus, .reactodia-btn-primary:active {\n  background-color: #265a88;\n}\n.reactodia-btn-primary:hover, .reactodia-btn-primary:focus {\n  border-color: #204d74;\n}\n.reactodia-btn-primary.active {\n  border-color: #245580;\n}\n.reactodia-btn-primary[disabled], .reactodia-btn-primary[disabled]:hover, .reactodia-btn-primary[disabled]:focus, .reactodia-btn-primary[disabled]:active, .reactodia-btn-primary[disabled].active {\n  background-color: #265a88;\n}\n\n.reactodia-btn-success {\n  background-color: #5cb85c;\n  border-color: #5cb85c;\n  color: #fff;\n  transition: 0.3s;\n}\n.reactodia-btn-success:hover {\n  background: #47a447;\n}\n\n.reactodia-btn-danger {\n  background-color: #c9302c;\n  border-color: #c9302c;\n  color: #fff;\n  transition: 0.3s;\n}\n.reactodia-btn-danger:hover {\n  background: #a82825;\n}\n\n.reactodia-btn-group {\n  position: relative;\n  display: inline-block;\n  vertical-align: middle;\n}\n.reactodia-btn-group > .reactodia-btn, .reactodia-btn-group > .reactodia-btn-group {\n  position: relative;\n  float: left;\n}\n.reactodia-btn-group > .reactodia-btn:hover,\n.reactodia-btn-group > .reactodia-btn:focus,\n.reactodia-btn-group > .reactodia-btn.active,\n.reactodia-btn-group > .reactodia-btn.active:hover {\n  z-index: 2;\n}\n.reactodia-btn-group .reactodia-btn + .reactodia-btn,\n.reactodia-btn-group .reactodia-btn + .reactodia-btn-group,\n.reactodia-btn-group .reactodia-btn-group + .reactodia-btn,\n.reactodia-btn-group .reactodia-btn-group + .reactodia-btn-group {\n  margin-left: -1px;\n}\n.reactodia-btn-group > .reactodia-btn:first-child {\n  margin-left: 0;\n}\n.reactodia-btn-group-sm > .reactodia-btn {\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 5px 10px;\n}\n.reactodia-btn-group-xs > .reactodia-btn {\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 1px 5px;\n}\n\n.clearfix:before, .clearfix:after {\n  display: table;\n  content: "";\n}\n.clearfix:after {\n  clear: both;\n}\n\n.reactodia-form-control {\n  display: block;\n  width: 100%;\n  height: 34px;\n  margin: 0;\n  padding: 6px 12px;\n  font: inherit;\n  font-size: 14px;\n  line-height: 1.42857143;\n  color: #555;\n  background: #fff;\n  border: 1px solid #ccc;\n  transition: border-color ease-in-out 0.15s;\n}\n.reactodia-form-control:focus {\n  border-color: #66afe9;\n  outline: 0;\n}\n.reactodia-form-control:disabled {\n  background-color: #eee;\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.reactodia-input-group {\n  position: relative;\n  display: table;\n  border-collapse: separate;\n}\n.reactodia-input-group .reactodia-form-control {\n  display: table-cell;\n  position: relative;\n  z-index: 2;\n  float: left;\n  width: 100%;\n  margin-bottom: 0;\n}\n.reactodia-input-group .reactodia-form-control:first-child {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n\n.reactodia-input-group-btn {\n  display: table-cell;\n  width: 1%;\n  vertical-align: middle;\n  position: relative;\n  font-size: 0;\n  white-space: nowrap;\n}\n.reactodia-input-group-btn:last-child > .reactodia-btn {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  z-index: 2;\n  margin-left: -1px;\n}\n\n.reactodia-label {\n  display: inline-block;\n  max-width: 100%;\n  margin-bottom: 5px;\n  font-weight: 700;\n}\n\n.reactodia-overlaid-element {\n  cursor: move;\n  outline: none;\n}\n.reactodia-overlaid-element--blurred {\n  filter: grayscale(100%);\n  opacity: 0.5;\n}\n\n.reactodia-overlaid-element img,\n.reactodia-exported-element img {\n  vertical-align: middle;\n}\n\n.reactodia-link--blurred {\n  opacity: 0.5;\n}\n\n.reactodia-link-path__wrap {\n  stroke-width: 12px;\n  stroke-linejoin: round;\n  stroke-linecap: round;\n  stroke: transparent;\n  fill: none;\n}\n.reactodia-link:hover .reactodia-link-path__wrap {\n  stroke: rgba(140, 140, 140, 0.44);\n}\n\n.reactodia-link-vertices__vertex {\n  cursor: all-scroll;\n}\n.reactodia-link:not(:hover) .reactodia-link-vertices__vertex {\n  fill: transparent;\n}\n.reactodia-link-vertices__handle {\n  opacity: 0;\n  cursor: pointer;\n}\n.reactodia-link-vertices__handle > circle {\n  fill: gray;\n}\n.reactodia-link-vertices__handle > path {\n  stroke: white;\n}\n.reactodia-link-vertices__handle:hover > circle {\n  fill: black;\n}\n.reactodia-link:hover .reactodia-link-vertices__handle {\n  opacity: 0.8;\n}\n\n.reactodia-paper-area {\n  flex: auto;\n  width: 0;\n  display: flex;\n  position: relative;\n  cursor: default;\n  background: #fff;\n}\n.reactodia-paper-area__area {\n  flex: auto;\n  overflow: scroll;\n  touch-action: pan-x pan-y;\n}\n.reactodia-paper-area--hide-scrollbars .reactodia-paper-area__area {\n  /* For Firefox */\n  scrollbar-width: none;\n  /* For Safari, Chrome, etc */\n}\n.reactodia-paper-area--hide-scrollbars .reactodia-paper-area__area::-webkit-scrollbar {\n  display: none;\n}\n.reactodia-paper-area__widgets {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.reactodia-paper-area__watermark {\n  background-size: cover;\n  width: 8%;\n  max-width: 130px;\n  min-width: 50px;\n  position: absolute;\n  top: 15px;\n  right: 25px;\n  cursor: pointer;\n  opacity: 0.3;\n  transition: opacity 0.3s;\n}\n.reactodia-paper-area__watermark:hover {\n  opacity: 0.5;\n}\n.reactodia-paper-area--animated .reactodia-overlaid-element {\n  transition: transform 0.5s ease-in-out;\n}\n.reactodia-paper-area--animated .reactodia-link-layer {\n  transition: none;\n  opacity: 0;\n}\n.reactodia-paper-area--animated .reactodia-paper-area__widgets {\n  transition: none;\n  opacity: 0;\n}\n\n.reactodia-paper {\n  position: relative;\n}\n\n.reactodia-exported-watermark {\n  opacity: 0.3;\n  transition: opacity 0.3s;\n}\n\n.reactodia-exported-canvas {\n  /* Defaults for inheritable properties */\n  box-sizing: border-box;\n  white-space: initial;\n  color: #333;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: 14px;\n  line-height: 1.42857;\n}\n.reactodia-exported-canvas *, .reactodia-exported-canvas *:before, .reactodia-exported-canvas *:after {\n  box-sizing: inherit;\n}\n\n.reactodia-spinner__arrow {\n  animation-name: reactodia-spinner-rotation;\n  animation-duration: 1.5s;\n  animation-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1);\n  animation-iteration-count: infinite;\n}\n.reactodia-spinner[data-error=true] .reactodia-spinner__arrow {\n  animation-iteration-count: 1;\n}\n\n@keyframes reactodia-spinner-rotation {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.reactodia-authoring-state__item-error {\n  align-self: flex-end;\n  margin: 0px 5px;\n  display: flex;\n  align-items: center;\n  cursor: help;\n}\n.reactodia-authoring-state__item-error-icon {\n  background: red;\n  -webkit-mask: url(${q});\n  mask: url(${q});\n  height: 15px;\n  width: 17px;\n}\n.reactodia-authoring-state__state-label {\n  font-weight: bold;\n  margin-right: 5px;\n}\n.reactodia-authoring-state__state-cancel {\n  color: #3f87a6;\n  cursor: pointer;\n}\n.reactodia-authoring-state__state-cancel:hover {\n  text-decoration: underline;\n}\n.reactodia-authoring-state__state-indicator {\n  position: absolute;\n}\n.reactodia-authoring-state__state-indicator-container {\n  position: relative;\n}\n.reactodia-authoring-state__state-indicator-body {\n  position: absolute;\n  white-space: nowrap;\n  display: flex;\n  align-items: center;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.7);\n  border-radius: 5px;\n}\n\n.reactodia-edit-form {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-edit-form__body {\n  overflow: auto;\n  padding: 10px;\n  flex: 1 1 100%;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n}\n.reactodia-edit-form__controls {\n  border-top: 1px solid #ccc;\n  padding: 10px;\n  text-align: right;\n  flex: 0 0 auto;\n}\n.reactodia-edit-form__apply-button {\n  margin-right: 5px;\n}\n.reactodia-edit-form__form-row {\n  display: block;\n  margin-bottom: 10px;\n}\n.reactodia-edit-form__element-selector {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-edit-form__search {\n  flex-shrink: 0;\n  position: relative;\n}\n.reactodia-edit-form__search-icon {\n  background-image: url(${X});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  opacity: 0.6;\n  position: absolute;\n  top: 50%;\n  left: 10px;\n  margin-top: -7px;\n}\n.reactodia-edit-form__search-input {\n  padding-left: 33px;\n}\n.reactodia-edit-form__existing-elements-list {\n  flex: 1 1 0;\n  margin-top: 7px;\n  padding-right: 10px;\n  overflow-y: scroll;\n}\n.reactodia-edit-form__separator {\n  margin: 7px 0;\n  overflow: hidden;\n  text-align: center;\n}\n.reactodia-edit-form__separator-text {\n  color: #555;\n  display: inline-block;\n  font-size: 13px;\n  position: relative;\n}\n.reactodia-edit-form__separator-text:before, .reactodia-edit-form__separator-text:after {\n  content: "";\n  border-top: 1px solid;\n  position: absolute;\n  top: 50%;\n  margin: 0 10px;\n  width: 500px;\n}\n.reactodia-edit-form__separator-text:before {\n  left: 100%;\n}\n.reactodia-edit-form__separator-text:after {\n  right: 100%;\n}\n.reactodia-edit-form__progress {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactodia-edit-form__control-row {\n  position: relative;\n  padding-bottom: 18px;\n}\n.reactodia-edit-form__control-error {\n  color: red;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n}\n\n.reactodia-loading-widget {\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.9);\n  z-index: 10;\n}\n\n.reactodia-fetch-status--loading {\n  animation: reactodia-loading-pulse 2s linear infinite;\n}\n.reactodia-fetch-status--error::before {\n  content: "\u26a0 ";\n  color: rgba(255, 0, 0, 0.5);\n}\n\n@keyframes reactodia-loading-pulse {\n  0% {\n    opacity: 1;\n    stroke-opacity: 1;\n  }\n  50% {\n    opacity: 0.3;\n    stroke-opacity: 0.3;\n  }\n  100% {\n    opacity: 1;\n    stroke-opacity: 1;\n  }\n}\n.reactodia-canvas {\n  flex: 1 1 0px;\n  width: 100%;\n  display: flex;\n  overflow: hidden;\n}\n\n.reactodia-class-tree {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-class-tree__filter {\n  flex-shrink: 0;\n  margin: 10px 0 10px 0;\n}\n.reactodia-class-tree__filter-group {\n  margin-left: 10px;\n  margin-right: 10px;\n}\n.reactodia-class-tree__only-creatable {\n  display: block;\n  margin-top: 5px;\n}\n.reactodia-class-tree__tree {\n  border-top: 1px solid rgb(221, 221, 221);\n}\n.reactodia-class-tree__spinner {\n  align-self: center;\n  /* center vertically in flexbox */\n  margin: auto;\n}\n\n.reactodia-class-tree-item {\n  margin: 1px 0;\n}\n.reactodia-class-tree-item__row {\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-class-tree-item__row > * {\n  flex-shrink: 0;\n}\n.reactodia-class-tree-item__body {\n  display: flex;\n  align-items: center;\n  text-decoration: none;\n  font-size: 15px;\n  padding: 1px;\n  border: 1px solid;\n  border-color: transparent;\n}\n.reactodia-class-tree-item__body:hover {\n  background: rgba(220, 235, 255, 0.568627451);\n  border-color: #ccefff;\n  cursor: pointer;\n}\n.reactodia-class-tree-item__body--selected {\n  background-color: #beebff;\n  border-color: #8edcff;\n}\n.reactodia-class-tree-item__icon-container {\n  height: 20px;\n}\n.reactodia-class-tree-item__icon {\n  display: block;\n  height: 100%;\n}\n.reactodia-class-tree-item__default-icon-leaf, .reactodia-class-tree-item__default-icon-parent {\n  background-image: url(${J});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 20px;\n  height: 20px;\n}\n.reactodia-class-tree-item__label {\n  margin-left: 5px;\n  color: black;\n}\n.reactodia-class-tree-item__highlighted-term {\n  font-weight: bold;\n}\n.reactodia-class-tree-item__count {\n  margin-left: 5px;\n}\n.reactodia-class-tree-item__children {\n  margin-left: 20px;\n}\n.reactodia-class-tree-item__toggle, .reactodia-class-tree-item__toggle-expanded, .reactodia-class-tree-item__toggle-collapsed {\n  margin: 2px;\n}\n.reactodia-class-tree-item__toggle-expanded, .reactodia-class-tree-item__toggle-collapsed {\n  opacity: 0.5;\n}\n.reactodia-class-tree-item__toggle-expanded:hover, .reactodia-class-tree-item__toggle-collapsed:hover {\n  cursor: pointer;\n  opacity: 1;\n  transition: opacity 0.3s;\n}\n.reactodia-class-tree-item__toggle::before {\n  display: block;\n  content: "";\n  width: 16px;\n  height: 16px;\n}\n.reactodia-class-tree-item__toggle-expanded::before {\n  background-image: url(${K});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-class-tree-item__toggle-collapsed::before {\n  background-image: url(${ee});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-class-tree-item__create-button {\n  margin-left: 5px;\n  padding: 5px;\n  cursor: move;\n}\n.reactodia-class-tree-item__create-button::before {\n  background-image: url(${te});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 12px;\n  height: 12px;\n}\n\n.reactodia-connections-menu {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-connections-menu__breadcrumbs {\n  padding: 10px;\n  padding-bottom: 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  height: 27px;\n  min-height: 27px;\n  flex-grow: 0;\n}\n.reactodia-connections-menu__breadcrumbs-link {\n  color: #337ab7;\n  cursor: pointer;\n  text-decoration: none;\n}\n.reactodia-connections-menu__breadcrumbs-link:hover {\n  text-decoration: underline;\n}\n.reactodia-connections-menu__title-label {\n  position: absolute;\n  top: -11px;\n  left: 10px;\n  background: white;\n  padding-left: 3px;\n  padding-right: 3px;\n  border-radius: 6px;\n}\n.reactodia-connections-menu__search-line {\n  padding: 10px;\n  display: flex;\n  align-items: center;\n  flex: 0 0 auto;\n}\n.reactodia-connections-menu__search-line-input {\n  flex: 1 1 100%;\n}\n.reactodia-connections-menu__sort-switches {\n  flex: 0 0 20px;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__sort-switch {\n  display: none;\n}\n.reactodia-connections-menu__sort-switch:checked + .reactodia-connections-menu__sort-switch-label {\n  color: #337ab7;\n  opacity: 1;\n}\n.reactodia-connections-menu__sort-switch-label {\n  cursor: pointer;\n  display: block;\n  margin: 0;\n  opacity: 0.4;\n  text-align: center;\n}\n.reactodia-connections-menu__sort-switch-label:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__sort-label-alpha::before {\n  background-image: url(${ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-connections-menu__sort-label-smart::before {\n  background-image: url(${ie});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-connections-menu__loading, .reactodia-connections-menu__error {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  font-size: x-large;\n  display: flex;\n  color: #cbcbcb;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-connections-menu__links-list {\n  padding: 5px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  border-top: 1px solid #dbdbdb;\n  flex-grow: 1;\n  margin: 0;\n}\n.reactodia-connections-menu__links-list-empty {\n  display: flex;\n  align-items: center;\n}\n.reactodia-connections-menu__empty-label {\n  width: 100%;\n  position: relative;\n  font-size: x-large;\n  color: #cbcbcb;\n  text-align: center;\n}\n.reactodia-connections-menu__links-list-hr {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n.reactodia-connections-menu__link {\n  display: flex;\n  overflow: hidden;\n  padding: 0 5px 0 0;\n  align-items: center;\n  margin-bottom: 4px;\n  background: #f7f7f7;\n}\n.reactodia-connections-menu__link:hover {\n  background-color: #e2e2e2;\n}\n.reactodia-connections-menu__link-direction {\n  flex-shrink: 0;\n  background: rgba(219, 219, 219, 0.35);\n  min-height: 30px;\n  padding: 5px 0px 5px 10px;\n  display: flex;\n  align-items: center;\n}\n.reactodia-connections-menu__link-direction-in {\n  background: url(${re}) 0 0 no-repeat;\n  flex-shrink: 0;\n  width: 20px;\n  height: 20px;\n  margin: 0 14px 0 0;\n  background-size: contain;\n  opacity: 0.5;\n}\n.reactodia-connections-menu__link-direction-out {\n  background: url(${oe}) 0 0 no-repeat;\n  flex-shrink: 0;\n  width: 20px;\n  height: 20px;\n  margin: 0 8px 0 6px;\n  background-size: contain;\n  opacity: 0.5;\n}\n.reactodia-connections-menu__link-title {\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin: 5px 0px 5px 5px;\n}\n.reactodia-connections-menu__link-count {\n  flex-shrink: 0;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__link-navigate-button {\n  flex-shrink: 0;\n  float: right;\n  background-image: url(${se});\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n  margin-left: 10px;\n  min-width: 16px;\n  background-size: cover;\n}\n.reactodia-connections-menu__link-navigate-button:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__link-filter-button {\n  flex-shrink: 0;\n  background-image: url(${ae});\n  background-size: 20px 20px;\n  width: 20px;\n  height: 20px;\n  opacity: 0.4;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__link-filter-button:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__move-to-filter {\n  display: flex;\n  padding: 5px 10px;\n  cursor: pointer;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-connections-menu__move-to-filter:hover {\n  background-color: #e6e6e6;\n}\n.reactodia-connections-menu__objects {\n  flex-grow: 1;\n  padding: 10px;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  padding-top: 0px;\n}\n.reactodia-connections-menu__objects-select-all {\n  white-space: nowrap;\n  margin-bottom: 5px;\n  display: flex;\n}\n.reactodia-connections-menu__objects-select-all input {\n  margin-right: 5px;\n}\n.reactodia-connections-menu__objects-select-all input:disabled {\n  opacity: 0.3;\n}\n.reactodia-connections-menu__objects-loading {\n  border: 1px solid gray;\n  flex-grow: 1;\n  box-shadow: inset 0px 0px 23px -8px gray;\n  background-color: whitesmoke;\n  position: relative;\n  font-size: x-large;\n  display: flex;\n  color: #cbcbcb;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 5px;\n}\n.reactodia-connections-menu__objects-list {\n  border: 1px solid gray;\n  height: 0;\n  flex-grow: 1;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  padding: 5px;\n  margin-bottom: 5px;\n}\n.reactodia-connections-menu__objects-statusbar {\n  height: 25px;\n  white-space: nowrap;\n  display: flex;\n  justify-content: space-between;\n}\n.reactodia-connections-menu__objects-count {\n  height: 25px;\n  float: left;\n  padding: 0px 5px;\n  font-size: larger;\n  display: flex;\n  align-items: center;\n  max-width: 60%;\n}\n.reactodia-connections-menu__objects-extra {\n  color: gray;\n  cursor: help;\n}\n.reactodia-connections-menu__objects-add-button {\n  height: 25px;\n  padding-top: 1px;\n  padding-bottom: 2px;\n}\n\n.reactodia-dialog {\n  background: #fff;\n  border: 1px solid #333;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n  position: absolute;\n}\n.reactodia-dialog__caption {\n  font-weight: bold;\n  position: absolute;\n  top: -11px;\n  left: 10px;\n  background: white;\n  padding-left: 3px;\n  padding-right: 3px;\n  border-radius: 6px;\n}\n.reactodia-dialog__close-button {\n  background: transparent url(${le}) no-repeat;\n  background-size: contain;\n  border: 0 none;\n  cursor: pointer;\n  display: block;\n  outline: none;\n  padding: 0;\n  position: absolute;\n  top: -22px;\n  right: -22px;\n  height: 20px;\n  width: 20px;\n  opacity: 0.5;\n  transition: 0.3s;\n}\n.reactodia-dialog__close-button:hover {\n  opacity: 1;\n}\n\n.reactodia-dialog__bottom-right-handle {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 10px 10px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n  cursor: nwse-resize;\n}\n.reactodia-dialog__bottom-right-handle::before {\n  content: "";\n  position: absolute;\n  bottom: -10px;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 5px 5px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n}\n.reactodia-dialog__bottom-right-handle:hover {\n  border-color: transparent transparent rgba(0, 0, 0, 0.5) transparent;\n}\n\n.reactodia-dialog__bottom-handle, .reactodia-dialog__right-handle {\n  position: absolute;\n  opacity: 0;\n  background-color: black;\n}\n.reactodia-dialog__bottom-handle:hover, .reactodia-dialog__right-handle:hover {\n  opacity: 0.1;\n}\n\n.reactodia-dialog__bottom-handle {\n  bottom: 0;\n  width: 100%;\n  height: 5px;\n  cursor: ns-resize;\n}\n\n.reactodia-dialog__right-handle {\n  top: 0;\n  right: 0;\n  width: 5px;\n  height: 100%;\n  cursor: ew-resize;\n}\n\n.reactodia-dropdown {\n  position: relative;\n  float: left;\n  z-index: 1;\n}\n.reactodia-dropdown__toggle::before {\n  background-image: url(${ce});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-dropdown--expanded .reactodia-dropdown__toggle {\n  background-color: #bfbfbf;\n}\n.reactodia-dropdown__items {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  opacity: 1;\n  background: white;\n  list-style: none;\n  display: flex;\n  flex-direction: column;\n  transition: opacity 0.1s ease-in-out;\n}\n.reactodia-dropdown--collapsed .reactodia-dropdown__items {\n  height: 0;\n  opacity: 0;\n  pointer-events: none;\n}\n\n.reactodia-dropdown-item ~ .reactodia-dropdown-item {\n  margin-top: -1px;\n  border-top-color: #eee;\n}\n.reactodia-dropdown-item--disabled, .reactodia-dropdown-item--disabled:hover {\n  background-color: #e0e0e0;\n  cursor: not-allowed;\n  opacity: 0.65;\n}\n\n.reactodia-halo {\n  position: absolute;\n  pointer-events: none;\n  border: 1.5px dashed #d8956d;\n  border-radius: 2px;\n  box-shadow: 0 0 5px 0 #d8956d inset;\n}\n\n.reactodia-halo-link__label-highlight {\n  position: absolute;\n  pointer-events: none;\n  border-bottom: 2px solid #d8956d;\n}\n.reactodia-halo-link__path-highlight {\n  fill: none;\n  /* Invisible by default but allows to be customized externally */\n}\n\n.reactodia-instances-search {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-instances-search__criteria {\n  flex-shrink: 0;\n  margin: 10px 0 10px 0;\n}\n.reactodia-instances-search__criterions {\n  padding-left: 15px;\n  margin-bottom: 10px;\n}\n.reactodia-instances-search__criterions:empty {\n  margin-bottom: 0;\n}\n.reactodia-instances-search__criterion {\n  display: block;\n  position: relative;\n  width: 100%;\n}\n.reactodia-instances-search__criterion-class {\n  border: black 1px dashed;\n  background: rgb(255, 210, 33);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__criterion-element {\n  border: black 1px dashed;\n  background: rgb(255, 131, 92);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__criterion-link-type {\n  border: black 1px dashed;\n  background: rgb(202, 255, 206);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__link-direction {\n  height: 1em;\n  opacity: 0.5;\n  vertical-align: middle;\n}\n.reactodia-instances-search__criterion-remove {\n  float: right;\n  margin: 0 10px 4px 4px;\n}\n.reactodia-instances-search__criterion-remove-button::before {\n  background-image: url(${de});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-instances-search__text-criteria {\n  margin: 0 10px;\n}\n.reactodia-instances-search__search-button {\n  height: 34px;\n}\n.reactodia-instances-search__search-button::before {\n  background-image: url(${X});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-instances-search__rest {\n  padding: 10px 10px 0 10px;\n  border-top: 1px solid rgb(221, 221, 221);\n}\n.reactodia-instances-search__results {\n  padding-left: 0;\n  padding-top: 10px;\n  margin: 0 10px 0 10px;\n  outline: none;\n}\n.reactodia-instances-search[data-state=finished] .reactodia-instances-search__results:empty:before {\n  content: "No items correspond to the specified criteria.";\n  font-style: italic;\n}\n.reactodia-instances-search__rest-end {\n  margin: 5px 0 10px 0;\n}\n.reactodia-instances-search__load-more {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-instances-search__load-more::before {\n  background-image: url(${ue});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 5px;\n  filter: invert(100%);\n}\n\n.reactodia-link-action {\n  position: absolute;\n  cursor: pointer;\n  border: 0 none;\n  padding: 0;\n  opacity: 0.8;\n  outline: none;\n  transition: opacity 0.3s;\n}\n.reactodia-link-action:hover {\n  opacity: 1;\n}\n.reactodia-link-action[disabled] {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n.reactodia-link-action__spinner {\n  position: absolute;\n}\n.reactodia-link-action__button {\n  background-color: #ccc;\n  background-position: 50%;\n  background-repeat: no-repeat;\n  background-size: 65%;\n  border-radius: calc(var(--reactodia-link-button-size) * 0.5);\n  height: var(--reactodia-link-button-size);\n  width: var(--reactodia-link-button-size);\n}\n.reactodia-link-action__endpoint {\n  background: transparent;\n}\n.reactodia-link-action__edit {\n  background-image: url(${he});\n}\n.reactodia-link-action__delete {\n  background-image: url(${pe});\n}\n.reactodia-link-action__rename {\n  background: white url(${he}) no-repeat;\n  background-size: 80%;\n  background-position: center;\n  filter: invert();\n  position: absolute;\n  margin-left: 5px;\n  padding: 0;\n  border: 0 none;\n  border-radius: 2px;\n  outline: none;\n  cursor: pointer;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-link-action__rename:hover {\n  opacity: 1;\n}\n\n.link-types-toolbox {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 0;\n}\n.link-types-toolbox__heading {\n  padding: 10px;\n}\n.link-types-toolbox__searching-box {\n  display: flex;\n  align-items: center;\n}\n.link-types-toolbox__clearSearch {\n  margin-left: -25px;\n  padding: 0;\n  cursor: pointer;\n  background: 0 0;\n  border: 0;\n  transition: background-color 0.3s;\n}\n.link-types-toolbox__clearSearch:hover {\n  background-color: #eeeeee;\n}\n.link-types-toolbox__clearSearch::after {\n  background-image: url(${de});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.link-types-toolbox__switch-all {\n  margin-top: 5px;\n}\n.link-types-toolbox__rest {\n  border-top: 1px solid #dddddd;\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.link-types-toolbox__toggle-invisible, .link-types-toolbox__toggle-lines-only, .link-types-toolbox__toggle-visible {\n  border-color: rgb(195, 195, 195);\n}\n.link-types-toolbox__toggle-invisible::before {\n  background-image: url(${ge});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.link-types-toolbox__toggle-lines-only::before {\n  background-image: url(${fe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.link-types-toolbox__toggle-visible::before {\n  background-image: url(${me});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.link-types-toolbox__links-heading {\n  font-size: 18px;\n  font-weight: 500;\n  margin: 10px 0.4em;\n}\n.link-types-toolbox__links-heading > span {\n  border: black 1px dashed;\n  background: rgb(255, 131, 92);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n  line-height: 1.3;\n}\n.link-types-toolbox__connected-links {\n  margin: 0;\n  padding: 0;\n}\n.link-types-toolbox__connected-links .linkInToolBox .reactodia-badge {\n  /* show connection count badge only in "Connected to Element" list */\n  display: inline;\n}\n.link-types-toolbox__connected-links .linkInToolBox__filter-button {\n  /* show filter button only in "Connected to Element" list */\n  display: inline;\n}\n.link-types-toolbox__link-item {\n  position: relative;\n  display: block;\n  padding: 0 0 0 5px;\n  margin-bottom: -1px;\n  background-color: #fff;\n  border: 1px solid #ddd;\n  word-break: break-word;\n}\n.link-types-toolbox__link-item:last-child {\n  margin-bottom: 0;\n}\n.link-types-toolbox__link-item > div {\n  display: inline;\n}\n.link-types-toolbox__link-title {\n  font-size: 16px;\n  color: black;\n  display: inline;\n}\n.link-types-toolbox__link-buttons {\n  float: left;\n  margin-top: 2px;\n  margin-right: 6px;\n  margin-bottom: 2px;\n}\n.link-types-toolbox__count-badge {\n  display: none;\n  margin-left: 0.5em;\n  white-space: normal;\n  word-wrap: normal;\n}\n.link-types-toolbox__link-item:hover .link-types-toolbox__filter-button {\n  opacity: 1;\n  transition: opacity 200ms 0ms;\n}\n.link-types-toolbox__filter-button {\n  display: none;\n  float: right;\n  background-image: url(${ae});\n  background-size: 20px 20px;\n  width: 20px;\n  height: 20px;\n  margin: 3px;\n  cursor: pointer;\n  opacity: 0.4;\n  transition: opacity 200ms 0ms;\n}\n\n.reactodia-list-element-view {\n  position: relative;\n  display: block;\n  background: #808080;\n  padding: 1px 1px 1px 10px;\n  border-radius: 2px;\n  margin: 0 0 2px 0;\n  opacity: 1;\n  cursor: move;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-list-element-view--disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n.reactodia-list-element-view__label {\n  background: white;\n  border-radius: 0 2px 2px 0;\n  font-family: "Andale Mono", sans-serif;\n  font-size: 15px;\n  min-height: 1.3em;\n  padding-left: 7px;\n  padding-right: 5px;\n  overflow-wrap: break-word;\n}\n\n.reactodia-text-highlight {\n  font-weight: bold;\n}\n\n.reactodia-navigator {\n  display: block;\n  position: absolute;\n  bottom: 25px;\n  right: 25px;\n  overflow: hidden;\n  background: #fff;\n  border: 1px solid #ddd;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n  transition: width 0.3s, height 0.3s;\n}\n.reactodia-navigator--collapsed {\n  width: 24px;\n  height: 24px;\n}\n.reactodia-navigator > canvas {\n  transition: opacity 0.3s;\n}\n.reactodia-navigator--expanded > canvas {\n  opacity: 1;\n}\n.reactodia-navigator--collapsed > canvas {\n  opacity: 0;\n}\n.reactodia-navigator__toggle {\n  position: absolute;\n  background: transparent;\n  border: none;\n  outline: none;\n  padding: 4px;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-navigator__toggle:hover {\n  opacity: 1;\n}\n.reactodia-navigator--expanded .reactodia-navigator__toggle {\n  top: 5px;\n  left: 5px;\n}\n.reactodia-navigator--collapsed .reactodia-navigator__toggle {\n  top: 0px;\n  left: 0px;\n}\n.reactodia-navigator__toggle-icon {\n  width: 18px;\n  height: 18px;\n  background-size: 18px 18px;\n  background-repeat: no-repeat;\n}\n.reactodia-navigator--expanded .reactodia-navigator__toggle-icon {\n  background-image: url(${ye});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-navigator--collapsed .reactodia-navigator__toggle-icon {\n  background-image: url(${be});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n@keyframes reactodia-progress-bar-stripes {\n  from {\n    background-position: 40px 0;\n  }\n  to {\n    background-position: 0 0;\n  }\n}\n.reactodia-progress-bar {\n  flex-shrink: 0;\n  width: 100%;\n  background-color: #f5f5f5;\n  background-image: linear-gradient(to bottom, #ebebeb 0%, #f5f5f5 100%);\n  background-repeat: repeat-x;\n  overflow: hidden;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n.reactodia-progress-bar__bar {\n  float: left;\n  height: 100%;\n  font-size: 12px;\n  line-height: 20px;\n  color: #fff;\n  text-align: center;\n  transition: width 0.6s ease;\n  background-color: #337ab7;\n  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n  background-repeat: repeat-x;\n  background-size: 40px 40px;\n  animation: reactodia-progress-bar-stripes 2s linear infinite;\n}\n.reactodia-progress-bar--error .reactodia-progress-bar__bar {\n  background-color: #E72F2F;\n}\n.reactodia-progress-bar--loading, .reactodia-progress-bar--error {\n  /* property name | duration | delay */\n  transition: height 300ms 300ms;\n}\n.reactodia-progress-bar--completed {\n  /* property name | duration | delay */\n  transition: height 200ms 0ms;\n}\n\n.reactodia-search-results {\n  margin: 0;\n  padding: 0;\n  outline: none;\n}\n\n.reactodia-selection {\n  position: absolute;\n  --reactodia-dock-margin-x: 2px;\n  --reactodia-dock-margin-y: 2px;\n}\n.reactodia-selection__selectedBox {\n  position: absolute;\n  background-color: rgba(255, 166, 0, 0.06);\n  border: 1px solid orange;\n  border-radius: 2px;\n  box-shadow: 0 0 7px 7px rgba(51, 51, 51, 0.13);\n  cursor: move;\n}\n.reactodia-selection__selectedActions {\n  position: absolute;\n}\n.reactodia-selection__selectedItem {\n  position: absolute;\n  border: 1px dashed orange;\n  background-color: rgba(255, 166, 0, 0.16);\n}\n.reactodia-selection__highlightedBox {\n  position: absolute;\n  background-color: rgba(0, 219, 255, 0.13);\n  border: 2px dashed rgb(0, 179, 209);\n  border-radius: 2px;\n}\n.reactodia-selection__highlightedItem {\n  position: absolute;\n  border: 1px dashed rgb(0, 188, 126);\n  background: rgba(0, 188, 126, 0.33);\n}\n\n.reactodia-selection-action {\n  position: absolute;\n  background-color: transparent;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n  border: 0 none;\n  cursor: pointer;\n  outline: none;\n  padding: 0;\n  pointer-events: auto;\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-selection-action:hover {\n  opacity: 1;\n}\n.reactodia-selection-action[disabled] {\n  cursor: not-allowed;\n  opacity: 0.2;\n}\n.reactodia-selection-action--dock-nw {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-n {\n  left: 50%;\n  margin-left: calc(-11px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-ne {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-e {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: 50%;\n  margin-top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-se {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-s {\n  left: 50%;\n  margin-left: calc(-11px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-sw {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-w {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: 50%;\n  margin-top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action__spinner {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n}\n.reactodia-selection-action__remove {\n  background-image: url(${xe});\n}\n.reactodia-selection-action__delete {\n  background-image: url(${pe});\n}\n.reactodia-selection-action__zoomToFit {\n  background-image: url(${we});\n}\n.reactodia-selection-action__layout {\n  background-image: url(${ve});\n}\n.reactodia-selection-action__expand {\n  background-image: url(${ue});\n}\n.reactodia-selection-action__collapse {\n  background-image: url(${ke});\n}\n.reactodia-selection-action__link {\n  background-image: url(${Le});\n}\n.reactodia-selection-action__navigate-open {\n  background-image: url(${_e});\n}\n.reactodia-selection-action__navigate-close {\n  background-image: url(${le});\n}\n.reactodia-selection-action__add-to-filter {\n  background-image: url(${ae});\n}\n.reactodia-selection-action__establish-link {\n  background-image: url(${Se});\n}\n\n.reactodia-toolbar {\n  position: absolute;\n  left: 10px;\n  top: 10px;\n  /* Make transparent toolbar parts "click-through"\n    while keeping buttons clickable */\n  pointer-events: none;\n}\n.reactodia-toolbar > * {\n  pointer-events: auto;\n}\n.reactodia-toolbar__menu {\n  margin-right: 5px;\n}\n\n.reactodia-toolbar-action__open {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__open::before {\n  background-image: url(${Me});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__open-input {\n  display: none;\n}\n.reactodia-toolbar-action__save {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__save::before {\n  background-image: url(${Ie});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__clear-all {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__clear-all::before {\n  background-image: url(${pe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__export-image {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__export-image::before {\n  background-image: url(${Te});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__print {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__print::before {\n  background-image: url(${Ee});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__undo:empty::before {\n  background-image: url(${Ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 18px;\n  height: 18px;\n}\n.reactodia-toolbar-action__undo:not(:empty) {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__undo:not(:empty)::before {\n  background-image: url(${Ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__redo:empty::before {\n  background-image: url(${je});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 18px;\n  height: 18px;\n}\n.reactodia-toolbar-action__redo:not(:empty) {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__redo:not(:empty)::before {\n  background-image: url(${je});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__layout {\n  margin-right: 5px;\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__layout::before {\n  background-image: url(${ve});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__language-selector {\n  float: left;\n  position: relative;\n  height: 30px;\n  background: white;\n  border: 1px solid #ccc;\n  padding: 0 5px;\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__language-selector select {\n  color: inherit;\n  margin: 0;\n  font: inherit;\n  line-height: inherit;\n}\n.reactodia-toolbar-action__language-selector label {\n  display: inline-block;\n  margin-right: 5px;\n}\n.reactodia-toolbar-action__language-selector label::before {\n  background-image: url(${Ce});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-zoom-control {\n  position: absolute;\n  left: 10px;\n  bottom: 10px;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n}\n.reactodia-zoom-control .reactodia-btn {\n  padding: 3px;\n}\n.reactodia-zoom-control .reactodia-btn + .reactodia-btn {\n  margin-top: -1px;\n}\n.reactodia-zoom-control__zoom-in-button::before {\n  background-image: url(${Ae});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-zoom-control__zoom-out-button::before {\n  background-image: url(${De});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-zoom-control__zoom-fit-button::before {\n  background-image: url(${we});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-accordion {\n  flex: auto;\n  display: flex;\n  height: 100%;\n  width: 100%;\n}\n.reactodia-accordion--scrollable {\n  overflow: auto;\n}\n.reactodia-accordion--vertical {\n  flex-direction: column;\n}\n.reactodia-accordion--vertical:not(.reactodia-accordion--resizing) > .reactodia-accordion-item {\n  transition: height 0.3s ease-in-out;\n}\n\n.reactodia-accordion-item {\n  display: flex;\n  position: relative;\n  flex: auto;\n}\n.reactodia-accordion-item--resizing > .reactodia-accordion-item__handle, .reactodia-accordion-item__handle:hover {\n  background: rgba(0, 0, 0, 0.1);\n}\n.reactodia-accordion-item--vertical {\n  border-top: 1px solid lightgray;\n}\n.reactodia-accordion-item--vertical:first-child {\n  border-top-width: 0;\n}\n.reactodia-accordion-item--horizontal {\n  border-right: 1px solid lightgray;\n}\n.reactodia-accordion-item--horizontal:last-child {\n  border-right-width: 0;\n}\n.reactodia-accordion-item__handle {\n  position: absolute;\n  z-index: 2;\n}\n.reactodia-accordion-item__handle-vertical {\n  height: 5px;\n  bottom: -2.5px;\n  left: 0;\n  width: 100%;\n  cursor: ns-resize;\n}\n.reactodia-accordion-item__handle-horizontal {\n  height: 100%;\n  top: 0;\n  right: -2.5px;\n  width: 5px;\n  cursor: ew-resize;\n}\n.reactodia-accordion-item__handle-btn {\n  background: #fff;\n  border: 2px solid #17b;\n  box-shadow: 0 0 0 1px rgba(9, 30, 66, 0.08), 0 2px 4px 1px rgba(9, 30, 66, 0.08);\n  border-radius: 10px;\n  cursor: pointer;\n  height: 20px;\n  position: absolute;\n  top: 50%;\n  margin-top: -10px;\n  width: 20px;\n  z-index: 20;\n  transition: 0.3s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-accordion-item__handle-btn::before {\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  background-size: cover;\n  content: "";\n  height: 16px;\n  width: 16px;\n  opacity: 0.3;\n  transition: opacity filter 0.3s;\n}\n.reactodia-accordion-item__handle-btn:hover {\n  background: #17b;\n}\n.reactodia-accordion-item__handle-btn:hover::before {\n  opacity: 1;\n  filter: invert();\n}\n.reactodia-accordion-item__handle-btn-left {\n  left: 100%;\n  margin-left: -10px;\n}\n.reactodia-accordion-item__handle-btn-left::before {\n  background-image: url(${Pe});\n}\n.reactodia-accordion-item__handle-btn-right {\n  right: 100%;\n  margin-right: -10px;\n}\n.reactodia-accordion-item__handle-btn-right:before {\n  background-image: url(${se});\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__handle-btn:before {\n  transform: rotate(180deg);\n}\n.reactodia-accordion-item__inner {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.reactodia-accordion-item__body {\n  flex: 1 1 0px;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-accordion-item__header {\n  padding-left: 20px;\n  position: relative;\n  flex-shrink: 0;\n  font-size: 16px;\n  background: #E4E4E4;\n  cursor: default;\n  /* unselectable */\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.reactodia-accordion-item__header:before {\n  border-top: 6px solid #555555;\n  border-left: 3.5px solid transparent;\n  border-right: 3.5px solid transparent;\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 7px;\n  margin-top: -3px;\n  -webkit-transition: 0.1s;\n  -moz-transition: 0.1s;\n  transition: 0.1s;\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__header:before {\n  -webkit-transform: rotate(-90deg);\n  -moz-transform: rotate(-90deg);\n  -ms-transform: rotate(-90deg);\n  transform: rotate(-90deg);\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__body {\n  display: none;\n}\n\n.reactodia-workspace {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* Defaults for inheritable properties */\n  box-sizing: border-box;\n  white-space: initial;\n  color: #333;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: 14px;\n  line-height: 1.42857;\n}\n.reactodia-workspace *, .reactodia-workspace *:before, .reactodia-workspace *:after {\n  box-sizing: inherit;\n}\n\n.reactodia-scrollable {\n  flex: 1 1 0px;\n  overflow-y: scroll;\n}\n\n.reactodia-scrollable > * {\n  position: relative;\n}\n\n.reactodia-classic-template, .reactodia-group-template__wrap {\n  max-width: 450px;\n  float: left;\n  border-radius: 12px;\n  border-style: solid;\n  border-width: 1px;\n}\n.reactodia-classic-template__thumbnail {\n  text-align: center;\n}\n.reactodia-classic-template__thumbnail-image {\n  max-width: 200px;\n}\n.reactodia-classic-template--expanded .reactodia-classic-template__thumbnail-image {\n  max-width: 350px;\n}\n.reactodia-classic-template__type-line, .reactodia-group-template__type-line {\n  padding: 0px 7px;\n  color: white;\n  height: 18px;\n  margin-bottom: 2px;\n  overflow: hidden;\n  display: flex;\n  align-items: baseline;\n  margin-top: -3px;\n}\n.reactodia-classic-template__type-line-icon, .reactodia-group-template__type-line-icon {\n  position: inherit !important;\n  margin-right: 4px;\n}\n.reactodia-classic-template__type-line-text-container, .reactodia-group-template__type-line-text-container {\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  width: 0;\n}\n.reactodia-classic-template__type-line-text, .reactodia-group-template__type-line-text {\n  display: inline;\n  white-space: nowrap;\n  font-size: 12px;\n}\n.reactodia-classic-template__body, .reactodia-group-template__body {\n  border-bottom-left-radius: 12px;\n  border-bottom-right-radius: 12px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  background: white;\n  padding: 7px 10px 8px 10px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-classic-template__label, .reactodia-group-template__label {\n  font-size: 19px;\n  font-weight: 100;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 0;\n  white-space: nowrap;\n  word-wrap: break-word;\n}\n.reactodia-classic-template__expander {\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n}\n.reactodia-classic-template__iri-heading {\n  font-size: 12px;\n  font-weight: 100;\n  margin-right: 15px;\n  color: #b6b6b6;\n}\n.reactodia-classic-template__iri-container {\n  font-size: 12px;\n  width: 100%;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n.reactodia-classic-template__iri {\n  color: #b6b6b6;\n}\n.reactodia-classic-template__divider {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin: 5px 0px 5px 0px;\n}\n.reactodia-classic-template__property-table {\n  font-size: 15px;\n  font-weight: 100;\n  margin-bottom: 5px;\n  max-height: 200px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n.reactodia-classic-template__property-row {\n  white-space: nowrap;\n}\n.reactodia-classic-template__property-label {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  vertical-align: top;\n}\n.reactodia-classic-template__property-values {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.reactodia-classic-template__property-value {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: initial;\n  padding-right: 10px;\n}\n\n.reactodia-default-link__label-text {\n  fill: black;\n  stroke: none;\n  stroke-width: 0;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: inherit;\n  font-weight: bold;\n}\n.reactodia-default-link--renamed .reactodia-default-link__label-text {\n  font-style: italic;\n  font-weight: normal;\n}\n.reactodia-default-link__label-background {\n  fill: white;\n  stroke: none;\n  stroke-width: 0;\n}\n\n.reactodia-group-template {\n  overflow: hidden;\n}\n.reactodia-group-template__wrap {\n  max-width: none;\n}\n.reactodia-group-template__body {\n  overflow: visible;\n}\n.reactodia-group-template__embedded-layer {\n  margin-top: 7px;\n}\n.reactodia-group-template .reactodia-paper__canvas {\n  border-color: #fff;\n}\n\n.reactodia-standard-template {\n  min-width: 180px;\n  max-width: 400px;\n  float: left;\n}\n.reactodia-standard-template__main {\n  border-radius: 2px;\n  border: 1px solid;\n}\n.reactodia-standard-template__body {\n  margin-left: 8px;\n  border-radius: 0 2px 2px 0;\n  border-left: 1px solid;\n  padding: 3px 0;\n  background: #fafaf9;\n}\n.reactodia-standard-template__body-horizontal {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  overflow: hidden;\n}\n.reactodia-standard-template__body-content {\n  flex-grow: 1;\n  min-width: 0;\n  margin-right: 12px;\n}\n.reactodia-standard-template__label {\n  font-size: 19px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template__thumbnail {\n  font-size: 26px;\n  margin: 5px 10px;\n  flex-shrink: 0;\n  width: 50px;\n  height: 50px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.reactodia-standard-template__thumbnail-image {\n  max-height: 100%;\n  max-width: 100%;\n}\n.reactodia-standard-template__thumbnail-icon {\n  width: 26px;\n  height: 26px;\n  object-fit: contain;\n}\n.reactodia-standard-template__photo {\n  border-bottom: 1px solid;\n}\n.reactodia-standard-template__photo-image {\n  width: 100%;\n  border-radius: 2px 2px 0 0;\n}\n.reactodia-standard-template__type {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 11px;\n  font-style: italic;\n  color: #999;\n  display: flex;\n}\n.reactodia-standard-template__type-value {\n  width: 0;\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template__iri {\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n}\n.reactodia-standard-template__iri-key {\n  font-size: 12px;\n  margin-right: 4px;\n  color: #b6b6b6;\n}\n.reactodia-standard-template__iri-value {\n  font-size: 12px;\n  width: 100%;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template__iri-value a {\n  color: #b6b6b6;\n}\n.reactodia-standard-template__hr {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin: 5px 0;\n}\n.reactodia-standard-template__properties {\n  font-size: 15px;\n  max-height: 200px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n.reactodia-standard-template__propertites-row {\n  white-space: nowrap;\n}\n.reactodia-standard-template__properties-key {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  vertical-align: top;\n}\n.reactodia-standard-template__properties-values {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.reactodia-standard-template__properties-value {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: initial;\n  padding-right: 10px;\n}\n.reactodia-standard-template__pinned-props {\n  border-top: 1px solid;\n  margin: 0 5px;\n}\n.reactodia-standard-template__dropdown {\n  border-radius: 2px;\n  background-color: white;\n  margin-top: 5px;\n  border: 1px solid;\n}\n.reactodia-standard-template__dropdown-content {\n  width: 100%;\n  padding: 9px;\n}\n.reactodia-standard-template__actions {\n  display: flex;\n  justify-content: space-between;\n}\n.reactodia-standard-template__delete-button, .reactodia-standard-template__edit-button {\n  display: flex;\n  align-items: center;\n  padding: 5px;\n  min-width: 60px;\n}\n.reactodia-standard-template__delete-button {\n  display: flex;\n  align-items: center;\n}\n.reactodia-standard-template__delete-button::before {\n  background-image: url(${pe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-standard-template__edit-button {\n  display: flex;\n  align-items: center;\n}\n.reactodia-standard-template__edit-button::before {\n  background-image: url(${he});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}`,""]);const Oe=G},e=>{e.exports=function(e){return e[1]}},e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy41NiAxaC44OGw2LjU0IDEyLjI2LS40NC43NEgxLjQ0TDEgMTMuMjYgNy41NiAxek04IDIuMjhMMi4yOCAxM0gxMy43TDggMi4yOHpNOC42MjUgMTJ2LTFoLTEuMjV2MWgxLjI1em0tMS4yNS0yVjZoMS4yNXY0aC0xLjI1eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNS4yNSAwYTguMjUgOC4yNSAwIDAgMC02LjE4IDEzLjcyTDEgMjIuODhsMS4xMiAxIDguMDUtOS4xMkE4LjI1MSA4LjI1MSAwIDEgMCAxNS4yNS4wMVYwem0wIDE1YTYuNzUgNi43NSAwIDEgMSAwLTEzLjUgNi43NSA2Ljc1IDAgMCAxIDAgMTMuNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy41MSA0bC01LTNoLTFsLTUgMy0uNDkuODZ2NmwuNDkuODUgNSAzaDFsNS0zIC40OS0uODV2LTZMMTMuNTEgNHptLTYgOS41NmwtNC41LTIuN1Y1LjdsNC41IDIuNDV2NS40MXpNMy4yNyA0LjdsNC43NC0yLjg0IDQuNzQgMi44NC00Ljc0IDIuNTlMMy4yNyA0Ljd6bTkuNzQgNi4xNmwtNC41IDIuN1Y4LjE1bDQuNS0yLjQ1djUuMTZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0yIDUuNTZMMi40MTMgNWgxMS4xOTRsLjM5My41NEw4LjM3MyAxMWgtLjgyN0wyIDUuNTZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik01LjU2IDE0TDUgMTMuNTg3VjIuMzkzTDUuNTQgMiAxMSA3LjYyN3YuODI3TDUuNTYgMTR6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNCA3djFIOHY2SDdWOEgxVjdoNlYxaDF2Nmg2eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMjMgMTAuOTMzYy4zMjYuMTkyLjY5OS4yOSAxLjA3Ny4yODJhMi4xNTkgMi4xNTkgMCAwIDAgMS43NTQtLjg0MiAzLjI5MSAzLjI5MSAwIDAgMCAuNjU0LTIuMTEzIDIuODg2IDIuODg2IDAgMCAwLS41NzYtMS44NzcgMS45OSAxLjk5IDAgMCAwLTEuNjM0LS43MzMgMi4yOTQgMi4yOTQgMCAwIDAtMS41MjMuNTY3VjMuNDc1aC0uOTkxVjExLjFoLjk5NXYtLjM0NGMuMDc2LjA2Ni4xNTguMTI1LjI0NC4xNzd6TTcuODUgNi43Yy4xODYtLjA3OS4zODgtLjExMy41OS0uMWExLjA4IDEuMDggMCAwIDEgLjg5Ni40MjhjLjI1Ny4zNjMuMzgyLjgwMi4zNTcgMS4yNDVhMi40ODUgMi40ODUgMCAwIDEtLjQgMS40ODQgMS4xMzMgMS4xMzMgMCAwIDEtLjk2LjUwOCAxLjIyNCAxLjIyNCAwIDAgMS0uOTc2LS40MTdBMS41MjIgMS41MjIgMCAwIDEgNi45NzUgOC44di0uNmExLjcyMiAxLjcyMiAwIDAgMSAuMzkzLTEuMTQ1Yy4xMy0uMTU0LjI5Ni0uMjc2LjQ4Mi0uMzU1ek0zLjI4OSA1LjY3NWEzLjAzIDMuMDMgMCAwIDAtLjkzNy4xNjIgMi41OSAyLjU5IDAgMCAwLS44LjRsLS4xLjA3N3YxLjJsLjQyMy0uMzU5YTIuMSAyLjEgMCAwIDEgMS4zNjYtLjU3Mi43NTguNzU4IDAgMCAxIC42NjEuMjgyYy4xNS4yMzIuMjMuNTAzLjIzMS43NzlMMi45IDcuODI1YTIuNiAyLjYgMCAwIDAtMS4zNzguNTc1IDEuNjUgMS42NSAwIDAgMC0uMDIyIDIuMzM2IDEuNzM3IDEuNzM3IDAgMCAwIDEuMjUzLjQ1NCAxLjk2IDEuOTYgMCAwIDAgMS4xMDctLjMzMmMuMTAyLS4wNjguMTk3LS4xNDUuMjg2LS4yMjl2LjQ0NGguOTQxVjcuNzE1YTIuMTkzIDIuMTkzIDAgMCAwLS40NjktMS41IDEuNjg3IDEuNjg3IDAgMCAwLTEuMzI5LS41NHptLjg1NyAzLjA0MWMuMDIuNDE4LS4xMi44MjktLjM5MSAxLjE0OGExLjIyMSAxLjIyMSAwIDAgMS0uOTU1LjQyMi44MzIuODMyIDAgMCAxLS42MDgtLjIuODMzLjgzMyAwIDAgMSAwLTEuMDkxYy4yODEtLjE3NC42LS4yNzcuOTMtLjNsMS4wMi0uMTQ4LjAwNC4xNjl6bTguMzEzIDIuMzE3Yy4zMDcuMTMuNjQuMTkzLjk3My4xODIuNDk1LjAxMi45ODMtLjExNCAxLjQxLS4zNjVsLjEyMy0uMDc1LjAxMy0uMDA3VjkuNjE1bC0uNDQ2LjMyYy0uMzE2LjIyNC0uNjk2LjM0LTEuMDg0LjMyOUExLjMgMS4zIDAgMCAxIDEyLjQgOS44YTEuOTc1IDEuOTc1IDAgMCAxLS40LTEuMzEyIDIuMDEgMi4wMSAwIDAgMSAuNDUzLTEuMzgxQTEuNDMyIDEuNDMyIDAgMCAxIDEzLjYgNi42YTEuOCAxLjggMCAwIDEgLjk3MS4yNzlsLjQzLjI2NVY1Ljk3bC0uMTctLjA3M2EyLjkgMi45IDAgMCAwLTEuMTctLjI0NyAyLjUyIDIuNTIgMCAwIDAtMS45MjkuODE3IDIuOSAyLjkgMCAwIDAtLjc0NyAyLjA0OWMtLjAyOC43MDcuMjEgMS40LjY3IDEuOTM5LjIyMi4yNDkuNDk3LjQ0Ni44MDQuNTc4eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTEuNjcgOC42NThhMy42NjEgMy42NjEgMCAwIDAtLjc4MSAxLjExNCAzLjI4IDMuMjggMCAwIDAtLjI2OCAxLjMyOXYxLjZhMS4zMDQgMS4zMDQgMCAwIDEtLjc5NCAxLjE5NyAxLjI4MiAxLjI4MiAwIDAgMS0uNTA5LjEwMkg3LjcxMmExLjI4NSAxLjI4NSAwIDAgMS0uOTIyLS4zNzkgMS4zMDMgMS4zMDMgMCAwIDEtLjM4LS45MnYtMS42YzAtLjQ3OS0uMDkyLS45MjEtLjI3NC0xLjMyOWEzLjU1NiAzLjU1NiAwIDAgMC0uNzc2LTEuMTE0IDQuNjg5IDQuNjg5IDAgMCAxLTEuMDA2LTEuNDM3QTQuMTg3IDQuMTg3IDAgMCAxIDQgNS41YTQuNDMyIDQuNDMyIDAgMCAxIC42MTYtMi4yN2MuMTk3LS4zMzYuNDMyLS42NC43MDUtLjkxNGE0LjYgNC42IDAgMCAxIC45MTEtLjcwMmMuMzM4LS4xOTYuNy0uMzQ4IDEuMDg0LS40NTRhNC40NSA0LjQ1IDAgMCAxIDEuMi0uMTYgNC40NzYgNC40NzYgMCAwIDEgMi4yNzYuNjE0IDQuNDc1IDQuNDc1IDAgMCAxIDEuNjIyIDEuNjE2IDQuNDM4IDQuNDM4IDAgMCAxIC42MTYgMi4yN2MwIC42MTctLjExNyAxLjE5MS0uMzUzIDEuNzIxYTQuNjkgNC42OSAwIDAgMS0xLjAwNiAxLjQzN3pNOS42MjMgMTAuNUg3LjQwOXYyLjIwMWMwIC4wODEuMDI4LjE1LjA5LjIxMmEuMjkuMjkgMCAwIDAgLjIxMy4wOWgxLjYwNmEuMjg5LjI4OSAwIDAgMCAuMjEzLS4wOS4yODYuMjg2IDAgMCAwIC4wOS0uMjEyVjEwLjV6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSA1LjksNiBoIC0xIFYgMyBoIDEwIHYgMTAgaCAtMTAgdiAtMyBoIDEgdiAyIGggOCBWIDQgaCAtOCB6IiAvPg0KPHBhdGggZD0iTSAxLjUsNy41IEggNy43NzE5MTkgTCA2LjQ0Mjk4LDYgNy4xMDc0NSw1LjI1IDkuNCw3LjgzNzY0NjEgViA4LjE2MjM1MzkgTCA3LjEwNzQ1LDEwLjc1IDYuNDQyOTgsMTAgNy43NzE5MTksOC41IEggMS41IFoiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSAxMC41LDYgaCAxIFYgMyBoIC0xMCB2IDEwIGggMTAgdiAtMyBoIC0xIHYgMiBoIC04IFYgNCBoIDggeiIgLz4NCjxwYXRoIGQ9Im0gNyw3LjUgaCA2LjI3MTkxOSBMIDExLjk0Mjk4LDYgMTIuNjA3NDUsNS4yNSAxNC45LDcuODM3NjQ2MSBWIDguMTYyMzUzOSBMIDEyLjYwNzQ1LDEwLjc1IDExLjk0Mjk4LDEwIDEzLjI3MTkxOSw4LjUgSCA3IFoiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMDcyIDguMDI0TDUuNzE1IDMuNjY3bC42MTgtLjYyTDExIDcuNzE2di42MThMNi4zMzMgMTNsLS42MTgtLjYxOSA0LjM1Ny00LjM1N3oiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSAxNC41LDMuNSAtMSwtMSBtIDAsMCBIIDIuNSBWIDMuMDY1MjMyNCBMIDYuOTg2MTUyNiw4IDcuNSw4LjU2NTIzMjIgViAxMi41MTAzIGwgMSwtMC43MzMzMzMgViA4LjU0ODkxNzggbCA1LC01LjQ5OTk5OTggeiBtIDAsMC41NDg5MTggViA0LjYgbSAwLDAgLTQsNC40IHYgMy4zIGwgLTMsMi4yIFYgOSBsIC01LC01LjUgdiAtMiBoIDEzIHYgMiIgLz4NCjxwYXRoIGQ9Ik0gMy4wMTg3NDI0LDggSCA0IHYgMS41IGggMS41IHYgMSBMIDQsMTAuNDY3Mjg3IFYgMTIgSCAzIFYgMTAuNSBIIDEuNSB2IC0xIEggMyBaIiAvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC42IDFjMS42LjEgMy4xLjkgNC4yIDIgMS4zIDEuNCAyIDMuMSAyIDUuMSAwIDEuNi0uNiAzLjEtMS42IDQuNC0xIDEuMi0yLjQgMi4xLTQgMi40LTEuNi4zLTMuMi4xLTQuNi0uNy0xLjQtLjgtMi41LTItMy4xLTMuNUMuOSA5LjIuOCA3LjUgMS4zIDZjLjUtMS42IDEuNC0yLjkgMi44LTMuOEM1LjQgMS4zIDcgLjkgOC42IDF6bS41IDEyLjljMS4zLS4zIDIuNS0xIDMuNC0yLjEuOC0xLjEgMS4zLTIuNCAxLjItMy44IDAtMS42LS42LTMuMi0xLjctNC4zLTEtMS0yLjItMS42LTMuNi0xLjctMS4zLS4xLTIuNy4yLTMuOCAxLTEuMS44LTEuOSAxLjktMi4zIDMuMy0uNCAxLjMtLjQgMi43LjIgNCAuNiAxLjMgMS41IDIuMyAyLjcgMyAxLjIuNyAyLjYuOSAzLjkuNnpNNy45IDcuNUwxMC4zIDVsLjcuNy0yLjQgMi41IDIuNCAyLjUtLjcuNy0yLjQtMi41LTIuNCAyLjUtLjctLjcgMi40LTIuNS0yLjQtMi41LjctLjcgMi40IDIuNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNiA1SDBWNGgxNnYxem0wIDhIMHYtMWgxNnYxem0wLTQuMDA4SDBWOGgxNnYuOTkyeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOCA4LjcwN2wzLjY0NiAzLjY0Ny43MDgtLjcwN0w4LjcwNyA4bDMuNjQ3LTMuNjQ2LS43MDctLjcwOEw4IDcuMjkzIDQuMzU0IDMuNjQ2bC0uNzA3LjcwOEw3LjI5MyA4bC0zLjY0NiAzLjY0Ni43MDcuNzA4TDggOC43MDd6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy45NzYgMTAuMDcybDQuMzU3LTQuMzU3LjYyLjYxOEw4LjI4NCAxMWgtLjYxOEwzIDYuMzMzbC42MTktLjYxOCA0LjM1NyA0LjM1N3oiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy4yMyAxaC0xLjQ2TDMuNTIgOS4yNWwtLjE2LjIyTDEgMTMuNTkgMi40MSAxNWw0LjEyLTIuMzYuMjItLjE2TDE1IDQuMjNWMi43N0wxMy4yMyAxek0yLjQxIDEzLjU5bDEuNTEtMyAxLjQ1IDEuNDUtMi45NiAxLjU1em0zLjgzLTIuMDZMNC40NyA5Ljc2bDgtOCAxLjc3IDEuNzctOCA4eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAgM2gzdjFoLTF2OWwtMSAxSDRsLTEtMVY0SDJWM2gzVjJhMSAxIDAgMCAxIDEtMWgzYTEgMSAwIDAgMSAxIDF2MXpNOSAySDZ2MWgzVjJ6TTQgMTNoN1Y0SDR2OXptMi04SDV2N2gxVjV6bTEgMGgxdjdIN1Y1em0yIDBoMXY3SDlWNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xLjQ3OTc4IDEuNDc5N0MxLjMwMjI3IDEuNjU3MjEgMS4yODYxNCAxLjkzNDk4IDEuNDMxMzcgMi4xMzA3MkwxLjQ3OTc4IDIuMTg2OEw0LjE2OTUgNC44NzY1MkMyLjg4ODE3IDUuNzc2MTYgMS45MzA1MiA3LjExOTg1IDEuNTMyNTkgOC43MDk1MkMxLjQ2NTU0IDguOTc3MzggMS42MjgzNCA5LjI0ODkyIDEuODk2MjEgOS4zMTU5OEMyLjE2NDA5IDkuMzgyOTggMi40MzU2IDkuMjIwMjUgMi41MDI2NiA4Ljk1MjMyQzIuODU1NjQgNy41NDIyNSAzLjcyNzQyIDYuMzU5NTYgNC44ODk0NCA1LjU5NjI2TDYuMDk1ODYgNi44MDI3OEM1LjYyNDE5IDcuMjgzNzggNS4zMzMzNCA3Ljk0Mjc4IDUuMzMzMzQgOC42Njk2NUM1LjMzMzM0IDEwLjE0MjQgNi41MjcyNCAxMS4zMzYzIDggMTEuMzM2M0M4LjcyNjk0IDExLjMzNjMgOS4zODU4NyAxMS4wNDU0IDkuODY2OTQgMTAuNTczOEwxMy44MTMxIDE0LjUyMDFDMTQuMDA4NCAxNC43MTU0IDE0LjMyNDkgMTQuNzE1NCAxNC41MjAyIDE0LjUyMDFDMTQuNjk3NyAxNC4zNDI2IDE0LjcxMzkgMTQuMDY0OSAxNC41Njg2IDEzLjg2OTFMMTQuNTIwMiAxMy44MTNMMTAuNDQ0NSA5LjczNjkyTDEwLjQ0NTMgOS43MzU5Mkw5LjY0NTI3IDguOTM3MzJMNy43MzIgNy4wMjQ0NUw3LjczMzM0IDcuMDIzOTJMNS44MTI1MiA1LjEwNTEzTDUuODEzMzQgNS4xMDM5Mkw1LjA1NzgyIDQuMzUwMjRMMi4xODY4OSAxLjQ3OTdDMS45OTE2MyAxLjI4NDQ0IDEuNjc1MDQgMS4yODQ0NCAxLjQ3OTc4IDEuNDc5N1pNNi44MDI3NCA3LjUxMDI1TDkuMTU5NDcgOS44NjY5OEM4Ljg1OTQ3IDEwLjE1NzUgOC40NTA2IDEwLjMzNjMgOCAxMC4zMzYzQzcuMDc5NTQgMTAuMzM2MyA2LjMzMzM0IDkuNTkwMTIgNi4zMzMzNCA4LjY2OTY1QzYuMzMzMzQgOC4yMTkwNSA2LjUxMjE2IDcuODEwMTggNi44MDI3NCA3LjUxMDI1Wk04IDMuNjY2NThDNy4zMzMxNCAzLjY2NjU4IDYuNjg2MDcgMy43NjUzIDYuMDc0MDYgMy45NDk5Mkw2Ljg5ODc0IDQuNzc0MDRDNy4yNTU5NCA0LjcwMzQ2IDcuNjI0MjcgNC42NjY1OCA4IDQuNjY2NThDMTAuNjE1NCA0LjY2NjU4IDEyLjg3MzMgNi40NTM0MiAxMy40OTgxIDguOTU1MzhDMTMuNTY1IDkuMjIzMjUgMTMuODM2NCA5LjM4NjE4IDE0LjEwNDMgOS4zMTkzMkMxNC4zNzIzIDkuMjUyMzggMTQuNTM1MiA4Ljk4MDk4IDE0LjQ2ODMgOC43MTMwNUMxMy43MzI5IDUuNzY4NCAxMS4wNzcgMy42NjY1OCA4IDMuNjY2NThaTTguMTI5OCA2LjAwNjFMMTAuNjY0IDguNTM5OTJDMTAuNTk2MSA3LjE2ODY1IDkuNDk4MTQgNi4wNzE2OCA4LjEyOTggNi4wMDYxWiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMyA5bDIuMTQ2IDIuMTQ2LS43MDcuNzA4LTMtM3YtLjcwOGwzLTMgLjcwNy43MDhMMyA4aDEwbC0yLjE0Ni0yLjE0Ni43MDctLjcwOCAzIDN2LjcwOGwtMyAzLS43MDctLjcwN0wxMyA5SDN6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik03Ljk5OTkzIDYuMDAzMTZDOS40NzI2NiA2LjAwMzE2IDEwLjY2NjYgNy4xOTcwOCAxMC42NjY2IDguNjY5ODFDMTAuNjY2NiAxMC4xNDI2IDkuNDcyNjYgMTEuMzM2NSA3Ljk5OTkzIDExLjMzNjVDNi41MjcxNSAxMS4zMzY1IDUuMzMzMjQgMTAuMTQyNiA1LjMzMzI0IDguNjY5ODFDNS4zMzMyNCA3LjE5NzA4IDYuNTI3MTUgNi4wMDMxNiA3Ljk5OTkzIDYuMDAzMTZaTTcuOTk5OTMgNy4wMDMxNUM3LjA3OTQ2IDcuMDAzMTUgNi4zMzMyNCA3Ljc0OTM1IDYuMzMzMjQgOC42Njk4MUM2LjMzMzI0IDkuNTkwMjggNy4wNzk0NiAxMC4zMzY1IDcuOTk5OTMgMTAuMzM2NUM4LjkyMDQgMTAuMzM2NSA5LjY2NjYgOS41OTAyOCA5LjY2NjYgOC42Njk4MUM5LjY2NjYgNy43NDkzNSA4LjkyMDQgNy4wMDMxNSA3Ljk5OTkzIDcuMDAzMTVaTTcuOTk5OTMgMy42NjY3NUMxMS4wNzU2IDMuNjY2NzUgMTMuNzMwNyA1Ljc2Njc1IDE0LjQ2NzMgOC43MDk2OEMxNC41MzQ0IDguOTc3NTUgMTQuMzcxNiA5LjI0OTA4IDE0LjEwMzcgOS4zMTYxNUMxMy44MzU4IDkuMzgzMTUgMTMuNTY0MyA5LjIyMDQxIDEzLjQ5NzMgOC45NTI0OEMxMi44NzEzIDYuNDUyMDUgMTAuNjE0MSA0LjY2Njc1IDcuOTk5OTMgNC42NjY3NUM1LjM4NDU0IDQuNjY2NzUgMy4xMjY2NCA2LjQ1MzU5IDIuNTAxODIgOC45NTU1NUMyLjQzNDkxIDkuMjIzNDEgMi4xNjM0OCA5LjM4NjM1IDEuODk1NTcgOS4zMTk0OEMxLjYyNzY2IDkuMjUyNTUgMS40NjQ3MSA4Ljk4MTE1IDEuNTMxNjIgOC43MTMyMUMyLjI2NzAxIDUuNzY4NTYgNC45MjI5IDMuNjY2NzUgNy45OTk5MyAzLjY2Njc1WiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMCA3djFINVY3aDV6Ii8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xLjUgMWgxMmwuNS41djEybC0uNS41aC0xMmwtLjUtLjV2LTEybC41LS41ek0yIDEzaDExVjJIMnYxMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMS41IDFoMTJsLjUuNXYxMmwtLjUuNWgtMTJsLS41LS41di0xMmwuNS0uNXpNMiAxM2gxMVYySDJ2MTF6Ii8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04IDRIN3YzSDR2MWgzdjNoMVY4aDNWN0g4VjR6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnDQogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgdmlld0JveD0iMCAwIDExMCAxMTAiDQogICB2ZXJzaW9uPSIxLjEiDQogICB3aWR0aD0iNTAwIg0KICAgaGVpZ2h0PSI1MDAiPg0KICA8cGF0aA0KICAgICBkPSJNIDgyLjE4MjQyMiw4LjA1MjExMDcgQyA1Ni40NDc3NSwtNi45MDE4MTM3IDIzLjQ2MzE4NSwxLjgzNzcyNTggOC41MDkyNzA2LDI3LjU3MjM4IC02LjQ0NDY0MzQsNTMuMzA3MDM0IDIuMjk0ODM1Nyw4Ni4yOTE2MTYgMjguMDI5NTA4LDEwMS4yNDU1NCA1My43NjQxOCwxMTYuMTk5NDYgODYuNzQ4NzQ2LDEwNy40NTk5MyAxMDEuNzAyNjYsODEuNzI1MjcxIDExNi42NTY1Nyw1NS45OTA2MTYgMTA3LjkxNzA5LDIzLjAwNjAzNSA4Mi4xODI0MjIsOC4wNTIxMTA3IFogTSA3MS43NTYwMiwyOC41Nzg1NTMgODIuMjg2ODUsMzguODQ2OTg0IDY1LjQ1MzQ3OSw1Ni4zNzMyOTYgODMuMDY0NzM4LDczLjMxNDMwMSA3Mi43OTY5MzcsODMuODQ0NDg1IDU1LjE2OTczNiw2Ni42NTcwMzkgMzkuMDEwOTk4LDgzLjIyODcxMSAyOC40ODAxNjcsNzIuOTYwMjggNDQuNjM5Mzc4LDU2LjM4OTA2OSAyOC40MTUyMTEsNDAuNTY4NjMxIDM4LjY4MzAxMywzMC4wMzg0NDYgNTQuOTM4ODkzLDQ1Ljg1ODcxIFoiDQogICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuMDY4MTI3NjMiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPgo8cGF0aCBkPSJNIDEuNSw2IFYgMS41IEggNiB2IDEgSCAyLjUgViA2IFoiIC8+CjxwYXRoIGQ9Im0gMTAsMi41IHYgLTEgaCA0LjUgViA2IGggLTEgViAyLjUgWiIgLz4KPHBhdGggZD0ibSAxLjUsMTAgdiA0LjUgSCA2IHYgLTEgSCAyLjUgViAxMCBaIiAvPgo8cGF0aCBkPSJtIDEwLDEzLjUgdiAxIGggNC41IFYgMTAgaCAtMSB2IDMuNSB6IiAvPgo8L3N2Zz4K"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy41IDExaC0xLjcyOUw4LjQzOCA2SDkuNWwuNS0uNXYtNEw5LjUgMWgtNGwtLjUuNXY0bC41LjVoMS4wNjJsLTMuMzMzIDVIMS41bC0uNS41djNsLjUuNWgzbC41LS41di0zbC0uNS0uNWgtLjA2OEw3LjUgNi40bDMuMDY4IDQuNkgxMC41bC0uNS41djNsLjUuNWgzbC41LS41di0zbC0uNS0uNXpNNiA1VjJoM3YzSDZ6bS0yIDd2Mkgydi0yaDJ6bTkgMmgtMnYtMmgydjJ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC4wMjQgNS45MjhsLTQuMzU3IDQuMzU3LS42Mi0uNjE4TDcuNzE2IDVoLjYxOEwxMyA5LjY2N2wtLjYxOS42MTgtNC4zNTctNC4zNTd6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNC40IDNoMy4wODVhMy40IDMuNCAwIDAgMSAzLjQgMy40di4yMDVBMy40IDMuNCAwIDAgMSA3LjQ4NSAxMEg3VjloLjQ4NUEyLjQgMi40IDAgMCAwIDkuODggNi42MVY2LjRBMi40IDIuNCAwIDAgMCA3LjQ5IDRINC40QTIuNCAyLjQgMCAwIDAgMiA2LjR2LjIwNUEyLjM5NCAyLjM5NCAwIDAgMCA0IDguOTZ2MWEzLjQgMy40IDAgMCAxLTMtMy4zNVY2LjRBMy40MDUgMy40MDUgMCAwIDEgNC40IDN6TTEyIDcuMDR2LTFhMy40IDMuNCAwIDAgMSAzIDMuMzZ2LjIwNUEzLjQwNSAzLjQwNSAwIDAgMSAxMS42MDUgMTNoLTMuMDlBMy40IDMuNCAwIDAgMSA1LjEyIDkuNjFWOS40QTMuNCAzLjQgMCAwIDEgOC41MTUgNkg5djFoLS40ODVBMi40IDIuNCAwIDAgMCA2LjEyIDkuNHYuMjA1QTIuNCAyLjQgMCAwIDAgOC41MTUgMTJoMy4wOUEyLjQgMi40IDAgMCAwIDE0IDkuNjFWOS40YTIuMzk0IDIuMzk0IDAgMCAwLTItMi4zNnoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik05LjAwODg1IDYuOTkxMDNMMTEuMDMzMyAxMS4wMzMyTDYuOTkxMTQgOS4wMDg3NEw0Ljk2NjY2IDQuOTY2NTVMOS4wMDg4NSA2Ljk5MTAzWk05LjQzNTQxIDkuNDM1M0w4LjQ4MDcyIDcuNTE5MTZMNi41NjQ1OCA2LjU2NDQ3TDcuNTE5MjYgOC40ODA2Mkw5LjQzNTQxIDkuNDM1M1oiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEzLjk3OTUgOC41QzEzLjczOSAxMS40MTQ5IDExLjQxNDkgMTMuNzM5IDguNDk5OTkgMTMuOTc5NVYxM0g3LjQ5OTk5VjEzLjk3OTVDNC41NzIzMyAxMy43Mzc5IDIuMjQwNjcgMTEuMzk0NSAyLjAxNzUgOC40NjE2N0gzVjcuNDYxNjdIMi4wMjM4MkMyLjI4MTQxIDQuNTY0NzUgNC41OTc4OCAyLjI1OTk2IDcuNDk5OTkgMi4wMjA1NFYzSDguNDk5OTlWMi4wMjA1NEMxMS40MTQ5IDIuMjYxMDEgMTMuNzM5IDQuNTg1MSAxMy45Nzk1IDcuNUgxM1Y4LjVIMTMuOTc5NVpNOCAxNUMxMS44NjYgMTUgMTUgMTEuODY2IDE1IDhDMTUgNC4xMzQwMSAxMS44NjYgMSA4IDFDNC4xMzQwMSAxIDEgNC4xMzQwMSAxIDhDMSAxMS44NjYgNC4xMzQwMSAxNSA4IDE1WiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNyAxSDZ2M0g0LjVsLS41LjVWOGE0IDQgMCAwIDAgMy41IDMuOTY5VjE1aDF2LTMuMDMxQTQgNCAwIDAgMCAxMiA4VjQuNWwtLjUtLjVIMTBWMUg5djNIN1Yxem0zLjEyMSA5LjEyMUEzIDMgMCAwIDEgNSA4VjVoNnYzYTMgMyAwIDAgMS0uODc5IDIuMTIxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xLjUgMTRoMTFsLjQ4LS4zNyAyLjYzLTctLjQ4LS42M0gxNFYzLjVsLS41LS41SDcuNzFsLS44Ni0uODVMNi41IDJoLTVsLS41LjV2MTFsLjUuNXpNMiAzaDQuMjlsLjg2Ljg1LjM1LjE1SDEzdjJIOC41bC0uMzUuMTUtLjg2Ljg1SDMuNWwtLjQ3LjM0LTEgMy4wOEwyIDN6bTEwLjEzIDEwSDIuMTlsMS42Ny01SDcuNWwuMzUtLjE1Ljg2LS44NWg1Ljc5bC0yLjM3IDZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuMzUzIDEuMTQ2bDEuNSAxLjVMMTUgM3YxMS41bC0uNS41aC0xM2wtLjUtLjV2LTEzbC41LS41SDEzbC4zNTMuMTQ2ek0yIDJ2MTJoMTJWMy4yMDhMMTIuNzkzIDJIMTF2NEg0VjJIMnptNiAwdjNoMlYySDh6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMiAyaDZ2My41bC41LjVIMTJ2MWgxVjQuOGwtLjE1LS4zNi0zLjI4LTMuM0w5LjIyIDFIMS41bC0uNS41djEzbC41LjVINXYtMUgyVjJ6bTcgMGwzIDNIOVYyem01LjUgNmgtOGwtLjUuNXY2bC41LjVoOGwuNS0uNXYtNmwtLjUtLjV6TTE0IDl2NGwtMS42My0xLjZoLS43MWwtMS4xNiAxLjE3LTIuMTMtMi4xM2gtLjcxTDcgMTEuMVY5aDd6bS0yLjggNC4yN2wuODEtLjgxTDEzLjU1IDE0aC0xLjYybC0uNzMtLjczek03IDE0di0xLjQ5bDEtMUwxMC41MiAxNEg3em01LjUtMy41YS41LjUgMCAxIDAgMC0xIC41LjUgMCAwIDAgMCAxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuODUgNC40NGwtMy4yOC0zLjMtLjM1LS4xNEgyLjVsLS41LjVWN2gxVjJoNnYzLjVsLjUuNUgxM3YxaDFWNC44bC0uMTUtLjM2ek0xMCA1VjJsMyAzaC0zek0yLjUgOGwtLjUuNXY2bC41LjVoMTFsLjUtLjV2LTZsLS41LS41aC0xMXpNMTMgMTN2MUgzVjloMTB2NHptLTgtMWgtLjMydjFINHYtM2gxLjA2Yy43NSAwIDEuMTMuMzYgMS4xMyAxYS45NC45NCAwIDAgMS0uMzIuNzJBMS4zMyAxLjMzIDAgMCAxIDUgMTJ6bS0uMDYtMS40NWgtLjI2di45M2guMjZjLjM2IDAgLjU0LS4xNi41NC0uNDcgMC0uMzEtLjE4LS40Ni0uNTQtLjQ2ek05IDEyLjU4YTEuNDggMS40OCAwIDAgMCAuNDQtMS4xMmMwLTEtLjUzLTEuNDYtMS42LTEuNDZINi43OHYzaDEuMDZBMS42IDEuNiAwIDAgMCA5IDEyLjU4em0tMS41NS0uMTN2LTEuOWguMzNhLjk0Ljk0IDAgMCAxIC43LjI1LjkxLjkxIDAgMCAxIC4yNS42NyAxIDEgMCAwIDEtLjI1LjcyLjk0Ljk0IDAgMCAxLS42OS4yNmgtLjM0em00LjQ1LS42MWgtLjk3VjEzaC0uNjh2LTNoMS43NHYuNTVoLTEuMDZ2Ljc0aC45N3YuNTV6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMy41IDJ2My41TDQgNmgzLjVWNUg0Ljk3OWwuOTQxLS45NDFhMy41NTIgMy41NTIgMCAxIDEgNS4wMjMgNS4wMjNMNS43NDYgMTQuMjhsLjcyLjcyIDUuMTk4LTUuMTk4QTQuNTcgNC41NyAwIDAgMCA1LjIgMy4zMzlsLS43LjdWMmgtMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNSAydjMuNUwxMiA2SDguNVY1aDIuNTIxbC0uOTQxLS45NDFhMy41NTIgMy41NTIgMCAxIDAtNS4wMjMgNS4wMjNsNS4xOTcgNS4xOTgtLjcyLjcyLTUuMTk4LTUuMTk4QTQuNTcgNC41NyAwIDAgMSAxMC44IDMuMzM5bC43LjdWMmgxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC41IDFhNi41IDYuNSAwIDEgMSAwIDEzIDYuNSA2LjUgMCAwIDEgMC0xM3ptNC44OTQgNGE1LjUyNyA1LjUyNyAwIDAgMC0zLjA1My0yLjY3NmMuNDQ0Ljg0Ljc2NSAxLjc0Ljk1MyAyLjY3NmgyLjF6bS41ODIgMi45OTVBNS4xMSA1LjExIDAgMCAwIDE0IDcuNWE1LjQ2NCA1LjQ2NCAwIDAgMC0uMjEzLTEuNWgtMi4zNDJjLjAzMi4zMzEuMDU1LjY2NC4wNTUgMWExMC4xMTQgMTAuMTE0IDAgMCAxLS4yMDYgMmgyLjQ5M2MuMDk1LS4zMjkuMTU4LS42NjUuMTktMS4wMDV6bS0zLjUzNSAwbC4wMDYtLjA1MUE5LjA0IDkuMDQgMCAwIDAgMTAuNSA3YTguOTk0IDguOTk0IDAgMCAwLS4wNzYtMUg2LjU3NkE4LjgyIDguODIgMCAwIDAgNi41IDdhOC45OCA4Ljk4IDAgMCAwIC4yMzMgMmgzLjUzNGMuMDc3LS4zMzIuMTM1LS42NjcuMTc0LTEuMDA1ek0xMC4yNDkgNWE4Ljk3NCA4Ljk3NCAwIDAgMC0xLjI1NS0yLjk3QzguODMgMi4wMTYgOC42NjYgMiA4LjUgMmEzLjYyIDMuNjIgMCAwIDAtLjMxMi4wMTVsLS4xODIuMDE1TDggMi4wNEE4Ljk3IDguOTcgMCAwIDAgNi43NTEgNWgzLjQ5OHpNNS43MDYgNWE5Ljk1OSA5Ljk1OSAwIDAgMSAuOTY2LTIuNjgxQTUuNTI3IDUuNTI3IDAgMCAwIDMuNjA2IDVoMi4xek0zLjIxMyA2QTUuNDggNS40OCAwIDAgMCAzIDcuNSA1LjQ4IDUuNDggMCAwIDAgMy4yMTMgOWgyLjQ5M0ExMC4wMTYgMTAuMDE2IDAgMCAxIDUuNSA3YzAtLjMzNi4wMjMtLjY2OS4wNTUtMUgzLjIxM3ptMi43NTQgNGgtMi4zNmE1LjUxNSA1LjUxNSAwIDAgMCAzLjgxOSAyLjg5M0ExMC4wMjMgMTAuMDIzIDAgMCAxIDUuOTY3IDEwek04LjUgMTIuNjQ0QTguOTQyIDguOTQyIDAgMCAwIDkuOTc4IDEwSDcuMDIyQTguOTQzIDguOTQzIDAgMCAwIDguNSAxMi42NDR6TTExLjAzMyAxMGExMC4wMjQgMTAuMDI0IDAgMCAxLTEuNDU5IDIuODkzQTUuNTE3IDUuNTE3IDAgMCAwIDEzLjM5MyAxMGgtMi4zNnoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDI3IDYuMTQ5YTUuNTIgNS41MiAwIDAgMS0xLjI3IDMuOTA4bDQuMjYgNC4yNi0uNy43MS00LjI2LTQuMjdhNS41MiA1LjUyIDAgMSAxIDEuOTctNC42MDh6bS01LjQ1IDQuODg4YTQuNTEgNC41MSAwIDAgMCAzLjE4LTEuMzJsLS4wNC4wMmE0LjUxIDQuNTEgMCAwIDAgMS4zNi0zLjIgNC41IDQuNSAwIDEgMC00LjUgNC41em0yLjQ0LTR2LTFoLTJ2LTJoLTF2MmgtMnYxaDJ2Mmgxdi0yaDJ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDI3IDYuMTQ5YTUuNTIgNS41MiAwIDAgMS0xLjI3IDMuOTA4bDQuMjYgNC4yNi0uNy43MS00LjI2LTQuMjdhNS41MiA1LjUyIDAgMSAxIDEuOTctNC42MDh6bS01LjQ1IDQuODg4YTQuNTEgNC41MSAwIDAgMCAzLjE4LTEuMzJsLS4wNC4wMmE0LjUxIDQuNTEgMCAwIDAgMS4zNi0zLjIgNC41IDQuNSAwIDEgMC00LjUgNC41em0tMi41NC00Ljk4aDV2MWgtNXYtMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNS45MjggNy45NzZsNC4zNTcgNC4zNTctLjYxOC42Mkw1IDguMjg0di0uNjE4TDkuNjY3IDNsLjYxOC42MTktNC4zNTcgNC4zNTd6Ii8+PC9zdmc+"},(e,t,n)=>{n.r(t),n.d(t,{AbortScope:()=>a,delay:()=>l,mapAbortedToNull:()=>r,raceAbortSignal:()=>o,raceHappyEyes:()=>s});var i=n(53);function r(e,t){return e.then((e=>t&&t.aborted?null:e),(e=>t&&t.aborted?null:Promise.reject(e)))}function o(e,t){if(!t)return e;let n;const i=new Promise(((e,i)=>{n=()=>{t.removeEventListener("abort",r),n=void 0};const r=()=>{n?.();try{t.throwIfAborted()}catch(e){i(e)}i(new Error("Failed to throw abort error"))};t.addEventListener("abort",r)}));return Promise.race([e,i]).then((e=>(n?.(),e)))}async function s(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const{timeout:o,signal:s}=n,c=(0,i.__addDisposableResource)(r,new a(s),!1),{signal:d}=c,u=new Map;let h;for(const n of e){d.throwIfAborted(),u.set(n,t(n,d).then((e=>({type:"resolve",result:e})),(()=>({type:"reject",variant:n}))));const e=l(o,{signal:d}).then((()=>({type:"timeout"})));e:for(;u.size>0;){const t=await Promise.race([...u.values(),e]);switch(t.type){case"resolve":return t.result;case"reject":if(u.delete(t.variant),t.variant===h)break e;break;case"timeout":break e}}h=n}throw new Error("No variants left to attempt")}catch(o){r.error=o,r.hasError=!0}finally{(0,i.__disposeResources)(r)}}class a{controller;parentSignal;onAbort;constructor(e){this.controller=new AbortController,e&&(this.parentSignal=void 0,this.onAbort=()=>this.controller.abort(),e.addEventListener("abort",this.onAbort))}get signal(){return this.controller.signal}[Symbol.dispose](){this.controller.abort(),this.parentSignal&&this.onAbort&&this.parentSignal.removeEventListener("abort",this.onAbort)}abort(){this[Symbol.dispose]()}}function l(e,t){const n=t?.signal;return new Promise(((t,i)=>{let r;const o=setTimeout((()=>{n&&r&&n.removeEventListener("abort",r),t()}),e);if(n){if(n.aborted)try{n.throwIfAborted()}catch(s){i(s)}r=()=>{clearTimeout(o),n.removeEventListener("abort",r);try{n.throwIfAborted()}catch(s){i(s)}},n.addEventListener("abort",r)}}))}},(e,t,n)=>{n.r(t),n.d(t,{__addDisposableResource:()=>D,__assign:()=>o,__asyncDelegator:()=>S,__asyncGenerator:()=>_,__asyncValues:()=>M,__await:()=>L,__awaiter:()=>g,__classPrivateFieldGet:()=>j,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>C,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>O,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>r,__generator:()=>f,__importDefault:()=>N,__importStar:()=>E,__makeTemplateObject:()=>I,__metadata:()=>p,__param:()=>l,__propKey:()=>u,__read:()=>x,__rest:()=>s,__runInitializers:()=>d,__setFunctionName:()=>h,__spread:()=>w,__spreadArray:()=>k,__spreadArrays:()=>v,__values:()=>b,default:()=>z});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function a(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function l(e,t){return function(n,i){t(n,i,e)}}function c(e,t,n,i,r,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=i.kind,c="getter"===l?"get":"setter"===l?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=n.length-1;p>=0;p--){var g={};for(var f in i)g[f]="access"===f?{}:i[f];for(var f in i.access)g.access[f]=i.access[f];g.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var m=(0,n[p])("accessor"===l?{get:u.get,set:u.set}:u[c],g);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=s(m.get))&&(u.get=a),(a=s(m.set))&&(u.set=a),(a=s(m.init))&&r.unshift(a)}else(a=s(m))&&("field"===l?r.unshift(a):u[c]=a)}d&&Object.defineProperty(d,i.name,u),h=!0}function d(e,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(e,n):t[r].call(e);return i?n:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(t){o(t)}}function a(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function f(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(l){a=[6,l],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var m=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function x(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(x(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function k(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function L(e){return this instanceof L?(this.v=e,this):new L(e)}function _(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof L?Promise.resolve(n.value.v).then(l,c):d(o[0][2],n)}catch(i){d(o[0][3],i)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function S(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:L(e[i](t)),done:!1}:r?r(t):t}:r}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=b(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return T(t,e),t}function N(e){return e&&e.__esModule?e:{default:e}}function j(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function C(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function D(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:n})}else n&&e.stack.push({async:!0});return t}var P="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function O(e){function t(t){e.error=e.hasError?new P(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var i=e.stack.pop();try{var r=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(r).then(n,(function(e){return t(e),n()}))}catch(o){t(o)}}if(e.hasError)throw e.error}()}const z={__extends:r,__assign:o,__rest:s,__decorate:a,__param:l,__metadata:p,__awaiter:g,__generator:f,__createBinding:m,__exportStar:y,__values:b,__read:x,__spread:w,__spreadArrays:v,__spreadArray:k,__await:L,__asyncGenerator:_,__asyncDelegator:S,__asyncValues:M,__makeTemplateObject:I,__importStar:E,__importDefault:N,__classPrivateFieldGet:j,__classPrivateFieldSet:C,__classPrivateFieldIn:A,__addDisposableResource:D,__disposeResources:O}},(e,t,n)=>{function i(e,t){let n=e.get(t);return n||(n=[],e.set(t,n)),n}function r(e,t){let n=e.get(t);return n||(n=new Set,e.set(t,n)),n}function o(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.r(t),n.d(t,{MoveDirection:()=>a,OrderedMap:()=>s,getOrCreateArrayInMap:()=>i,getOrCreateSetInMap:()=>r,makeMoveComparator:()=>l,shallowArrayEqual:()=>o});class s{mapping=new Map;ordered=[];reorder(e){this.ordered.sort(e)}get items(){return this.ordered}get(e){return this.mapping.get(e)}push(e,t){if(this.mapping.has(e)){const n=this.mapping.get(e);if(n===t)return;const i=this.ordered.indexOf(n);this.ordered.splice(i,1)}this.mapping.set(e,t),this.ordered.push(t)}delete(e){if(!this.mapping.has(e))return;const t=this.mapping.get(e),n=this.ordered.indexOf(t);return this.ordered.splice(n,1),this.mapping.delete(e),t}}var a;function l(e,t,n){const i=new Map,r=n*e.length;e.forEach(((e,t)=>{i.set(e,t)}));for(const o of t)i.set(o,r+i.get(o));return(e,t)=>{const n=i.get(e),r=i.get(t);return n>r?1:n<r?-1:0}}!function(e){e[e.ToStart=-1]="ToStart",e[e.ToEnd=1]="ToEnd"}(a||(a={}))},(e,t,n)=>{n.r(t),n.d(t,{EventObserver:()=>r,EventSource:()=>i});class i{listeners=new Map;anyListeners;on(e,t){let n=this.listeners.get(e);n||(n=new Set,this.listeners.set(e,n)),n.add(t)}onAny(e){let t=this.anyListeners;t||(t=new Set,this.anyListeners=t),t.add(e)}off(e,t){const n=this.listeners.get(e);n&&n.delete(t)}offAny(e){const t=this.anyListeners;t&&t.delete(e)}trigger(e,t){const n=this.listeners.get(e);if(n)for(const i of n)i(t);if(this.anyListeners)for(const i of this.anyListeners)i({[e]:t})}}class r{unsubscribeByKey=new Map;onDispose=[];listen(e,t,n){e.on(t,n),this.onDispose.push((()=>e.off(t,n)))}listenAny(e,t){e.onAny(t),this.onDispose.push((()=>e.offAny(t)))}listenOnce(e,t,n){let i=!1;const r=o=>{i=!0,e.off(t,r),n(o)};e.on(t,r),this.onDispose.push((()=>{i||e.off(t,r)}))}stopListening(){for(const e of this.onDispose)e();this.onDispose.length=0,this.unsubscribeByKey.forEach((e=>{for(const t of e)t()})),this.unsubscribeByKey.clear()}}},(e,t,n)=>{n.r(t),n.d(t,{HashMap:()=>i,HashSet:()=>r});class i{hashKey;equalKeys;map=new Map;_size=0;constructor(e,t){this.hashKey=e,this.equalKeys=t}get size(){return this._size}has(e){const t=this.map.get(this.hashKey(e));if(!t)return!1;if(!Array.isArray(t))return this.equalKeys(t.k,e);for(const n of t)if(this.equalKeys(n.k,e))return!0;return!1}get(e){const t=this.map.get(this.hashKey(e));if(t)if(Array.isArray(t)){for(const n of t)if(this.equalKeys(n.k,e))return n.v}else if(this.equalKeys(t.k,e))return t.v}set(e,t){const n=this.hashKey(e);let i=this.map.get(n);if(i)if(Array.isArray(i)){let n=-1;for(let t=0;t<i.length;t++)if(this.equalKeys(i[t].k,e)){n=t;break}n>=0?i.splice(n,1):this._size++,i.push({k:e,v:t})}else if(this.equalKeys(i.k,e))this.map.set(n,{k:e,v:t});else{i=[i,{k:e,v:t}],this.map.set(n,i),this._size++}else i={k:e,v:t},this.map.set(n,i),this._size++;return this}delete(e){const t=this.hashKey(e),n=this.map.get(t);if(!n)return!1;if(Array.isArray(n)){for(let i=0;i<n.length;i++)if(this.equalKeys(n[i].k,e))return n.splice(i,1),this._size--,0===n.length&&this.map.delete(t),!0}else if(this.equalKeys(n.k,e))return this.map.delete(t),this._size--,!0;return!1}clear(){this.map.clear(),this._size=0}clone(){const e=new i(this.hashKey,this.equalKeys);e._size=this.size;for(const[t,n]of this.map)e.map.set(t,Array.isArray(n)?[...n]:n);return e}forEach(e){for(const[t,n]of this)e(n,t,this)}*keys(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield t.k;else yield e.k}*values(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield t.v;else yield e.v}*entries(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield[t.k,t.v];else yield[e.k,e.v]}[Symbol.iterator](){return this.entries()}}class r{hashCode;equals;map;constructor(e,t){this.hashCode=e,this.equals=t,this.map=new i(e,t)}get size(){return this.map.size}has(e){return this.map.has(e)}add(e){return this.map.set(e,e),this}delete(e){return this.map.delete(e)}clear(){this.map.clear()}clone(){const e=new r(this.hashCode,this.equals);return this.forEach((t=>e.add(t))),e}forEach(e){this.map.forEach(((t,n)=>e(t,n,this)))}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map.keys()}}},(e,t,n)=>{n.r(t),n.d(t,{useEventStore:()=>s,useFrameDebouncedStore:()=>a,useObservedProperty:()=>o,useSyncStore:()=>l});var i=n(58),r=n(59);function o(e,t,n){return l(s(e,t),n)}function s(e,t){return i.useCallback((n=>(e.on(t,n),()=>e.off(t,n))),[e,t])}function a(e){return i.useCallback((t=>{let n;const i=()=>{n=void 0,t()},r=e((()=>{void 0===n&&(n=requestAnimationFrame(i))}));return()=>{void 0!==n&&cancelAnimationFrame(n),r()}}),[e])}function l(e,t,n){const o=i.useRef();return(0,r.useSyncExternalStore)(e,n?()=>{const e=t();if(o.current){const[t]=o.current;if(n(t,e))return t}return o.current=[e],e}:t)}},e=>{e.exports=ve},(e,t,n)=>{e.exports=n(60)},(e,t,n)=>{var i=n(58);var r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=i.useState,s=i.useEffect,a=i.useLayoutEffect,l=i.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(i){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=o({inst:{value:n,getSnapshot:t}}),r=i[0].inst,d=i[1];return a((function(){r.value=n,r.getSnapshot=t,c(r)&&d({inst:r})}),[e,n,t]),s((function(){return c(r)&&d({inst:r}),e((function(){c(r)&&d({inst:r})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:d},(e,t,n)=>{0},(e,t,n)=>{n.r(t),n.d(t,{KeyedObserver:()=>i,observeElementTypes:()=>r,observeLinkTypes:()=>s,observeProperties:()=>o});class i{subscribe;observedKeys=new Map;constructor(e){this.subscribe=e}observe(e){if(0===e.length&&0===this.observedKeys.size)return;const t=new Map;for(const n of e){if(t.has(n))continue;let e=this.observedKeys.get(n);e||(e=this.subscribe(n)),e&&t.set(n,e)}this.observedKeys.forEach(((e,n)=>{t.has(n)||e()})),this.observedKeys=t}stopListening(){this.observe([])}}function r(e,t,n){return new i((i=>{const r=e.getElementType(i);if(r)return r.events.on(t,n),()=>r.events.off(t,n)}))}function o(e,t,n){return new i((i=>{const r=e.getPropertyType(i);if(r)return r.events.on(t,n),()=>r.events.off(t,n)}))}function s(e,t,n){return new i((i=>{const r=e.createLinkType(i);if(r)return r.events.on(t,n),()=>r.events.off(t,n)}))}},(e,t,n)=>{n.r(t),n.d(t,{defineWorker:()=>r,useWorker:()=>a});var i=n(58);function r(e,t){return{[o]:()=>({instance:new l(e,t),refCount:0}),[s]:void 0}}const o=Symbol("WorkerDefinition.construct"),s=Symbol("WorkerDefinition.state");function a(e){i.useEffect((()=>{let t=e[s];return t||(t=e[o](),e[s]=t),t.refCount++,()=>{const t=e[s];t&&(t.refCount--,t.refCount<=0&&t.instance.disconnect())}}),[e]);let t=e[s];return t||(t=e[o](),e[s]=t),t.instance.proxy}class l{workerFactory;constructorArgs;static PROXY_OWNER=Symbol("LazyWorkerProxy.owner");connectionState;methods=new Map;proxy;constructor(e,t){this.workerFactory=e,this.constructorArgs=t,this.connectionState={type:"initial"};const n={[l.PROXY_OWNER]:this};this.proxy=new Proxy(n,{get:(e,t)=>{if("string"!=typeof t)return;return e[l.PROXY_OWNER].getMethod(t)}})}getMethod(e){let t=this.methods.get(e);return t||(t=async(...t)=>{const[n,i]=await this.ensureConnection();return n.call(e,t,{signal:i})}),t}async ensureConnection(){switch(this.connectionState.type){case"initial":{const e=this.connectionState,t=new AbortController,n=this.connect(e,t.signal).then((e=>{const[n,i]=e;return i.aborted&&n.dispose(),i.throwIfAborted(),this.connectionState={type:"connected",connection:n,controller:t},e}));return this.connectionState={type:"connecting",request:n,controller:t},n}case"connecting":{const{request:e}=this.connectionState;return e}case"connected":{const{connection:e,controller:t}=this.connectionState;return Promise.resolve([e,t.signal])}}}async connect(e,t){t.throwIfAborted();const{workerFactory:n,constructorArgs:i}=this,r=new c(n());return await r.call("constructor",i,{signal:t}),[r,t]}disconnect(){switch(this.connectionState.type){case"connecting":{const{controller:e}=this.connectionState;e.abort();break}case"connected":{const{connection:e,controller:t}=this.connectionState;t.abort(),e.dispose();break}}this.connectionState={type:"initial"}}}class c{worker;requests=new Map;nextCallId=1;constructor(e){this.worker=e,this.worker.addEventListener("message",this.onMessage),this.worker.addEventListener("error",this.onError)}call(e,t,n){const i=this.nextCallId++,r=new Promise(((e,t)=>{this.requests.set(i,{resolve:e,reject:t})})),o={type:"call",id:i,method:e,args:t};return this.worker.postMessage(o),r}onMessage=e=>{const t=e.data,n=this.requests.get(t.id);if(n)switch(this.requests.delete(t.id),t.type){case"success":n.resolve(t.result);break;case"error":n.reject(t.error);break;default:console.warn(`Unexpected worker response type: ${t.type}`)}};onError=e=>{const t=Array.from(this.requests.values());this.requests.clear();for(const n of t)n.reject(e)};dispose(){this.worker.removeEventListener("message",this.onMessage),this.worker.removeEventListener("error",this.onError),this.worker.terminate()}[Symbol.dispose](){this.dispose()}}},(e,t,n)=>{n.r(t),n.d(t,{applyLayout:()=>s,calculateAveragePosition:()=>d,calculateLayout:()=>o,placeElementsAround:()=>u,translateToPositiveQuadrant:()=>l,uniformGrid:()=>c});var i=n(65),r=n(71);async function o(e){const{layoutFunction:t,model:n,sizeProvider:i,fixedElements:o,selectedElements:s}=e;if(s&&s.size<=1)return{positions:new Map,sizes:new Map,nestedLayouts:[]};const a=(0,r.computeGrouping)(n.elements);return await async function e(l){const c=l?a.get(l)??[]:n.elements.filter((e=>void 0===e.group)),d=s?c.filter((e=>s.has(e))):c,u=[];for(const t of d)a.has(t.id)&&u.push(e(t.id));const h=await Promise.all(u),p=Object.create(null),g=Object.create(null);for(const t of d)p[t.id]={types:t.data.types,fixed:o?.has(t)},g[t.id]=(0,r.boundsOf)(t,i);const f=[];for(const t of n.links)Object.hasOwn(p,t.sourceId)&&Object.hasOwn(p,t.targetId)&&f.push({source:t.sourceId,target:t.targetId});const m=await t({nodes:p,links:f},{bounds:g}),y=new Map,b=new Map;for(const[t,{x:n,y:i,width:r,height:o}]of Object.entries(m.bounds))y.set(t,{x:n,y:i}),b.set(t,{width:r,height:o});return{positions:y,sizes:b,group:l,nestedLayouts:h}}(e.group)}function s(e,t){const{positions:n,sizes:i,group:o,nestedLayouts:c}=e,u=new a(i),h=t.elements.filter((({id:e})=>n.has(e)));for(const r of c)s(r,t);if(o){const e=(0,r.getContentFittingBox)(h,[],u);l(n,e)}const p=d(h,u);for(const r of h){const e=n.get(r.id);e&&r.setPosition(e)}const g=d(h,u),f=p.x-g.x,m=p.y-g.y;for(const[r,s]of n){t.getElement(r).setPosition({x:s.x+f,y:s.y+m})}}class a{sizes;constructor(e){this.sizes=e}getElementSize(e){return this.sizes.get(e.id)}}function l(e,t){let n=1/0,i=1/0;e.forEach((e=>{n=Math.min(n,e.x),i=Math.min(i,e.y)}));const{x:r,y:o}=t;e.forEach(((t,s)=>{e.set(s,{x:t.x-n+r,y:t.y-i+o})}))}function c(e){return t=>{const n=Math.floor(t/e.rows);return{x:(t-n*e.rows)*e.cellSize.x,y:n*e.cellSize.y,width:e.cellSize.x,height:e.cellSize.y}}}function d(e,t){let n=0,i=0;for(const o of e){const{x:e,y:s,width:a,height:l}=(0,r.boundsOf)(o,t);n+=e+a/2,i+=s+l/2}return{x:n/e.length,y:i/e.length}}function u(e){const{elements:t,model:n,sizeProvider:o,targetElement:s,preferredLinksLength:a}=e,l=i.RestoreGeometry.capture(n),c=(0,r.boundsOf)(s,o),u=c.x+c.width/2,h=c.y+c.height/2;let p=0;const g=n.getElementLinks(s);if(g.length>0){const e=d(g.map((e=>{const t=n.sourceOf(e);return t!==s?t:n.targetOf(e)})),o),t={x:u-e.x,y:h-e.y};0===t.x&&0===t.y||(p=Math.atan2(t.y,t.x))}const f=Math.min(Math.PI/t.length,Math.PI/6),m=[...t],y=(e,t)=>{if(t){const{width:n,height:i}=(0,r.boundsOf)(t,o);t.setPosition({x:u+a*Math.cos(e)-n/2,y:h+a*Math.sin(e)-i/2})}};if(m.length%2==0)for(let i=f/2;m.length>0;i+=f)y(p-i,m.pop()),y(p+i,m.pop());else{y(p,m.pop());for(let e=f;m.length>0;e+=f)y(p-e,m.pop()),y(p+e,m.pop())}const b=l.filterOutUnchanged();b.hasChanges()&&n.history.registerToUndo(b)}},(e,t,n)=>{n.r(t),n.d(t,{RestoreGeometry:()=>s,changeLinkTypeVisibility:()=>c,restoreCapturedLinkGeometry:()=>a,restoreViewport:()=>p,setElementData:()=>d,setElementExpanded:()=>l,setLinkData:()=>h});var i=n(66),r=n(71),o=n(72);class s{elementState;linkState;title="Move elements and links";constructor(e,t){this.elementState=e,this.linkState=t}static capture(e){return s.captureElementsAndLinks(e.elements,e.links)}static captureElementsAndLinks(e,t){return new s(e.map((e=>({element:e,position:e.position}))),t.map((e=>({link:e,vertices:e.vertices}))))}hasChanges(){return this.elementState.length>0||this.linkState.length>0}filterOutUnchanged(){return new s(this.elementState.filter((({element:e,position:t})=>!r.Vector.equals(e.position,t))),this.linkState.filter((({link:e,vertices:t})=>!(0,r.isPolylineEqual)(e.vertices,t))))}invoke(){const e=s.captureElementsAndLinks(this.elementState.map((e=>e.element)),this.linkState.map((e=>e.link)));for(const{element:t,position:n}of[...this.elementState].reverse())t.setPosition(n);for(const{link:t,vertices:n}of this.linkState)t.setVertices(n);return e}}function a(e){const t=e.vertices;return o.Command.create("Change link vertices",(()=>{const n=a(e);return e.setVertices(t),n}))}function l(e,t){const n=t?"Expand element":"Collapse element";return o.Command.create(n,(()=>(e.setExpanded(t),l(e,!t))))}function c(e,t){return o.Command.create("Change link type visibility",(()=>{const n=e.visibility;return e.setVisibility(t),c(e,n)}))}function d(e,t,n){const i=o.Command.create("Set element data",(()=>{const r=new Map;for(const i of e.elements.filter((e=>e.iri===t))){const t=i.iri;r.set(i,i.data),i.setData(n),u(e,i,t,n.id)}return o.Command.create("Revert element data",(()=>{for(const[t,n]of r){const i=t.iri;t.setData(n),u(e,t,i,n.id)}return i}))}));return i}function u(e,t,n,i){for(const r of e.getElementLinks(t)){let e=r.data;e.sourceId===n&&(e={...e,sourceId:i}),e.targetId===n&&(e={...e,targetId:i}),r.setData(e)}}function h(e,t,n){if(!(0,i.equalLinks)(t,n))throw new Error("Cannot change typeId, sourceId or targetId when changing link data");return o.Command.create("Set link data",(()=>{for(const r of e.links)(0,i.equalLinks)(r.data,t)&&r.setData(n);return h(e,n,t)}))}function p(e){function t(){const{metrics:t}=e,{clientWidth:n,clientHeight:i}=e.metrics.area,r=t.clientToPaperCoords(n/2,i/2),{scale:o}=t.getTransform();return{center:r,scale:o}}function n({center:t,scale:n}){e.centerTo(t,{scale:n})}const i=t(),r=o.Command.create("Restore viewport",(()=>{const e=t();return n(i),o.Command.create("Revert viewport",(()=>(n(e),r)))}));return r}},(e,t,n)=>{n.r(t),n.d(t,{equalElements:()=>u,equalLinks:()=>c,equalSubtypeEdges:()=>l,hashLink:()=>d,hashSubtypeEdge:()=>a,isEncodedBlank:()=>s});var i=n(54),r=n(67),o=n(68);function s(e){return e.startsWith("urn:reactodia:blank:")}function a(e){const[t,n]=e;let i=o.hashString(t);return i=o.chainHash(i,o.hashString(n)),o.dropHighestNonSignBit(i)}function l(e,t){const[n,i]=e,[r,o]=t;return n===r&&i===o}function c(e,t){return e.linkTypeId===t.linkTypeId&&e.sourceId===t.sourceId&&e.targetId===t.targetId}function d(e){const{linkTypeId:t,sourceId:n,targetId:i}=e;let o=(0,r.hashFnv32a)(t);return o=31*o+(0,r.hashFnv32a)(n),o=31*o+(0,r.hashFnv32a)(i),o}function u(e,t){return e.id===t.id&&(0,i.shallowArrayEqual)(e.types,t.types)&&h(e.label,t.label)&&e.image===t.image&&function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(!Object.prototype.hasOwnProperty.call(t,n))return!1;if(!h(e[n],t[n]))return!1}for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}(e.properties,t.properties)}function h(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!o.equalTerms(e[n],t[n]))return!1;return!0}},(e,t,n)=>{function i(){function e(){return Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function r(e,t=2166136261){let n,i,r=2147483647&t;for(n=0,i=e.length;n<i;n++)r^=e.charCodeAt(n),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24);return r>>>0}function o(e){let t=e.indexOf("#");if(t<0&&(t=e.lastIndexOf("/")),t<0&&(t=e.lastIndexOf(":")),!(t<0))return e.substring(t+1)}n.r(t),n.d(t,{generate128BitID:()=>i,getUriLocalName:()=>o,hashFnv32a:()=>r})},(e,t,n)=>{n.r(t),n.d(t,{DefaultDataFactory:()=>s,chainHash:()=>u,dropHighestNonSignBit:()=>h,equalQuads:()=>f,equalTerms:()=>p,hashQuad:()=>g,hashString:()=>d,hashTerm:()=>c,looksLikeTerm:()=>a,termToString:()=>l});var i=n(69),r=n(67),o=n(70);const s=i.DataFactory;function a(e){if(!("object"==typeof e&&e&&"termType"in e&&"equals"in e&&"function"==typeof e.equals))return!1;const{termType:t}=e;switch(t){case"NamedNode":case"Literal":case"BlankNode":case"DefaultGraph":case"Variable":case"Quad":return!0;default:return!1}}function l(e){switch(e.termType){case"NamedNode":return`<${(0,o.escapeRdfValue)(e.value)}>`;case"BlankNode":return`_:${e.value}`;case"Literal":{const{value:t,language:n,datatype:i}=e,r=`"${(0,o.escapeRdfValue)(t)}"`;return n?r+`@${n}`:i?r+"^^"+l(i):r}case"DefaultGraph":return"(default graph)";case"Variable":return`?${e.value}`;case"Quad":{let t="<< ";return t+=l(e.subject)+" ",t+=l(e.predicate)+" ",t+=l(e.object)+" ","DefaultGraph"!==e.graph.termType&&(t+=l(e.graph)+" "),t+=">>",t}}}function c(e){let t=0;switch(e.termType){case"NamedNode":case"BlankNode":case"Variable":t=(0,r.hashFnv32a)(e.value);break;case"Literal":t=(0,r.hashFnv32a)(e.value),e.datatype&&(t=Math.imul(t,31)+(0,r.hashFnv32a)(e.datatype.value)|0),e.language&&(t=Math.imul(t,31)+(0,r.hashFnv32a)(e.language)|0);break;case"Quad":t=Math.imul(t,31)+c(e.subject)|0,t=Math.imul(t,31)+c(e.predicate)|0,t=Math.imul(t,31)+c(e.object)|0,t=Math.imul(t,31)+c(e.graph)|0}return h(t)}function d(e){return(0,r.hashFnv32a)(e)}function u(e,t){return Math.imul(e,31)+t|0}function h(e){return e>>>1&1073741824|3221225471&e}function p(e,t){if(e.termType!==t.termType)return!1;switch(e.termType){case"NamedNode":case"BlankNode":case"Variable":case"DefaultGraph":{const{value:n}=t;return e.value===n}case"Literal":{const{value:n,language:i,datatype:r}=t;return e.value===n&&e.datatype.value===r.value&&e.language===i}case"Quad":{const{subject:n,predicate:i,object:r,graph:o}=t;return p(e.subject,n)&&p(e.predicate,i)&&p(e.object,r)&&p(e.graph,o)}}}function g(e){return c(e)}function f(e,t){return p(e,t)}},e=>{e.exports=xe},(e,t,n)=>{function i(e){return r.test(e)?e.replace(o,a):e}n.r(t),n.d(t,{escapeRdfValue:()=>i});const r=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,o=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,s={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e){let t=s[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}},(e,t,n)=>{var i,r;function o(e,t){const{x:n,y:i}=e.position,r=t.getElementSize(e);return{x:n,y:i,width:r?r.width:0,height:r?r.height:0}}function s(e,t){const n=0===e.width||0===e.height||t.x>e.x&&t.x<e.x+e.width&&t.y>e.y&&t.y<e.y+e.height,r=e.width/2,o=e.height/2,s={x:e.x+r,y:e.y+o};if(n)return s;const a=i.normalize({x:t.x-s.x,y:t.y-s.y}),l={x:Math.abs(a.x),y:a.y};return i.cross2D({x:r,y:-o},l)>0&&i.cross2D({x:r,y:o},l)<0?{x:s.x+r*Math.sign(a.x),y:s.y+r*a.y/Math.abs(a.x)}:{x:s.x+o*a.x/Math.abs(a.y),y:s.y+o*Math.sign(a.y)}}function a(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const i=e[n],r=t[n];if(i.x!==r.x||i.y!==r.y)return!1}return!0}function l(e,t,n){const i=s(e,n.length>0?n[0]:r.center(t)),o=s(t,n.length>0?n[n.length-1]:r.center(e));return[i,...n,o]}function c(e){let t;return e.reduce(((e,n)=>{const r=t?i.length({x:n.x-t.x,y:n.y-t.y}):0;return t=n,e+r}),0)}function d(e,t){if(0===e.length)throw new Error("Cannot compute a point for empty polyline");if(t<0)return e[0];let n=0;for(let r=1;r<e.length;r++){const o=e[r-1],s=e[r],a={x:s.x-o.x,y:s.y-o.y},l=i.length(a),c=n+l;if(t<c){const e=(t-n)/l;return{x:o.x+e*a.x,y:o.y+e*a.y}}n=c}return e[e.length-1]}function u(e,t){let n=1/0,r=0;for(let o=0;o<e.length-1;o++){const s=e[o],a=e[o+1],l={x:t.x-s.x,y:t.y-s.y},c={x:a.x-s.x,y:a.y-s.y},d=i.length(c),u=i.dot(l,c)/d;if(u<0||u>d)continue;const h=Math.abs(i.cross2D(l,c))/d;h<n&&(n=h,r=o)}return r}function h(e){return"M"+e.map((({x:e,y:t})=>`${e},${t}`)).join(" L")}function p(e,t,n){for(let i=e.length-1;i>=0;i--){const r=e[i],{x:s,y:a,width:l,height:c}=o(r,n);if(!r.temporary&&(t.x>=s&&t.x<=s+l&&t.y>=a&&t.y<=a+c))return r}}function g(e){const t=new Map;for(const n of e){const e=n.group;if("string"==typeof e){let i=t.get(e);i||(i=[],t.set(e,i)),i.push(n)}}return t}function f(e,t,n){let i=1/0,r=1/0,o=-1/0,s=-1/0;for(const a of e){const{x:e,y:t}=a.position,l=n.getElementSize(a);i=Math.min(i,e),r=Math.min(r,t),o=Math.max(o,e+(l?l.width:0)),s=Math.max(s,t+(l?l.height:0))}for(const a of t){const e=a.vertices||[];for(const{x:t,y:n}of e)i=Math.min(i,t),r=Math.min(r,n),o=Math.max(o,t),s=Math.max(s,n)}return{x:Number.isFinite(i)?i:0,y:Number.isFinite(r)?r:0,width:Number.isFinite(i)&&Number.isFinite(o)?o-i:0,height:Number.isFinite(r)&&Number.isFinite(s)?s-r:0}}n.r(t),n.d(t,{Rect:()=>r,Vector:()=>i,boundsOf:()=>o,computeGrouping:()=>g,computePolyline:()=>l,computePolylineLength:()=>c,findElementAtPoint:()=>p,findNearestSegmentIndex:()=>u,getContentFittingBox:()=>f,getPointAlongPolyline:()=>d,isPolylineEqual:()=>a,pathFromPolyline:()=>h}),function(e){e.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},e.subtract=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},e.scale=function(e,t){return{x:e.x*t,y:e.y*t}},e.equals=function(e,t){return e.x===t.x&&e.y===t.y},e.length=function({x:e,y:t}){return Math.sqrt(e*e+t*t)},e.normalize=function({x:e,y:t}){if(0===e&&0===t)return{x:e,y:t};const n=1/Math.sqrt(e*e+t*t);return{x:e*n,y:t*n}},e.dot=function({x:e,y:t},{x:n,y:i}){return e*n+t*i},e.cross2D=function({x:e,y:t},{x:n,y:i}){return e*i-t*n}}(i||(i={})),function(e){e.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},e.center=function({x:e,y:t,width:n,height:i}){return{x:e+n/2,y:t+i/2}},e.intersects=function(e,t){return e.x<=t.x+t.width&&e.y<=t.y+t.height&&t.x<=e.x+e.width&&t.y<=e.y+e.height}}(r||(r={}))},(e,t,n)=>{n.r(t),n.d(t,{Command:()=>i,InMemoryHistory:()=>l});var i,r=n(55);!function(e){e.create=function(e,t){return new o(e,t)},e.effect=function(e,t){return new s(e,t)},e.compound=function(e,t){return new a(e,t)}}(i||(i={}));class o{title;invoke;constructor(e,t){this.title=e,this.invoke=t}}class s{title;body;skip;constructor(e,t){this.title=e,this.body=t,this.skip={title:"Skipped effect: "+e,invoke:()=>this}}invoke(){const{body:e}=this;return e(),this.skip}}class a{title;commands;constructor(e,t){this.title=e,this.commands=t}invoke(){const e=[];for(const t of this.commands)e.push(t.invoke());return e.reverse(),new a(this.title,e)}}class l{source=new r.EventSource;events=this.source;_undoStack=[];_redoStack=[];batches=[];get undoStack(){return this._undoStack}get redoStack(){return this._redoStack}hasChanges(){return this._undoStack.length>0}reset(){this._undoStack.length=0,this._redoStack.length=0,this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}undo(){const e=this._undoStack.pop();if(e){const t=e.invoke();this._redoStack.push(t),this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}}redo(){const e=this._redoStack.pop();if(e){const t=e.invoke();this._undoStack.push(t),this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}}execute(e){const t=e.invoke();this.registerToUndo(t)}registerToUndo(e){const t=this.topBatch();t?t._inverses.push(e):(this._undoStack.push(e),this._redoStack.length=0,this.source.trigger("historyChanged",{hasChanges:this.hasChanges()}))}topBatch(){return 0===this.batches.length?void 0:this.batches[this.batches.length-1]}startBatch(e){const t={_title:e,_inverses:[],history:this,store:()=>{if(this.batches.includes(t))for(;this.batches.length>0;){const e=this.batches.pop();if(e!==t&&console.warn("Storing other unclosed batch on top",e),e._inverses.length>0){const n=[...e._inverses].reverse();this.registerToUndo(i.compound(t._title,n))}if(e===t)break}else console.warn("Failed to find batch to store (already stored or discarded?)",t)},discard:()=>{if(this.batches.includes(t))for(;this.batches.length>0;){const e=this.batches.pop();if(e!==t&&console.warn("Discarding other unclosed batch on top",e),e===t)break}else console.warn("Failed to find batch to store (already stored or discarded?)")}};return this.batches.push(t),t}}},(e,t,n)=>{n.r(t),n.d(t,{defineLayoutWorker:()=>r});var i=n(63);function r(e){return(0,i.defineWorker)(e,[])}},(e,t,n)=>{n.r(t),n.d(t,{blockingDefaultLayout:()=>d,colaFlowLayout:()=>s,colaForceLayout:()=>o,colaRemoveOverlaps:()=>a,evaluateColaLayout:()=>r,getContentFittingBoxForLayout:()=>u,layoutPadded:()=>l,layoutPaddedBiasFree:()=>c});var i=n(75);function r(e,t,n){const i=new Map,r=[];for(const[s,a]of Object.entries(e.nodes)){const e=Object.hasOwn(t.bounds,s)?t.bounds[s]:void 0;i.set(s,{x:e?e.x:0,y:e?e.y:0,width:e?e.width:void 0,height:e?e.height:void 0,fixed:a.fixed?1:0})}for(const s of e.links){const e=i.get(s.source),t=i.get(s.target);e&&t&&r.push({source:e,target:t})}n(i,r);const o=Object.create(null);for(const[s,a]of i)o[s]={x:a.x,y:a.y,width:a.width??0,height:a.height??0};return{bounds:o}}function o(e,t,n){const{preferredLinkLength:o=200,avoidOverlaps:s=!0}=n??{};return r(e,t,((e,t)=>{(new i.Layout).nodes(Array.from(e.values())).links(t).avoidOverlaps(s).convergenceThreshold(1e-9).jaccardLinkLengths(o).handleDisconnected(!0).start(30,0,10,void 0,!1)}))}function s(e,t,n){const{axis:o="y",minSeparation:s=200,preferredLinkLength:a=50,avoidOverlaps:l=!0}=n??{};return r(e,t,((e,t)=>{(new i.Layout).nodes(Array.from(e.values())).links(t).avoidOverlaps(l).flowLayout(o,s).symmetricDiffLinkLengths(a).start(10,20,20,void 0,!1)}))}function a(e){const t=new Map;for(const[r,{x:o,y:s,width:a,height:l}]of Object.entries(e.bounds))t.set(r,new i.Rectangle(o,o+a,s,s+l));i.removeOverlaps(Array.from(t.values()));const n=Object.create(null);for(const[i,{x:r,y:o}]of t){const t=Object.hasOwn(e.bounds,i)?e.bounds[i]:void 0;n[i]={x:r,y:o,width:t?t.width:0,height:t?t.height:0}}return{bounds:n}}function l(e,t){if(!t)return{state:e,unwrap:e=>e};const n=Object.create(null);for(const[i,{x:r,y:o,width:s,height:a}]of Object.entries(e.bounds))n[i]={x:r-t.x,y:o-t.y,width:s+2*t.x,height:a+2*t.y};return{state:{bounds:n},unwrap:e=>{const n=Object.create(null);for(const[i,{x:r,y:o,width:s,height:a}]of Object.entries(e.bounds))n[i]={x:r+t.x,y:o+t.y,width:s-2*t.x,height:a-2*t.y};return{bounds:n}}}}function c(e,t){const n=Object.create(null);let i=1/0,r=1/0;for(const[s,{x:a,y:l,width:c,height:d}]of Object.entries(e.bounds)){const e=Math.max(c,d);i=Math.min(c?e/c:1,i),r=Math.min(d?e/d:1,r),n[s]={x:a,y:l,width:e,height:e}}const o=l({bounds:n},t);return{state:o.state,unwrap:t=>{const n=o.unwrap(t),s=u(n),a=Object.create(null);for(const[o,l]of Object.entries(n.bounds)){const t=Object.hasOwn(e.bounds,o)?e.bounds[o]:void 0;a[o]={x:(l.x-s.x)/i+s.x,y:(l.y-s.y)/r+s.y,width:t?t.width:l.width,height:t?t.height:l.height}}return{bounds:a}}}}function d(e,t,n){const{preferredLinkLength:i=200,padding:r={x:50,y:50}}=n??{},s=c(o(e,t,{preferredLinkLength:i,avoidOverlaps:!1}),r),l=a(s.state),d=s.unwrap(l);return Promise.resolve(d)}function u(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,{x:s,y:a,width:l,height:c}]of Object.entries(e.bounds))t=Math.min(t,s),n=Math.min(n,a),i=Math.max(i,s+l),r=Math.max(r,a+c);return{x:Number.isFinite(t)?t:0,y:Number.isFinite(n)?n:0,width:Number.isFinite(t)&&Number.isFinite(i)?i-t:0,height:Number.isFinite(n)&&Number.isFinite(r)?r-n:0}}},e=>{e.exports=_e},(e,t,n)=>{n.r(t),n.d(t,{BatchingScheduler:()=>i,BufferingQueue:()=>r,Debouncer:()=>o,animateInterval:()=>s,easeInOutBezier:()=>a});class i{waitingTime;useAnimationFrame;scheduled;constructor(e=0){this.waitingTime=e,this.useAnimationFrame=0===e,this.runSynchronously=this.runSynchronously.bind(this)}schedule(){void 0===this.scheduled&&(this.useAnimationFrame?this.scheduled=requestAnimationFrame(this.runSynchronously):this.scheduled=setTimeout(this.runSynchronously,this.waitingTime))}runSynchronously(){this.cancelScheduledTimeout()&&this.run()}dispose(){this.cancelScheduledTimeout()}cancelScheduledTimeout(){return void 0!==this.scheduled&&(this.useAnimationFrame?cancelAnimationFrame(this.scheduled):clearTimeout(this.scheduled),this.scheduled=void 0,!0)}}class r extends i{onFetch;fetchingQueue=Object.create(null);constructor(e,t=200){super(t),this.onFetch=e}push(e){this.fetchingQueue[e]=!0,this.schedule()}clear(){this.fetchingQueue=Object.create(null)}run(){const{fetchingQueue:e,onFetch:t}=this;this.fetchingQueue=Object.create(null),t(Object.keys(e))}}class o extends i{callback;call(e){this.callback=e,this.schedule()}run(){const e=this.callback;e?.()}}function s(e,t,n){return new Promise((i=>{let r,o,s;const a=l=>{if(n&&n.aborted)return;o=o||l;let c=l-o;c>e&&(c=e),t(c/e),c<e?r=requestAnimationFrame(a):(s?.(),i())};if(n){const e=()=>{cancelAnimationFrame(r),s?.(),i()};s=()=>{n.removeEventListener("abort",e)},n.addEventListener("abort",e)}r=requestAnimationFrame(a)}))}function a(e){return e<0?0:e>1?1:e*e*(3-2*e)}},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t),n.d(t,{DIAGRAM_CONTEXT_URL_V1:()=>r,GenerateID:()=>a,PLACEHOLDER_ELEMENT_TYPE:()=>o,PLACEHOLDER_LINK_TYPE:()=>s,TemplateProperties:()=>l});var i=n(67);const r="https://ontodia.org/context/v1.json",o="urn:reactodia:newElement",s="urn:reactodia:newLink";var a,l;!function(e){e.forElement=function(){return`urn:reactodia:e:${(0,i.generate128BitID)()}`},e.forLink=function(){return`urn:reactodia:l:${(0,i.generate128BitID)()}`}}(a||(a={})),function(e){e.PinnedProperties="urn:reactodia:pinnedProperties",e.CustomLabel="urn:reactodia:customLabel"}(l||(l={}))},(e,t,n)=>{n.r(t),n.d(t,{CompositeDataProvider:()=>o});var i=n(68),r=n(82);class o{providers;constructor(e){const{providers:t}=e;this.providers=t}get factory(){return this.providers.length>0?this.providers[0].provider.factory:i.DefaultDataFactory}async requestWithMerge(e,t){return t(await Promise.all(this.providers.map((t=>e(t.provider).then((e=>[e,t]))))))}knownElementTypes(e){return this.requestWithMerge((t=>t.knownElementTypes(e)),r.mergeKnownElementTypes)}knownLinkTypes(e){return this.requestWithMerge((t=>t.knownLinkTypes(e)),r.mergeKnownLinkTypes)}elementTypes(e){return this.requestWithMerge((t=>t.elementTypes(e)),r.mergeElementTypes)}propertyTypes(e){return this.requestWithMerge((t=>t.propertyTypes(e)),r.mergePropertyTypes)}linkTypes(e){return this.requestWithMerge((t=>t.linkTypes(e)),r.mergeLinkTypes)}elements(e){return this.requestWithMerge((t=>t.elements(e)),r.mergeElementInfo)}links(e){return this.requestWithMerge((t=>t.links(e)),r.mergeLinksInfo)}connectedLinkStats(e){return this.requestWithMerge((t=>t.connectedLinkStats(e)),r.mergeConnectedLinkStats)}lookup(e){return this.requestWithMerge((t=>t.lookup(e)),r.mergeLookup)}}},(e,t,n)=>{n.r(t),n.d(t,{mergeConnectedLinkStats:()=>w,mergeElementInfo:()=>f,mergeElementTypes:()=>u,mergeKnownElementTypes:()=>a,mergeKnownLinkTypes:()=>l,mergeLinkTypes:()=>h,mergeLinksInfo:()=>x,mergeLookup:()=>v,mergePropertyTypes:()=>c});var i=n(56),r=n(68),o=n(66);const s="urn:reactodia:sourceProvider";function a(e){const t=new Map,n=new i.HashSet(o.hashSubtypeEdge,o.equalSubtypeEdges);for(const[i]of e){for(const e of i.elementTypes){const n=t.get(e.id);t.set(e.id,n?_(n,e):e)}for(const e of i.subtypeOf)n.add(e)}return{elementTypes:Array.from(t.values()),subtypeOf:Array.from(n.values())}}function l(e){const t=new Map;for(const[n]of e)for(const e of n){const n=t.get(e.id);t.set(e.id,n?p(n,e):e)}return Array.from(t.values())}function c(e){return g(e,d)}function d(e,t){return{...e,...t,label:k(e.label,t.label)}}function u(e){return g(e,_)}function h(e){return g(e,p)}function p(e,t){return{...e,...t,label:k(e.label,t.label),count:e.count||t.count?(e.count??0)+(t.count??0):void 0}}function g(e,t){const n=new Map;for(const[i]of e)for(const[e,r]of i){const i=n.get(e);n.set(e,i?t(i,r):r)}return n}function f(e){const t=new Map;for(const[n,i]of e)for(const[e,r]of n){const n={...r,properties:m(r.properties,i)},o=t.get(e);t.set(e,o?y(o,n):n)}return t}function m(e,t){return{...e,[s]:[t.provider.factory.literal(t.name)]}}function y(e,t){const n=new Set(e.types);for(const i of t.types)n.add(i);return{...e,...t,label:k(e.label,t.label),types:Array.from(n).sort(),image:e.image||t.image,properties:b(e.properties,t.properties)}}function b(e,t){const n=new i.HashSet(r.hashTerm,r.equalTerms),o={};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(Object.prototype.hasOwnProperty.call(t,i)){const r=[];L(e[i],r,n),L(t[i],r,n),o[i]=r,n.clear()}else o[i]=e[i];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(o,i)||(o[i]=t[i]));return o}function x(e){const t=new i.HashSet(o.hashLink,o.equalLinks),n=[];for(const[i]of e)for(const e of i)t.has(e)||(t.add(e),n.push(e));return n}function w(e){const t=new Map;for(const[r]of e)for(const e of r){const r=t.get(e.id);t.set(e.id,r?(n=r,i=e,{...n,...i,inCount:n.inCount+i.inCount,outCount:n.outCount+i.outCount,inexact:Boolean(n.inexact||i.inexact)}):e)}var n,i;return Array.from(t.values())}function v(e){const t=new Map;for(const[n,i]of e)for(const{element:e,inLinks:r,outLinks:o}of n){const n={...e,properties:m(e.properties,i)},s=t.get(n.id);if(s){s.element=y(s.element,n);for(const e of r)s.inLinks.add(e);for(const e of o)s.outLinks.add(e)}else t.set(e.id,{element:n,inLinks:new Set(r),outLinks:new Set(o)})}return Array.from(t.values())}function k(e,t){const n=[],o=new i.HashSet(r.hashTerm,r.equalTerms);return L(e,n,o),L(t,n,o),n}function L(e,t,n){for(const i of e)n.has(i)||(n.add(i),t.push(i))}function _(e,t){return{...e,...t,label:k(e.label,t.label),count:S(e.count,t.count)}}function S(e,t){if(void 0!==e||void 0!==t)return(e??0)+(t??0)}},(e,t,n)=>{n.r(t),n.d(t,{DecoratedDataProvider:()=>r,makeDelayProviderDecorator:()=>o});var i=n(52);class r{baseProvider;decorator;constructor(e){this.baseProvider=e.baseProvider,this.decorator=e.decorator}get factory(){return this.baseProvider.factory}decorate(e,t){const n=this.baseProvider[e].bind(this.baseProvider),{decorator:i}=this;return i(e,t[0],n)}knownElementTypes(e){return this.decorate("knownElementTypes",[e])}knownLinkTypes(e){return this.decorate("knownLinkTypes",[e])}elementTypes(e){return this.decorate("elementTypes",[e])}propertyTypes(e){return this.decorate("propertyTypes",[e])}linkTypes(e){return this.decorate("linkTypes",[e])}elements(e){return this.decorate("elements",[e])}links(e){return this.decorate("links",[e])}connectedLinkStats(e){return this.decorate("connectedLinkStats",[e])}lookup(e){return this.decorate("lookup",[e])}}function o(e,t){return(n,r,o)=>{const s="linear"===t?Math.random()*e*2:"exponential"===t?-Math.log(Math.random())*e:e;return(0,i.delay)(s,{signal:r.signal}).then((()=>o(r)))}}},(e,t,n)=>{n.r(t),n.d(t,{IndexedDbCachedProvider:()=>r});const i=["elementType","element","link","direction","text","limit"];class r{static DB_VERSION=2;baseProvider;dbName;cacheTextLookups;closeSignal;openedDb;deleteRequest;constructor(e){this.baseProvider=e.baseProvider,this.dbName=e.dbName,this.cacheTextLookups=e.cacheTextLookups??!1,this.closeSignal=e.closeSignal,this.closeSignal.addEventListener("abort",this.onClose)}get factory(){return this.baseProvider.factory}clearCache(){return this.deleteRequest=this.deleteDatabase(),this.deleteRequest}async deleteDatabase(){await this.closeDatabase(),await a(indexedDB.deleteDatabase(this.dbName))}async openDb(){return this.deleteRequest&&await this.deleteRequest.catch((()=>{})),this.openedDb||(this.openedDb=new Promise(((e,t)=>{const n=indexedDB.open(this.dbName,r.DB_VERSION);n.onupgradeneeded=e=>{const t=n.result;if(e.newVersion!==e.oldVersion)for(const n of t.objectStoreNames)t.deleteObjectStore(n);t.objectStoreNames.contains("knownElementTypes")||t.createObjectStore("knownElementTypes",{keyPath:"id"}),t.objectStoreNames.contains("knownLinkTypes")||t.createObjectStore("knownLinkTypes",{keyPath:"id"}),t.objectStoreNames.contains("elementTypes")||t.createObjectStore("elementTypes",{keyPath:"id"}),t.objectStoreNames.contains("linkTypes")||t.createObjectStore("linkTypes",{keyPath:"id"}),t.objectStoreNames.contains("propertyTypes")||t.createObjectStore("propertyTypes",{keyPath:"id"}),t.objectStoreNames.contains("elements")||t.createObjectStore("elements",{keyPath:"id"}),t.objectStoreNames.contains("connectedLinkStats")||t.createObjectStore("connectedLinkStats",{keyPath:"elementId"}),t.objectStoreNames.contains("lookup")||t.createObjectStore("lookup",{keyPath:i})},n.onsuccess=t=>{const i=n.result;e(i)},n.onerror=e=>{t(n.error)}}))),this.openedDb}onClose=async()=>{this.closeSignal.removeEventListener("abort",this.onClose),this.closeDatabase()};async closeDatabase(){if(this.openedDb){(await this.openedDb).close(),this.openedDb=void 0}}async knownElementTypes(e){const t=await this.openDb(),n=await o(t,"knownElementTypes","knownElementTypes",(async t=>({id:t,value:await this.baseProvider.knownElementTypes(e)})));return c(n.value.elementTypes.values(),this.factory),n.value}async knownLinkTypes(e){const t=await this.openDb(),n=await o(t,"knownLinkTypes","knownLinkTypes",(async t=>({id:t,value:await this.baseProvider.knownLinkTypes(e)})));return c(n.value.values(),this.factory),n.value}async elementTypes(e){const{classIds:t,signal:n}=e,i=await this.openDb(),r=await s(i,"elementTypes",t,(async e=>await this.baseProvider.elementTypes({classIds:e,signal:n})));return c(r.values(),this.factory),r}async propertyTypes(e){const{propertyIds:t,signal:n}=e,i=await this.openDb(),r=await s(i,"propertyTypes",t,(async e=>await this.baseProvider.propertyTypes({propertyIds:e,signal:n})));return c(r.values(),this.factory),r}async linkTypes(e){const{linkTypeIds:t,signal:n}=e,i=await this.openDb(),r=await s(i,"linkTypes",t,(async e=>await this.baseProvider.linkTypes({linkTypeIds:e,signal:n})));return c(r.values(),this.factory),r}async elements(e){const{elementIds:t,signal:n}=e,i=await this.openDb(),r=await s(i,"elements",t,(async e=>await this.baseProvider.elements({elementIds:e,signal:n})));return c(r.values(),this.factory),d(r.values(),this.factory),r}links(e){return this.baseProvider.links(e)}async connectedLinkStats(e){const{elementId:t,inexactCount:n,signal:i}=e,r=await this.openDb();return(await o(r,"connectedLinkStats",t,(async e=>({elementId:e,stats:await this.baseProvider.connectedLinkStats({elementId:e,inexactCount:n,signal:i})})))).stats}async lookup(e){if(!this.cacheTextLookups&&void 0!==e.text)return this.baseProvider.lookup(e);const t=[e.elementTypeId??"",e.refElementId??"",e.refElementLinkId??"",e.linkDirection??"",e.text??"",void 0===e.limit?"":null===e.limit?"null":String(e.limit)],n=await this.openDb(),i=await o(n,"lookup",t,(async([t,n,i,r,o,s])=>({elementType:t,element:n,link:i,direction:r,text:o,limit:s,result:await this.baseProvider.lookup(e)}))),r=i.result.map((e=>e.element));return c(r,this.factory),d(r,this.factory),i.result}}async function o(e,t,n,i){{const i=e.transaction(t,"readonly"),r=i.objectStore(t),o=await a(r.get(n));if(i.commit(),o)return o}const r=l(await i(n)),o=e.transaction(t,"readwrite"),s=o.objectStore(t);return await a(s.put(r)),o.commit(),r}async function s(e,t,n,i){const r=new Map,o=[];if(n.length>0){const i=e.transaction(t,"readonly"),s=i.objectStore(t);await function(e,t,n){return new Promise(((i,r)=>{let o=0,s=!1;for(const a of t){const l=e.get(a);l.onsuccess=()=>{if(!s){o++;try{n(l.result,a)}catch(e){s=!0,r(e)}o===t.length&&i()}},l.onerror=()=>{s=!0,r(l.error)}}}))}(s,n,((e,t)=>{const n=e;n?r.set(t,n):o.push(t)})),i.commit()}if(o.length>0){const n=await i(o),c=[];for(const[e,t]of n){const n=l(t);r.set(e,n),c.push(n)}const d=e.transaction(t,"readwrite"),u=d.objectStore(t);await(s=u,a=c,new Promise(((e,t)=>{const n=[];let i=!1;for(const r of a){const o=s.put(r);o.onsuccess=()=>{i||(n.push(o.result),n.length===a.length&&e(n))},o.onerror=()=>{i=!0,t(o.error)}}}))),d.commit()}var s,a;return r}function a(e){return new Promise(((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)}))}function l(e){return JSON.parse(JSON.stringify(e))}function c(e,t){for(const n of e)n.label=n.label.map((e=>u(e,t)))}function d(e,t){for(const n of e)for(const e in n.properties)if(Object.prototype.hasOwnProperty.call(n.properties,e)){const i=n.properties[e];i&&(n.properties[e]=i.map((e=>u(e,t))))}}function u(e,t){switch(e.termType){case"NamedNode":return t.namedNode(e.value);case"Literal":return t.literal(e.value,e.language?e.language:t.namedNode(e.datatype.value));default:return e}}},(e,t,n)=>{n.r(t),n.d(t,{IndexQuadBy:()=>i,makeIndexedDataset:()=>a});var i,r,o=n(56),s=n(68);function a(e){return new l(e)}!function(e){e[e.OnlyQuad=0]="OnlyQuad",e[e.S=1]="S",e[e.P=2]="P",e[e.O=4]="O",e[e.SP=8]="SP",e[e.OP=16]="OP"}(i||(i={}));class l{_size=0;byQuad;bySubject;byPredicate;byObject;bySubjectPredicate;byObjectPredicate;constructor(e){this.byQuad=new o.HashMap(s.hashQuad,s.equalQuads),e&i.S&&(this.bySubject=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.P&&(this.byPredicate=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.O&&(this.byObject=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.SP&&(this.bySubjectPredicate=new o.HashMap(r.hashCode,r.equals)),e&i.OP&&(this.byObjectPredicate=new o.HashMap(r.hashCode,r.equals))}get size(){return this._size}add(e){return this.byQuad.has(e)||(this.byQuad.set(e,e),this.bySubject&&d(this.bySubject,e.subject,e),this.byPredicate&&d(this.byPredicate,e.predicate,e),this.byObject&&d(this.byObject,e.object,e),this.bySubjectPredicate&&d(this.bySubjectPredicate,{source:e.subject,predicate:e.predicate},e),this.byObjectPredicate&&d(this.byObjectPredicate,{source:e.object,predicate:e.predicate},e),this._size++),this}addAll(e){for(const t of e)this.add(t);return this}delete(e){const t=this.byQuad.get(e);return t&&(this.byQuad.delete(t),this.bySubject&&u(this.bySubject,t.subject,t),this.byPredicate&&u(this.byPredicate,t.predicate,t),this.byObject&&u(this.byObject,t.object,t),this.bySubjectPredicate&&u(this.bySubjectPredicate,{source:e.subject,predicate:e.predicate},t),this.byObjectPredicate&&u(this.byObjectPredicate,{source:e.object,predicate:e.predicate},t),this._size--),this}clear(){this._size=0,this.byQuad.clear(),this.bySubject&&this.bySubject.clear(),this.byPredicate&&this.byPredicate.clear(),this.byObject&&this.byObject.clear(),this.bySubjectPredicate&&this.bySubjectPredicate.clear(),this.byObjectPredicate&&this.byObjectPredicate.clear()}has(e){return this.byQuad.has(e)}hasMatches(e,t,n,i){for(const r of this.iterateMatches(e,t,n,i))return!0;return!1}iterateMatches(e,t,n,i){let r;if(e&&t&&n&&i){const o=this.byQuad.get(s.DefaultDataFactory.quad(e,t,n,i));r=o?[o]:[]}else if(this.bySubjectPredicate&&e&&t){r=h(c(this.bySubjectPredicate.get({source:e,predicate:t})),null,null,n)}else if(this.byObjectPredicate&&t&&n){r=h(c(this.byObjectPredicate.get({source:n,predicate:t})),e,null,null)}else if(this.bySubject&&e){r=h(c(this.bySubject.get(e)),null,t,n)}else if(this.byPredicate&&t){r=h(c(this.byPredicate.get(t)),e,null,n)}else if(this.byObject&&n){r=h(c(this.byObject.get(n)),e,t,null)}else r=h(this.byQuad.values(),e,t,n);return i?function*(e,t){for(const n of e)(0,s.equalTerms)(n.graph,t)&&(yield n)}(r,i):r}[Symbol.iterator](){return this.byQuad.values()}forEach(e){this.byQuad.forEach(e)}}function c(e){return e instanceof Set?e:e?[e]:[]}function d(e,t,n){let i=e.get(t);if(i)if(i instanceof Set)i.add(n);else{const r=i;i=new Set,i.add(r),i.add(n),e.set(t,i)}else i=n,e.set(t,i)}function u(e,t,n){const i=e.get(t);i&&(i instanceof Set?i.delete(n):e.delete(t))}function*h(e,t,n,i){for(const r of e)t&&!(0,s.equalTerms)(t,r.subject)||n&&!(0,s.equalTerms)(n,r.predicate)||i&&!(0,s.equalTerms)(i,r.object)||(yield r)}!function(e){e.hashCode=function(e){return(0,s.dropHighestNonSignBit)(Math.imul((0,s.hashTerm)(e.source),31)+(0,s.hashTerm)(e.predicate)|0)},e.equals=function(e,t){return(0,s.equalTerms)(e.source,t.source)&&(0,s.equalTerms)(e.predicate,t.predicate)}}(r||(r={}))},(e,t,n)=>{n.r(t),n.d(t,{RdfDataProvider:()=>l});var i=n(56),r=n(66),o=n(85),s=n(68);const a="urn:reactodia:blank:rdf:";class l{factory;dataset;acceptBlankNodes;typePredicate;labelPredicate;imagePredicate;elementTypeBaseTypes;elementSubtypePredicate;linkTypeBaseTypes;EMPTY_LINKS=new Set;constructor(e={}){this.factory=e.factory??s.DefaultDataFactory,this.dataset=(0,o.makeIndexedDataset)(o.IndexQuadBy.S|o.IndexQuadBy.SP|o.IndexQuadBy.O|o.IndexQuadBy.OP),this.acceptBlankNodes=e.acceptBlankNodes??!0,this.typePredicate=this.factory.namedNode(e.typePredicate??"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.labelPredicate=null===e.labelPredicate?null:this.factory.namedNode(e.labelPredicate??"http://www.w3.org/2000/01/rdf-schema#label"),this.imagePredicate=null===e.imagePredicate?null:this.factory.namedNode(e.imagePredicate??"https://schema.org/thumbnailUrl"),this.elementTypeBaseTypes=(e.elementTypeBaseTypes??["http://www.w3.org/2002/07/owl#Class","http://www.w3.org/2000/01/rdf-schema#Class"]).map((e=>this.factory.namedNode(e))),this.elementSubtypePredicate=null===e.elementSubtypePredicate?null:this.factory.namedNode(e.elementSubtypePredicate??"http://www.w3.org/2000/01/rdf-schema#subClassOf"),this.linkTypeBaseTypes=(e.linkTypeBaseTypes??["http://www.w3.org/2002/07/owl#ObjectProperty","http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"]).map((e=>this.factory.namedNode(e)))}addGraph(e){if(this.acceptBlankNodes)this.dataset.addAll(e);else for(const t of e)"BlankNode"!==t.subject.termType&&"BlankNode"!==t.object.termType&&"BlankNode"!==t.graph.termType&&this.dataset.add(t)}encodeTerm(e){return g(e)}decodeTerm(e){return function(e,t){return e.startsWith(a)?t.blankNode(e.substring(a.length)):t.namedNode(e)}(e,this.factory)}knownElementTypes(e){const t=this.computeTypeCounts();for(const i of this.elementTypeBaseTypes)for(const e of this.dataset.iterateMatches(null,this.typePredicate,i))if(c(e.subject)){const n=this.encodeTerm(e.subject);t.has(n)||t.set(n,0)}const n=new i.HashSet(r.hashSubtypeEdge,r.equalSubtypeEdges);if(this.elementSubtypePredicate)for(const i of this.dataset.iterateMatches(null,this.elementSubtypePredicate,null))if(c(i.subject)&&c(i.object)){const e=this.encodeTerm(i.subject);t.has(e)||t.set(e,0);const r=this.encodeTerm(i.object);t.has(r)||t.set(r,0),n.add([this.encodeTerm(i.subject),this.encodeTerm(i.object)])}const o=[],s=new Set;for(const[i,r]of t){const e=this.decodeTerm(i),t=this.labelPredicate?h(this.dataset,e,this.labelPredicate):[];"BlankNode"===e.termType&&0===t.length?s.add(i):o.push({id:i,label:t,count:r})}const a=[];for(const i of n.values()){const[e,t]=i;s.has(e)||s.has(t)||a.push(i)}const l={elementTypes:o,subtypeOf:a};return Promise.resolve(l)}knownLinkTypes(e){const t=this.computeLinkCounts();for(const i of this.linkTypeBaseTypes)for(const e of this.dataset.iterateMatches(null,this.typePredicate,i))if(c(e.subject)){const n=this.encodeTerm(e.subject);t.has(n)||t.set(n,0)}const n=new Map;for(const[i,r]of t){const e=this.decodeTerm(i),t=this.labelPredicate?h(this.dataset,e,this.labelPredicate):[];"BlankNode"===e.termType&&0===t.length||n.set(i,{id:i,label:t,count:r})}return Promise.resolve(Array.from(n.values()))}elementTypes(e){const{classIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i);let t=0;for(const n of this.dataset.iterateMatches(null,this.typePredicate,e))t++;const r={id:i,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],count:t};n.set(i,r)}return Promise.resolve(n)}propertyTypes(e){const{propertyIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i),t={id:i,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[]};n.set(i,t)}return Promise.resolve(n)}linkTypes(e){const{linkTypeIds:t}=e,n=this.computeLinkCounts(t),i=new Map;for(const r of t){const e=this.decodeTerm(r),t={id:r,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],count:n.get(r)??0};i.set(r,t)}return Promise.resolve(i)}elements(e){const{elementIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i);if(this.dataset.hasMatches(e,null,null)){const t=this.imagePredicate?d(this.dataset,e,this.imagePredicate):void 0,r={id:i,types:u(this.dataset,e,this.typePredicate),label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],image:t?t.value:void 0,properties:p(this.dataset,e)};n.set(i,r)}}return Promise.resolve(n)}links(e){const{elementIds:t,linkTypeIds:n}=e,r=new i.HashSet(s.hashTerm,s.equalTerms);for(const i of t)r.add(this.decodeTerm(i));const o=n?new Set(n):void 0,a=[];for(const i of this.dataset)if(c(i.subject)&&"NamedNode"===i.predicate.termType&&c(i.object)&&(r.has(i.subject)||r.has(i.object))&&(!o||!o.has(i.predicate.value))){const e=p(this.dataset,i);a.push({sourceId:this.encodeTerm(i.subject),targetId:this.encodeTerm(i.object),linkTypeId:this.encodeTerm(i.predicate),properties:e})}return Promise.resolve(a)}connectedLinkStats(e){const{elementId:t}=e,n=this.decodeTerm(t),i=new Map;for(const s of this.dataset.iterateMatches(n,null,null))if("NamedNode"===s.predicate.termType&&c(s.object)){const e=this.encodeTerm(s.predicate);i.set(e,(i.get(e)??0)+1)}const r=new Map;for(const s of this.dataset.iterateMatches(null,null,n))if("NamedNode"===s.predicate.termType&&c(s.subject)){const e=this.encodeTerm(s.predicate);r.set(e,(r.get(e)??0)+1)}const o=[];for(const[s,a]of i)o.push({id:s,inCount:r.get(s)??0,outCount:a});for(const[s,a]of r)i.has(s)||o.push({id:s,inCount:a,outCount:0});return Promise.resolve(o)}lookup(e){const t=new i.HashMap(s.hashTerm,s.equalTerms);let n=e.text?new RegExp(e.text.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),"i"):void 0;if(e.refElementId){const n=this.decodeTerm(e.refElementId),i=e.refElementLinkId?this.decodeTerm(e.refElementLinkId):null;if(!e.linkDirection||"out"===e.linkDirection)for(const e of this.dataset.iterateMatches(n,i,null))if("NamedNode"===e.predicate.termType&&c(e.object)){const n=e.object;let i=t.get(n);i||(i={term:n},t.set(n,i));const r=this.encodeTerm(e.predicate);i.outLinks||(i.outLinks=new Set),i.outLinks.add(r)}if(!e.linkDirection||"in"===e.linkDirection)for(const e of this.dataset.iterateMatches(null,i,n))if("NamedNode"===e.predicate.termType&&c(e.subject)){const n=e.subject;let i=t.get(n);i||(i={term:n},t.set(n,i));const r=this.encodeTerm(e.predicate);i.inLinks||(i.inLinks=new Set),i.inLinks.add(r)}if(e.elementTypeId){const n=this.decodeTerm(e.elementTypeId);for(const e of Array.from(t.values()))this.dataset.hasMatches(e.term,this.typePredicate,n)||t.delete(e.term)}}else if(e.elementTypeId){const n=this.decodeTerm(e.elementTypeId);for(const e of this.dataset.iterateMatches(null,this.typePredicate,n))c(e.subject)&&!t.has(e.subject)&&t.set(e.subject,{term:e.subject})}else if(n&&this.labelPredicate){for(const e of this.dataset.iterateMatches(null,this.labelPredicate,null))c(e.subject)&&"Literal"===e.object.termType&&n.test(e.object.value)&&!t.has(e.subject)&&t.set(e.subject,{term:e.subject});n=void 0}const r=[],o="number"==typeof e.limit?e.limit:Number.POSITIVE_INFINITY;for(const i of t.values()){if(r.length>=o)break;let e;if(this.labelPredicate){if(e=h(this.dataset,i.term,this.labelPredicate),n){let t=!1;for(const i of e)if(n.test(i.value)){t=!0;break}if(!t)continue}}else e=[];const t=this.imagePredicate?d(this.dataset,i.term,this.imagePredicate):void 0,s={id:this.encodeTerm(i.term),types:u(this.dataset,i.term,this.typePredicate),label:e,image:t?t.value:void 0,properties:{}};r.push({element:s,inLinks:i.inLinks??this.EMPTY_LINKS,outLinks:i.outLinks??this.EMPTY_LINKS})}return Promise.resolve(r)}computeTypeCounts(){const e=new Map;for(const t of this.dataset.iterateMatches(null,this.typePredicate,null))if(c(t.object)){const n=this.encodeTerm(t.object);e.set(n,(e.get(n)??0)+1)}return e}computeLinkCounts(e){const t=e?new Set(e):void 0,n=new Map;for(const i of this.dataset)if("NamedNode"===i.predicate.termType){const e=this.encodeTerm(i.predicate);t&&!t.has(e)||n.set(e,(n.get(e)??0)+1)}return n}}function c(e){switch(e.termType){case"NamedNode":case"BlankNode":return!0;default:return!1}}function d(e,t,n){for(const i of e.iterateMatches(t,n,null))if(s.equalTerms(i.predicate,n)&&("NamedNode"===i.object.termType||"Literal"===i.object.termType))return i.object}function u(e,t,n){const i=new Set;for(const r of e.iterateMatches(t,n,null))if(c(r.object)){const e=g(r.object);i.add(e)}return Array.from(i).sort()}function h(e,t,n){const i=[];for(const r of e.iterateMatches(t,n,null))s.equalTerms(r.predicate,n)&&"Literal"===r.object.termType&&i.push(r.object);return i}function p(e,t){const n={};for(const i of e.iterateMatches(t,null,null))if("NamedNode"===i.predicate.termType&&"Literal"===i.object.termType){const e=g(i.predicate);let t;Object.prototype.hasOwnProperty.call(n,e)?t=n[e]:(t=[],n[e]=t),t.push(i.object)}return n}function g(e){switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return a+e.value;default:throw new Error(`Unexpected term type to encode: ${e.termType}`)}}},(e,t,n)=>{n.r(t),n.d(t,{SparqlDataProvider:()=>c});var i=n(69),r=n(54),o=n(68),s=n(88),a=n(89),l=n(90);class c{factory;options;settings;queryFunction;acceptBlankNodes=!1;linkByPredicate=new Map;linkById=new Map;openWorldLinks;propertyByPredicate=new Map;openWorldProperties;constructor(e,t=l.OwlStatsSettings){const{factory:n=o.DefaultDataFactory,queryFunction:i=p}=e;this.factory=n,this.options=e,this.settings=t,this.queryFunction=i;for(const o of t.linkConfigurations){this.linkById.set(o.id,o);const e=(0,s.isDirectLink)(o)?o.path:o.id;(0,r.getOrCreateArrayInMap)(this.linkByPredicate,e).push(o)}this.openWorldLinks=0===t.linkConfigurations.length||Boolean(t.openWorldLinks);for(const o of t.propertyConfigurations){const e=(0,s.isDirectProperty)(o)?o.path:o.id;(0,r.getOrCreateArrayInMap)(this.propertyByPredicate,e).push(o)}this.openWorldProperties=0===t.propertyConfigurations.length||Boolean(t.openWorldProperties)}async knownElementTypes(e){const{signal:t}=e,{defaultPrefix:n,schemaLabelProperty:i,classTreeQuery:r}=this.settings;if(!r)return{elementTypes:[],subtypeOf:[]};const o=n+u(r,{schemaLabelProperty:i}),a=await this.executeSparqlSelect(o,{signal:t}),l=(0,s.getClassTree)(a);return this.options.prepareLabels&&await d(l.elementTypes,this.options.prepareLabels,t),l}async propertyTypes(e){const{propertyIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,propertyInfoQuery:o}=this.settings;let a;if(o){const e=i+u(o,{ids:t.map(g).map((e=>` ( ${e} )`)).join(" "),schemaLabelProperty:r}),l=await this.executeSparqlSelect(e,{signal:n});a=(0,s.getPropertyInfo)(l)}else{a=new Map;for(const e of t)a.set(e,{id:e,label:[]})}return this.options.prepareLabels&&await d(a.values(),this.options.prepareLabels,n),a}async elementTypes(e){const{classIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,classInfoQuery:o}=this.settings;let a;if(o){const e=i+u(o,{ids:t.map(g).map((e=>` ( ${e} )`)).join(" "),schemaLabelProperty:r}),l=await this.executeSparqlSelect(e,{signal:n});a=(0,s.getClassInfo)(l)}else{a=new Map;for(const e of t)a.set(e,{id:e,label:[]})}return this.options.prepareLabels&&await d(a.values(),this.options.prepareLabels,n),a}async linkTypes(e){const{linkTypeIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,linkTypesInfoQuery:o}=this.settings;let a;if(o){const e=i+u(o,{ids:t.map(g).map((e=>` ( ${e} )`)).join(" "),schemaLabelProperty:r}),l=await this.executeSparqlSelect(e,{signal:n});a=(0,s.getLinkTypes)(l)}else{a=new Map;for(const e of t)a.set(e,{id:e,label:[]})}return this.options.prepareLabels&&await d(a.values(),this.options.prepareLabels,n),a}async knownLinkTypes(e){const{signal:t}=e,{defaultPrefix:n,schemaLabelProperty:i,linkTypesQuery:r,linkTypesPattern:o}=this.settings;if(!r)return[];const a=n+u(r,{linkTypesPattern:o,schemaLabelProperty:i}),l=await this.executeSparqlSelect(a,{signal:t}),c=(0,s.getLinkTypes)(l);return this.options.prepareLabels&&await d(c.values(),this.options.prepareLabels,t),Array.from(c.values())}async elements(e){const{elementIds:t,signal:n}=e;let i;if(t.length>0){const e=t.map(g).map((e=>` (${e})`)).join(" "),{defaultPrefix:n,dataLabelProperty:r,elementInfoQuery:o}=this.settings,s=n+u(o,{ids:e,dataLabelProperty:r,propertyConfigurations:this.formatPropertyInfo()});i=await this.executeSparqlConstruct(s)}else i=[];const r=this.queryManyElementTypes(this.settings.propertyConfigurations.length>0?t:[],n),o=(0,s.triplesToElementBinding)(i),a=(0,s.getElementsInfo)(o,await r,this.propertyByPredicate,this.openWorldProperties);return this.options.prepareLabels&&await d(a.values(),this.options.prepareLabels,n),this.options.prepareImages?await function(e,t,n){return t(e.values(),n).then((t=>{for(const[n,i]of t){const t=e.get(n);t&&(t.image=i)}}))}(a,this.options.prepareImages,n):this.options.imagePropertyUris&&this.options.imagePropertyUris.length&&await this.attachImages(a,this.options.imagePropertyUris,n),a}async attachImages(e,t,n){const i=Array.from(e.keys(),(e=>` ( ${g(e)} )`)).join(" "),r=t.map(g).map((e=>` ( ${e} )`)).join(" "),o=this.settings.defaultPrefix+`\n            SELECT ?inst ?linkType ?image\n            WHERE {{\n                VALUES (?inst) {${i}}\n                VALUES (?linkType) {${r}}\n                ${this.settings.imageQueryPattern}\n            }}\n        `;try{const t=await this.executeSparqlSelect(o,{signal:n});(0,s.enrichElementsWithImages)(t,e)}catch(a){console.error(a)}}async links(e){const{elementIds:t,linkTypeIds:n,signal:i}=e,r=this.formatLinkLinks();let o;if(t.length>0){const e=t.map(g).map((e=>` ( ${e} )`)).join(" "),n=this.settings.defaultPrefix+u(this.settings.linksInfoQuery,{ids:e,linkConfigurations:r});o=this.executeSparqlSelect(n,{signal:i})}else o=Promise.resolve({head:{vars:[]},results:{bindings:[]}});const a=this.queryManyElementTypes(0===this.linkByPredicate.size?[]:t,i);let l=(0,s.getLinksInfo)(await o,await a,this.linkByPredicate,this.openWorldLinks);if(n){const e=new Set(n);l=l.filter((t=>e.has(t.linkTypeId)))}return l}async connectedLinkStats(e){const{elementId:t,inexactCount:n,signal:i}=e,{defaultPrefix:r,linkTypesOfQuery:o,linkTypesStatisticsQuery:a,filterTypePattern:l}=this.settings,c=/\?direction\b/.test(o),d=g(t),h=this.formatLinkUnion(t,void 0,void 0,"?outObject","?inObject",c);h.usePredicatePart&&(h.unionParts.push(`{ ${d} ?link ?outObject ${c?'BIND("out" AS ?direction)':""} }`),h.unionParts.push(`{ ?inObject ?link ${d} ${c?'BIND("in" AS ?direction)':""} }`));const p=r+u(o,{elementIri:d,linkConfigurations:h.unionParts.join("\nUNION\n")}),f=await this.executeSparqlSelect(p,{signal:i}),m=f.head.vars.includes("direction"),y=(0,s.getConnectedLinkTypes)(f,this.linkByPredicate,this.openWorldLinks),b=this.acceptBlankNodes?"FILTER (IsIri(?outObject) || IsBlank(?outObject))":"FILTER IsIri(?outObject)",x=this.acceptBlankNodes?"FILTER (IsIri(?inObject) || IsBlank(?inObject))":"FILTER IsIri(?inObject)",w=[];return await Promise.all(y.map((async({linkType:e,hasInLink:t,hasOutLink:o})=>{const c=this.linkById.get(e);let h,p;if(!c||(0,s.isDirectLink)(c)){const t=g(c&&(0,s.isDirectLink)(c)?c.path:e);h=`${d} ${t} ?outObject`,p=`?inObject ${t} ${d}`}else h=this.formatLinkPath(c.path,d,"?outObject"),p=this.formatLinkPath(c.path,"?inObject",d);if(c&&c.domain&&c.domain.length>0){const e=c.domain.map(g).join(", ");h+=` { ${l.replace(/[?$]inst\b/g,d)} FILTER(?class IN (${e})) }`,p+=` { ${l.replace(/[?$]inst\b/g,"?inObject")} FILTER(?class IN (${e})) }`}if(!a||n&&m)w.push({id:e,inCount:t?1:0,outCount:o?1:0,inexact:!0});else{const t=r+u(a,{linkId:g(e),elementIri:d,linkConfigurationOut:h,linkConfigurationIn:p,navigateElementFilterOut:b,navigateElementFilterIn:x}),n=await this.executeSparqlSelect(t,{signal:i}),o=(0,s.getLinkStatistics)(n);o&&w.push(o)}}))),w}async lookup(e){const{signal:t}=e,n={...e,limit:void 0===e.limit?100:e.limit},i=this.querySingleElementTypes(n.refElementId&&this.settings.linkConfigurations.length>0?n.refElementId:void 0,t),r=this.createFilterQuery(n),o=await this.executeSparqlSelect(r,{signal:t}),a=(0,s.getFilteredData)(o,await i,this.linkByPredicate,this.openWorldLinks);if(this.options.prepareLabels){const e=a.map((e=>e.element));await d(e,this.options.prepareLabels,t)}return a}createFilterQuery(e){if(!e.refElementId&&e.refElementLinkId)throw new Error("Cannot execute refElementLink filter without refElement");let t="?inst ?class ?label ?blankType",n="?inst",i="",r="";e.refElementId&&(t+=" ?link ?direction",n+=" ?link ?direction",i=this.createRefQueryPart({elementId:e.refElementId,linkId:e.refElementLinkId,direction:e.linkDirection}),this.settings.linkConfigurations.length>0&&(t+=" ?classAll",r=this.settings.filterTypePattern.replace(/[?$]class\b/g,"?classAll")));let o="";if(e.elementTypeId){const t=g(e.elementTypeId);o=this.settings.filterTypePattern.replace(/[?$]class\b/g,t)}const{defaultPrefix:s,fullTextSearch:a,dataLabelProperty:l}=this.settings;let c="";e.text&&(n+=" ?score",this.settings.fullTextSearch.extractLabel&&(c+=`\n        BIND ( str( ${"?inst"} ) as ?uriStr)\n        BIND ( strafter(?uriStr, "#") as ?label3)\n        BIND ( strafter(strafter(?uriStr, "//"), "/") as ?label6)\n        BIND ( strafter(?label6, "/") as ?label5)\n        BIND ( strafter(?label5, "/") as ?label4)\n        BIND (if (?label3 != "", ?label3,\n            if (?label4 != "", ?label4,\n            if (?label5 != "", ?label5, ?label6))) as ${"?extractedLabel"})\n    `),c=u(a.queryPattern,{text:e.text,dataLabelProperty:l}));let d="";return"number"==typeof e.limit&&(d=`LIMIT ${e.limit}`),`${s}\n            ${a.prefix}\n\n        SELECT ${t}\n        WHERE {\n            {\n                SELECT DISTINCT ${n} WHERE {\n                    ${o}\n                    ${i}\n                    ${c}\n                    ${this.settings.filterAdditionalRestriction}\n                }\n                ${c?"ORDER BY DESC(?score)":""}\n                ${d}\n            }\n            ${r}\n            ${u(this.settings.filterElementInfoPattern,{dataLabelProperty:l})}\n        } ${c?"ORDER BY DESC(?score)":""}\n        `}executeSparqlSelect(e,t){const n=this.options.queryMethod??"GET",{signal:i}=t??{};return async function(e,t,n,i,r,o){let s;s=i("GET"===n?{url:h(e,{query:t}),headers:{Accept:"application/sparql-results+json"},method:"GET",signal:o}:{url:e,body:t,headers:{Accept:"application/sparql-results+json","Content-Type":"application/sparql-query; charset=UTF-8"},method:"POST",signal:o});const l=await s;if(l.ok){const e=await l.json();return(0,a.mapSparqlResponseIntoRdfJs)(e,r)}{const e=new Error(l.statusText);throw e.response=l,e}}(this.options.endpointUrl,e,n,this.queryFunction,this.factory,i)}executeSparqlConstruct(e,t){const n=this.options.queryMethod??"GET",{signal:r}=t??{};return async function(e,t,n,r,o){let s;s=r("GET"===n?{url:h(e,{query:t}),headers:{Accept:"text/turtle"},method:"GET",signal:o}:{url:e,body:t,headers:{Accept:"text/turtle","Content-Type":"application/sparql-query; charset=UTF-8"},method:"POST",signal:o});const a=await s;if(a.ok){const e=await a.text();return(new i.Parser).parse(e)}{const e=new Error(a.statusText);throw e.response=a,e}}(this.options.endpointUrl,e,n,this.queryFunction,r)}createRefQueryPart(e){const{elementId:t,linkId:n,direction:i}=e,{unionParts:r,usePredicatePart:o}=this.formatLinkUnion(t,n,i,"?inst","?inst",!0);if(o){const t=g(e.elementId);let o;if(n){const e=this.linkById.get(n);o=e&&(0,s.isDirectLink)(e)?g(e.path):g(n)}const a=o||"?link",l=o?`BIND(${o} as ?link)`:"",c=this.acceptBlankNodes?"FILTER(isIri(?inst) || isBlank(?inst))":"FILTER(isIri(?inst))";i&&"out"!==i||r.push(`{ ${t} ${a} ?inst BIND("out" as ?direction) ${l} ${c} }`),i&&"in"!==i||r.push(`{ ?inst ${a} ${t} BIND("in" as ?direction) ${l} ${c} }`)}let a=0===r.length?"FILTER(false)":r.join("\nUNION\n");return!n&&this.settings.filterRefElementLinkPattern.length>0&&(a+=`\n${this.settings.filterRefElementLinkPattern}`),a}formatLinkUnion(e,t,n,i,r,o){const{linkConfigurations:a}=this.settings,l=g(e),c=[];let d=!1;for(const u of a)if(!t||u.id===t)if((0,s.isDirectLink)(u))d=!0;else{const e=g(u.id);if(!n||"out"===n){const t=this.formatLinkPath(u.path,l,i),n=o?'BIND("out" as ?direction) ':"";c.push(`{ ${t} BIND(${e} as ?link) ${n}}`)}if(!n||"in"===n){const t=this.formatLinkPath(u.path,r,l),n=o?'BIND("in" as ?direction) ':"";c.push(`{ ${t} BIND(${e} as ?link) ${n}}`)}}return{unionParts:c,usePredicatePart:this.openWorldLinks||d}}formatLinkLinks(){const e=[];let t=!1;for(const n of this.settings.linkConfigurations)if((0,s.isDirectLink)(n))t=!0;else{const t=g(n.id);e.push(`${this.formatLinkPath(n.path,"?source","?target")} BIND(${t} as ?type)`)}return(this.openWorldLinks||t)&&e.push("?source ?type ?target"),0===e.length?"":1===e.length?e[0]:"{ "+e.join(" }\nUNION\n{ ")+" }"}formatLinkPath(e,t,n){return e.replace(/[?$]source\b/g,t).replace(/[?$]target\b/g,n)}formatPropertyInfo(){const e=[];let t=!1;for(const n of this.settings.propertyConfigurations)if((0,s.isDirectProperty)(n))t=!0;else{const t=g(n.id),i=this.formatPropertyPath(n.path,"?inst","?propValue");e.push(`{ ${i} BIND(${t} as ?propType) }`)}return(this.openWorldProperties||t)&&e.push("{ ?inst ?propType ?propValue }"),e.join("\nUNION\n")}formatPropertyPath(e,t,n){return e.replace(/[?$]inst\b/g,t).replace(/[?$]value\b/g,n)}async querySingleElementTypes(e,t){if(!e)return;return(await this.queryManyElementTypes([e],t)).get(e)}async queryManyElementTypes(e,t){if(0===e.length)return new Map;const{filterTypePattern:n}=this.settings,i=u("SELECT ?inst ?class { VALUES(?inst) { ${ids} } ${filterTypePattern} }",{ids:e.map((e=>`(${g(e)})`)).join(" "),filterTypePattern:n}),r=await this.executeSparqlSelect(i,{signal:t});return(0,s.getElementTypes)(r)}}async function d(e,t,n){const i=new Set;for(const o of e)i.add(o.id);const r=await t(i,n);for(const o of e){const e=r.get(o.id);e&&(o.label=e)}}function u(e,t){let n=e;for(const i in t){if(!Object.prototype.hasOwnProperty.call(t,i))continue;const e=t[i];e&&(n=n.replace(new RegExp("\\${"+i+"}","g"),e))}return n}function h(e,t={}){const n=e.indexOf("?")<0?"?":"&";return e+(n+Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&"))}function p(e){return fetch(e.url,{method:e.method,body:e.body,credentials:"same-origin",mode:"cors",cache:"default",headers:e.headers,signal:e.signal})}function g(e){if("string"!=typeof e)throw new Error(`Cannot escape IRI of type "${typeof e}"`);return`<${e}>`}},(e,t,n)=>{n.r(t),n.d(t,{enrichElement:()=>N,enrichElementsWithImages:()=>x,getClassInfo:()=>p,getClassTree:()=>h,getConnectedLinkTypes:()=>k,getElementTypes:()=>w,getElementsInfo:()=>y,getFilteredData:()=>_,getLinkStatistics:()=>L,getLinkTypes:()=>f,getLinksInfo:()=>v,getPropertyInfo:()=>g,isDirectLink:()=>I,isDirectProperty:()=>T,triplesToElementBinding:()=>m});var i=n(54),r=n(56),o=n(68),s=n(66),a=n(89);const l="urn:reactodia:sparql:type",c="urn:reactodia:sparql:label",d=new Map,u=new Set;function h(e){const t=new Map,n=new r.HashSet(s.hashSubtypeEdge,s.equalSubtypeEdges);for(const r of e.results.bindings){if(!(0,a.isRdfIri)(r.class))continue;const e=r.class.value;let o=t.get(e);if(o||(o=i(e),t.set(e,o)),j(o.label,r.label),r.parent){const t=r.parent.value;n.add([e,t])}r.instcount&&(o.count=A(r.instcount))}for(const r of e.results.bindings)if(r.parent){const e=r.parent.value;t.has(e)||t.set(e,i(e))}function i(e){return{id:e,label:[],count:void 0}}return{elementTypes:Array.from(t.values()),subtypeOf:Array.from(n.values())}}function p(e){const t=new Map;for(const n of e.results.bindings){if(!n.class)continue;const e=n.class.value,i=t.get(e);if(i){if(j(i.label,n.label),n.instcount){const e=A(n.instcount);void 0!==e&&(i.count=void 0===i.count?e:Math.max(i.count,e))}}else t.set(e,{id:e,label:n.label?[n.label]:[],count:n.instcount?A(n.instcount):void 0})}return t}function g(e){const t=new Map;for(const n of e.results.bindings){const e=n.property.value,i=t.get(e);i?j(i.label,n.label):t.set(e,{id:n.property.value,label:n.label?[n.label]:[]})}return t}function f(e){const t=new Map;for(const n of e.results.bindings){const e=n.link.value,i=t.get(e);i?j(i.label,n.label):t.set(e,P(n))}return t}function m(e){const t=new Map,n={head:{vars:["inst","class","label","blankType","propType","propValue"]},results:{bindings:[]}};for(const r of e){if(!(0,a.isRdfIri)(r.subject))continue;const e=r.subject.value;t.has(e)||t.set(e,i(r)),r.predicate.value===c&&(0,a.isRdfLiteral)(r.object)?(t.get(e).label&&t.set(e,i(r)),t.get(e).label=r.object):r.predicate.value===l&&(0,a.isRdfIri)(r.object)&&(0,a.isRdfIri)(r.predicate)?(t.get(e).class&&t.set(e,i(r)),t.get(e).class=r.object):((0,a.isRdfIri)(r.object)||(0,a.isRdfLiteral)(r.object))&&(0,a.isRdfIri)(r.predicate)&&(t.get(e).propType&&t.set(e,i(r)),t.get(e).propType=r.predicate,t.get(e).propValue=r.object)}function i(e){const t={inst:e.subject};return n.results.bindings.push(t),t}return n}function y(e,t=d,n=d,i=!0){const r=new Map;for(const o of e.results.bindings){if(!(0,a.isRdfIri)(o.inst))continue;const e=o.inst.value;let t=r.get(e);t||(t=D(e),r.set(e,t)),N(t,o)}if(!i||n.size>0)for(const o of r.values()){const e=t.get(o.id);o.properties=b(o,e,n,i)}return r}function b(e,t,n,i){const r={};for(const o in e.properties){if(!Object.hasOwnProperty.call(e.properties,o))continue;const s=n.get(o);if(s&&s.length>0)for(const n of s)E(n,t)&&(r[n.id]=e.properties[o]);else i&&(r[o]=e.properties[o])}return r}function x(e,t){for(const n of e.results.bindings){if(!(0,a.isRdfIri)(n.inst))continue;const e=t.get(n.inst.value);e&&(e.image=n.image.value)}}function w(e){const t=new Map;for(const n of e.results.bindings)if((0,a.isRdfIri)(n.inst)&&(0,a.isRdfIri)(n.class)){const e=n.inst.value,r=n.class.value;(0,i.getOrCreateSetInMap)(t,e).add(r)}return t}function v(e,t=d,n=d,i=!0){const o=e.results.bindings,a=new r.HashMap(s.hashLink,s.equalLinks);for(const r of o){const e={sourceId:r.source.value,linkTypeId:r.type.value,targetId:r.target.value,properties:{}},o=a.get(e);if(o)r.propType&&r.propValue&&C(o.properties,r.propType,r.propValue);else{r.propType&&r.propValue&&C(e.properties,r.propType,r.propValue);const o=n.get(e.linkTypeId);if(o&&o.length>0){for(const n of o)if(E(n,t.get(e.sourceId))){const t=I(n)?{...e,linkTypeId:n.id}:e;a.set(t,t)}}else i&&a.set(e,e)}}return Array.from(a.values())}function k(e,t=d,n=!0){const i=new Map,r=(e,t)=>{let n=i.get(e);n||(n={linkType:e},i.set(e,n)),(0,a.isRdfLiteral)(t)&&("in"===t.value?n.hasInLink=!0:"out"===t.value&&(n.hasOutLink=!0))};for(const o of e.results.bindings){if(!(0,a.isRdfIri)(o.link))continue;const e=t.get(o.link.value);if(e&&e.length>0)for(const t of e){r(I(t)?t.id:o.link.value,o.direction)}else n&&r(o.link.value,o.direction)}return Array.from(i.values())}function L(e){for(const n of e.results.bindings)if((0,a.isRdfIri)(n.link))return{id:(t=n).link.value,inCount:A(t.inCount),outCount:A(t.outCount)};var t}function _(e,t,n,r){const o=n??d,s=new Map,l=new Map,c=new Map,h=new Map;for(const d of e.results.bindings){if(!(0,a.isRdfIri)(d.inst)&&!(0,a.isRdfBlank)(d.inst))continue;const e=d.inst.value;let t=s.get(e);if(t||(t=D(e),s.set(e,t)),N(t,d),(0,a.isRdfIri)(d.classAll)&&(0,i.getOrCreateSetInMap)(l,e).add(d.classAll.value),!r&&d.link&&d.direction){const e="in"===d.direction.value?h:"out"===d.direction.value?c:void 0;e&&(0,i.getOrCreateSetInMap)(e,t.id).add(d.link.value)}}const p=[];for(const i of s.values()){const e=l.get(i.id);if(r||S(t,c.get(i.id),o)&&S(e,h.get(i.id),o)){i.types.sort();const n=new Set(M(t,c.get(i.id)??u,o,r)),s=new Set(M(e,h.get(i.id)??u,o,r));p.push({element:i,outLinks:n,inLinks:s})}}return p}function S(e,t,n){if(!t)return!0;const i=M(e,t,n,!1);for(const r of i)return!0;return!1}function*M(e,t,n,i){for(const r of t){const t=n.get(r);if(t)for(const n of t)E(n,e)&&(yield n.id);else i&&(yield r)}}function I(e){return!/[?$][a-zA-Z]+\b/.test(e.path)}function T(e){return!/[?$][a-zA-Z]+\b/.test(e.path)}function E(e,t){if(e.domain&&0!==e.domain.length){if(t){for(const n of e.domain)if(t.has(n))return!0;return!1}return!1}return!0}function N(e,t){e&&(j(e.label,t.label),t.class&&e.types.indexOf(t.class.value)<0&&e.types.push(t.class.value),t.propType&&t.propValue&&t.propType.value!==c&&C(e.properties,t.propType,t.propValue))}function j(e,t){if(t){for(const n of e)if(o.equalTerms(n,t))return;e.push(t)}}function C(e,t,n){let i=Object.prototype.hasOwnProperty.call(e,t.value)?e[t.value]:void 0;if(i){for(const r of i)if(o.equalTerms(r,n))return}else i=[],e[t.value]=i;i.push(n)}function A(e){const t=+e.value;return Number.isFinite(t)?t:0}function D(e){return{id:e,label:[],types:[],properties:{}}}function P(e){return{id:e.link.value,label:e.label?[e.label]:[],count:e.instcount?A(e.instcount):void 0}}},(e,t,n)=>{function i(e,t){return{...e,results:{...e.results,bindings:e.results.bindings.map((function(e){const n={};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const r=e[i];switch(r.type){case"uri":n[i]=t.namedNode(r.value);break;case"bnode":n[i]=t.blankNode(r.value);break;case"literal":n[i]=t.literal(r.value,r["xml:lang"]?r["xml:lang"]:r.datatype?t.namedNode(r.datatype):void 0);break;default:throw new Error(`Unexpected SPARQL term type: "${r.type}"`)}}return n}))}}}function r(e){return Boolean(e&&"NamedNode"===e.termType)}function o(e){return Boolean(e&&"BlankNode"===e.termType)}function s(e){return Boolean(e&&"Literal"===e.termType)}n.r(t),n.d(t,{isRdfBlank:()=>o,isRdfIri:()=>r,isRdfLiteral:()=>s,mapSparqlResponseIntoRdfJs:()=>i})},(e,t,n)=>{n.r(t),n.d(t,{DBPediaSettings:()=>u,OwlRdfsSettings:()=>a,OwlRdfsSettingsOverride:()=>s,OwlStatsSettings:()=>c,RdfSettings:()=>i,WikidataSettings:()=>o});const i={linkConfigurations:[],openWorldLinks:!1,propertyConfigurations:[],openWorldProperties:!1,linksInfoQuery:"SELECT ?source ?type ?target\n            WHERE {\n                ${linkConfigurations}\n                VALUES (?source) {${ids}}\n                VALUES (?target) {${ids}}\n            }",defaultPrefix:"",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",fullTextSearch:{prefix:"",queryPattern:""},classTreeQuery:"",classInfoQuery:'SELECT ?class ?label ?instcount WHERE {\n    VALUES(?class) {${ids}}\n    OPTIONAL { ?class ${schemaLabelProperty} ?label }\n    BIND("" as ?instcount)\n}',linkTypesQuery:"SELECT DISTINCT ?link ?instcount ?label WHERE {\n    ${linkTypesPattern}\n    OPTIONAL { ?link ${schemaLabelProperty} ?label }\n}",linkTypesPattern:"",linkTypesInfoQuery:"SELECT ?link ?label WHERE {\n    VALUES(?link) {${ids}}\n    OPTIONAL { ?link ${schemaLabelProperty} ?label }\n}",propertyInfoQuery:"SELECT ?property ?label WHERE {\n    VALUES(?property) {${ids}}\n    OPTIONAL { ?property ${schemaLabelProperty} ?label }\n}",elementInfoQuery:"",imageQueryPattern:"",linkTypesOfQuery:"",linkTypesStatisticsQuery:"",filterRefElementLinkPattern:"",filterTypePattern:"",filterAdditionalRestriction:"",filterElementInfoPattern:""},r={defaultPrefix:"PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n PREFIX wdt: <http://www.wikidata.org/prop/direct/>\n PREFIX wd: <http://www.wikidata.org/entity/>\n PREFIX owl:  <http://www.w3.org/2002/07/owl#>\n",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",classTreeQuery:"\n        SELECT distinct ?class ?label ?parent WHERE {\n            ?class rdfs:label ?label.\n            { ?class wdt:P279 wd:Q35120. }\n            UNION\n            { ?parent wdt:P279 wd:Q35120.\n            ?class wdt:P279 ?parent. }\n            UNION\n            { ?parent wdt:P279/wdt:P279 wd:Q35120.\n            ?class wdt:P279 ?parent. }\n        }\n    ",linkTypesQuery:"",linkTypesPattern:"\n        ?link wdt:P279* wd:Q18616576.\n        BIND(0 as ?instcount)\n    ",linkTypesInfoQuery:"SELECT ?link ?label WHERE {\n    VALUES (?link) {${ids}}\n    OPTIONAL {\n        ?claim <http://wikiba.se/ontology#directClaim> ?link .\n        ?claim ${schemaLabelProperty} ?label\n    }\n}",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            OPTIONAL {\n                ?inst wdt:P31 ?class\n            }\n            OPTIONAL {?inst rdfs:label ?label}\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n            }\n        }\n    ",imageQueryPattern:' { ?inst ?linkType ?fullImage } union { ?inst wdt:P163/wdt:P18 ?fullImage }\n                BIND(CONCAT("https://commons.wikimedia.org/w/thumb.php?f=",\n                    STRAFTER(STR(?fullImage), "Special:FilePath/"), "&w=200") AS ?image)',linkTypesOfQuery:"\n        SELECT DISTINCT ?link ?direction\n        WHERE {\n            ${linkConfigurations}\n            ?claim <http://wikiba.se/ontology#directClaim> ?link .\n        }\n    ",linkTypesStatisticsQuery:"\n        SELECT (${linkId} as ?link) (COUNT(?outObject) AS ?outCount) (COUNT(?inObject) AS ?inCount)\n        WHERE {\n            {\n                {\n                    SELECT DISTINCT ?outObject WHERE {\n                        ${linkConfigurationOut}\n                        FILTER(ISIRI(?outObject))\n                        ?outObject ?someprop ?someobj.\n                    }\n                    LIMIT 101\n                }\n            } UNION {\n                {\n                    SELECT DISTINCT ?inObject WHERE {\n                        ${linkConfigurationIn}\n                        FILTER(ISIRI(?inObject))\n                        ?inObject ?someprop ?someobj.\n                    }\n                    LIMIT 101\n                }\n            }\n        }\n    ",filterRefElementLinkPattern:"?claim <http://wikiba.se/ontology#directClaim> ?link .",filterTypePattern:"?inst wdt:P31 ?instType. ?instType wdt:P279* ?class",filterAdditionalRestriction:"FILTER ISIRI(?inst)\n                        BIND(STR(?inst) as ?strInst)\n                        FILTER exists {?inst ?someprop ?someobj}\n",filterElementInfoPattern:"OPTIONAL {?inst wdt:P31 ?foundClass}\n                BIND (coalesce(?foundClass, owl:Thing) as ?class)\n                OPTIONAL {?inst rdfs:label ?label}\n",fullTextSearch:{prefix:"PREFIX bds: <http://www.bigdata.com/rdf/search#>\n",queryPattern:'\n            SERVICE wikibase:mwapi {\n                bd:serviceParam wikibase:endpoint "www.wikidata.org";\n                    wikibase:api "EntitySearch";\n                    mwapi:search "${text}";\n                    mwapi:language "en".\n                ?inst wikibase:apiOutputItem mwapi:item.\n                ?num wikibase:apiOrdinal true.\n            }\n            BIND(IF(\n                STRLEN(STR(?inst)) > 33,\n                0-<http://www.w3.org/2001/XMLSchema#integer>(SUBSTR(STR(?inst), 33)),\n                -10000\n            ) as ?score)\n        '}},o={...i,...r},s={defaultPrefix:"PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n PREFIX owl:  <http://www.w3.org/2002/07/owl#>\n",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",fullTextSearch:{prefix:"",queryPattern:' OPTIONAL {?inst ${dataLabelProperty} ?search1}\n        FILTER regex(COALESCE(str(?search1), str(?extractedLabel)), "${text}", "i")\n        BIND(0 as ?score)\n',extractLabel:!0},classTreeQuery:"\n            SELECT ?class ?label ?parent\n            WHERE {\n                {\n                    ?class a rdfs:Class\n                } UNION {\n                    ?class a owl:Class\n                }\n                FILTER ISIRI(?class)\n                OPTIONAL {?class rdfs:label ?label}\n                OPTIONAL {?class rdfs:subClassOf ?parent. FILTER ISIRI(?parent)}\n            }\n        ",linkTypesPattern:"{\t?link a rdf:Property\n                    } UNION {\n                    ?link a owl:ObjectProperty\n                }\n                BIND('' as ?instcount)\n    ",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            OPTIONAL { ?inst a ?class }\n            OPTIONAL {?inst ${dataLabelProperty} ?label}\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n            }\n        }\n    ",imageQueryPattern:"{ ?inst ?linkType ?image } UNION { [] ?linkType ?inst. BIND(?inst as ?image) }",linkTypesOfQuery:"\n        SELECT DISTINCT ?link ?direction\n        WHERE {\n            ${linkConfigurations}\n        }\n    ",linkTypesStatisticsQuery:"\n        SELECT ?link ?outCount ?inCount\n        WHERE {\n            {\n                SELECT (${linkId} as ?link) (count(?outObject) as ?outCount) WHERE {\n                    ${linkConfigurationOut}\n                    ${navigateElementFilterOut}\n                } LIMIT 101\n            } {\n                SELECT (${linkId} as ?link) (count(?inObject) as ?inCount) WHERE {\n                    ${linkConfigurationIn}\n                    ${navigateElementFilterIn}\n                } LIMIT 101\n            }\n        }\n    ",filterRefElementLinkPattern:"",filterTypePattern:"?inst a ?instType. ?instType rdfs:subClassOf* ?class",filterElementInfoPattern:"OPTIONAL {?inst rdf:type ?foundClass}\n                BIND (coalesce(?foundClass, owl:Thing) as ?class)\n                OPTIONAL {?inst ${dataLabelProperty} ?label}",filterAdditionalRestriction:""},a={...i,...s},l={classTreeQuery:"\n        SELECT ?class ?instcount ?label ?parent\n        WHERE {\n            {SELECT ?class (count(?inst) as ?instcount)\n                WHERE {\n                    ?inst rdf:type ?class.\n                    FILTER ISIRI(?class)\n                } GROUP BY ?class } UNION\n            {\n                ?class rdf:type rdfs:Class\n            } UNION {\n                ?class rdf:type owl:Class\n            }\n            OPTIONAL {?class rdfs:label ?label}\n            OPTIONAL {?class rdfs:subClassOf ?parent. FILTER ISIRI(?parent)}\n        }\n    "},c={...a,...l},d={fullTextSearch:{prefix:"PREFIX dbo: <http://dbpedia.org/ontology/>\n",queryPattern:'\n              ?inst rdfs:label ?searchLabel.\n              ?searchLabel bif:contains "${text}".\n              ?inst dbo:wikiPageID ?origScore .\n              BIND(0-?origScore as ?score)\n        '},classTreeQuery:"\n        SELECT distinct ?class ?label ?parent WHERE {\n            ?class rdfs:label ?label.\n            OPTIONAL {?class rdfs:subClassOf ?parent}\n            ?root rdfs:subClassOf owl:Thing.\n            ?class rdfs:subClassOf? | rdfs:subClassOf/rdfs:subClassOf ?root\n        }\n    ",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            ?inst a ?class .\n            ?inst rdfs:label ?label .\n            FILTER (!contains(str(?class), 'http://dbpedia.org/class/yago'))\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n            }\n        }\n    ",filterTypePattern:"?inst a ?instType. ?instType rdfs:subClassOf* ?class",filterElementInfoPattern:"\n        OPTIONAL {?inst rdf:type ?foundClass. FILTER (!contains(str(?foundClass), 'http://dbpedia.org/class/yago'))}\n        BIND (coalesce(?foundClass, owl:Thing) as ?class)\n        OPTIONAL {?inst ${dataLabelProperty} ?label}",imageQueryPattern:' { ?inst ?linkType ?fullImage } UNION { [] ?linkType ?inst. BIND(?inst as ?fullImage) }\n            BIND(CONCAT("https://commons.wikimedia.org/w/thumb.php?f=",\n            STRAFTER(STR(?fullImage), "Special:FilePath/"), "&w=200") AS ?image)\n    '},u={...a,...d}},(e,t,n)=>{n.r(t),n.d(t,{CanvasContext:()=>r,useCanvas:()=>o});var i=n(58);const r=i.createContext(null);function o(){const e=i.useContext(r);if(!e)throw new Error("Missing Reactodia canvas context");return e}},(e,t,n)=>{n.r(t),n.d(t,{defineCanvasWidget:()=>r,extractCanvasWidget:()=>o});const i=Symbol("getWidgetMetadata");function r(e,t){e[i]=t}function o(e){const t=e.type[i];if(t)return t(e)}},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t),n.d(t,{Element:()=>s,ElementType:()=>d,Link:()=>a,LinkType:()=>h,LinkVertex:()=>p,PropertyType:()=>u,linkMarkerKey:()=>l,makeLinkWithDirection:()=>c});var i=n(55),r=n(80),o=n(71);class s{source=new i.EventSource;events=this.source;id;_data;_position;_expanded;_group;_elementState;_temporary;constructor(e){const{id:t=r.GenerateID.forElement(),data:n,position:i={x:0,y:0},expanded:o=!1,group:s,elementState:a,temporary:l=!1}=e;this.id=t,this._data=n,this._position=i,this._expanded=o,this._group=s,this._elementState=a,this._temporary=l}static placeholderData(e){return{id:e,types:[],label:[],properties:{}}}get iri(){return this._data.id}get data(){return this._data}setData(e){const t=this._data;t!==e&&(this._data=e,this.source.trigger("changeData",{source:this,previous:t}))}get position(){return this._position}setPosition(e){const t=this._position;t.x===e.x&&t.y===e.y||(this._position=e,this.source.trigger("changePosition",{source:this,previous:t}))}get isExpanded(){return this._expanded}setExpanded(e){const t=this._expanded;t!==e&&(this._expanded=e,this.source.trigger("changeExpanded",{source:this,previous:t}))}get group(){return this._group}setGroup(e){const t=this._group;t!==e&&(this._group=e,this.source.trigger("changeGroup",{source:this,previous:t}))}get elementState(){return this._elementState}setElementState(e){const t=this._elementState;t!==e&&(this._elementState=e,this.source.trigger("changeElementState",{source:this,previous:t}))}get temporary(){return this._temporary}focus(){this.source.trigger("requestedFocus",{source:this})}redraw(){this.source.trigger("requestedRedraw",{source:this})}requestGroupContent(){this.source.trigger("requestedGroupContent",{source:this})}}class a{source=new i.EventSource;events=this.source;id;_sourceId;_targetId;_data;_layoutOnly=!1;_vertices;_linkState;constructor(e){const{id:t=r.GenerateID.forLink(),sourceId:n,targetId:i,data:o,vertices:s=[],linkState:a}=e;this.id=t,this._sourceId=n,this._targetId=i,this._data=o,this._vertices=s,this._linkState=a}get typeId(){return this._data?.linkTypeId}get sourceId(){return this._sourceId}get targetId(){return this._targetId}get data(){return this._data}setData(e){const t=this._data;t!==e&&(this._data=e,this.source.trigger("changeData",{source:this,previous:t}))}get layoutOnly(){return this._layoutOnly}setLayoutOnly(e){const t=this._layoutOnly;t!==e&&(this._layoutOnly=e,this.source.trigger("changeLayoutOnly",{source:this,previous:t}))}get vertices(){return this._vertices}setVertices(e){const t=this._vertices;(0,o.isPolylineEqual)(this._vertices,e)||(this._vertices=e,this.source.trigger("changeVertices",{source:this,previous:t}))}get linkState(){return this._linkState}setLinkState(e){const t=this._linkState;t!==e&&(this._linkState=e,this.source.trigger("changeLinkState",{source:this,previous:t}))}}function l(e,t){return`ramp-marker-${t?"start":"end"}-${e}`}function c(e,t){if(t.sourceId!==e.data.sourceId&&t.sourceId!==e.data.targetId)throw new Error("New link source IRI is unrelated to original link");if(t.targetId!==e.data.sourceId&&t.targetId!==e.data.targetId)throw new Error("New link target IRI is unrelated to original link");const n=t.sourceId===e.data.sourceId?e.sourceId:e.targetId,i=t.targetId===e.data.targetId?e.targetId:e.sourceId;return new a({sourceId:n,targetId:i,data:t})}class d{source=new i.EventSource;events=this.source;id;_label;_count;constructor(e){const{id:t,label:n=[],count:i}=e;this.id=t,this._label=n,this._count=i}get label(){return this._label}setLabel(e){const t=this._label;t!==e&&(this._label=e,this.source.trigger("changeLabel",{source:this,previous:t}))}get count(){return this._count}setCount(e){const t=this._count;t!==e&&(this._count=e,this.source.trigger("changeCount",{source:this,previous:t}))}}class u{source=new i.EventSource;events=this.source;id;_label;constructor(e){const{id:t,label:n=[]}=e;this.id=t,this._label=n}get label(){return this._label}setLabel(e){const t=this._label;t!==e&&(this._label=e,this.source.trigger("changeLabel",{source:this,previous:t}))}}class h{source=new i.EventSource;events=this.source;id;_index;_label;_visibility="visible";constructor(e){const{id:t,index:n,label:i=[]}=e;this.id=t,this._index=n,this._label=i}get index(){return this._index}setIndex(e){if("number"==typeof this._index)throw new Error("Cannot set index for link type more than once.");this._index=e}get label(){return this._label}setLabel(e){const t=this._label;t!==e&&(this._label=e,this.source.trigger("changeLabel",{source:this,previous:t}))}get visibility(){return this._visibility}setVisibility(e){const t=this._visibility;t!==e&&(this._visibility=e,this.source.trigger("changeVisibility",{source:this,previous:t}))}}class p{link;vertexIndex;constructor(e,t){this.link=e,this.vertexIndex=t}createAt(e){const t=[...this.link.vertices];t.splice(this.vertexIndex,0,e),this.link.setVertices(t)}moveTo(e){const t=[...this.link.vertices];t.splice(this.vertexIndex,1,e),this.link.setVertices(t)}remove(){const e=[...this.link.vertices],[t]=e.splice(this.vertexIndex,1);this.link.setVertices(e)}}},(e,t,n)=>{n.r(t),n.d(t,{EmbeddedLayer:()=>d});var i=n(96),r=n(58),o=n(55),s=n(94),a=n(71),l=n(100),c=n(91);class d extends r.Component{static contextType=c.CanvasContext;listener=new o.EventObserver;nestedElementListener=new o.EventObserver;layerOffsetLeft=0;layerOffsetTop=0;isApplyingParentMove=!1;isNestedElementMoving=!1;previousPositions=[];constructor(e){super(e),this.state={paperWidth:0,paperHeight:0,offsetX:0,offsetY:0}}componentDidMount(){const{elementId:e}=this.props,{canvas:t,model:n}=this.context,i=n.getElement(e);this.listener.listen(n.events,"changeGroupContent",(({group:e,layoutComplete:t})=>{if(e===i.id&&t){this.listenNestedElements(this.getNestedElements());const{offsetX:e,offsetY:t}=this.getOffset();this.moveNestedElements(e,t)}})),this.listener.listen(i.events,"changePosition",(()=>{if(this.isNestedElementMoving)return;const{offsetX:e,offsetY:t}=this.getOffset(),{x:n,y:i}=this.getContentFittingBox(),r=e-n,o=t-i;this.moveNestedElements(r,o),this.setState({offsetX:e,offsetY:t})})),this.listener.listen(t.events,"pointerUp",(e=>{this.isNestedElementMoving=!1}));const r=this.getNestedElements();if(this.listenNestedElements(r),r.length>0){const{x:e,y:t,width:n,height:r}=this.getContentFittingBox();this.setState({offsetX:e,offsetY:t,paperWidth:n,paperHeight:r},(()=>i.redraw()))}else i.requestGroupContent()}listenNestedElements(e){const{canvas:t}=this.context,n=new o.EventObserver;for(const r of e)n.listen(r.events,"changePosition",this.recomputeSelfBounds);const i=new Set;for(const r of e)i.add(r.id);n.listen(t.renderingState.events,"changeElementSize",(e=>{i.has(e.source.id)&&this.recomputeSelfBounds()})),this.nestedElementListener.stopListening(),this.nestedElementListener=n}componentWillUnmount(){this.listener.stopListening(),this.nestedElementListener.stopListening(),this.removeElements(),this.setState({paperWidth:0,paperHeight:0,offsetX:0,offsetY:0})}getNestedElements(){const{elementId:e}=this.props,{model:t}=this.context;return t.elements.filter((t=>t.group===e))}getContentFittingBox(){const{canvas:e}=this.context,t=this.getNestedElements();return(0,a.getContentFittingBox)(t,[],e.renderingState)}removeElements(){const{model:e}=this.context,t=e.history.startBatch();for(const n of this.getNestedElements())e.removeElement(n.id);t.discard()}getOffset(){const{elementId:e}=this.props,{model:t}=this.context,n=t.getElement(e),{x:i,y:r}=n.position;return{offsetX:i+this.layerOffsetLeft,offsetY:r+this.layerOffsetTop}}moveNestedElements(e,t){this.isApplyingParentMove=!0;try{for(const n of this.getNestedElements()){const{x:i,y:r}=n.position,o={x:i+e,y:r+t};n.setPosition(o)}}finally{this.isApplyingParentMove=!1,this.recomputeSelfBounds()}}recomputeSelfBounds=()=>{if(this.isApplyingParentMove)return;const{elementId:e}=this.props,{model:t}=this.context,n=t.getElement(e),{x:i,y:r,width:o,height:s}=this.getContentFittingBox();if(this.isNestedElementMoving){const e={x:i-this.layerOffsetLeft,y:r-this.layerOffsetTop};n.setPosition(e)}this.setState({offsetX:i,offsetY:r,paperWidth:o,paperHeight:s},(()=>n.redraw()))};onPaperPointerDown=(e,t)=>{0===e.button&&t&&t instanceof s.Element&&(e.preventDefault(),this.isNestedElementMoving=!0)};calculateOffset(e){const{canvas:t}=this.context,n=t.getScale(),i=u(e),{left:r,top:o}=e.getBoundingClientRect(),{left:s,top:a}=i.getBoundingClientRect();return{left:(r-s)/n,top:(o-a)/n}}onLayerInit=e=>{if(!e)return;const{left:t,top:n}=this.calculateOffset(e);this.layerOffsetLeft=t,this.layerOffsetTop=n};render(){const{elementId:e}=this.props,{canvas:t,model:n}=this.context,{paperWidth:r,paperHeight:o,offsetX:s,offsetY:a}=this.state,c={width:r,height:o,originX:-s,originY:-a,scale:1,paddingX:0,paddingY:0};return(0,i.jsx)("div",{className:"reactodia-embedded-layer",ref:this.onLayerInit,children:(0,i.jsx)(l.Paper,{model:n,renderingState:t.renderingState,paperTransform:c,onPointerDown:this.onPaperPointerDown,group:e})})}}function u(e){const t=e.parentElement;if(t)return t.hasAttribute("data-element-id")?t:u(t);throw new Error("Cannot find parent diagram element for EmbeddedLayer")}},(e,t,n)=>{e.exports=n(97)},(e,t,n)=>{n(98);var i=n(58),r=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),t.Fragment=o("react.fragment")}var s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,o={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:d,props:o,_owner:s.current}}t.jsx=c,t.jsxs=c},e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(e,r){for(var o,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(a[c]=o[c]);if(t){s=t(o);for(var d=0;d<s.length;d++)i.call(o,s[d])&&(a[s[d]]=o[s[d]])}}return a}},(e,t,n)=>{0},(e,t,n)=>{n.r(t),n.d(t,{Paper:()=>c,TransformedSvgCanvas:()=>u,paneFromPaperCoords:()=>g,paneTopLeft:()=>p,paperFromPaneCoords:()=>f,totalPaneSize:()=>h});var i=n(96),r=n(58),o=n(94),s=n(101),a=n(105);const l="reactodia-paper";class c extends r.Component{render(){const{model:e,renderingState:t,group:n,paperTransform:r,svgCanvasRef:o,linkLayerWidgets:c,elementLayerWidgets:d}=this.props,{width:h,height:p,originX:g,originY:f,scale:m,paddingX:y,paddingY:b}=r,x={width:h*m+y,height:p*m+b,marginLeft:y,marginTop:b,paddingRight:y,paddingBottom:b},w={position:"absolute",left:0,top:0,transform:`scale(${m},${m})translate(${g}px,${f}px)`};return(0,i.jsxs)("div",{className:l,style:x,onPointerDown:this.onPointerDown,onContextMenu:this.onContextMenu,onScrollCapture:this.onScrollCapture,children:[(0,i.jsxs)(u,{svgCanvasRef:o,className:`${l}__canvas`,style:{overflow:"visible"},paperTransform:r,children:[(0,i.jsx)(a.LinkMarkers,{model:e,renderingState:t}),(0,i.jsx)(a.LinkLayer,{model:e,renderingState:t,links:e.links,group:n})]}),c,(0,i.jsx)(s.ElementLayer,{model:e,renderingState:t,group:n,style:w}),d]})}onPointerDown=e=>{const{model:t,onPointerDown:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}};onContextMenu=e=>{const{model:t,onContextMenu:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}};onScrollCapture=e=>{const{model:t,onScrollCapture:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}}}function d(e,t,n){let i,r=e;for(;;){if(r instanceof Element){if(r.hasAttribute("data-element-id"))return n.getElement(r.getAttribute("data-element-id"));if(r.hasAttribute("data-link-id")){const e=n.getLink(r.getAttribute("data-link-id"));if(!e)return;return"number"==typeof i?new o.LinkVertex(e,i):e}r.hasAttribute("data-vertex")&&(i=Number(r.getAttribute("data-vertex")))}if(!r||r===t)break;r=r.parentNode}}class u extends r.Component{static SVG_STYLE={position:"absolute",top:0,left:0};render(){const{svgCanvasRef:e,paperTransform:t,style:n,children:r,...o}=this.props,{width:s,height:a,originX:l,originY:c,scale:d,paddingX:h,paddingY:p}=t,g=s*d,f=a*d;let m=u.SVG_STYLE;return n&&(m={...m,...n}),(0,i.jsx)("svg",{ref:e,width:g,height:f,style:m,...o,children:(0,i.jsx)("g",{transform:`scale(${d},${d})translate(${l},${c})`,children:r})})}}function h(e){return{x:e.width*e.scale+2*e.paddingX,y:e.height*e.scale+2*e.paddingY}}function p(e){return{x:-e.paddingX,y:-e.paddingY}}function g(e,t){return{x:(e.x+t.originX)*t.scale,y:(e.y+t.originY)*t.scale}}function f(e,t){return{x:e.x/t.scale-t.originX,y:e.y/t.scale-t.originY}}},(e,t,n)=>{n.r(t),n.d(t,{ElementLayer:()=>h});var i,r=n(96),o=n(58),s=n(102),a=n(55),l=n(62),c=n(76),d=n(65),u=n(103);!function(e){e[e.None=0]="None",e[e.ScanCell=1]="ScanCell",e[e.Render=2]="Render",e[e.RecomputeTemplate=6]="RecomputeTemplate",e[e.RecomputeBlurred=10]="RecomputeBlurred"}(i||(i={}));class h extends o.Component{listener=new a.EventObserver;redrawBatch={requests:new Map,forAll:i.None};delayedRedraw=new c.Debouncer;memoizedElements=new WeakMap;sizeRequests=new Map;delayedUpdateSizes=new c.Debouncer;constructor(e){super(e);const{model:t,renderingState:n,group:i}=this.props;this.state={elementStates:p(t,n.shared,i,this.redrawBatch,new Map)}}render(){const{style:e,model:t,renderingState:n}=this.props,{elementStates:i}=this.state,{memoizedElements:s}=this,a=[];for(const{id:r}of t.elements){const e=i.get(r);e&&a.push(e)}return(0,r.jsx)("div",{className:"reactodia-element-layer",style:e,children:a.map((e=>{let i=s.get(e);if(!i){i=(0,r.jsx)(f,{state:e,model:t,renderingState:n,onInvalidate:this.requestRedraw,onResize:this.requestSizeUpdate},e.element.id);const a=n.shared._decorateElement(e.element);a&&(i=(0,r.jsxs)(o.Fragment,{children:[i,a]},e.element.id)),s.set(e,i)}return i}))})}componentDidMount(){const{model:e,renderingState:t}=this.props;this.listener.listen(e.events,"changeCells",(e=>{e.updateAll?this.requestRedrawAll(i.ScanCell):e.changedElement&&this.requestRedraw(e.changedElement,i.ScanCell)})),this.listener.listen(e.events,"changeCellOrder",(()=>{this.requestRedrawAll(i.None)})),this.listener.listen(e.events,"elementEvent",(({data:e})=>{const t=e.changeData||e.changeExpanded||e.changeElementState;t&&this.requestRedraw(t.source,i.RecomputeTemplate);const n=e.changePosition||e.requestedRedraw;n&&this.requestRedraw(n.source,i.Render)})),this.listener.listen(e.events,"changeLanguage",(()=>{this.requestRedrawAll(i.RecomputeTemplate)})),this.listener.listen(t.shared.events,"changeHighlight",(()=>{this.requestRedrawAll(i.RecomputeBlurred)})),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{e===u.RenderingLayer.Element?this.delayedRedraw.runSynchronously():e===u.RenderingLayer.ElementSize&&this.delayedUpdateSizes.runSynchronously()}))}componentDidUpdate(e){this.props.group!==e.group&&this.setState(((e,t)=>({elementStates:p(t.model,t.renderingState.shared,t.group,this.redrawBatch,e.elementStates)})))}componentWillUnmount(){this.listener.stopListening(),this.delayedRedraw.dispose(),this.delayedUpdateSizes.dispose()}requestRedraw=(e,t)=>{if((this.redrawBatch.forAll|t)===this.redrawBatch.forAll)return;const n=this.redrawBatch.requests.get(e.id)||i.None;this.redrawBatch.requests.set(e.id,n|t),this.delayedRedraw.call(this.redrawElements)};requestRedrawAll(e){this.redrawBatch.forAll|=e,this.delayedRedraw.call(this.redrawElements)}redrawElements=()=>{this.setState(((e,t)=>({elementStates:p(t.model,t.renderingState.shared,t.group,this.redrawBatch,e.elementStates)})))};requestSizeUpdate=(e,t)=>{this.sizeRequests.set(e.id,{element:e,node:t}),this.delayedUpdateSizes.call(this.recomputeQueuedSizes)};recomputeQueuedSizes=()=>{const{renderingState:e}=this.props,t=this.sizeRequests;this.sizeRequests=new Map,t.forEach((({element:t,node:n})=>{const{clientWidth:i,clientHeight:r}=n;e.setElementSize(t,{width:i,height:r})}))}}function p(e,t,n,r,o){if(r.forAll===i.None&&0===r.requests.size)return o;const s=new Map;for(const a of e.elements){if(a.group!==n)continue;const e=a.id;let l=o.get(e);if(l){const n=(r.requests.get(e)||i.None)|r.forAll;n&i.Render&&(l={element:a,templateProps:(n&i.RecomputeTemplate)===i.RecomputeTemplate?g(l.element):l.templateProps,blurred:(n&i.RecomputeBlurred)===i.RecomputeBlurred?y(l.element,t):l.blurred}),s.set(e,l),r.requests.delete(e)}else s.set(a.id,{element:a,templateProps:g(a),blurred:y(a,t)})}return r.forAll=i.None,s}function g(e){return{elementId:e.id,data:e.data,isExpanded:e.isExpanded,elementState:e.elementState}}class f extends o.Component{listener=new a.EventObserver;disposed=!1;typesObserver;propertiesObserver;rerenderTemplate=()=>{this.disposed||this.props.onInvalidate(this.props.state.element,i.RecomputeTemplate)};render(){const{state:{element:e,blurred:t}}=this.props;if(e.temporary)return(0,r.jsx)("div",{});const{x:n=0,y:i=0}=e.position,o=`translate(${n}px,${i}px)`,s="reactodia-overlaid-element "+(t?"reactodia-overlaid-element--blurred":"");return(0,r.jsx)("div",{className:s,"data-element-id":e.id,style:{position:"absolute",transform:o},tabIndex:0,ref:this.onMount,onLoad:this.onLoadOrErrorEvent,onError:this.onLoadOrErrorEvent,onClick:this.onClick,onDoubleClick:this.onDoubleClick,children:(0,r.jsx)(m,{...this.props})})}onMount=e=>{if(!e)return;const{state:t,onResize:n}=this.props;n(t.element,e)};onLoadOrErrorEvent=()=>{const{state:e,onResize:t}=this.props;t(e.element,(0,s.findDOMNode)(this))};onClick=e=>{if(e.target instanceof HTMLElement&&"a"===e.target.localName){const t=e.target,{renderingState:n,state:i}=this.props,r="openEntityIri"===e.target.getAttribute("data-iri-click-intent")?"openEntityIri":"openOtherIri";n.shared.onIriClick(decodeURI(t.href),i.element,r,e)}};onDoubleClick=e=>{e.preventDefault(),e.stopPropagation();const{model:t,state:{element:n}}=this.props;t.history.execute((0,d.setElementExpanded)(n,!n.isExpanded))};componentDidMount(){const{state:e,model:t}=this.props;this.listener.listen(e.element.events,"requestedFocus",(()=>{const e=(0,s.findDOMNode)(this);e&&e.focus()})),this.typesObserver=(0,l.observeElementTypes)(t,"changeLabel",this.rerenderTemplate),this.propertiesObserver=(0,l.observeProperties)(t,"changeLabel",this.rerenderTemplate),this.observeTypes()}componentWillUnmount(){this.listener.stopListening(),this.typesObserver.stopListening(),this.propertiesObserver.stopListening(),this.disposed=!0}shouldComponentUpdate(e){return this.props.state!==e.state}componentDidUpdate(){this.observeTypes(),this.props.onResize(this.props.state.element,(0,s.findDOMNode)(this))}observeTypes(){const{state:{element:e}}=this.props;this.typesObserver.observe(e.data.types),this.propertiesObserver.observe(Object.keys(e.data.properties))}}class m extends o.Component{cachedTemplateClass;cachedTemplateProps;render(){const{state:e,renderingState:t}=this.props,{element:n,templateProps:i}=e,r=t.getElementTemplate(n.data.types);return this.cachedTemplateClass=r,this.cachedTemplateProps=i,o.createElement(r,i)}shouldComponentUpdate(e){const t=e.renderingState.getElementTemplate(e.state.element.data.types);return!(this.cachedTemplateClass===t&&this.cachedTemplateProps===e.state.templateProps)}}function y(e,t){return Boolean(t.highlighter&&!t.highlighter(e))}},e=>{e.exports=Le},(e,t,n)=>{n.r(t),n.d(t,{RenderingLayer:()=>i,RenderingState:()=>d});var i,r=n(55),o=n(76),s=n(71),a=n(104);!function(e){e[e.Element=1]="Element",e[e.ElementSize=2]="ElementSize",e[e.PaperArea=3]="PaperArea",e[e.LinkRoutes=4]="LinkRoutes",e[e.Link=5]="Link",e[e.LinkLabel=6]="LinkLabel",e[e.Editor=7]="Editor",e[e.FirstToUpdate=1]="FirstToUpdate",e[e.LastToUpdate=7]="LastToUpdate"}(i||(i={}));const l=e=>{},c=e=>{};class d{listener=new r.EventObserver;source=new r.EventSource;events=this.source;model;resolveElementTemplate;resolveLinkTemplate;linkRouter;elementSizes=new WeakMap;linkLabelBounds=new WeakMap;linkTemplates=new Map;delayedUpdateRoutings=new o.Debouncer;routings=new Map;shared;constructor(e){this.model=e.model,this.shared=e.shared,this.resolveElementTemplate=e.elementTemplateResolver??l,this.resolveLinkTemplate=e.linkTemplateResolver??c,this.linkRouter=e.linkRouter??new a.DefaultLinkRouter,this.listener.listen(this.model.events,"changeCells",(()=>this.scheduleUpdateRoutings())),this.listener.listen(this.model.events,"linkEvent",(({data:e})=>{e.changeVertices&&this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"elementEvent",(({data:e})=>{e.changePosition&&this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"linkTypeEvent",(({data:e})=>{e.changeVisibility&&this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"discardGraph",(()=>{this.linkTemplates.clear();const e=this.routings;this.routings=new Map,this.delayedUpdateRoutings.dispose(),this.source.trigger("changeLinkTemplates",{source:this}),this.source.trigger("changeRoutings",{source:this,previous:e})})),this.listener.listen(this.events,"changeElementSize",(()=>{this.scheduleUpdateRoutings()})),this.listener.listen(this.events,"syncUpdate",(({layer:e})=>{e===i.LinkRoutes&&this.delayedUpdateRoutings.runSynchronously()})),this.updateRoutings()}dispose(){this.listener.stopListening(),this.delayedUpdateRoutings.dispose()}syncUpdate(){for(let e=i.FirstToUpdate;e<=i.LastToUpdate;e++)this.source.trigger("syncUpdate",{layer:e})}getElementSize(e){return this.elementSizes.get(e)}setElementSize(e,t){const n=this.elementSizes.get(e);n&&n.width===t.width&&n.height===t.height||(this.elementSizes.set(e,t),this.source.trigger("changeElementSize",{source:e,previous:n}))}getLinkLabelBounds(e){return this.linkLabelBounds.get(e)}setLinkLabelBounds(e,t){const n=this.linkLabelBounds.get(e);!n&&!t||n&&t&&n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height||(t?this.linkLabelBounds.set(e,t):this.linkLabelBounds.delete(e),this.source.trigger("changeLinkLabelBounds",{source:e,previous:n}))}getElementTemplate(e){return this.resolveElementTemplate(e)??this.shared.defaultElementTemplate}getLinkTemplates(){return this.linkTemplates}createLinkTemplate(e){const t=this.linkTemplates.get(e.id);if(t)return t;const n=this.resolveLinkTemplate(e.id)??this.shared.defaultLinkTemplate;return this.linkTemplates.set(e.id,n),this.source.trigger("changeLinkTemplates",{source:this}),n}getRoutings(){return this.routings}getRouting(e){return this.routings.get(e)}scheduleUpdateRoutings(){this.delayedUpdateRoutings.call(this.updateRoutings)}updateRoutings=()=>{const e=this.routings,t=this.linkRouter.route(this.model,this);e.forEach(((e,n)=>{const i=t.get(n);var r,o;i&&(o=i,(r=e).linkId===o.linkId&&r.labelTextAnchor===o.labelTextAnchor&&(0,s.isPolylineEqual)(r.vertices,o.vertices))&&t.set(n,e)})),this.routings=t,this.source.trigger("changeRoutings",{source:this,previous:e})}}},(e,t,n)=>{n.r(t),n.d(t,{DefaultLinkRouter:()=>r});var i=n(71);class r{gap;constructor(e=20){this.gap=e}route(e,t){const n=new Map;for(const i of e.links){if(n.has(i.id))continue;const{sourceId:r,targetId:o}=i;r&&o&&(r===o?this.routeFeedbackSiblingLinks(r,e,t,n):this.routeNormalSiblingLinks(r,o,e,t,n))}return n}routeFeedbackSiblingLinks(e,t,n,r){const a=t.getElement(e),{x:l,y:c,width:d,height:u}=(0,i.boundsOf)(a,n);let h=0;for(const i of t.getElementLinks(a)){if(r.has(i.id)||!o(i,t)||s(i))continue;const{sourceId:e,targetId:n}=i;if(e===n){const e=this.gap*(h+1),t=[{x:l-e,y:c+u/2},{x:l-e,y:c-e},{x:l+d/2,y:c-e}];r.set(i.id,{linkId:i.id,vertices:t}),h++}}}routeNormalSiblingLinks(e,t,n,r,a){const l=n.getElement(e),c=n.getElement(t),d=i.Rect.center((0,i.boundsOf)(l,r)),u=i.Rect.center((0,i.boundsOf)(c,r)),h=(d.x+u.x)/2,p=(d.y+u.y)/2,g=i.Vector.normalize({x:u.x-d.x,y:u.y-d.y}),f=n.getElementLinks(l).filter((e=>(e.sourceId===t||e.targetId===t)&&!a.has(e.id)&&!s(e)&&o(e,n)));if(f.length<=1)return;const m=f.length%2?0:1;f.forEach(((e,t)=>{const n=t+m,i=this.gap*Math.ceil(n/2)-(m?this.gap/2:0),r=n%2?{x:-g.y,y:g.x}:{x:g.y,y:-g.x},o={x:h+r.x*i,y:p+r.y*i};a.set(e.id,{linkId:e.id,vertices:[o],labelTextAnchor:this.getLabelAlignment(g,t,f.length)})}))}getLabelAlignment(e,t,n){const i=Math.atan2(e.y,e.x),r=Math.abs(i),o=i<0,s=i>0,a=n-2,l=n-1;if(!(r<1*Math.PI/8||r>7*Math.PI/8)){if(o&&t===l||s&&t===a)return"end";if(o&&t===a||s&&t===l)return"start"}return"middle"}}function o(e,t){const n=t.getLinkType(e.typeId);return!n||"hidden"!==n.visibility}function s(e){return e.vertices.length>0}},(e,t,n)=>{n.r(t),n.d(t,{LinkLabel:()=>L,LinkLayer:()=>f,LinkMarkers:()=>I,LinkPath:()=>w,LinkVertices:()=>S});var i,r=n(96),o=n(58),s=n(106),a=n.n(s),l=n(55),c=n(76),d=n(65),u=n(94),h=n(71),p=n(103),g=n(91);!function(e){e[e.Partial=1]="Partial",e[e.All=2]="All"}(i||(i={}));class f extends o.Component{listener=new l.EventObserver;delayedUpdate=new c.Debouncer;providedContext;updateState=i.Partial;scheduledToUpdate=new Set;labelMeasureRequests=new Set;delayedMeasureLabels=new c.Debouncer;memoizedLinks=new WeakMap;constructor(e){super(e),this.providedContext={scheduleLabelMeasure:this.scheduleLabelMeasure}}componentDidMount(){const{model:e,renderingState:t}=this.props,n=t=>{for(const n of e.getElementLinks(t))this.scheduleUpdateLink(n.id)};this.listener.listen(e.events,"changeLanguage",this.scheduleUpdateAll),this.listener.listen(e.events,"changeCells",(e=>{if(e.updateAll)this.scheduleUpdateAll();else if(e.changedElement&&n(e.changedElement),e.changedLinks)for(const t of e.changedLinks)this.scheduleUpdateLink(t.id)})),this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&n(e.changePosition.source)})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{const t=e.changeData||e.changeLayoutOnly||e.changeVertices||e.changeLinkState;t&&this.scheduleUpdateLink(t.source.id)})),this.listener.listen(e.events,"linkTypeEvent",(({data:t})=>{const n=t.changeLabel||t.changeVisibility;if(!n)return;const i=n.source.id;for(const r of e.links.filter((e=>e.typeId===i)))this.scheduleUpdateLink(r.id)})),this.listener.listen(t.shared.events,"changeHighlight",this.scheduleUpdateAll),this.listener.listen(t.events,"changeElementSize",(e=>{n(e.source)}));const i=(e,t)=>{e.forEach(((e,n)=>{t.get(n)!==e&&this.scheduleUpdateLink(n)}))};this.listener.listen(t.events,"changeRoutings",(({previous:e})=>{const n=t.getRoutings();i(n,e),i(e,n)})),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{switch(e){case p.RenderingLayer.Link:this.delayedUpdate.runSynchronously();break;case p.RenderingLayer.LinkLabel:this.delayedMeasureLabels.runSynchronously()}}))}shouldComponentUpdate(){return!1}componentWillUnmount(){this.listener.stopListening(),this.delayedUpdate.dispose()}scheduleUpdateAll=()=>{this.updateState!==i.All&&(this.updateState=i.All,this.scheduledToUpdate=new Set),this.delayedUpdate.call(this.performUpdate)};scheduleUpdateLink(e){this.updateState===i.Partial&&this.scheduledToUpdate.add(e),this.delayedUpdate.call(this.performUpdate)}popShouldUpdatePredicate(){const{updateState:e,scheduledToUpdate:t}=this;return this.scheduledToUpdate=new Set,this.updateState=i.Partial,e===i.All?()=>!0:e=>t.has(e.id)}scheduleLabelMeasure=(e,t)=>{if(e.owner&&t){const{renderingState:t}=this.props;this.labelMeasureRequests.delete(e),t.setLinkLabelBounds(e.owner,void 0)}else this.labelMeasureRequests.add(e),this.delayedMeasureLabels.call(this.measureLabels)};measureLabels=()=>{const{renderingState:e}=this.props,t=Array.from(this.labelMeasureRequests);this.labelMeasureRequests.clear();const n=[];for(const i of t)n.push(i.measureSize());for(let i=0;i<t.length;i++){const r=t[i],o=n[i];if(r.owner&&o){const t=r.computeBounds(o);e.setLinkLabelBounds(r.owner,t)}}this.setState((()=>{for(let e=0;e<t.length;e++){const i=t[e],r=n[e];r&&i.applySize(r)}return null}))};performUpdate=()=>{this.forceUpdate()};getLinks(){const{model:e,links:t,group:n}=this.props;if(!n)return t;const i=function(e,t){const n={};function i(t){n[t]=!0;const r=e.get(t);if(r)for(const e of r)e.group===t&&i(e.id)}return i(t),n}((0,h.computeGrouping)(e.elements),n);return t.filter((t=>{const{sourceId:n,targetId:r}=t,o=e.getElement(n),s=e.getElement(r);return!(!o||!s)&&Boolean(o.group&&i[o.group]||s.group&&i[s.group])}))}render(){const{model:e,renderingState:t}=this.props,{memoizedLinks:n}=this,i=this.popShouldUpdatePredicate(),o=this.getLinks();for(const r of o)i(r)&&n.delete(r);return(0,r.jsx)(m.Provider,{value:this.providedContext,children:(0,r.jsx)("g",{className:"reactodia-link-layer",children:o.map((i=>{let o=n.get(i);return o||(o=(0,r.jsx)(b,{link:i,model:e,renderingState:t},i.id),n.set(i,o)),o}))})})}}const m=o.createContext(null);const y="reactodia-link";function b(e){const{link:t,model:n,renderingState:i}=e,s=n.getLinkType(t.typeId),l=o.useMemo((()=>i.createLinkTemplate(s)),[s]),c=n.getElement(t.sourceId),d=n.getElement(t.targetId),{visibility:u}=s;if(!c||!d||"hidden"===u)return null;const p=i.getRouting(t.id),g=t.vertices,f=p?p.vertices:g,m=(0,h.computePolyline)((0,h.boundsOf)(c,i),(0,h.boundsOf)(d,i),f),b=(0,h.pathFromPolyline)(m),x=(0,h.computePolylineLength)(m),{highlighter:w}=i.shared,v=w&&!w(t),k=l.renderLink({link:t,linkType:s,path:b,getPathPosition:e=>(0,h.getPointAlongPolyline)(m,x*e),route:p,editableLabel:l.editableLabel});return(0,r.jsx)("g",{"data-link-id":t.id,"data-source-id":t.sourceId,"data-target-id":t.targetId,className:a()(y,v?`${y}--blurred`:void 0),children:k})}const x="reactodia-link-path";function w(e){const{linkType:t,path:n,pathProps:i}=e,o=t.index;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{...i,className:a()(x,i?.className),d:n,markerStart:`url(#${(0,u.linkMarkerKey)(o,!0)})`,markerEnd:`url(#${(0,u.linkMarkerKey)(o,!1)})`}),(0,r.jsx)("path",{className:`${x}__wrap`,d:n})]})}const v="reactodia-link-label",k="middle";class L extends o.Component{static contextType=m;text;shouldUpdateBounds=!0;constructor(e){super(e),this.state={width:0,height:0}}get owner(){const{link:e,primary:t}=this.props;return t?e:void 0}render(){const{primary:e,position:{x:t,y:n},line:i=0,className:o,textAnchor:s=k,rectClass:l,rectStyle:c,textClass:d,textStyle:u,title:h,content:p,children:g}=this.props,{width:f,height:m}=this.state,{x:y,y:b}=this.computeBounds({width:f,height:m}),x=0===i?void 0:`translate(0, ${i*(m+2)}px)`;return(0,r.jsxs)("g",{style:x?{transform:x}:void 0,className:a()(v,e?`${v}--primary`:void 0,o),children:[h?(0,r.jsx)("title",{children:h}):void 0,(0,r.jsx)("rect",{x:y,y:b,width:f,height:m,className:l,style:c}),(0,r.jsx)("text",{ref:this.onTextMount,x:t,y:n,dy:"0.6ex",textAnchor:s,className:d,style:u,children:p}),g]})}measureSize(){if(!this.text)return;const{width:e,height:t}=this.text.getBBox();return{width:e,height:t}}applySize({width:e,height:t}){e===this.state.width&&t===this.state.height||this.setState({width:e,height:t})}computeBounds({width:e,height:t}){const{position:{x:n,y:i},textAnchor:r=k}=this.props;let o=0;return"middle"===r?o=-e/2:"end"===r&&(o=-e),{x:n+o,y:i-t/2,width:e,height:t}}onTextMount=e=>{this.text=e};componentDidMount(){this.tryRecomputeBounds(this.props)}componentWillUnmount(){const{scheduleLabelMeasure:e}=this.context;e(this,!0)}UNSAFE_componentWillReceiveProps(e){this.shouldUpdateBounds=!0}componentDidUpdate(e){this.tryRecomputeBounds(this.props)}tryRecomputeBounds(e){if(this.text&&this.shouldUpdateBounds){this.shouldUpdateBounds=!1;const{scheduleLabelMeasure:e}=this.context;e(this,!1)}}}const _="reactodia-link-vertices";function S(e){const{linkId:t,vertices:n,className:i,vertexRadius:o=10,fill:s}=e,{model:l}=(0,g.useCanvas)();if(0===n.length)return null;const c=a()(`${_}__vertex`,i),h=e=>{const n=l.getLink(t);if(!n)return;const i=new u.LinkVertex(n,e);l.history.registerToUndo((0,d.restoreCapturedLinkGeometry)(i.link)),i.remove()},p=[];for(let a=0;a<n.length;a++){const{x:e,y:t}=n[a],i=p.length;p.push((0,r.jsx)("circle",{"data-vertex":a,className:c,cx:e,cy:t,r:o,fill:s},i)),p.push((0,r.jsx)(M,{vertexIndex:a,vertexRadius:o,x:e,y:t,onRemove:h},i+1))}return(0,r.jsx)("g",{className:_,children:p})}class M extends o.Component{render(){const{vertexRadius:e,x:t,y:n}=this.props,i=`translate(${t+2*e},${n-2*e})scale(${e})`;return(0,r.jsxs)("g",{className:`${_}__handle`,transform:i,onPointerDown:this.onRemoveVertex,children:[(0,r.jsx)("title",{children:"Remove vertex"}),(0,r.jsx)("circle",{r:1}),(0,r.jsx)("path",{d:"M-0.5,-0.5 L0.5,0.5 M0.5,-0.5 L-0.5,0.5",strokeWidth:2/e})]})}onRemoveVertex=e=>{if(0!==e.button)return;e.preventDefault(),e.stopPropagation();const{onRemove:t,vertexIndex:n}=this.props;t(n)}}class I extends o.Component{listener=new l.EventObserver;delayedUpdate=new c.Debouncer;render(){const{model:e,renderingState:t}=this.props,n=t.shared.defaultLinkTemplate,i=[];for(const[o,s]of t.getLinkTemplates()){const t=e.getLinkType(o);if(!t)continue;const a=t.index;s.markerSource&&i.push((0,r.jsx)(T,{linkTypeIndex:a,isStartMarker:!0,style:s.markerSource,defaultStyle:n.markerSource},2*a)),s.markerTarget&&i.push((0,r.jsx)(T,{linkTypeIndex:a,isStartMarker:!1,style:s.markerTarget,defaultStyle:n.markerTarget},2*a+1))}return(0,r.jsx)("defs",{children:i})}componentDidMount(){const{renderingState:e}=this.props;this.listener.listen(e.events,"syncUpdate",(({layer:e})=>{e===p.RenderingLayer.Link&&this.delayedUpdate.runSynchronously()})),this.listener.listen(e.events,"changeLinkTemplates",(()=>{this.delayedUpdate.call((()=>this.forceUpdate()))}))}shouldComponentUpdate(){return!1}componentWillUnmount(){this.listener.stopListening(),this.delayedUpdate.dispose()}}class T extends o.Component{render(){return(0,r.jsx)("marker",{ref:this.onMarkerMount})}shouldComponentUpdate(){return!1}onMarkerMount=e=>{if(!e)return;const{linkTypeIndex:t,isStartMarker:n,style:i,defaultStyle:r}=this.props,{d:o=r?.d,width:s=r?.width,height:a=r?.height}=i;if(void 0===o||void 0===s||void 0===a)return;e.setAttribute("id",(0,u.linkMarkerKey)(t,n)),e.setAttribute("markerWidth",String(s)),e.setAttribute("markerHeight",String(a)),e.setAttribute("orient","auto");const l=n?0:s-1;e.setAttribute("refX",String(l)),e.setAttribute("refY",String(a/2)),e.setAttribute("markerUnits","userSpaceOnUse");const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",o),void 0!==i.fill&&c.setAttribute("fill",i.fill),void 0!==i.stroke&&c.setAttribute("stroke",i.stroke),void 0!==i.strokeWidth&&c.setAttribute("stroke-width",i.strokeWidth),e.appendChild(c)}}},(e,t)=>{var n;!function(){var i={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)i.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},(e,t,n)=>{n.r(t),n.d(t,{HtmlSpinner:()=>s,Spinner:()=>o});var i=n(96);const r="reactodia-spinner";function o(e){const{position:t={x:0,y:0},size:n=50,statusText:o,errorOccurred:s}=e,a="m3.47,-19.7 a20,20 0 1,1 -6.95,0 m0,0 l-6,5 m6,-5 l-8,-0"+(s?"M-8,-8L8,8M-8,8L8,-8":"");return(0,i.jsxs)("g",{className:r,"data-error":s,transform:`translate(${t.x},${t.y})`,children:[(0,i.jsx)("g",{className:`${r}__arrow`,children:(0,i.jsx)("path",{d:a,transform:`scale(0.02)scale(${n})`,fill:"none",stroke:s?"red":"black",strokeWidth:"3",strokeLinecap:"round"})}),(0,i.jsx)("text",{style:{dominantBaseline:"middle"},x:n/2+5,children:o})]})}function s(e){const{width:t,height:n}=e,r=Math.min(t,n);return(0,i.jsx)("svg",{width:t,height:n,children:(0,i.jsx)(o,{size:r,position:{x:t/2,y:n/2}})})}},(e,t,n)=>{n.r(t),n.d(t,{AsyncModel:()=>u,requestElementData:()=>h,restoreLinksBetweenElements:()=>p});var i=n(52),r=n(109),o=n(80),s=n(94),a=n(72),l=n(110),c=n(112),d=n(113);class u extends l.DiagramModel{groupByProperties;loadingScope;_dataProvider;fetcher;linkSettings=new Map;constructor(e){super(e);const{groupBy:t}=e;this.groupByProperties=t,this._dataProvider=new r.EmptyDataProvider,this.fetcher=new c.DataFetcher(this.graph,this._dataProvider)}get asyncSource(){return this.source}get dataProvider(){return this._dataProvider}getTermFactory(){return this._dataProvider.factory}get operations(){return this.fetcher.operations}resetGraph(){super.resetGraph(),this.loadingScope?.abort(),this.fetcher.dispose(),this.linkSettings.clear()}subscribeGraph(){super.subscribeGraph(),this.graphListener.listen(this.events,"elementEvent",(e=>{e.data.requestedGroupContent&&this.loadGroupContent(e.data.requestedGroupContent.source).catch((e=>{if(!this.fetcher.signal.aborted)throw new Error("Error loading group content",{cause:e})}))}))}setDataProvider(e){this._dataProvider=e,this.fetcher=new c.DataFetcher(this.graph,e),this.graphListener.listen(this.fetcher.events,"changeOperations",(e=>{this.asyncSource.trigger("changeOperations",e)}))}async createNewDiagram(e){const{dataProvider:t,signal:n}=e;return this.importLayout({dataProvider:t,signal:n})}async importLayout(e){const{dataProvider:t,diagram:n=(0,d.emptyDiagram)(),preloadedElements:r,validateLinks:o=!1,hideUnusedLinkTypes:s=!1,signal:a}=e;this.resetGraph(),this.setDataProvider(t),this.loadingScope=new i.AbortScope(a),this.asyncSource.trigger("loadingStart",{source:this});const l=this.loadingScope.signal;try{const t=await this.dataProvider.knownLinkTypes({signal:l});this.initLinkTypes(t),l.throwIfAborted(),this.setLinkSettings(n.linkTypeOptions??[]),this.createGraphElements({layoutData:n.layoutData,preloadedElements:r,markLinksAsLayoutOnly:o}),s&&this.hideUnusedLinkTypes(),this.subscribeGraph();const i=this.graph.getElements().filter((e=>!(r&&r.has(e.iri)))).map((e=>e.iri)),a=this.requestElementData(i),c=e.validateLinks?this.requestLinksOfType():Promise.resolve();await Promise.all([a,c]),this.history.reset(),this.asyncSource.trigger("loadingSuccess",{source:this})}catch(c){throw this.asyncSource.trigger("loadingError",{source:this,error:c}),new Error("Reactodia: failed to import a layout",{cause:c})}finally{this.loadingScope?.abort(),this.loadingScope=void 0}}discardLayout(){this.linkSettings.clear(),this.resetGraph(),this.setDataProvider(new r.EmptyDataProvider),this.asyncSource.trigger("loadingStart",{source:this}),this.subscribeGraph(),this.history.reset(),this.asyncSource.trigger("loadingSuccess",{source:this})}exportLayout(){const e=(0,d.makeSerializedLayout)(this.graph.getElements(),this.graph.getLinks()),t=this.graph.getLinkTypes().filter((e=>"visible"!==e.visibility&&e.id!==o.PLACEHOLDER_LINK_TYPE)).map((({id:e,visibility:t})=>({"@type":"LinkTypeOptions",property:e,visible:"hidden"!==t,showLabel:"visible"===t})));return(0,d.makeSerializedDiagram)({layoutData:e,linkTypeOptions:t})}initLinkTypes(e){const t=[];for(const{id:n,label:i}of e){const e=new s.LinkType({id:n,label:i});this.graph.addLinkType(e),t.push(e)}return t}setLinkSettings(e){for(const t of e){const{visible:e=!0,showLabel:n=!0}=t,i=t.property,r=e&&n?"visible":e&&!n?"withoutLabel":"hidden";this.linkSettings.set(i,r);const o=this.getLinkType(i);o&&o.setVisibility(r)}}createGraphElements(e){const{layoutData:t=(0,d.emptyLayoutData)(),preloadedElements:n,markLinksAsLayoutOnly:i}=e,r=[],o=new Set,a=this.history.startBatch("Import layout");for(const l of t.elements){const{"@id":e,iri:t,position:i,isExpanded:o,group:a,elementState:c}=l,d=n?.get(t),u=d??s.Element.placeholderData(t),h=new s.Element({id:e,data:u,position:i,expanded:o,group:a,elementState:c});this.graph.addElement(h),d||r.push(h.iri)}for(const l of t.links){const{"@id":e,property:t,source:n,target:r,vertices:a,linkState:c}=l,d=this.createLinkType(t);o.add(d.id);const u=this.graph.getElement(n["@id"]),h=this.graph.getElement(r["@id"]);if(u&&h){const n={linkTypeId:t,sourceId:u.iri,targetId:h.iri,properties:{}},r=new s.Link({id:e,sourceId:u.id,targetId:h.id,data:n,vertices:a,linkState:c});r.setLayoutOnly(i),this.addLink(r)}}a.store()}hideUnusedLinkTypes(){const e=new Set;for(const t of this.graph.getLinks())e.add(t.typeId);for(const t of this.graph.getLinkTypes())e.has(t.id)||t.setVisibility("hidden")}requestElementData(e){return this.fetcher.fetchElementData(e)}requestLinksOfType(e){const t=this.graph.getElements().map((e=>e.iri));return 0===t.length?Promise.resolve():this.fetcher.fetchLinks(t,e).then((e=>this.onLinkInfoLoaded(e)))}createElementType(e){const t=super.getElementType(e);if(t)return t;const n=super.createElementType(e);return this.fetcher.fetchElementType(n),n}createLinkType(e){if(this.graph.getLinkType(e))return super.createLinkType(e);const t=super.createLinkType(e),n=this.linkSettings.get(t.id);return n&&t.setVisibility(n),this.fetcher.fetchLinkType(t),t}createPropertyType(e){if(this.graph.getPropertyType(e))return super.createPropertyType(e);const t=super.createPropertyType(e);return this.fetcher.fetchPropertyType(t),t}onLinkInfoLoaded(e){let t;const n=()=>{t=!1},i=this.history.startBatch("Create loaded links");for(const r of e)this.createLinkType(r.linkTypeId),t=!0,this.asyncSource.trigger("createLoadedLink",{source:this,model:r,cancel:n}),t&&this.createLinks(r);i.discard()}createLinks(e){const t=this.graph.getElements().filter((t=>t.iri===e.sourceId)),n=this.graph.getElements().filter((t=>t.iri===e.targetId)),i=this.history.startBatch("Create links");for(const r of t)for(const t of n)this.createLink(new s.Link({sourceId:r.id,targetId:t.id,data:e}));i.store()}async loadGroupContent(e){const t=await this.loadEmbeddedElements(e.iri),n=this.history.startBatch();for(const i of t.values())this.createElement(i,e.id);n.discard(),await Promise.all([this.requestElementData(Array.from(t.keys())),this.requestLinksOfType()]),this.fetcher.signal.throwIfAborted(),this._triggerChangeGroupContent(e.id,{layoutComplete:!1})}async loadEmbeddedElements(e){const t=this.groupByProperties.map((t=>this.dataProvider.lookup({refElementId:e,refElementLinkId:t.linkType,linkDirection:t.linkDirection,signal:this.fetcher.signal}))),n=await Promise.all(t),i=new Map;for(const r of n)for(const{element:e}of r)i.set(e.id,e);return i}}function h(e,t){return a.Command.effect("Fetch element data",(()=>{e.requestElementData(t)}))}function p(e){return a.Command.effect("Restore links between elements",(()=>{e.requestLinksOfType()}))}},(e,t,n)=>{n.r(t),n.d(t,{EmptyDataProvider:()=>r});var i=n(68);class r{get factory(){return i.DefaultDataFactory}knownElementTypes(e){return Promise.resolve({elementTypes:[],subtypeOf:[]})}knownLinkTypes(e){return Promise.resolve([])}elementTypes(e){return Promise.resolve(new Map)}propertyTypes(e){return Promise.resolve(new Map)}linkTypes(e){return Promise.resolve(new Map)}elements(e){return Promise.resolve(new Map)}links(e){return Promise.resolve([])}connectedLinkStats(e){return Promise.resolve([])}lookup(e){return Promise.resolve([])}}},(e,t,n)=>{n.r(t),n.d(t,{DiagramModel:()=>c});var i=n(55),r=n(66),o=n(68),s=n(67),a=n(94),l=n(111);class c{source=new i.EventSource;events=this.source;_language="en";graph=new l.Graph;graphListener=new i.EventObserver;history;locale;constructor(e){const{history:t,selectLabelLanguage:n=f}=e;this.history=t,this.locale=new g(this,n)}get language(){return this._language}setLanguage(e){if(!e)throw new Error("Cannot set empty language.");const t=this._language;t!==e&&(this._language=e,this.source.trigger("changeLanguage",{source:this,previous:t}))}get factory(){return this.getTermFactory()}get elements(){return this.graph.getElements()}get links(){return this.graph.getLinks()}getTermFactory(){return o.DefaultDataFactory}getElement(e){return this.graph.getElement(e)}getElementLinks(e){return this.graph.getElementLinks(e)}getLink(e){return this.graph.getLink(e)}findLink(e,t,n){return this.graph.findLink(e,t,n)}sourceOf(e){return this.getElement(e.sourceId)}targetOf(e){return this.getElement(e.targetId)}resetGraph(){this.graphListener&&(this.graphListener.stopListening(),this.graphListener=new i.EventObserver),this.graph=new l.Graph,this.source.trigger("discardGraph",{source:this})}subscribeGraph(){this.graphListener.listen(this.graph.events,"changeCells",(e=>{this.source.trigger("changeCells",e)})),this.graphListener.listen(this.graph.events,"elementEvent",(e=>{this.source.trigger("elementEvent",e)})),this.graphListener.listen(this.graph.events,"linkEvent",(e=>{this.source.trigger("linkEvent",e)})),this.graphListener.listen(this.graph.events,"elementTypeEvent",(e=>{this.source.trigger("elementTypeEvent",e)})),this.graphListener.listen(this.graph.events,"linkTypeEvent",(e=>{this.source.trigger("linkTypeEvent",e)})),this.graphListener.listen(this.graph.events,"propertyTypeEvent",(e=>{this.source.trigger("propertyTypeEvent",e)})),this.source.trigger("changeCells",{updateAll:!0})}reorderElements(e){this.graph.reorderElements(e),this.source.trigger("changeCellOrder",{source:this})}createElement(e,t){const n="string"==typeof e?e:e.id,i=this.elements.filter((e=>e.iri===n&&e.group===t));if(i.length>0)return i[0];let r="string"==typeof e?a.Element.placeholderData(n):e;r={...r,id:r.id};const o=new a.Element({data:r,group:t});return this.addElement(o),o}addElement(e){this.history.execute(new d(this.graph,e,[]))}removeElement(e){const t=this.getElement(e);t&&this.history.execute(new u(this.graph,t))}createLink(e){const{typeId:t,sourceId:n,targetId:i,data:r}=e,o=this.findLink(t,n,i);return o?(e.data&&(o.setLayoutOnly(!1),o.setData(r)),o):(this.addLink(e),e)}addLink(e){if(e.data.linkTypeId!==e.typeId)throw new Error("link.data.linkTypeId must match link.typeId");this.createLinkType(e.typeId),this.history.execute(new h(this.graph,e))}removeLink(e){const t=this.graph.getLink(e);t&&this.history.execute(new p(this.graph,t))}getElementType(e){return this.graph.getElementType(e)}createElementType(e){const t=this.graph.getElementType(e);if(t)return t;const n=new a.ElementType({id:e});return this.addElementType(n),n}addElementType(e){this.graph.addElementType(e)}getLinkType(e){return this.graph.getLinkType(e)}createLinkType(e){const t=this.graph.getLinkType(e);if(t)return t;const n=new a.LinkType({id:e});return this.graph.addLinkType(n),n}getPropertyType(e){return this.graph.getPropertyType(e)}createPropertyType(e){const t=this.graph.getPropertyType(e);if(t)return t;const n=new a.PropertyType({id:e});return this.graph.addPropertyType(n),n}_triggerChangeGroupContent(e,t){const{layoutComplete:n}=t;this.source.trigger("changeGroupContent",{group:e,layoutComplete:n})}}class d{graph;element;connectedLinks;constructor(e,t,n){this.graph=e,this.element=t,this.connectedLinks=n}get title(){return"Add element"}invoke(){const{graph:e,element:t,connectedLinks:n}=this;e.addElement(t);for(const i of n){e.getLink(i.id)||e.findLink(i.typeId,i.sourceId,i.targetId)||e.addLink(i)}return new u(e,t)}}class u{graph;element;constructor(e,t){this.graph=e,this.element=t}get title(){return"Remove element"}invoke(){const{graph:e,element:t}=this,n=[...e.getElementLinks(t)];return e.removeElement(t.id),new d(e,t,n)}}class h{graph;link;constructor(e,t){this.graph=e,this.link=t}get title(){return"Add link"}invoke(){const{graph:e,link:t}=this;return e.addLink(t),new p(e,t)}}class p{graph;link;constructor(e,t){this.graph=e,this.link=t}get title(){return"Remove link"}invoke(){const{graph:e,link:t}=this;return e.removeLink(t.id),new h(e,t)}}class g{model;selectLabelLanguage;constructor(e,t){this.model=e,this.selectLabelLanguage=t}selectLabel(e,t){const n=t??this.model.language,{selectLabelLanguage:i}=this;return i(e,n)}formatLabel(e,t,n){return function(e,t){if(e)return e.value;return(0,s.getUriLocalName)(t)||t}(this.selectLabel(e,n),t)}formatIri(e){return(0,r.isEncodedBlank)(e)?"(blank node)":`<${e}>`}formatElementTypes(e,t){return e.map((e=>{const n=this.model.createElementType(e);return this.formatLabel(n.label,n.id,t)})).sort()}formatPropertyList(e,t){const n=t??this.model.language,i=Object.keys(e).map((t=>{const i=this.model.createPropertyType(t),r=this.formatLabel(i.label,t),o=e[t],s=o.filter((e=>"NamedNode"===e.termType||""===e.language||e.language===n));return{propertyId:t,label:r,values:0===s.length?o:s}}));return i.sort(((e,t)=>e.label.localeCompare(t.label))),i}}function f(e,t){if(0===e.length)return;let n,i;for(const r of e){if(r.language===t)return r;""===r.language?n=r:"en"===r.language&&(i=r)}return void 0!==n?n:void 0!==i?i:e[0]}},(e,t,n)=>{n.r(t),n.d(t,{Graph:()=>o});var i=n(54),r=n(55);class o{source=new r.EventSource;events=this.source;elements=new i.OrderedMap;links=new i.OrderedMap;elementLinks=new WeakMap;classesById=new Map;propertiesById=new Map;linkTypes=new Map;static nextLinkTypeIndex=0;getElements(){return this.elements.items}getLinks(){return this.links.items}getLink(e){return this.links.get(e)}getElementLinks(e){return this.elementLinks.get(e)??[]}findLink(e,t,n){const i=this.getElement(t);if(!i)return;const r=this.elementLinks.get(i);if(r){const i=a(r,e,t,n);return i>=0?r[i]:void 0}}sourceOf(e){return this.getElement(e.sourceId)}targetOf(e){return this.getElement(e.targetId)}reorderElements(e){this.elements.reorder(e)}getElement(e){return this.elements.get(e)}addElement(e){if(this.getElement(e.id))throw new Error(`Element '${e.id}' already exists.`);e.events.onAny(this.onElementEvent),this.elements.push(e.id,e),this.source.trigger("changeCells",{updateAll:!1,changedElement:e})}onElementEvent=e=>{this.source.trigger("elementEvent",{data:e})};removeElement(e){const t=this.elements.get(e);if(t){const n={silent:!0},i=[...this.getElementLinks(t)];for(const e of i)this.removeLink(e.id,n);this.elements.delete(e),t.events.offAny(this.onElementEvent),this.source.trigger("changeCells",{updateAll:!1,changedElement:t,changedLinks:i})}}addLink(e){if(this.getLink(e.id))throw new Error(`Link already exists: ${e.id}`);if(!this.getLinkType(e.typeId))throw new Error(`Link type not found: ${e.typeId}`);this.registerLink(e)}registerLink(e){const t=this.sourceOf(e);if(!t)throw new Error(`Link source not found: ${e.sourceId}`);const n=this.targetOf(e);if(!n)throw new Error(`Link target not found: ${e.targetId}`);let i=this.elementLinks.get(t);if(i||(i=[],this.elementLinks.set(t,i)),i.push(e),e.sourceId!==e.targetId){let t=this.elementLinks.get(n);t||(t=[],this.elementLinks.set(n,t)),t.push(e)}e.events.onAny(this.onLinkEvent),this.links.push(e.id,e),this.source.trigger("changeCells",{updateAll:!1,changedLinks:[e]})}onLinkEvent=e=>{this.source.trigger("linkEvent",{data:e})};removeLink(e,t){const n=this.links.delete(e);if(n){const{typeId:e,sourceId:i,targetId:r}=n;n.events.offAny(this.onLinkEvent),this.removeLinkReferences(e,i,r),t&&t.silent||this.source.trigger("changeCells",{updateAll:!1,changedLinks:[n]})}}removeLinkReferences(e,t,n){const i=this.getElement(t);if(i){const r=this.elementLinks.get(i);r&&(s(r,e,t,n),0===r.length&&this.elementLinks.delete(i))}const r=this.getElement(n);if(r){const i=this.elementLinks.get(r);i&&(s(i,e,t,n),0===i.length&&this.elementLinks.delete(r))}}getLinkTypes(){const e=[];return this.linkTypes.forEach((t=>e.push(t))),e}getLinkType(e){return this.linkTypes.get(e)}addLinkType(e){if(this.getLinkType(e.id))throw new Error(`Link type already exists: ${e.id}`);e.setIndex(o.nextLinkTypeIndex++),e.events.onAny(this.onLinkTypeEvent),this.linkTypes.set(e.id,e)}onLinkTypeEvent=e=>{this.source.trigger("linkTypeEvent",{data:e})};getPropertyType(e){return this.propertiesById.get(e)}addPropertyType(e){if(this.getPropertyType(e.id))throw new Error(`Property type already exists: ${e.id}`);e.events.onAny(this.onPropertyTypeEvent),this.propertiesById.set(e.id,e)}onPropertyTypeEvent=e=>{this.source.trigger("propertyTypeEvent",{data:e})};getElementType(e){return this.classesById.get(e)}getElementTypes(){const e=[];return this.classesById.forEach((t=>e.push(t))),e}addElementType(e){if(this.getElementType(e.id))throw new Error(`Element type already exists: ${e.id}`);e.events.onAny(this.onElementTypeEvent),this.classesById.set(e.id,e)}onElementTypeEvent=e=>{this.source.trigger("elementTypeEvent",{data:e})}}function s(e,t,n,i){if(e)for(;;){const r=a(e,t,n,i);if(r<0)break;e.splice(r,1)}}function a(e,t,n,i){for(let r=0;r<e.length;r++){const o=e[r];if(o.sourceId===n&&o.targetId===i&&o.typeId===t)return r}return-1}},(e,t,n)=>{n.r(t),n.d(t,{DataFetcher:()=>o});var i=n(55),r=n(76);class o{graph;dataProvider;source=new i.EventSource;events=this.source;cancellation=new AbortController;_operations=[];classQueue=new r.BufferingQueue((e=>{const t={type:"elementType",targets:new Set(e)},n=this.dataProvider.elementTypes({classIds:e,signal:this.signal}).then(this.onElementTypesLoaded);this.addOperation(t,n)}));linkTypeQueue=new r.BufferingQueue((e=>{const t={type:"linkType",targets:new Set(e)},n=this.dataProvider.linkTypes({linkTypeIds:e,signal:this.signal}).then(this.onLinkTypesLoaded);this.addOperation(t,n)}));propertyTypeQueue=new r.BufferingQueue((e=>{const t={type:"propertyType",targets:new Set(e)},n=this.dataProvider.propertyTypes({propertyIds:e,signal:this.signal}).then(this.onPropertyTypesLoaded);this.addOperation(t,n)}));constructor(e,t){this.graph=e,this.dataProvider=t}get signal(){return this.cancellation.signal}dispose(){this.cancellation.abort()}get operations(){return this._operations}addOperation(e,t){const n=this._operations,i=[...n,e];t.then((()=>this.onOperationComplete(e)),(t=>this.onOperationComplete(e,t))),this._operations=i,this.source.trigger("changeOperations",{previous:n})}onOperationComplete(e,t){const n=this._operations,i=n.indexOf(e);if(i>=0){const e=[...n];e.splice(i,1),this._operations=e}(this._operations!==n||t)&&this.source.trigger("changeOperations",{previous:n,fail:t?{operation:e,error:t}:void 0})}fetchElementData(e){if(0===e.length)return Promise.resolve();const t={type:"element",targets:new Set(e)},n=this.dataProvider.elements({elementIds:[...e],signal:this.signal}).then(this.onElementInfoLoaded);return this.addOperation(t,n),n}onElementInfoLoaded=e=>{for(const t of this.graph.getElements()){const n=e.get(t.iri);n&&t.setData(n)}};fetchLinks(e,t){const n=this.dataProvider.links({elementIds:e,linkTypeIds:t});return this.addOperation({type:"link"},n),n}fetchElementType(e){this.classQueue.push(e.id)}onElementTypesLoaded=e=>{for(const{id:t,label:n,count:i}of e.values()){const e=this.graph.getElementType(t);e&&(e.setLabel(n),"number"==typeof i&&e.setCount(i))}};fetchLinkType(e){this.linkTypeQueue.push(e.id)}onLinkTypesLoaded=e=>{for(const{id:t,label:n}of e.values()){const e=this.graph.getLinkType(t);e&&e.setLabel(n)}};fetchPropertyType(e){this.propertyTypeQueue.push(e.id)}onPropertyTypesLoaded=e=>{for(const{id:t,label:n}of e.values()){const e=this.graph.getPropertyType(t);e&&e.setLabel(n)}}}},(e,t,n)=>{n.r(t),n.d(t,{emptyDiagram:()=>r,emptyLayoutData:()=>o,makeSerializedDiagram:()=>s,makeSerializedLayout:()=>a});var i=n(80);function r(){return{"@context":i.DIAGRAM_CONTEXT_URL_V1,"@type":"Diagram",layoutData:{"@type":"Layout",elements:[],links:[]},linkTypeOptions:[]}}function o(){return{"@type":"Layout",elements:[],links:[]}}function s(e){const t={...r(),linkTypeOptions:e.linkTypeOptions};return e.layoutData&&(t.layoutData=e.layoutData),t}function a(e,t){return{"@type":"Layout",elements:e.map((e=>({"@type":"Element","@id":e.id,iri:e.iri,position:e.position,isExpanded:e.isExpanded,group:e.group,elementState:e.elementState}))),links:t.map((e=>({"@type":"Link","@id":e.id,property:e.typeId,source:{"@id":e.sourceId},target:{"@id":e.targetId},vertices:[...e.vertices],linkState:e.linkState})))}}},(e,t,n)=>{n.r(t),n.d(t,{useAuthoredEntity:()=>l});var i,r=n(58),o=n(52),s=n(57),a=n(115);function l(e,t,n){const{model:l,editor:c,overlay:d}=(0,a.useWorkspace)(),[u,h]=r.useState(),p=(0,s.useObservedProperty)(c.events,"changeAuthoringState",(()=>c.authoringState)).elements.get(t.id);return r.useEffect((()=>{const e=new AbortController;return n&&(!c.metadataApi||p&&p.deleted?h(i.None):(0,o.mapAbortedToNull)(Promise.all([c.metadataApi.canEditElement(t,e.signal),c.metadataApi.canDeleteElement(t,e.signal)]),e.signal).then((e=>{if(null===e)return;const[t,n]=e;h((t?i.Edit:i.None)|(n?i.Delete:i.None))}))),()=>e.abort()}),[t,p,n]),{editedIri:p?p.newIri:void 0,canEdit:void 0===u?void 0:Boolean(u&i.Edit),canDelete:void 0===u?void 0:Boolean(u&i.Delete),onEdit:()=>{const t=l.getElement(e);t&&d.showEditEntityForm(t)},onDelete:()=>{c.deleteEntity(t.id)}}}!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Delete=2]="Delete",e[e.All=3]="All"}(i||(i={}))},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceContext:()=>o,WorkspaceEventKey:()=>i,useWorkspace:()=>s});var i,r=n(58);!function(e){e.searchUpdateCriteria="search:updateCriteria",e.searchQueryItem="search:queryItems",e.connectionsLoadLinks="connections:loadLinks",e.connectionsExpandLink="connections:expandLink",e.connectionsLoadElements="connections:loadElements",e.editorChangeSelection="editor:changeSelection",e.editorToggleDialog="editor:toggleDialog",e.editorAddElements="editor:addElements"}(i||(i={}));const o=r.createContext(null);function s(){const e=r.useContext(o);if(!e)throw new Error("Missing Reactodia workspace context");return e}},(e,t,n)=>{n.r(t),n.d(t,{AuthoringKind:()=>i,AuthoringState:()=>r,TemporaryState:()=>o,isLinkConnectedToElement:()=>l});var i,r,o,s=n(56),a=n(66);function l(e,t){return e.sourceId===t||e.targetId===t}!function(e){e.ChangeElement="changeElement",e.ChangeLink="changeLink"}(i||(i={})),function(e){function t(e){return{elements:new Map(e.elements),links:e.links.clone()}}function n(e,t){return t.type===i.ChangeElement?e.elements.get(t.after.id)===t:e.links.get(t.after)===t}function r(e,t){const n=e.elements.get(t);return Boolean(n&&n.type===i.ChangeElement&&!n.before)}function o(e,t){const n=e.elements.get(t);return Boolean(n&&n.deleted)}function c(e,t){const n=e.elements.get(t);return Boolean(n&&n.type===i.ChangeElement&&n.before&&n.newIri)}function d(e,t){const n=e.links.get(t);return Boolean(n&&!n.before)}function u(e,t){const n=e.links.get(t);return n&&n.deleted||o(e,t.sourceId)||o(e,t.targetId)}e.empty={elements:new Map,links:new s.HashMap(a.hashLink,a.equalLinks)},e.isEmpty=function(e){return 0===e.elements.size&&0===e.links.size},e.clone=t,e.has=n,e.discard=function(e,r){if(!n(e,r))return e;const o=t(e);return r.type===i.ChangeElement?(o.elements.delete(r.after.id),r.before||e.links.forEach((e=>{l(e.after,r.after.id)&&o.links.delete(e.after)}))):o.links.delete(r.after),o},e.addElement=function(e,n){const r={type:i.ChangeElement,after:n,deleted:!1},o=t(e);return o.elements.set(r.after.id,r),o},e.addLink=function(e,n){const r={type:i.ChangeLink,after:n,deleted:!1},o=t(e);return o.links.set(r.after,r),o},e.changeElement=function(e,n,r){const o=t(e);o.elements.delete(n.id);const s=e.elements.get(n.id);if(s&&!s.before)o.elements.set(r.id,{type:i.ChangeElement,after:r,deleted:!1}),n.id!==r.id&&e.links.forEach((e=>{if(!e.before&&l(e.after,n.id)){const l=(t=e.after,s=n.id,a=r.id,{...t,sourceId:t.sourceId===s?a:t.sourceId,targetId:t.targetId===s?a:t.targetId});o.links.delete(e.after),o.links.set(l,{type:i.ChangeLink,after:l,deleted:!1})}var t,s,a}));else{const e=r.id!==n.id,t=s?s.before:void 0;o.elements.set(n.id,{type:i.ChangeElement,before:t||n,after:e?{...r,id:n.id}:r,newIri:e?r.id:void 0,deleted:!1})}return o},e.changeLink=function(e,n,r){if(!(0,a.equalLinks)(n,r))throw new Error("Cannot move link to another element or change its type");const o=t(e),s=e.links.get(n);return o.links.set(n,{type:i.ChangeLink,before:s?s.before:void 0,after:r,deleted:!1}),o},e.deleteElement=function(e,n){const o=t(e);return o.elements.delete(n.id),e.links.forEach((e=>{l(e.after,n.id)&&o.links.delete(e.after)})),r(e,n.id)||o.elements.set(n.id,{type:i.ChangeElement,before:n,after:n,deleted:!0}),o},e.deleteLink=function(e,n){const r=t(e);return r.links.delete(n),d(e,n)||r.links.set(n,{type:i.ChangeLink,before:n,after:n,deleted:!0}),r},e.deleteNewLinksConnectedToElements=function(e,n){const i=t(e);return e.links.forEach((e=>{if(!e.before){const t=e.after;(n.has(t.sourceId)||n.has(t.targetId))&&i.links.delete(t)}})),i},e.isNewElement=r,e.isDeletedElement=o,e.isElementWithModifiedIri=c,e.isNewLink=d,e.isDeletedLink=u,e.isUncertainLink=function(e,t){return!u(e,t)&&(c(e,t.sourceId)||c(e,t.targetId))}}(r||(r={})),function(e){e.empty={elements:new Set,links:new s.HashSet(a.hashLink,a.equalLinks)},e.addElement=function(e,t){if(e.elements.has(t.id))return e;const n=new Set(e.elements);return n.add(t.id),{...e,elements:n}},e.deleteElement=function(e,t){if(!e.elements.has(t.id))return e;const n=new Set(e.elements);return n.delete(t.id),{...e,elements:n}},e.addLink=function(e,t){if(e.links.has(t))return e;const n=e.links.clone();return n.add(t),{...e,links:n}},e.deleteLink=function(e,t){if(!e.links.has(t))return e;const n=e.links.clone();return n.delete(t),{...e,links:n}}}(o||(o={}))},(e,t,n)=>{n.r(t),n.d(t,{EditorController:()=>u});var i=n(54),r=n(55),o=n(66),s=n(65),a=n(94),l=n(72),c=n(116),d=n(118);class u{listener=new r.EventObserver;source=new r.EventSource;events=this.source;model;options;_metadataApi;_authoringState=c.AuthoringState.empty;_validationState=d.ValidationState.empty;_temporaryState=c.TemporaryState.empty;_selection=[];cancellation=new AbortController;constructor(e){const{model:t,...n}=e;this.model=t,this.options=n,this.listener.listen(this.model.events,"changeCells",this.onCellsChanged),this.listener.listen(this.events,"changeValidationState",(e=>{for(const t of this.model.elements){const n=e.previous.elements.get(t.iri);this.validationState.elements.get(t.iri)!==n&&t.redraw()}})),this.listener.listen(this.events,"changeAuthoringState",(e=>{if(this.options.validationApi){const t=(0,d.changedElementsToValidate)(e.previous,this.authoringState,this.model);(0,d.validateElements)(t,this.options.validationApi,this.model,this,this.cancellation.signal)}})),this.listener.listen(this.events,"changeSelection",(()=>{const e=this.selection.filter((e=>e instanceof a.Element));this.bringElements(e,"front")})),document.addEventListener("keyup",this.onKeyUp),this.cancellation.signal.addEventListener("abort",(()=>{document.removeEventListener("keyup",this.onKeyUp)}))}dispose(){this.listener.stopListening(),this.cancellation.abort()}get inAuthoringMode(){return Boolean(this._metadataApi)}get metadataApi(){return this._metadataApi}setMetadataApi(e){const t=this._metadataApi;e!==t&&(this._metadataApi=e,Boolean(e)!==Boolean(t)&&this.source.trigger("changeMode",{source:this}))}get authoringState(){return this._authoringState}setAuthoringState(e){this._authoringState!==e&&this.model.history.execute(this.updateAuthoringState(e))}updateAuthoringState(e){const t=this._authoringState;return l.Command.create("Create or delete entities and links",(()=>(this._authoringState=e,this.source.trigger("changeAuthoringState",{source:this,previous:t}),this.updateAuthoringState(t))))}get validationState(){return this._validationState}setValidationState(e){const t=this._validationState;e!==t&&(this._validationState=e,this.source.trigger("changeValidationState",{source:this,previous:t}))}get temporaryState(){return this._temporaryState}setTemporaryState(e){const t=this._temporaryState;e!==t&&(this._temporaryState=e,this.source.trigger("changeTemporaryState",{source:this,previous:t}))}get selection(){return this._selection}setSelection(e){const t=this._selection;t!==e&&(this._selection=e,this.source.trigger("changeSelection",{source:this,previous:t}))}cancelSelection(){this.setSelection([])}onKeyUp=e=>{"Delete"===e.key&&document.activeElement&&"input"!==document.activeElement.localName&&this.removeSelectedElements()};removeSelectedElements(){const e=this.selection;0!==e.length&&(this.cancelSelection(),this.removeItems(e))}removeItems(e){const t=this.model.history.startBatch(),n=new Set;for(const i of e)if(i instanceof a.Element){const e=this.authoringState.elements.get(i.iri);e&&this.discardChange(e),this.model.removeElement(i.id),n.add(i.iri)}else i instanceof a.Link&&c.AuthoringState.isNewLink(this.authoringState,i.data)&&this.deleteLink(i.data);if(n.size>0){const e=c.AuthoringState.deleteNewLinksConnectedToElements(this.authoringState,n);this.setAuthoringState(e)}t.store()}onCellsChanged=()=>{if(0===this.selection.length)return;const e=this.selection.filter((e=>e instanceof a.Element?this.model.getElement(e.id):e instanceof a.Link&&this.model.getLink(e.id)));e.length<this.selection.length&&this.setSelection(e)};bringElements(e,t){0!==e.length&&this.model.reorderElements((0,i.makeMoveComparator)(this.model.elements,e,"front"===t?i.MoveDirection.ToEnd:i.MoveDirection.ToStart))}createNewEntity({elementModel:e,temporary:t}){const n=this.model.history.startBatch("Create new entity"),i=this.model.createElement(e);return i.setExpanded(!0),t?(this.setTemporaryState(c.TemporaryState.addElement(this.temporaryState,i.data)),n.discard()):(this.setAuthoringState(c.AuthoringState.addElement(this._authoringState,i.data)),n.store()),i}changeEntityData(e,t){const n=this.model.elements.filter((t=>t.iri===e));if(0===n.length)return;const i=n[0].data,r=this.model.history.startBatch("Edit entity"),o=c.AuthoringState.changeElement(this._authoringState,i,t),a=o.elements.get(e)||o.elements.get(t.id);this.model.history.execute((0,s.setElementData)(this.model,e,a.after)),this.setAuthoringState(o),r.store()}deleteEntity(e){const t=this.authoringState,n=this.model.elements.filter((t=>t.iri===e));if(0===n.length)return;const i=this.model.history.startBatch("Delete entity"),r=n[0].data,o=t.elements.get(e),s=new Set;for(const a of n)for(const e of this.model.getElementLinks(a))e.data&&c.AuthoringState.isNewLink(t,e.data)&&s.add(e.id);s.forEach((e=>this.model.removeLink(e))),o&&this.discardChange(o),this.setAuthoringState(c.AuthoringState.deleteElement(t,r)),i.store()}createNewLink(e){const{link:t,temporary:n}=e;if(this.model.findLink(t.typeId,t.sourceId,t.targetId))throw Error("The link already exists");const i=this.model.history.startBatch("Create new link");this.model.addLink(t),n||this.model.createLinks(t.data);return this.model.links.filter((e=>(0,o.equalLinks)(e.data,t.data))).length>0?n?(this.setTemporaryState(c.TemporaryState.addLink(this.temporaryState,t.data)),i.discard()):(this.setAuthoringState(c.AuthoringState.addLink(this._authoringState,t.data)),i.store()):i.discard(),t}changeLink(e,t){const n=this.model.history.startBatch("Change link");if((0,o.equalLinks)(e,t))this.model.history.execute((0,s.setLinkData)(this.model,e,t)),this.setAuthoringState(c.AuthoringState.changeLink(this._authoringState,e,t));else{let n=this._authoringState;n=c.AuthoringState.deleteLink(n,e),n=c.AuthoringState.addLink(n,t),c.AuthoringState.isNewLink(this._authoringState,e)&&this.model.links.filter((t=>(0,o.equalLinks)(t.data,e))).forEach((e=>this.model.removeLink(e.id))),this.model.createLinks(t),this.setAuthoringState(n)}n.store()}moveLinkSource(e){const{link:t,newSource:n}=e,i=this.model.history.startBatch("Move link to another element");this.changeLink(t.data,{...t.data,sourceId:n.iri});const r=this.model.findLink(t.typeId,n.id,t.targetId);return r.setVertices(t.vertices),i.store(),r}moveLinkTarget(e){const{link:t,newTarget:n}=e,i=this.model.history.startBatch("Move link to another element");this.changeLink(t.data,{...t.data,targetId:n.iri});const r=this.model.findLink(t.typeId,t.sourceId,n.id);return r.setVertices(t.vertices),i.store(),r}deleteLink(e){const t=this.authoringState;if(c.AuthoringState.isDeletedLink(t,e))return;const n=this.model.history.startBatch("Delete link"),i=c.AuthoringState.deleteLink(t,e);c.AuthoringState.isNewLink(t,e)&&this.model.links.filter((({data:t})=>(0,o.equalLinks)(t,e))).forEach((e=>this.model.removeLink(e.id))),this.setAuthoringState(i),n.store()}removeAllTemporaryCells(){const{temporaryState:e}=this,t=[];if(e.elements.size>0)for(const n of this.model.elements)e.elements.has(n.iri)&&t.push(n);if(e.links.size>0)for(const n of this.model.links)e.links.has(n.data)&&t.push(n);t.length>0&&this.removeTemporaryCells(t)}removeTemporaryCells(e){const{temporaryState:t}=this;let n=t;const i=this.model.history.startBatch();for(const r of e)r instanceof a.Element?t.elements.has(r.iri)&&(n=c.TemporaryState.deleteElement(n,r.data),this.model.removeElement(r.id)):r instanceof a.Link&&t.links.has(r.data)&&(n=c.TemporaryState.deleteLink(n,r.data),this.model.removeLink(r.id));i.discard(),this.setTemporaryState(n)}discardChange(e){const t=c.AuthoringState.discard(this._authoringState,e);if(t===this._authoringState)return;const n=this.model.history.startBatch("Discard change");e.type===c.AuthoringKind.ChangeElement?e.deleted||(e.before?this.model.history.execute((0,s.setElementData)(this.model,e.after.id,e.before)):this.model.elements.filter((t=>t.iri===e.after.id)).forEach((e=>this.model.removeElement(e.id)))):e.type===c.AuthoringKind.ChangeLink&&(e.deleted||(e.before?this.model.history.execute((0,s.setLinkData)(this.model,e.after,e.before)):this.model.links.filter((({data:t})=>(0,o.equalLinks)(t,e.after))).forEach((e=>this.model.removeLink(e.id))))),this.setAuthoringState(t),n.store()}}},(e,t,n)=>{n.r(t),n.d(t,{ValidationState:()=>i,changedElementsToValidate:()=>a,validateElements:()=>l});var i,r=n(52),o=n(56),s=n(66);function a(e,t,n){const i=new o.HashMap(s.hashLink,s.equalLinks);e.links.forEach(((e,t)=>i.set(t,!0))),t.links.forEach(((e,t)=>i.set(t,!0)));const r=new Set;i.forEach(((n,i)=>{t.links.get(i)!==e.links.get(i)&&r.add(i.sourceId)}));for(const o of n.elements){const i=t.elements.get(o.iri),s=e.elements.get(o.iri);if(i!==s&&(r.add(o.iri),(i||s).deleted))for(const e of n.getElementLinks(o))e.data.sourceId!==o.iri&&r.add(e.data.sourceId)}return r}function l(e,t,n,o,s){const a=o.validationState,l=i.createMutable();for(const i of n.elements){if(l.elements.has(i.iri))continue;const d=[];for(const e of n.getElementLinks(i))e.sourceId===i.id&&d.push(e.data);if(e.has(i.iri)){const e={target:i.data,outboundLinks:d,state:o.authoringState,model:n,signal:s},a=(0,r.mapAbortedToNull)(t.validate(e),s),u={loading:!0,errors:[]},h={loading:!0,errors:[]};l.elements.set(i.iri,u),d.forEach((e=>l.links.set(e,h))),c(a,u,h,e,o)}else{l.elements.set(i.iri,a.elements.get(i.iri));for(const e of d)l.links.set(e,a.links.get(e))}}o.setValidationState(l)}async function c(e,t,n,r,a){let l;try{if(l=await e,null===l)return}catch(h){console.error("Failed to validate element",r.target,h),l=[{type:"element",target:r.target.id,message:"Failed to validate element"}]}const c=[],d=new o.HashMap(s.hashLink,s.equalLinks);r.outboundLinks.forEach((e=>d.set(e,[])));for(const i of l)"element"===i.type&&i.target===r.target.id?c.push(i):"link"===i.type&&d.has(i.target)&&d.get(i.target).push(i);let u=a.validationState;u.elements.get(r.target.id)===t&&(u=i.setElementErrors(u,r.target.id,c)),d.forEach(((e,t)=>{u.links.get(t)===n&&(u=i.setLinkErrors(u,t,e))})),a.setValidationState(u)}!function(e){function t(){return{elements:new Map,links:new o.HashMap(s.hashLink,s.equalLinks)}}e.empty=t(),e.emptyElement={loading:!1,errors:[]},e.emptyLink={loading:!1,errors:[]},e.createMutable=t,e.setElementErrors=function(e,t,n){const i=new Map(e.elements);return n.length>0?i.set(t,{loading:!1,errors:n}):i.delete(t),{...e,elements:i}},e.setLinkErrors=function(e,t,n){const i=e.links.clone();return n.length>0?i.set(t,{loading:!1,errors:n}):i.delete(t),{...e,links:i}}}(i||(i={}))},(e,t,n)=>{n.r(t),n.d(t,{OverlayController:()=>x});var i=n(96),r=n(58),o=n(55),s=n(91),a=n(94),l=n(64),c=n(107),d=n(120),u=n(122),h=n(123),p=n(126),g=n(132),f=n(116),m=n(133),y=n(134),b=n(135);class x{listener=new o.EventObserver;source=new o.EventSource;events=this.source;model;view;editor;options;authoringStateDecorator;_openedDialog;constructor(e){const{model:t,view:n,editor:r,...o}=e;this.model=t,this.view=n,this.editor=r,this.options=o,this.listener.listen(this.model.events,"loadingSuccess",(()=>{this.view.setCanvasWidget("states",{element:(0,i.jsx)(b.LinkStateWidget,{}),attachment:"overLinks"})}));const s=async e=>{const t=this.view.findAnyCanvas();if(t){t.renderingState.syncUpdate();const n=await(0,l.calculateLayout)({layoutFunction:this.view.defaultLayout,model:this.model,sizeProvider:t.renderingState,group:e});(0,l.applyLayout)(n,this.model),this.model._triggerChangeGroupContent(e,{layoutComplete:!0})}};this.listener.listen(this.model.events,"changeGroupContent",(e=>{e.layoutComplete||s(e.group)})),this.listener.listen(this.editor.events,"changeSelection",(()=>{const e=1===this.editor.selection.length?this.editor.selection[0]:void 0;this.openedDialog&&this.openedDialog.target!==e&&this.hideDialog()})),n.setCanvasWidget("selectionHandler",{element:(0,i.jsx)(v,{onCanvasPointerUp:this.onAnyCanvasPointerUp}),attachment:"viewport"}),this.authoringStateDecorator=e=>(0,i.jsx)(y.ElementDecorator,{target:e,position:e.position}),this.listener.listen(this.editor.events,"changeMode",(()=>{this.updateElementDecorator()})),this.updateElementDecorator()}get openedDialog(){return this._openedDialog}dispose(){this.listener.stopListening()}onAnyCanvasPointerUp=e=>{const{sourceEvent:t,target:n,triggerAsClick:i}=e;t.ctrlKey||t.shiftKey||t.metaKey||this.openedDialog&&this.openedDialog.holdSelection||(n instanceof a.Element?(this.editor.setSelection([n]),n.focus()):n instanceof a.Link?this.editor.setSelection([n]):n instanceof a.LinkVertex?this.editor.setSelection([n.link]):!n&&i&&(this.editor.setSelection([]),this.hideDialog(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()))};updateElementDecorator(){this.view._setElementDecorator(this.editor.inAuthoringMode?this.authoringStateDecorator:void 0)}_startTask(){let e,t=!1;return this.setSpinner({}),{setError:n=>{t=!0,e=n},end:()=>{if(t){let t;if(e&&"object"==typeof e&&"message"in e){const n=e.message;"string"==typeof n&&(t=n)}this.setSpinner({statusText:t,errorOccurred:!0})}else this.setSpinner(void 0)}}}setSpinner(e){this.view.setCanvasWidget("loadingWidget",e?{element:(0,i.jsx)(w,{spinnerProps:e}),attachment:"viewport"}:null)}showSpinnerWhile(e){this.setSpinner({}),e.then((()=>{this.setSpinner(void 0)})).catch((e=>{console.error(e),this.setSpinner({statusText:"Unknown error occurred",errorOccurred:!0})}))}showDialog(e){const{target:t,dialogType:n,content:r,size:o,caption:s,offset:a,calculatePosition:l,onClose:c,holdSelection:u=!1}=e;this._openedDialog&&this._openedDialog.target!==t&&this.hideDialog();const h=this._openedDialog;this._openedDialog={target:t,knownType:n,holdSelection:u,onClose:c};const p=(0,i.jsx)(d.Dialog,{target:t,size:o,caption:s,offset:a,calculatePosition:l,onClose:c,children:r});this.view.setCanvasWidget("dialog",{element:p,attachment:"overElements"}),this.source.trigger("changeOpenedDialog",{source:this,previous:h})}hideDialog(){if(this._openedDialog){const e=this._openedDialog;this._openedDialog=void 0,e.onClose(),this.editor.removeTemporaryCells([e.target]),this.view.setCanvasWidget("dialog",null),this.source.trigger("changeOpenedDialog",{source:this,previous:e})}}startEditing(e){const{target:t,mode:n,point:r}=e,o=(0,i.jsx)(m.EditLayer,{mode:n,target:t,point:r,onFinishEditing:()=>{this.view.setCanvasWidget("editLayer",null)}});this.view.setCanvasWidget("editLayer",{element:o,attachment:"overElements"})}showEditEntityForm(e){const{propertyEditor:t}=this.options,n=t=>{this.hideDialog(),this.editor.changeEntityData(e.data.id,t)};let r=e.data;const o=this.editor.authoringState.elements.get(e.data.id);o&&o.newIri&&(r={...e.data,id:o.newIri});const s=()=>this.hideDialog(),a=t?t({elementData:e.data,onSubmit:n,onCancel:s}):(0,i.jsx)(u.EditEntityForm,{entity:r,onApply:n,onCancel:s});this.showDialog({target:e,dialogType:"editEntity",content:a,holdSelection:!0,onClose:s})}showFindOrCreateEntityForm({link:e,source:t,target:n,targetIsNew:r}){const o=()=>{this.editor.removeAllTemporaryCells(),this.hideDialog()},s=(0,i.jsx)(p.FindOrCreateEntityForm,{source:t,target:n,initialTargetIsNew:r,originalLink:e,onAfterApply:()=>{this.hideDialog(),f.AuthoringState.isNewElement(this.editor.authoringState,n.iri)&&this.showEditEntityForm(n)},onCancel:o});this.showDialog({target:n,dialogType:"findOrCreateEntity",content:s,caption:"Establish New Connection",onClose:o})}showEditLinkForm(e){const t=this.model.getElement(e.sourceId).data,n=this.model.getElement(e.targetId).data,r=()=>{this.editor.removeTemporaryCells([e]),this.hideDialog()},o=(0,i.jsx)(h.EditLinkForm,{link:e.data,source:t,target:n,onChange:t=>{if(this.editor.temporaryState.links.has(e.data)){this.editor.removeTemporaryCells([e]);const n=(0,a.makeLinkWithDirection)(e,t);this.showEditLinkForm(this.editor.createNewLink({link:n,temporary:!0}))}},onApply:t=>{if(this.editor.temporaryState.links.has(e.data)){this.editor.removeTemporaryCells([e]);const n=(0,a.makeLinkWithDirection)(e,t);this.editor.createNewLink({link:n})}else this.editor.changeLink(e.data,t);this.hideDialog()},onCancel:r}),s=this.editor.temporaryState.links.has(e.data)?"Establish New Connection":"Edit Connection";this.showDialog({target:e,dialogType:"editLink",content:o,size:{width:300,height:160},caption:s,onClose:r})}showRenameLinkForm(e){const t={width:300,height:145},n=()=>this.hideDialog();this.showDialog({target:e,dialogType:"renameLink",content:(0,i.jsx)(g.RenameLinkForm,{link:e,onFinish:n}),size:t,caption:"Rename Link",offset:{x:25,y:-t.height/2},calculatePosition:t=>{const n=t.renderingState.getLinkLabelBounds(e);if(n){const{x:e,y:t,width:i,height:r}=n;return{x:e+i,y:t+r/2}}},onClose:n})}}function w(e){const{spinnerProps:t}=e,{canvas:n}=(0,s.useCanvas)(),{clientWidth:r,clientHeight:o}=n.metrics.area,a={x:t.statusText?r/3:o/2,y:o/2};return(0,i.jsx)("div",{className:"reactodia-loading-widget",children:(0,i.jsx)("svg",{width:r,height:o,children:(0,i.jsx)(c.Spinner,{position:a,...t})})})}function v(e){const{onCanvasPointerUp:t}=e,{canvas:n}=(0,s.useCanvas)();return r.useEffect((()=>{const e=new o.EventObserver;return e.listen(n.events,"pointerUp",t),()=>e.stopListening()}),[t]),null}},(e,t,n)=>{n.r(t),n.d(t,{Dialog:()=>h});var i=n(96),r=n(58),o=n(55),s=n(91),a=n(94),l=n(71),c=n(121);const d="reactodia-dialog",u={width:300,height:300};class h extends r.Component{static contextType=s.CanvasContext;unsubscribeFromTarget=void 0;handler=new o.EventObserver;updateAll=()=>this.forceUpdate();startSize;constructor(e){super(e),this.state={}}componentDidMount(){this.listenToTarget(this.props.target),this.focusOn()}componentDidUpdate(e){this.props.target!==e.target&&this.listenToTarget(this.props.target)}componentWillUnmount(){this.listenToTarget(void 0)}listenToTarget(e){if(this.unsubscribeFromTarget&&(this.unsubscribeFromTarget(),this.unsubscribeFromTarget=void 0),e){const{model:t}=this.context;e instanceof a.Element?this.listenToElement(e):e instanceof a.Link&&this.listenToLink(e),this.handler.listen(t.events,"changeLanguage",this.updateAll),this.unsubscribeFromTarget=()=>{this.handler.stopListening()}}}listenToElement(e){const{canvas:t}=this.context;this.handler.listen(e.events,"changePosition",this.updateAll),this.handler.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.updateAll()}))}listenToLink(e){const{canvas:t,model:n}=this.context,i=n.getElement(e.sourceId),r=n.getElement(e.targetId);this.listenToElement(i),this.listenToElement(r),this.handler.listen(e.events,"changeVertices",this.updateAll),this.handler.listen(t.renderingState.events,"changeLinkLabelBounds",(t=>{t.source===e&&this.updateAll()}))}calculatePositionForElement(e){const{size:t=u}=this.props,{canvas:n}=this.context,i=(0,l.boundsOf)(e,n.renderingState),{y:r}=n.metrics.paperToScrollablePaneCoords(i.x,i.y),{x:o,y:s}=n.metrics.paperToScrollablePaneCoords(i.x+i.width,i.y+i.height);return{x:o+40,y:(r+s)/2-t.height/2}}calculatePositionForLink(e){const{canvas:t,model:n}=this.context,i=n.getElement(e.sourceId),r=n.getElement(e.targetId);if(!i||!r)throw new Error("Source and target are not specified");const o=t.renderingState.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s,c=(0,l.computePolyline)((0,l.boundsOf)(i,t.renderingState),(0,l.boundsOf)(r,t.renderingState),a),d=(0,l.computePolylineLength)(c),u=(0,l.getPointAlongPolyline)(c,d/2),{x:h,y:p}=t.metrics.paperToScrollablePaneCoords(u.x,u.y);return{y:p+20,x:h+20}}calculatePosition(){const{target:e,offset:t={x:0,y:0},calculatePosition:n}=this.props,{canvas:i}=this.context;if(n){const e=n(i);if(e){const{x:n,y:r}=i.metrics.paperToScrollablePaneCoords(e.x,e.y);return{x:n+t.x,y:r+t.y}}}if(e instanceof a.Element)return this.calculatePositionForElement(e);if(e instanceof a.Link)return this.calculatePositionForLink(e);throw new Error("Unknown target type")}getViewPortScrollablePoints(){const{canvas:e}=this.context,{clientWidth:t,clientHeight:n}=e.metrics.area;return{min:e.metrics.clientToScrollablePaneCoords(0,0),max:e.metrics.clientToScrollablePaneCoords(t,n)}}getDialogScrollablePoints(){const{size:e=u}=this.props,{x:t,y:n}=this.calculatePosition(),i={x:t-20,y:n-20};return{min:i,max:{x:i.x+e.width+40,y:i.y+e.height+40}}}focusOn(){const{canvas:e}=this.context,{min:t,max:n}=this.getViewPortScrollablePoints(),{min:i,max:r}=this.getDialogScrollablePoints();let o=0;i.x<t.x?o=i.x-t.x:r.x>n.x&&(o=r.x-n.x);let s=0;i.y<t.y?s=i.y-t.y:r.y>n.y&&(s=r.y-n.y);const a={x:t.x+(n.x-t.x)/2+o,y:t.y+(n.y-t.y)/2+s},l=e.metrics.scrollablePaneToPaperCoords(a.x,a.y);e.centerTo(l)}onStartDragging=e=>{this.preventSelection();const{size:t=u}=this.props;this.startSize={x:this.state.width||t.width,y:this.state.height||t.height}};calculateHeight(e){const{size:t=u}=this.props,n=Math.min(t.height,250),i=Math.max(t.height,800);return Math.max(n,Math.min(i,e))}calculateWidth(e){const{size:t=u}=this.props,n=Math.min(t.width,250),i=Math.max(t.width,800);return Math.max(n,Math.min(i,e))}onDragHandleBottom=(e,t,n)=>{const i=this.calculateHeight(this.startSize.y+n);this.setState({height:i})};onDragHandleRight=(e,t)=>{const n=this.calculateWidth(this.startSize.x+t);this.setState({width:n})};onDragHandleBottomRight=(e,t,n)=>{const i=this.calculateWidth(this.startSize.x+t),r=this.calculateHeight(this.startSize.y+n);this.setState({width:i,height:r})};preventSelection(){const e=()=>{document.body.classList.remove("reactodia--unselectable"),document.removeEventListener("mouseup",e)};document.addEventListener("mouseup",e),document.body.classList.add("reactodia--unselectable")}render(){const{size:e=u,caption:t}=this.props,{x:n,y:r}=this.calculatePosition(),o={top:r,left:n,width:this.state.width||e.width,height:this.state.height||e.height};return(0,i.jsxs)("div",{className:d,role:"dialog","aria-labelledby":t?"reactodia-dialog-caption":void 0,style:o,children:[(0,i.jsx)("button",{className:`${d}__close-button`,onClick:()=>this.props.onClose()}),t?(0,i.jsx)("div",{id:"reactodia-dialog-caption",className:"reactodia-dialog__caption",children:t}):null,this.props.children,(0,i.jsx)(c.DraggableHandle,{className:`${d}__bottom-handle`,onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandleBottom}),(0,i.jsx)(c.DraggableHandle,{className:`${d}__right-handle`,onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandleRight}),(0,i.jsx)(c.DraggableHandle,{className:`${d}__bottom-right-handle`,onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandleBottomRight})]})}}},(e,t,n)=>{n.r(t),n.d(t,{DraggableHandle:()=>o});var i=n(96),r=n(58);class o extends r.Component{holdState;render(){const{onBeginDragHandle:e,onDragHandle:t,onEndDragHandle:n,...r}=this.props;return(0,i.jsx)("div",{...r,onPointerDown:this.onPointerDown,children:this.props.children})}componentWillUnmount(){this.removeListeners()}onPointerDown=e=>{if(this.holdState||e.target!==e.currentTarget)return;if(e.button)return;const{pageX:t,pageY:n,currentTarget:i,pointerId:r}=e;e.preventDefault(),this.holdState={origin:{pageX:t,pageY:n},target:i,pointerId:r},i.addEventListener("pointermove",this.onPointerMove),i.addEventListener("pointerup",this.onPointerUp),i.addEventListener("pointercancel",this.onPointerUp),i.setPointerCapture(r);const{onBeginDragHandle:o}=this.props;o(e)};onPointerMove=e=>{if(!this.holdState)return;e.preventDefault();const{origin:t}=this.holdState,{onDragHandle:n}=this.props;n(e,e.pageX-t.pageX,e.pageY-t.pageY)};onPointerUp=e=>{this.removeListeners();const{onEndDragHandle:t}=this.props;t?.(e)};removeListeners(){if(this.holdState){const{target:e,pointerId:t}=this.holdState;this.holdState=void 0,e.releasePointerCapture(t),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp)}}}},(e,t,n)=>{n.r(t),n.d(t,{EditEntityForm:()=>a});var i=n(96),r=n(58),o=n(115);const s="reactodia-edit-form";class a extends r.Component{static contextType=o.WorkspaceContext;constructor(e,t){super(e,t),this.state={elementModel:e.entity}}componentDidUpdate(e){this.props.entity!==e.entity&&this.setState({elementModel:this.props.entity})}renderProperty(e,t){const{model:n}=this.context,r=n.getPropertyType(e),o=n.locale.formatLabel(r.label,e);return(0,i.jsx)("div",{className:`${s}__form-row`,children:(0,i.jsxs)("label",{children:[o,t.map(((e,t)=>(0,i.jsx)("input",{name:"reactodia-edit-entity-property",className:"reactodia-form-control",defaultValue:e.value},t)))]})},e)}renderProperties(){const{properties:e}=this.props.entity,t=Object.keys(e);return(0,i.jsx)("div",{children:t.map((t=>this.renderProperty(t,e[t])))})}renderType(){const{model:e}=this.context,{elementModel:t}=this.state,n=e.locale.formatElementTypes(t.types).join(", ");return(0,i.jsxs)("label",{children:["Type",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-type",value:n,disabled:!0})]})}onChangeIri=e=>{const t=e.target.value;this.setState((e=>({elementModel:{...e.elementModel,id:t}})))};renderIri(){const{elementModel:e}=this.state;return(0,i.jsxs)("label",{children:["IRI",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-iri",defaultValue:e.id,onChange:this.onChangeIri})]})}onChangeLabel=e=>{const{model:t}=this.context,n=e.target,i=n.value.length>0?[t.factory.literal(n.value)]:[];this.setState({elementModel:{...this.state.elementModel,label:i}})};renderLabel(){const{model:e}=this.context,t=e.locale.selectLabel(this.state.elementModel.label),n=t?t.value:"";return(0,i.jsxs)("label",{children:["Label",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-label",value:n,onChange:this.onChangeLabel})]})}render(){return(0,i.jsxs)("div",{className:s,children:[(0,i.jsxs)("div",{className:`${s}__body`,children:[(0,i.jsx)("div",{className:`${s}__form-row`,children:this.renderIri()}),(0,i.jsx)("div",{className:`${s}__form-row`,children:this.renderType()}),(0,i.jsx)("div",{className:`${s}__form-row`,children:this.renderLabel()}),this.renderProperties()]}),(0,i.jsxs)("div",{className:`${s}__controls`,children:[(0,i.jsx)("button",{type:"button",className:`reactodia-btn reactodia-btn-primary ${s}__apply-button`,onClick:()=>this.props.onApply(this.state.elementModel),children:"Apply"}),(0,i.jsx)("button",{type:"button",className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}}},(e,t,n)=>{n.r(t),n.d(t,{EditLinkForm:()=>d});var i=n(96),r=n(58),o=n(66),s=n(124),a=n(115),l=n(125);const c="reactodia-edit-form";class d extends r.Component{static contextType=a.WorkspaceContext;validationCancellation=new AbortController;constructor(e,t){super(e,t),this.state={linkValue:{value:{link:e.link,direction:"out"},validated:!0,allowChange:!0}}}componentDidMount(){this.validate()}componentDidUpdate(e,t){const{linkValue:n}=this.state;(0,o.equalLinks)(n.value.link,t.linkValue.value.link)||this.validate(),n!==t.linkValue&&n.validated&&n.allowChange&&this.props.onChange(n.value.link)}componentWillUnmount(){this.validationCancellation.abort()}validate(){const{link:e}=this.props,{linkValue:{value:t}}=this.state;this.setState({isValidating:!0}),this.validationCancellation.abort(),this.validationCancellation=new AbortController;const n=this.validationCancellation.signal;(0,l.validateLinkType)(t.link,e,this.context).then((e=>{n.aborted||this.setState((({linkValue:t})=>({linkValue:{...t,...e,validated:!0},isValidating:!1})))}))}render(){const{source:e,target:t}=this.props,{linkValue:n,isValidating:r}=this.state,o=!n.error;return(0,i.jsxs)("div",{className:c,children:[(0,i.jsxs)("div",{className:`${c}__body`,children:[(0,i.jsx)(l.LinkTypeSelector,{linkValue:n,source:e,target:t,onChange:e=>this.setState({linkValue:{value:e,error:void 0,validated:!1,allowChange:!1}})}),r?(0,i.jsx)("div",{className:`${c}__progress`,children:(0,i.jsx)(s.ProgressBar,{state:"loading",title:"Validating selected link type",height:10})}):null]}),(0,i.jsxs)("div",{className:`${c}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${c}__apply-button`,onClick:()=>this.props.onApply(n.value.link),disabled:!o||r,children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}}},(e,t,n)=>{n.r(t),n.d(t,{ProgressBar:()=>o});var i=n(96);const r="reactodia-progress-bar";function o(e){const{state:t,title:n,percent:o=100,height:s=20}=e,a=`${r} ${r}--${t}`,l="loading"===t||"error"===t;return(0,i.jsx)("div",{className:a,style:{height:l?s:0},children:(0,i.jsx)("div",{className:`${r}__bar`,style:{width:`${o}%`},title:n,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o})})}},(e,t,n)=>{n.r(t),n.d(t,{LinkTypeSelector:()=>h,validateLinkType:()=>p});var i=n(96),r=n(58),o=n(52),s=n(55),a=n(66),l=n(80),c=n(107),d=n(115);const u="reactodia-edit-form";class h extends r.Component{static contextType=d.WorkspaceContext;listener=new s.EventObserver;cancellation=new AbortController;constructor(e,t){super(e,t),this.state={fatLinkTypes:[]}}updateAll=()=>this.forceUpdate();componentDidMount(){this.fetchPossibleLinkTypes()}componentDidUpdate(e){const{source:t,target:n}=this.props;e.source===t&&e.target===n||(this.setState({fatLinkTypes:void 0}),this.fetchPossibleLinkTypes())}componentWillUnmount(){this.listener.stopListening(),this.cancellation.abort()}async fetchPossibleLinkTypes(){const{model:e,editor:{metadataApi:t}}=this.context,{source:n,target:i}=this.props;if(!t)return;const r=await(0,o.mapAbortedToNull)(t.possibleLinkTypes(n,i,this.cancellation.signal),this.cancellation.signal);if(null===r)return;const s=[];r.forEach((({linkTypeIri:t,direction:n})=>{const i=e.createLinkType(t);s.push({fatLinkType:i,direction:n})})),s.sort(function(e){return(t,n)=>{const i=e.locale.formatLabel(t.fatLinkType.label,t.fatLinkType.id),r=e.locale.formatLabel(n.fatLinkType.label,n.fatLinkType.id),o=i.localeCompare(r);return 0!==o?o:"out"===t.direction&&"in"===n.direction?-1:"in"===t.direction&&"out"===n.direction?1:0}}(e)),this.setState({fatLinkTypes:s}),this.listenToLinkLabels(s)}listenToLinkLabels(e){e.forEach((({fatLinkType:e})=>this.listener.listen(e.events,"changeLabel",this.updateAll)))}onChangeType=e=>{const{link:t,direction:n}=this.props.linkValue.value,i=parseInt(e.currentTarget.value,10),{fatLinkType:r,direction:o}=this.state.fatLinkTypes[i];let s={...t,linkTypeId:r.id};n!==o&&(s={...s,sourceId:t.targetId,targetId:t.sourceId}),this.props.onChange({link:s,direction:o})};renderPossibleLinkType=({fatLinkType:e,direction:t},n)=>{const{model:r}=this.context,{source:o,target:s}=this.props,a=r.locale.formatLabel(e.label,e.id);let[l,c]=[o,s].map((e=>r.locale.formatLabel(e.label,e.id)));return"in"===t&&([l,c]=[c,l]),(0,i.jsxs)("option",{value:n,children:[a," [",l," \u2192 ",c,"]"]},n)};render(){const{linkValue:e,disabled:t}=this.props,{fatLinkTypes:n}=this.state,r=(n||[]).findIndex((({fatLinkType:t,direction:n})=>t.id===e.value.link.linkTypeId&&n===e.value.direction));return(0,i.jsxs)("div",{className:`${u}__control-row`,children:[(0,i.jsx)("label",{children:"Link Type"}),n?(0,i.jsxs)("select",{className:"reactodia-form-control",name:"reactodia-link-type-selector-select",value:r,onChange:this.onChangeType,disabled:t,children:[(0,i.jsx)("option",{value:-1,disabled:!0,children:"Select link type"}),n.map(this.renderPossibleLinkType)]}):(0,i.jsx)("div",{children:(0,i.jsx)(c.HtmlSpinner,{width:20,height:20})}),e.error?(0,i.jsx)("span",{className:`${u}__control-error`,children:e.error}):""]})}}function p(e,t,{model:n,editor:i}){if(e.linkTypeId===l.PLACEHOLDER_LINK_TYPE)return Promise.resolve({error:"Required.",allowChange:!0});if((0,a.equalLinks)(e,t))return Promise.resolve({error:void 0,allowChange:!0});return n.links.find((({data:{linkTypeId:t,sourceId:n,targetId:r}})=>t===e.linkTypeId&&n===e.sourceId&&r===e.targetId&&!i.temporaryState.links.has(e)))?Promise.resolve({error:"The link already exists.",allowChange:!1}):n.dataProvider.links({elementIds:[e.sourceId,e.targetId],linkTypeIds:[e.linkTypeId]}).then((t=>t.some((t=>(0,a.equalLinks)(t,e)))?{error:"The link already exists.",allowChange:!1}:{error:void 0,allowChange:!0}))}},(e,t,n)=>{n.r(t),n.d(t,{FindOrCreateEntityForm:()=>g});var i=n(96),r=n(58),o=n(65),s=n(94),a=n(107),l=n(116),c=n(124),d=n(115),u=n(127),h=n(125);const p="reactodia-edit-form";class g extends r.Component{static contextType=d.WorkspaceContext;link;validationCancellation=new AbortController;constructor(e,t){super(e,t);const{target:n,initialTargetIsNew:i,originalLink:r}=this.props;this.link=r,this.state={elementValue:{value:n.data,isNew:i,loading:!1,validated:!0,allowChange:!0},linkValue:{value:{link:r.data,direction:"out"},validated:!0,allowChange:!0}}}componentDidMount(){this.validate()}componentWillUnmount(){this.validationCancellation.abort()}validate(){const{originalLink:e}=this.props,{elementValue:t,linkValue:n}=this.state;this.setState({isValidating:!0}),this.validationCancellation.abort(),this.validationCancellation=new AbortController;const i=this.validationCancellation.signal,r=(0,u.validateElementType)(t.value),o=(0,h.validateLinkType)(n.value.link,e.data,this.context);Promise.all([r,o]).then((([e,r])=>{i.aborted||(this.setState({isValidating:!1}),this.setElementOrLink({elementValue:{...t,...e,validated:!0},linkValue:{...n,...r,validated:!0}}))}))}render(){const{source:e,originalLink:t}=this.props,{elementValue:n,linkValue:r,isValidating:o}=this.state,s=!n.error&&!r.error;return(0,i.jsxs)("div",{className:p,children:[(0,i.jsxs)("div",{className:`${p}__body`,children:[(0,i.jsx)(u.ElementTypeSelector,{source:e.data,elementValue:n,onChange:e=>{this.setElementOrLink({elementValue:{value:e.value,isNew:e.isNew,loading:e.loading,error:void 0,validated:!1,allowChange:!1},linkValue:{value:{link:{...t.data,targetId:e.value.id},direction:"out"},validated:!1,allowChange:!1}})}}),n.loading?(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)(a.HtmlSpinner,{width:20,height:20}),"\xa0Loading entity..."]}):(0,i.jsx)(h.LinkTypeSelector,{linkValue:r,source:e.data,target:n.value,onChange:e=>this.setElementOrLink({linkValue:{value:e,error:void 0,validated:!1,allowChange:!1}}),disabled:void 0!==n.error}),o?(0,i.jsx)("div",{className:`${p}__progress`,children:(0,i.jsx)(c.ProgressBar,{state:"loading",title:"Validating selected element and link types",height:10})}):null]}),(0,i.jsxs)("div",{className:`${p}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${p}__apply-button`,onClick:this.onApply,disabled:n.loading||!s||o,children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}setElementOrLink({elementValue:e,linkValue:t}){const{model:n,editor:i}=this.context;this.setState((n=>({elementValue:e||n.elementValue,linkValue:t||n.linkValue})),(()=>{const{source:e,target:t}=this.props,{elementValue:r,linkValue:a}=this.state;if((r&&!r.validated||a&&!a.validated)&&this.validate(),r&&r.validated&&r.allowChange){const e=t.data;let s=i.temporaryState;s=l.TemporaryState.deleteElement(s,e),s=l.TemporaryState.deleteLink(s,this.link.data),i.setTemporaryState(s);const a=n.history.startBatch();a.history.execute((0,o.setElementData)(n,t.iri,r.value)),a.discard(),s=l.TemporaryState.addElement(s,t.data),s=l.TemporaryState.addLink(s,this.link.data),i.setTemporaryState(s)}if(a&&a.validated&&a.allowChange){i.removeTemporaryCells([this.link]);const n=(0,s.makeLinkWithDirection)(new s.Link({sourceId:e.id,targetId:t.id,data:{...a.value.link,sourceId:e.iri,targetId:t.iri}}),a.value.link);this.link=i.createNewLink({link:n,temporary:!0})}}))}onApply=()=>{const{model:e,editor:t}=this.context,{source:n,target:i,onAfterApply:r}=this.props,{elementValue:o,linkValue:a}=this.state,c=this.link;o.isNew||t.setTemporaryState(l.TemporaryState.deleteElement(t.temporaryState,o.value)),t.removeTemporaryCells([i,c]);const d=e.history.startBatch(o.isNew?"Create new entity":"Link to entity");o.isNew?(e.addElement(i),i.setExpanded(!0),t.setAuthoringState(l.AuthoringState.addElement(t.authoringState,i.data))):e.requestLinksOfType();const u=(0,s.makeLinkWithDirection)(new s.Link({sourceId:n.id,targetId:i.id,data:{...c.data,sourceId:n.iri,targetId:i.iri}}),a.value.link);t.createNewLink({link:u}),d.store(),r()}}},(e,t,n)=>{n.r(t),n.d(t,{ElementTypeSelector:()=>h,validateElementType:()=>p});var i=n(96),r=n(58),o=n(52),s=n(80),a=n(107),l=n(128),c=n(130),d=n(115);const u="reactodia-edit-form";class h extends r.Component{static contextType=d.WorkspaceContext;cancellation=new AbortController;filterCancellation=new AbortController;loadingItemCancellation=new AbortController;constructor(e,t){super(e,t),this.state={searchString:"",existingElements:[]}}componentDidMount(){this.fetchPossibleElementTypes()}componentDidUpdate(e,t){const{searchString:n}=this.state;n!==t.searchString&&this.searchExistingElements()}componentWillUnmount(){this.cancellation.abort(),this.filterCancellation.abort(),this.loadingItemCancellation.abort()}async fetchPossibleElementTypes(){const{model:e,editor:{metadataApi:t}}=this.context,{source:n}=this.props;if(!t)return;const i=await(0,o.mapAbortedToNull)(t.typesOfElementsDraggedFrom(n,this.cancellation.signal),this.cancellation.signal);null!==i&&(i.sort(function(e){return(t,n)=>{const i=e.createElementType(t),r=e.createElementType(n),o=e.locale.formatLabel(i.label,i.id),s=e.locale.formatLabel(r.label,r.id);return o.localeCompare(s)}}(e)),this.setState({elementTypes:i}))}searchExistingElements(){const{model:e}=this.context,{searchString:t}=this.state;if(this.setState({existingElements:[]}),t.length>0){this.setState({isLoading:!0}),this.filterCancellation.abort(),this.filterCancellation=new AbortController;const n=this.filterCancellation.signal,i=(0,l.createRequest)({text:t});e.dataProvider.lookup(i).then((e=>{if(n.aborted)return;const t=e.map((e=>e.element));this.setState({existingElements:t,isLoading:!1})}))}}onElementTypeChange=async e=>{this.setState({isLoading:!0}),this.loadingItemCancellation.abort(),this.loadingItemCancellation=new AbortController;const t=this.loadingItemCancellation.signal,{editor:{metadataApi:n}}=this.context,{onChange:i}=this.props,r=e.target.value,s=await(0,o.mapAbortedToNull)(n.generateNewElement([r],t),t);null!==s&&(this.setState({isLoading:!1}),i({value:s,isNew:!0,loading:!1}))};renderPossibleElementType=e=>{const{model:t}=this.context,n=t.createElementType(e),r=t.locale.formatLabel(n.label,n.id);return(0,i.jsx)("option",{value:e,children:r},e)};renderElementTypeSelector(){const{elementValue:e}=this.props,{elementTypes:t,isLoading:n}=this.state,r=e.value.types.length?e.value.types[0]:"";return n?(0,i.jsx)(a.HtmlSpinner,{width:20,height:20}):(0,i.jsxs)("div",{className:`${u}__control-row`,children:[(0,i.jsx)("label",{children:"Entity Type"}),t?(0,i.jsxs)("select",{className:"reactodia-form-control",name:"reactodia-element-type-selector-select",value:r,onChange:this.onElementTypeChange,children:[(0,i.jsx)("option",{value:s.PLACEHOLDER_ELEMENT_TYPE,disabled:!0,children:"Select entity type"}),t.map(this.renderPossibleElementType)]}):(0,i.jsx)("div",{children:(0,i.jsx)(a.HtmlSpinner,{width:20,height:20})}),e.error?(0,i.jsx)("span",{className:`${u}__control-error`,children:e.error}):""]})}renderExistingElementsList(){const{model:e,editor:t}=this.context,{elementValue:n}=this.props,{elementTypes:r,isLoading:o,existingElements:s}=this.state;return o?(0,i.jsx)(a.HtmlSpinner,{width:20,height:20}):s.length>0?s.map((o=>{const s=!t.temporaryState.elements.has(o.id)&&Boolean(e.elements.find((({iri:e,group:t})=>e===o.id&&void 0===t))),a=Boolean(r&&r.find((e=>o.types.indexOf(e)>=0)));return(0,i.jsx)(c.ListElementView,{element:o,disabled:s||!a,selected:o.id===n.value.id,onClick:(e,t)=>this.onSelectExistingItem(t)},o.id)})):(0,i.jsx)("span",{children:"No results"})}async onSelectExistingItem(e){const{model:t}=this.context,{onChange:n}=this.props;this.loadingItemCancellation.abort(),this.loadingItemCancellation=new AbortController;const i=this.loadingItemCancellation.signal;n({value:e,isNew:!1,loading:!0});const r=await t.dataProvider.elements({elementIds:[e.id]});if(i.aborted)return;n({value:r.get(e.id),isNew:!1,loading:!1})}render(){const{searchString:e}=this.state;return(0,i.jsxs)("div",{className:`${u}__form-row ${u}__element-selector`,children:[(0,i.jsxs)("div",{className:`${u}__search`,children:[(0,i.jsx)("span",{className:`${u}__search-icon`}),(0,i.jsx)("input",{className:`reactodia-form-control ${u}__search-input`,placeholder:"Search for...",name:"reactodia-element-type-selector-search",autoFocus:!0,value:e,onChange:e=>this.setState({searchString:e.target.value})})]}),e.length>0?(0,i.jsx)("div",{className:`${u}__existing-elements-list`,role:"listbox","aria-label":"Select an existing element to put on a diagram",children:this.renderExistingElementsList()}):(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:`${u}__separator`,children:(0,i.jsx)("i",{className:`${u}__separator-text`,children:"or create new entity"})}),this.renderElementTypeSelector()]})]})}}function p(e){const t=e.types.indexOf(s.PLACEHOLDER_ELEMENT_TYPE)<0?void 0:"Required.";return Promise.resolve({error:t,allowChange:!0})}},(e,t,n)=>{n.r(t),n.d(t,{InstancesSearch:()=>f,createRequest:()=>m});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(55),l=n(124),c=n(115),d=n(129);const u=n(20),h=n(21),p="reactodia-instances-search",g=100;class f extends r.Component{static contextType=c.WorkspaceContext;listener=new a.EventObserver;requestCancellation=new AbortController;currentRequest;constructor(e,t){super(e,t),this.state={criteria:{},resultId:0,selection:new Set}}componentDidMount(){const{commands:e}=this.props,{model:t,triggerWorkspaceEvent:n}=this.context;this.listener.listen(t.events,"changeLanguage",(()=>this.forceUpdate())),this.listener.listen(t.events,"loadingStart",(()=>{this.setState({criteria:{},inputText:void 0})})),this.listener.listen(e,"setCriteria",(({criteria:e})=>{n(c.WorkspaceEventKey.searchUpdateCriteria),this.setState({criteria:e,inputText:void 0})})),this.queryItems(!1)}componentDidUpdate(e,t){this.state.criteria!==t.criteria&&this.queryItems(!1)}componentWillUnmount(){this.listener.stopListening(),this.requestCancellation.abort(),this.currentRequest=void 0}render(){const e=`${p} ${this.props.className||""}`,t=this.state.querying?"loading":this.state.error?"error":this.state.items?"completed":"none",n=void 0===this.state.inputText?this.state.criteria.text:this.state.inputText;return(0,i.jsxs)("div",{className:e,children:[(0,i.jsx)(l.ProgressBar,{state:t,title:"Querying for elements"}),(0,i.jsxs)("div",{className:`${p}__criteria`,children:[this.renderCriteria(),(0,i.jsxs)("div",{className:`${p}__text-criteria reactodia-input-group`,children:[(0,i.jsx)("input",{type:"text",className:"reactodia-form-control",placeholder:"Search for...",name:"reactodia-instances-search-text",value:n||"",onChange:e=>this.setState({inputText:e.currentTarget.value}),onKeyUp:e=>{13===e.keyCode&&this.submitCriteriaUpdate()}}),(0,i.jsx)("span",{className:"reactodia-input-group-btn",children:(0,i.jsx)("button",{type:"button",title:"Search",className:s()(`${p}__search-button`,"reactodia-btn reactodia-btn-default"),onClick:()=>this.submitCriteriaUpdate()})})]})]}),(0,i.jsxs)("div",{className:`${p}__rest reactodia-scrollable`,children:[(0,i.jsx)(d.SearchResults,{items:this.state.items??[],highlightText:this.state.criteria.text,selection:this.state.selection,onSelectionChanged:this.onSelectionChanged}),(0,i.jsx)("div",{className:`${p}__rest-end`,children:(0,i.jsx)("button",{type:"button",className:`${p}__load-more reactodia-btn reactodia-btn-primary`,disabled:this.state.querying,style:{display:this.state.moreItemsAvailable?void 0:"none"},onClick:()=>this.queryItems(!0),children:"Show more"})})]},this.state.resultId)]})}onSelectionChanged=e=>{this.setState({selection:e})};renderCriteria(){const{model:e}=this.context,{criteria:t}=this.state,n=[];if(t.elementType){const r=t.elementType,o=e.locale.formatLabel(r.label,r.id);n.push((0,i.jsxs)("div",{className:`${p}__criterion`,children:[this.renderRemoveCriterionButtons((()=>this.setState({criteria:{...t,elementType:void 0}}))),"Has type ",(0,i.jsx)("span",{className:`${p}__criterion-class`,title:r.id,children:o})]},"hasType"))}else if(t.refElement){const r=t.refElement,o=e.locale.formatLabel(r.data.label,r.iri),s=t.refElementLink,a=s?e.locale.formatLabel(s.label,s.id):void 0;n.push((0,i.jsxs)("div",{className:`${p}__criterion`,children:[this.renderRemoveCriterionButtons((()=>this.setState({criteria:{...t,refElement:void 0,refElementLink:void 0}}))),"Connected to ",(0,i.jsx)("span",{className:`${p}__criterion-element`,title:r?r.iri:void 0,children:o}),s&&(0,i.jsxs)("span",{children:[" through ",(0,i.jsx)("span",{className:`${p}__criterion-link-type`,title:s?s.id:void 0,children:a}),"in"===t.linkDirection&&(0,i.jsxs)("span",{children:[" as ",(0,i.jsx)("img",{className:`${p}__link-direction`,src:u}),"\xa0source"]}),"out"===t.linkDirection&&(0,i.jsxs)("span",{children:[" as ",(0,i.jsx)("img",{className:`${p}__link-direction`,src:h}),"\xa0target"]})]})]},"hasLinkedElement"))}return(0,i.jsx)("div",{className:`${p}__criterions`,children:n})}renderRemoveCriterionButtons(e){return(0,i.jsx)("div",{className:`${p}__criterion-remove reactodia-btn-group reactodia-btn-group-xs`,children:(0,i.jsx)("button",{type:"button",title:"Remove criteria",className:s()(`${p}__criterion-remove-button`,"reactodia-btn reactodia-btn-default"),onClick:e})})}submitCriteriaUpdate(){this.setState((e=>{let t=void 0===this.state.inputText?e.criteria.text:e.inputText;return t=""===t?void 0:t,{criteria:{...e.criteria,text:t}}}))}queryItems(e){const{model:t,triggerWorkspaceEvent:n}=this.context;let i;if(this.requestCancellation.abort(),e){if(!this.currentRequest)throw new Error("Cannot request more items without initial request.");const{limit:e}=this.currentRequest;i={...this.currentRequest,limit:"number"==typeof e?e+g:e}}else i=m(this.state.criteria);if(!(i.text||i.elementTypeId||i.refElementId||i.refElementLinkId))return void this.setState({querying:!1,error:void 0,items:void 0,selection:new Set,moreItemsAvailable:!1});this.requestCancellation=new AbortController;const r=this.requestCancellation.signal;i={...i,signal:r},this.currentRequest=i,this.setState({querying:!0,error:void 0,moreItemsAvailable:!1}),t.dataProvider.lookup(i).then((e=>{r.aborted||(this.processFilterData(e),n(c.WorkspaceEventKey.searchQueryItem))})).catch((e=>{r.aborted||(console.error(e),this.setState({querying:!1,error:e}))}))}processFilterData(e){const t="number"==typeof this.currentRequest.limit&&this.currentRequest.limit>g,n=new Set;if(t)for(const o of this.state.items)n.add(o.id);const i=t?[...this.state.items]:[];for(const{element:o}of e)n.has(o.id)||i.push(o);const r="number"==typeof this.currentRequest.limit&&e.length>=this.currentRequest.limit;t?this.setState({querying:!1,items:i,error:void 0,moreItemsAvailable:r}):this.setState({querying:!1,resultId:this.state.resultId+1,items:i,selection:new Set,error:void 0,moreItemsAvailable:r})}}function m(e){const{text:t,elementType:n,refElement:i,refElementLink:r,linkDirection:o}=e;return{text:t,elementTypeId:n?n.id:void 0,refElementId:i?i.iri:void 0,refElementLinkId:r?r.id:void 0,linkDirection:o,limit:g}}},(e,t,n)=>{n.r(t),n.d(t,{SearchResults:()=>d});var i=n(96),r=n(58),o=n(55),s=n(76),a=n(115),l=n(130);const c=!0;class d extends r.Component{static contextType=a.WorkspaceContext;listener=new o.EventObserver;delayedChangeCells=new s.Debouncer;root;startSelection=0;endSelection=0;render(){const{items:e}=this.props;return(0,i.jsx)("ul",{ref:this.onRootMount,className:"reactodia-search-results",role:"listbox","aria-multiselectable":!0,"aria-label":"Select one or many elements",tabIndex:-1,onFocus:this.addKeyListener,onBlur:this.removeKeyListener,children:e.map(this.renderResultItem)})}onRootMount=e=>{this.root=e};renderResultItem=e=>{const{useDragAndDrop:t=c}=this.props,n=this.canBeSelected(e);return(0,i.jsx)(l.ListElementView,{element:e,highlightText:this.props.highlightText,disabled:!n,selected:this.props.selection.has(e.id),onClick:n?this.onItemClick:void 0,onDragStart:t?t=>{const{selection:n}=this.props,i=[];return n.forEach((e=>i.push(e))),n.has(e.id)||i.push(e.id),(0,l.startDragElements)(t,i)}:void 0},e.id)};componentDidMount(){const{model:e}=this.context;this.listener.listen(e.events,"changeCells",(()=>{this.delayedChangeCells.call(this.onChangeCells)}))}onChangeCells=()=>{const{model:e}=this.context,{items:t,selection:n}=this.props;if(0===n.size)t.length>0&&this.forceUpdate();else{const t=new Set(n);for(const i of e.elements)void 0===i.group&&n.has(i.iri)&&t.delete(i.iri);this.updateSelection(t)}};componentWillUnmount(){this.removeKeyListener(),this.listener.stopListening(),this.delayedChangeCells.dispose()}updateSelection(e){const{onSelectionChanged:t}=this.props;t(e)}addKeyListener=()=>{document.addEventListener("keydown",this.onKeyDown)};removeKeyListener=()=>{document.removeEventListener("keydown",this.onKeyDown)};onKeyDown=e=>{const{items:t}=this.props,n=38===e.keyCode||38===e.which,i=40===e.keyCode||40===e.which;if(n||i)if(e.shiftKey){n?this.endSelection=this.getNextIndex(this.endSelection,0):i&&(this.endSelection=this.getNextIndex(this.endSelection,1));const e=Math.min(this.startSelection,this.endSelection),t=Math.max(this.startSelection,this.endSelection),r=this.selectRange(e,t);this.updateSelection(r),this.focusOn(this.endSelection)}else{const e=Math.min(this.startSelection,this.endSelection),r=Math.max(this.startSelection,this.endSelection);n?this.startSelection=this.getNextIndex(e,0):i&&(this.startSelection=this.getNextIndex(r,1)),this.endSelection=this.startSelection;const o=t[this.startSelection],s=new Set;s.add(o.id),this.updateSelection(s),this.focusOn(this.startSelection)}e.preventDefault()};onItemClick=(e,t)=>{e.preventDefault();const{items:n,selection:i,onSelectionChanged:r}=this.props,o=(i.has(t.id),n.indexOf(t));let s;if(e.shiftKey&&-1!==this.startSelection){const e=Math.min(this.startSelection,o),t=Math.max(this.startSelection,o);s=this.selectRange(e,t)}else{this.endSelection=this.startSelection=o;e.ctrlKey||e.metaKey?(s=new Set(i),i.has(t.id)?s.delete(t.id):s.add(t.id)):(s=new Set,s.add(t.id))}r(s)};selectRange(e,t){const{items:n}=this.props,i=new Set;for(let r=e;r<=t;r++){const e=n[r];this.canBeSelected(e)&&i.add(e.id)}return i}getNextIndex(e,t){const{items:n}=this.props;if(0===n.length)return e;const i=0===t?-1:1;for(let r=1;r<n.length;r++){let t=e+r*i;if(t<0&&(t+=n.length),t>=n.length&&(t-=n.length),this.canBeSelected(n[t]))return t}return e}canBeSelected(e){const{model:t}=this.context,{useDragAndDrop:n=c}=this.props,i=t.elements.findIndex((t=>t.iri===e.id&&void 0===t.group))>=0;return!n||!i}focusOn(e){const t=this.root.parentElement,n=t.getBoundingClientRect(),i=this.root.children.item(e),r=i.getBoundingClientRect(),o=r.top-n.top,s=r.bottom-n.top;o<0?t.scrollTop+=o:s>n.height&&(t.scrollTop+=s-n.height),i.focus()}}},(e,t,n)=>{n.r(t),n.d(t,{ListElementView:()=>c,highlightSubstring:()=>h,startDragElements:()=>d});var i=n(96),r=n(106),o=n.n(r),s=n(131),a=n(115);const l="reactodia-list-element-view";function c(e){const{model:t,getElementTypeStyle:n}=(0,a.useWorkspace)(),{element:r,className:c,highlightText:d,disabled:u,selected:p,onClick:g,onDragStart:f}=e,{h:m,c:y,l:b}=(0,s.hcl)(n(r.types).color),x=p&&!u?(0,s.hcl)(m,y,1.2*b):(0,s.hcl)("white"),w=o()(l,u?`${l}--disabled`:void 0,c),v=t.locale.formatLabel(r.label,r.id);let k="";r.types.length>0&&(k=`\nClasses: ${t.locale.formatElementTypes(r.types).join(", ")}`);return(0,i.jsx)("li",{className:w,role:"option",draggable:!u&&Boolean(f),title:`${v} ${t.locale.formatIri(r.id)}${k}`,style:{background:(0,s.hcl)(m,y,b).toString()},onClick:e=>{!u&&g&&(e.persist(),g(e,r))},onDragStart:f,children:(0,i.jsx)("div",{className:`${l}__label`,style:{background:x.toString()},children:h(v,d)})})}function d(e,t){try{e.dataTransfer.setData("application/x-reactodia-elements",JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}return!1}const u={className:"reactodia-text-highlight"};function h(e,t,n=u){if(!t)return(0,i.jsx)("span",{children:e});const r=e.toLowerCase().indexOf(t.toLowerCase());if(r<0)return(0,i.jsx)("span",{children:e});const o=r+t.length,s=e.substring(0,r),a=e.substring(r,o),l=e.substring(o);return(0,i.jsxs)("span",{children:[s,(0,i.jsx)("span",{...n,children:a}),l]})}},e=>{e.exports=i},(e,t,n)=>{n.r(t),n.d(t,{RenameLinkForm:()=>a});var i=n(96),r=n(58),o=n(91);const s="reactodia-edit-form";class a extends r.Component{static contextType=o.CanvasContext;constructor(e,t){super(e,t);const n=this.computeLabel();this.state={label:n}}componentDidUpdate(e){if(this.props.link.typeId!==e.link.typeId){const e=this.computeLabel();this.setState({label:e})}}computeLabel(){const{link:e}=this.props,{canvas:t,model:n}=this.context,i=n.getLinkType(e.typeId),{editableLabel:r}=t.renderingState.createLinkTemplate(i);return r.getLabel(e)??n.locale.formatLabel(i.label,i.id)}render(){const{onFinish:e}=this.props,{label:t}=this.state;return(0,i.jsxs)("div",{className:s,children:[(0,i.jsx)("div",{className:`${s}__body`,children:(0,i.jsxs)("div",{className:`${s}__form-row`,children:[(0,i.jsx)("label",{children:"Link Label"}),(0,i.jsx)("input",{className:"reactodia-form-control",value:t,onChange:e=>this.setState({label:e.target.value})})]})}),(0,i.jsxs)("div",{className:`${s}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${s}__apply-button`,onClick:this.onApply,children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:e,children:"Cancel"})]})]})}onApply=()=>{const{link:e,onFinish:t}=this.props,{canvas:n,model:i}=this.context,{label:r}=this.state,o=i.getLinkType(e.typeId),{editableLabel:s}=n.renderingState.createLinkTemplate(o);s.setLabel(e,r),t()}}},(e,t,n)=>{n.r(t),n.d(t,{EditLayer:()=>m});var i=n(96),r=n(58),o=n(52),s=n(55),a=n(80),l=n(91),c=n(94),d=n(71),u=n(105),h=n(100),p=n(107),g=n(115),f=n(116);function m(e){const t=(0,g.useWorkspace)(),{canvas:n}=(0,l.useCanvas)();return(0,i.jsx)(y,{...e,workspace:t,canvas:n})}class y extends r.Component{listener=new s.EventObserver;cancellation=new AbortController;canDropOnElementCancellation=new AbortController;temporaryLink;temporaryElement;oldLink;constructor(e){super(e),this.state={}}componentDidMount(){const{mode:e,target:t,point:n}=this.props;if("establishLink"===e)this.beginCreatingLink({source:t,point:n});else{if("moveLinkSource"!==e&&"moveLinkTarget"!==e)throw new Error(`Unknown edit mode: "${e}"`);this.beginMovingLink(t,n)}this.forceUpdate(),this.queryCanLinkFrom(),this.queryCanDropOnCanvas(),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}componentWillUnmount(){this.listener.stopListening(),this.cancellation.abort(),this.canDropOnElementCancellation.abort(),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}beginCreatingLink(e){const{workspace:{model:t,editor:n}}=this.props,{source:i,point:r}=e,o=this.createTemporaryElement(r),s=new c.Link({sourceId:i.id,targetId:o.id,data:{linkTypeId:a.PLACEHOLDER_LINK_TYPE,sourceId:i.iri,targetId:o.iri,properties:{}}}),l=n.createNewLink({link:s,temporary:!0});t.createLinkType(l.typeId).setVisibility("withoutLabel"),this.temporaryElement=o,this.temporaryLink=l}beginMovingLink(e,t){const{mode:n,workspace:{model:i,editor:r}}=this.props;if("moveLinkSource"!==n&&"moveLinkTarget"!==n)throw new Error("Unexpected edit mode for moving link");this.oldLink=e,i.removeLink(e.id);const{id:o,sourceId:s,targetId:l,data:d,vertices:u,linkState:h}=e,p=this.createTemporaryElement(t),g=new c.Link({id:a.GenerateID.forLink(),sourceId:"moveLinkSource"===n?p.id:s,targetId:"moveLinkTarget"===n?p.id:l,data:{...d,sourceId:"moveLinkSource"===n?p.iri:d.sourceId,targetId:"moveLinkTarget"===n?p.iri:d.targetId},vertices:u,linkState:h}),f=r.createNewLink({link:g,temporary:!0});this.temporaryElement=p,this.temporaryLink=f}createTemporaryElement(e){const{workspace:{model:t}}=this.props,n=new c.Element({data:c.Element.placeholderData(""),temporary:!0});n.setPosition(e);const i=t.history.startBatch();return t.addElement(n),i.discard(),n}onMouseMove=e=>{const{workspace:{model:t},canvas:n}=this.props,{targetElement:i,waitingForMetadata:r}=this.state;if(e.preventDefault(),e.stopPropagation(),r)return;const o=n.metrics.pageToPaperCoords(e.pageX,e.pageY);this.temporaryElement.setPosition(o);const s=(0,d.findElementAtPoint)(t.elements,o,n.renderingState);s!==i&&this.queryCanDropOnElement(s),this.setState({targetElement:s})};queryCanLinkFrom(){const{workspace:{model:e,editor:t}}=this.props;if(!t.metadataApi)return void this.setState({canLinkFrom:!1});this.setState({canLinkFrom:void 0});const n=e.getElement(this.temporaryLink.sourceId);(0,o.mapAbortedToNull)(t.metadataApi.canLinkElement(n.data,this.cancellation.signal),this.cancellation.signal).then((e=>{null!==e&&this.setState({canLinkFrom:e})}),(e=>{console.error("Error calling canLinkElement:",e),this.setState({canLinkFrom:!1})}))}queryCanDropOnCanvas(){const{mode:e,workspace:{model:t,editor:n}}=this.props;if(!n.metadataApi||"establishLink"!==e)return void this.setState({canDropOnCanvas:!1});this.setState({canDropOnCanvas:void 0});const i=t.getElement(this.temporaryLink.sourceId);(0,o.mapAbortedToNull)(n.metadataApi.canDropOnCanvas(i.data,this.cancellation.signal),this.cancellation.signal).then((e=>{null!==e&&this.setState({canDropOnCanvas:e})}),(e=>{console.error("Error calling canDropOnCanvas:",e),this.setState({canDropOnCanvas:!1})}))}queryCanDropOnElement(e){const{mode:t,workspace:{model:n,editor:i}}=this.props;if(this.canDropOnElementCancellation.abort(),this.canDropOnElementCancellation=new AbortController,!i.metadataApi||!e)return void this.setState({canDropOnElement:!1});const r=i.authoringState.elements.get(e.iri);if(r&&r.deleted)return void this.setState({canDropOnElement:!1});let s,a;this.setState({canDropOnElement:void 0}),"establishLink"===t||"moveLinkTarget"===t?(s=n.getElement(this.temporaryLink.sourceId).data,a=e.data):"moveLinkSource"===t&&(s=e.data,a=n.getElement(this.temporaryLink.targetId).data);const l=this.canDropOnElementCancellation.signal;(0,o.mapAbortedToNull)(i.metadataApi.canDropOnElement(s,a,l),l).then((e=>{null!==e&&this.setState({canDropOnElement:e})}))}onMouseUp=e=>{const{canvas:t}=this.props;if(this.state.waitingForMetadata)return;this.setState({waitingForMetadata:!0});const n=t.metrics.pageToPaperCoords(e.pageX,e.pageY);this.executeEditOperation(n)};async executeEditOperation(e){const{mode:t,canvas:n,workspace:{model:i,editor:r,overlay:o}}=this.props;try{const{targetElement:s,canLinkFrom:a,canDropOnCanvas:l,canDropOnElement:c}=this.state;this.oldLink&&i.addLink(this.oldLink);if(a&&(s?c:l)){let a,l=s;switch(t){case"establishLink":{if(!l){const t=i.getElement(this.temporaryLink.sourceId);l=await this.createNewElement(t.data),l.setPosition(e),n.renderingState.syncUpdate(),function(e,t,n){const{width:i,height:r}=n.getElementSize(e)??{width:0,height:0};e.setPosition({x:t.x-i/2,y:t.y-r/2})}(l,e,n.renderingState)}const t=i.getElement(this.temporaryLink.sourceId);a=await this.createNewLink(t,l);break}case"moveLinkSource":a=r.moveLinkSource({link:this.oldLink,newSource:s});break;case"moveLinkTarget":a=r.moveLinkTarget({link:this.oldLink,newTarget:s});break;default:throw new Error("Unknown edit mode")}if(s){const e=a||this.oldLink;r.setSelection([e]),o.showEditLinkForm(e)}else if(l&&a){r.setSelection([l]);const e=i.getElement(a.sourceId);o.showFindOrCreateEntityForm({link:a,source:e,target:l,targetIsNew:!0})}}}finally{this.cleanupAndFinish()}}async createNewElement(e){const{workspace:{editor:t}}=this.props;if(!t.metadataApi)throw new Error("Cannot create new element without MetadataApi");const n=await t.metadataApi.typesOfElementsDraggedFrom(e,this.cancellation.signal),i=1===n.length?n[0]:a.PLACEHOLDER_ELEMENT_TYPE,r=await t.metadataApi.generateNewElement([i],this.cancellation.signal);return t.createNewEntity({elementModel:r,temporary:!0})}async createNewLink(e,t){const{workspace:{model:n,editor:i}}=this.props;if(!i.metadataApi)return;const r=await(0,o.mapAbortedToNull)(i.metadataApi.possibleLinkTypes(e.data,t.data,this.cancellation.signal),this.cancellation.signal);if(null===r)return;const s={linkTypeIri:a.PLACEHOLDER_LINK_TYPE,direction:"out"},{linkTypeIri:l,direction:d}=1===r.length?r[0]:s;let u={linkTypeId:l,sourceId:e.iri,targetId:t.iri,properties:{}},[h,p]=[e.id,t.id];"in"===d&&(u={...u,sourceId:t.iri,targetId:e.iri},[h,p]=[p,h]);const g=new c.Link({sourceId:h,targetId:p,data:u});return n.findLink(g.typeId,g.sourceId,g.targetId)||i.createNewLink({link:g,temporary:!0})}cleanupAndFinish(){const{onFinishEditing:e,workspace:{model:t,editor:n}}=this.props,i=t.history.startBatch();t.removeElement(this.temporaryElement.id),t.removeLink(this.temporaryLink.id),n.setTemporaryState(f.TemporaryState.deleteLink(n.temporaryState,this.temporaryLink.data)),i.discard(),e()}render(){const{workspace:{model:e},canvas:t}=this.props,{waitingForMetadata:n}=this.state;if(!this.temporaryLink)return null;const r=t.metrics.getTransform();return(0,i.jsxs)(h.TransformedSvgCanvas,{paperTransform:r,style:{overflow:"visible"},children:[(0,i.jsx)(u.LinkMarkers,{model:e,renderingState:t.renderingState}),this.renderHighlight(),this.renderCanDropIndicator(),n?null:(0,i.jsx)(u.LinkLayer,{model:e,renderingState:t.renderingState,links:[this.temporaryLink]})]})}renderHighlight(){const{canvas:e}=this.props,{targetElement:t,canLinkFrom:n,canDropOnElement:r,waitingForMetadata:o}=this.state;if(!t)return null;const{x:s,y:a,width:l,height:c}=(0,d.boundsOf)(t,e.renderingState);if(void 0===n||void 0===r||o)return(0,i.jsxs)("g",{transform:`translate(${s},${a})`,children:[(0,i.jsx)("rect",{width:l,height:c,fill:"white",fillOpacity:.5}),(0,i.jsx)(p.Spinner,{size:30,position:{x:l/2,y:c/2}})]});const u=n&&r?"#5cb85c":"#c9302c";return(0,i.jsx)("rect",{x:s,y:a,width:l,height:c,fill:"transparent",stroke:u,strokeWidth:3})}renderCanDropIndicator(){const{targetElement:e,canLinkFrom:t,canDropOnCanvas:n,waitingForMetadata:r}=this.state;if(e)return null;const{x:o,y:s}=this.temporaryElement.position;let a;return a=void 0===t||void 0===n?(0,i.jsx)(p.Spinner,{size:1.2,position:{x:.5,y:-.5}}):t&&n?(0,i.jsx)("path",{d:"M0.5,0 L0.5,-1 M0,-0.5 L1,-0.5",strokeWidth:.2,stroke:"#5cb85c"}):(0,i.jsxs)("g",{children:[(0,i.jsx)("circle",{cx:"0.5",cy:"-0.5",r:"0.5",fill:"none",strokeWidth:.2,stroke:"#c9302c"}),(0,i.jsx)("path",{d:"M0.5,0 L0.5,-1",strokeWidth:.2,stroke:"#c9302c",transform:"rotate(-45 0.5 -0.5)"})]}),(0,i.jsxs)("g",{transform:`translate(${o} ${s})scale(40)`,children:[(0,i.jsx)("rect",{x:-.5,y:-.5,width:1,height:1,fill:"rgba(0, 0, 0, 0.1)",rx:.25,ry:.25}),r?(0,i.jsx)(p.Spinner,{size:.8}):(0,i.jsx)("g",{transform:"translate(0.5, -0.5)scale(0.25)",children:a})]})}}},(e,t,n)=>{n.r(t),n.d(t,{ElementDecorator:()=>c});var i=n(96),r=n(58),o=n(55),s=n(91),a=n(107),l=n(115);function c(e){const{canvas:t}=(0,s.useCanvas)(),n=(0,l.useWorkspace)();return(0,i.jsx)(u,{...e,canvas:t,workspace:n})}const d="reactodia-authoring-state";class u extends r.Component{listener=new o.EventObserver;constructor(e){super(e);const{target:t,workspace:{editor:n}}=this.props;this.state={state:n.authoringState.elements.get(t.iri),validation:n.validationState.elements.get(t.iri),isTemporary:n.temporaryState.elements.has(t.iri)}}componentDidMount(){const{target:e,canvas:t,workspace:{editor:n}}=this.props;this.listener.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.forceUpdate()})),this.listener.listen(n.events,"changeAuthoringState",(t=>{const i=n.authoringState.elements.get(e.iri);i!==t.previous.elements.get(e.iri)&&this.setState({state:i})})),this.listener.listen(n.events,"changeValidationState",(t=>{const i=n.validationState.elements.get(e.iri);i!==t.previous.elements.get(e.iri)&&this.setState({validation:i})})),this.listener.listen(n.events,"changeTemporaryState",(t=>{const i=n.temporaryState.elements.has(e.iri);i!==t.previous.elements.has(e.iri)&&this.setState({isTemporary:i})})),this.listener.listen(e.events,"changeData",(t=>{t.previous.id!==e.iri&&this.setState({isTemporary:n.temporaryState.elements.has(e.iri),validation:n.validationState.elements.get(e.iri),state:n.authoringState.elements.get(e.iri)})}))}componentWillUnmount(){this.listener.stopListening()}shouldComponentUpdate(e,t){return this.state.state!==t.state||this.state.validation!==t.validation||this.state.isTemporary!==t.isTemporary||this.props.position!==e.position}renderElementOutlines(){const{target:e,canvas:t}=this.props,{state:n,isTemporary:r}=this.state,{width:o,height:s}=t.renderingState.getElementSize(e)??{width:0,height:0};if(r)return[(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"rgba(255, 255, 255, 0.5)"},`${e.id}-opacity`),(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"url(#stripe-pattern)"},`${e.id}-stripes`)];if(n&&n.deleted){const t=o,n=s;return(0,i.jsxs)("g",{children:[(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"white",fillOpacity:.5}),(0,i.jsx)("line",{x1:0,y1:0,x2:t,y2:n,stroke:"red"}),(0,i.jsx)("line",{x1:t,y1:0,x2:0,y2:n,stroke:"red"})]},e.id)}return null}renderErrorIcon(e,t){return(0,i.jsxs)("div",{className:`${d}__item-error`,title:e,children:[t.loading?(0,i.jsx)(a.HtmlSpinner,{width:15,height:17}):(0,i.jsx)("div",{className:`${d}__item-error-icon`}),!t.loading&&t.errors.length>0?t.errors.length:void 0]})}renderElementErrors(){const{workspace:{model:e}}=this.props,{validation:t}=this.state;if(!t)return null;const n=t.errors.map((t=>{if(t.propertyType){const{id:n,label:i}=e.createPropertyType(t.propertyType);return`${e.locale.formatLabel(i,n)}: ${t.message}`}return t.message})).join("\n");return this.renderErrorIcon(n,t)}renderElementState(){const{target:e,workspace:{editor:t}}=this.props,{state:n}=this.state;if(n){const r=()=>t.discardChange(n);let o,s,a;n.deleted?(s="Delete",a="Revert deletion of the element"):n.before?(s="Change",a="Revert all changes in properties of the element"):(s="New",a="Revert creation of the element"),s&&a&&(o=(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:`${d}__state-label`,children:s}),"[",(0,i.jsx)("span",{className:`${d}__state-cancel`,onClick:r,title:a,children:"cancel"}),"]"]}));const l=this.renderElementErrors();if(o||l)return(0,i.jsx)("div",{className:`${d}__state-indicator`,style:{left:0,top:0},children:(0,i.jsx)("div",{className:`${d}__state-indicator-container`,children:(0,i.jsxs)("div",{className:`${d}__state-indicator-body`,children:[o,l]})})},e.id)}return null}render(){const{target:e,canvas:t}=this.props,{position:n}=e,r=t.renderingState.getElementSize(e)??{width:0,height:0},o=`translate(${n.x}px,${n.y}px)`,s=this.renderElementOutlines(),a=this.renderElementState();return s||a?(0,i.jsxs)("div",{style:{position:"absolute",transform:o},children:[s?(0,i.jsxs)("svg",{width:r.width,height:r.height,style:{position:"absolute",pointerEvents:"none",overflow:"visible"},children:[(0,i.jsx)("defs",{children:(0,i.jsx)("pattern",{id:"stripe-pattern",patternUnits:"userSpaceOnUse",width:13,height:13,patternTransform:"rotate(45)",children:(0,i.jsx)("line",{x1:0,y:0,x2:0,y2:13,stroke:"#ddd",strokeWidth:10,strokeOpacity:.2})})}),this.renderElementOutlines()]}):null,a]}):null}}},(e,t,n)=>{n.r(t),n.d(t,{LinkStateWidget:()=>g});var i=n(96),r=n(58),o=n(55),s=n(76),a=n(91),l=n(71),c=n(100),d=n(103),u=n(107),h=n(115),p=n(116);function g(e){const t=(0,h.useWorkspace)(),{canvas:n}=(0,a.useCanvas)();return(0,i.jsx)(y,{...e,workspace:t,canvas:n})}const f="reactodia-authoring-state",m=5;class y extends r.Component{listener=new o.EventObserver;delayedUpdate=new s.Debouncer;componentDidMount(){this.listenEvents()}componentWillUnmount(){this.listener.stopListening()}listenEvents(){const{workspace:{model:e,editor:t},canvas:n}=this.props;this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&this.scheduleUpdate()})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{e.changeVertices&&this.scheduleUpdate()})),this.listener.listen(e.events,"changeCells",this.scheduleUpdate),this.listener.listen(t.events,"changeAuthoringState",this.scheduleUpdate),this.listener.listen(t.events,"changeTemporaryState",this.scheduleUpdate),this.listener.listen(t.events,"changeValidationState",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"changeElementSize",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"changeLinkLabelBounds",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"syncUpdate",(({layer:e})=>{e===d.RenderingLayer.Editor&&this.delayedUpdate.runSynchronously()}))}scheduleUpdate=()=>{this.delayedUpdate.call(this.performUpdate)};performUpdate=()=>{this.forceUpdate()};calculateLinkPath(e){const t=this.calculatePolyline(e);return(0,l.pathFromPolyline)(t)}calculatePolyline(e){const{workspace:{model:t},canvas:n}=this.props,i=t.getElement(e.sourceId),r=t.getElement(e.targetId),o=n.renderingState.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s;return(0,l.computePolyline)((0,l.boundsOf)(i,n.renderingState),(0,l.boundsOf)(r,n.renderingState),a)}renderLinkStateLabels(){const{workspace:{model:e,editor:t}}=this.props,n=[];for(const r of e.links){let e=null;const o=t.authoringState.links.get(r.data);if(o){const n=()=>t.discardChange(o);let r,s;o.deleted?(r="Delete",s="Revert deletion of the link"):o.before?(r="Change",s="Revert all changes in properties of the link"):(r="New",s="Revert creation of the link"),r&&s&&(e=(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:`${f}__state-label`,children:r}),"[",(0,i.jsx)("span",{className:`${f}__state-cancel`,onClick:n,title:s,children:"cancel"}),"]"]}))}const s=this.renderLinkErrors(r.data);if(e||s){const t=this.getLinkStateLabelPosition(r);if(t){const o={left:t.x,top:t.y};n.push((0,i.jsx)("div",{className:`${f}__state-indicator`,style:o,children:(0,i.jsx)("div",{className:`${f}__state-indicator-container`,children:(0,i.jsxs)("div",{className:`${f}__state-indicator-body`,children:[e,s]})})},r.id))}}}return n}renderLinkStateHighlighting(){const{workspace:{model:e,editor:t}}=this.props,n=[];for(const r of e.links)if(t.temporaryState.links.has(r.data)){const e=this.calculateLinkPath(r);n.push((0,i.jsx)("path",{d:e,fill:"none",stroke:"grey",strokeWidth:5,strokeOpacity:.5,strokeDasharray:"8 8"},r.id))}else{const e=t.authoringState.links.get(r.data),o=p.AuthoringState.isDeletedLink(t.authoringState,r.data),s=p.AuthoringState.isUncertainLink(t.authoringState,r.data);if(e||o||s){const t=this.calculateLinkPath(r);let a;o?a="red":s?a="blue":e&&e.type===p.AuthoringKind.ChangeLink&&(a=e.before?"blue":"green"),n.push((0,i.jsx)("path",{d:t,fill:"none",stroke:a,strokeWidth:5,strokeOpacity:.5},r.id))}}return n}getLinkStateLabelPosition(e){const{canvas:t,linkLabelMargin:n=m}=this.props,i=t.renderingState.getLinkLabelBounds(e);if(i){const{x:e,y:t}=i;return{x:e,y:t-n/2}}{const t=this.calculatePolyline(e),n=(0,l.computePolylineLength)(t);return(0,l.getPointAlongPolyline)(t,n/2)}}renderLinkErrors(e){const{workspace:{editor:t}}=this.props,{validationState:n}=t,i=n.links.get(e);if(!i)return null;const r=i.errors.map((e=>e.message)).join("\n");return this.renderErrorIcon(r,i)}renderErrorIcon(e,t){return(0,i.jsxs)("div",{className:`${f}__item-error`,title:e,children:[t.loading?(0,i.jsx)(u.HtmlSpinner,{width:15,height:17}):(0,i.jsx)("div",{className:`${f}__item-error-icon`}),!t.loading&&t.errors.length>0?t.errors.length:void 0]})}render(){const{workspace:{editor:e},canvas:t}=this.props,n=t.metrics.getTransform(),{scale:r,originX:o,originY:s}=n;if(!e.inAuthoringMode)return null;const a={position:"absolute",left:0,top:0,transform:`scale(${r},${r})translate(${o}px,${s}px)`};return(0,i.jsxs)("div",{className:`${f}`,children:[(0,i.jsx)(c.TransformedSvgCanvas,{paperTransform:n,style:{overflow:"visible",pointerEvents:"none"},children:this.renderLinkStateHighlighting()}),(0,i.jsx)("div",{className:`${f}__validation-layer`,style:a,children:this.renderLinkStateLabels()})]})}}},(e,t,n)=>{n.r(t),n.d(t,{WithFetchStatus:()=>c});var i,r=n(58),o=n(106),s=n.n(o),a=n(115);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.Error=2]="Error"}(i||(i={}));const l="reactodia-fetch-status";function c(e){const{type:t,target:n,children:o}=e,{model:c}=(0,a.useWorkspace)(),[u,h]=r.useState(i.None);return r.useEffect((()=>{const e=e=>{h((r=>{if(r===i.Error)return i.Error;if(e&&d(e.operation,t,n))return i.Error;{let e;for(const i of c.operations)if(d(i,t,n)){e=i;break}return e?i.Loading:i.None}}))};e();const r=t=>{e(t.fail)};return c.events.on("changeOperations",r),()=>c.events.off("changeOperations",r)}),[t,n]),u===i.None?o:r.cloneElement(o,{className:s()(o.props.className,u===i.Loading?`${l}--loading`:u===i.Error?`${l}--error`:void 0)})}function d(e,t,n){return e.type===t&&e.targets.has(n)}},(e,t,n)=>{n.r(t),n.d(t,{ClassicTemplate:()=>c});var i=n(96),r=n(106),o=n.n(r),s=n(136),a=n(115);const l="reactodia-classic-template";function c(e){const{data:t,isExpanded:n}=e,{model:r,getElementTypeStyle:c}=(0,a.useWorkspace)(),{color:u,icon:h}=c(t.types),p=t.types.length>0?r.locale.formatElementTypes(t.types).join(", "):"Thing",g=r.locale.formatLabel(t.label,t.id),f=r.locale.formatPropertyList(t.properties),m=t.image?(0,i.jsx)("div",{className:`${l}__thumbnail`,children:(0,i.jsx)("img",{className:`${l}__thumbnail-image`,src:t.image})}):void 0,y=n?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:`${l}__expander`,children:[(0,i.jsx)("div",{className:`${l}__iri-heading`,children:"IRI:"}),(0,i.jsx)("div",{className:`${l}__iri-container`,children:(0,i.jsx)("a",{className:`${l}__iri`,title:t.id,href:t.id,children:t.id})})]}),(0,i.jsx)("hr",{className:`${l}__divider`}),d(f)]}):null;return(0,i.jsxs)("div",{className:o()(l,n?`${l}--expanded`:`${l}--collapsed`),style:{backgroundColor:u,borderColor:u},"data-expanded":n,children:[(0,i.jsxs)("div",{className:`${l}__type-line`,title:g,children:[(0,i.jsx)("div",{className:`${l}__type-line-icon`,"aria-hidden":"true",children:(0,i.jsx)("img",{src:h})}),(0,i.jsx)("div",{title:p,className:`${l}__type-line-text-container`,children:(0,i.jsx)("div",{className:`${l}__type-line-text`,children:p})})]}),m,(0,i.jsxs)("div",{className:`${l}__body`,style:{borderColor:u},children:[(0,i.jsx)(s.WithFetchStatus,{type:"element",target:t.id,children:(0,i.jsx)("span",{className:`${l}__label`,title:g,children:g})}),y]})]})}function d(e){return e.length>0?(0,i.jsx)("div",{className:`${l}__property-table`,children:e.map((({propertyId:e,label:t,values:n})=>{const r=n.map(((e,t)=>(0,i.jsx)("div",{className:`${l}__property-value`,title:e.value,children:e.value},t)));return(0,i.jsxs)("div",{className:`${l}__property-row`,children:[(0,i.jsx)(s.WithFetchStatus,{type:"propertyType",target:e,children:(0,i.jsx)("div",{className:`${l}__property-label`,title:`${t} (${e})`,children:t})}),(0,i.jsx)("div",{className:`${l}__property-values`,children:r})]},e)}))}):(0,i.jsx)("div",{children:"no properties"})}},(e,t,n)=>{n.r(t),n.d(t,{DefaultLinkPathTemplate:()=>u,DefaultLinkTemplate:()=>c});var i=n(96),r=n(106),o=n.n(r),s=n(91),a=n(105),l=n(136);const c={markerTarget:{d:"M0,0 L0,8 L9,4 z",width:9,height:8,fill:"black"},renderLink:e=>(0,i.jsx)(u,{...e})},d="reactodia-default-link";function u(e){const{link:t,linkType:n,className:r,path:c,pathProps:u,getPathPosition:h,route:p,editableLabel:g,primaryLabelProps:f,propertyLabelProps:m,propertyLabelStartLine:y=1,prependLabels:b=null}=e,{model:x}=(0,s.useCanvas)(),w=g?.getLabel(t);let v=null;if("visible"===n.visibility){const e=`${d}__label-text`,r=`${d}__label-background`,s=w??x.locale.formatLabel(n.label,n.id),c=x.locale.formatPropertyList(t.data.properties);v=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.LinkLabel,{...f,primary:!0,link:t,position:h(.5),textAnchor:p?.labelTextAnchor??f?.textAnchor,textClass:o()(e,f?.textClass),rectClass:o()(r,f?.rectClass),title:f?.title??`${s} ${x.locale.formatIri(n.id)}`,content:w?s:(0,i.jsx)(l.WithFetchStatus,{type:"linkType",target:n.id,children:(0,i.jsx)("tspan",{children:s})})}),b,c.map(((n,s)=>(0,i.jsx)(a.LinkLabel,{...m,link:t,position:h(.5),line:y+s,textAnchor:p?.labelTextAnchor??m?.textAnchor,textClass:o()(e,m?.textClass),rectClass:o()(r,m?.rectClass),title:m?.title??`${n.label} ${x.locale.formatIri(n.propertyId)}`,content:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.WithFetchStatus,{type:"propertyType",target:n.propertyId,children:(0,i.jsxs)("tspan",{children:[n.label,":\xa0"]})}),n.values.map((e=>e.value)).join(", ")]})},n.propertyId)))]})}const k=u?.stroke??"black";return(0,i.jsxs)("g",{className:o()(d,w?`${d}--renamed`:void 0,r),children:[(0,i.jsx)(a.LinkPath,{linkType:n,path:c,pathProps:{fill:"none",...u,className:o()(`${d}__path`,u?.className),stroke:k,strokeDasharray:t.layoutOnly?"5,5":u?.strokeDasharray}}),v,0===t.vertices.length?null:(0,i.jsx)(a.LinkVertices,{linkId:t.id,vertices:t.vertices,fill:k})]})}},(e,t,n)=>{n.r(t),n.d(t,{GroupTemplate:()=>l});var i=n(96),r=n(95),o=n(136),s=n(115);const a="reactodia-group-template";function l(e){const{elementId:t,data:n,isExpanded:l}=e,{model:c,getElementTypeStyle:d}=(0,s.useWorkspace)(),{color:u,icon:h}=d(n.types),p=n.types.length>0?c.locale.formatElementTypes(n.types).join(", "):"Thing",g=c.locale.formatLabel(n.label,n.id);return(0,i.jsx)("div",{className:a,children:(0,i.jsxs)("div",{className:`${a}__wrap`,style:{backgroundColor:u,borderColor:u},children:[(0,i.jsxs)("div",{className:`${a}__type-line`,title:g,children:[(0,i.jsx)("div",{className:`${a}__type-line-icon`,children:(0,i.jsx)("img",{src:h})}),(0,i.jsx)("div",{title:p,className:`${a}__type-line-text-container`,children:(0,i.jsx)("div",{className:`${a}__type-line-text`,children:p})})]}),(0,i.jsxs)("div",{className:`${a}__body`,style:{borderColor:u},children:[(0,i.jsx)(o.WithFetchStatus,{type:"element",target:n.id,children:(0,i.jsx)("span",{className:`${a}__label`,title:g,children:g})}),l?(0,i.jsx)("div",{className:`${a}__embedded-layer`,children:(0,i.jsx)(r.EmbeddedLayer,{elementId:t})}):null]})]})})}},(e,t,n)=>{n.r(t),n.d(t,{StandardTemplate:()=>g});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(66),l=n(80),c=n(107),d=n(114),u=n(116),h=n(136),p=n(115);function g(e){const t=(0,p.useWorkspace)(),n=(0,d.useAuthoredEntity)(e.elementId,e.data,e.isExpanded);return(0,i.jsx)(y,{...e,workspace:t,entityContext:n})}const f="reactodia-standard-template",m="http://xmlns.com/foaf/0.1/name";class y extends r.Component{render(){const{data:e,isExpanded:t,workspace:{model:n,editor:r,getElementTypeStyle:o}}=this.props,{color:s,icon:a}=o(e.types),l=u.AuthoringState.isNewElement(r.authoringState,e.id)?"white":s,c=this.findPinnedProperties()??{},d=e.types.length>0?n.locale.formatElementTypes(e.types).join(", "):"Thing",p=this.formatLabel(),g=n.locale.formatPropertyList(e.properties),m=g.filter((e=>Boolean(Object.prototype.hasOwnProperty.call(c,e.propertyId)&&c[e.propertyId])));return(0,i.jsxs)("div",{className:f,children:[(0,i.jsx)("div",{className:`${f}__main`,style:{backgroundColor:l,borderColor:s},children:(0,i.jsxs)("div",{className:`${f}__body`,style:{borderLeftColor:s},children:[(0,i.jsxs)("div",{className:`${f}__body-horizontal`,children:[this.renderThumbnail(d,s,a),(0,i.jsxs)("div",{className:`${f}__body-content`,children:[(0,i.jsx)("div",{title:d,className:`${f}__type`,children:(0,i.jsx)("div",{className:`${f}__type-value`,children:this.renderTypes()})}),(0,i.jsx)(h.WithFetchStatus,{type:"element",target:e.id,children:(0,i.jsx)("div",{className:`${f}__label`,title:p,children:p})})]})]}),m.length>0?(0,i.jsx)("div",{className:`${f}__pinned-props`,style:{borderColor:s},children:this.renderProperties(m)}):null]})}),t?(0,i.jsxs)("div",{className:`${f}__dropdown`,style:{borderColor:s},children:[this.renderImage(s),(0,i.jsxs)("div",{className:`${f}__dropdown-content`,children:[this.renderIri(),this.renderProperties(g),r.inAuthoringMode?(0,i.jsx)("hr",{className:`${f}__hr`}):null,r.inAuthoringMode?this.renderActions():null]})]}):null]})}formatLabel(){const{data:e,workspace:{model:t}}=this.props,n=Object.prototype.hasOwnProperty.call(e.properties,m)?e.properties[m]:void 0;if(n){const i=n.filter((e=>"Literal"===e.termType));if(i.length>0)return t.locale.formatLabel(i,e.id)}return t.locale.formatLabel(e.label,e.id)}renderTypes(){const{data:e,workspace:{model:t}}=this.props;return 0===e.types.length?"Thing":e.types.map(((e,n)=>{const o=t.getElementType(e),s=t.locale.formatLabel(o?o.label:[],e);return(0,i.jsxs)(r.Fragment,{children:[0===n?null:", ",(0,i.jsx)(h.WithFetchStatus,{type:"elementType",target:e,children:(0,i.jsx)("span",{children:s})})]},e)}))}findPinnedProperties(){const{isExpanded:e,elementState:t}=this.props;if(e||!t)return;return t[l.TemplateProperties.PinnedProperties]}renderProperties(e){return e.length?(0,i.jsx)("div",{role:"list",className:`${f}__properties`,children:e.map((({propertyId:e,label:t,values:n})=>(0,i.jsxs)("div",{role:"listitem",className:`${f}__properties-row`,children:[(0,i.jsx)(h.WithFetchStatus,{type:"propertyType",target:e,children:(0,i.jsx)("div",{className:`${f}__properties-key`,title:`${t} (${e})`,children:t})}),(0,i.jsx)("div",{className:`${f}__properties-values`,children:n.map(((e,t)=>(0,i.jsx)("div",{className:`${f}__properties-value`,title:e.value,lang:"Literal"===e.termType&&e.language?e.language:void 0,children:e.value},t)))})]},e)))}):(0,i.jsx)("div",{children:"no properties"})}renderImage(e){const{data:t}=this.props;return t.image?(0,i.jsx)("div",{className:`${f}__photo`,style:{borderColor:e},children:(0,i.jsx)("img",{src:t.image,className:`${f}__photo-image`})}):null}renderIri(){const{data:e,entityContext:t}=this.props,n=void 0===t.editedIri?e.id:t.editedIri;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:`${f}__iri`,children:[(0,i.jsxs)("div",{className:`${f}__iri-key`,children:["IRI",t.editedIri?"\xa0(edited)":"",":"]}),(0,i.jsx)("div",{className:`${f}__iri-value`,children:(0,a.isEncodedBlank)(n)?(0,i.jsx)("span",{children:"(blank node)"}):(0,i.jsx)("a",{href:n,title:n,"data-iri-click-intent":"openEntityIri",children:n})})]}),(0,i.jsx)("hr",{className:`${f}__hr`})]})}renderThumbnail(e,t,n){const{data:r}=this.props;return r.image?(0,i.jsx)("div",{className:`${f}__thumbnail`,"aria-hidden":"true",children:(0,i.jsx)("img",{src:r.image,className:`${f}__thumbnail-image`})}):n?(0,i.jsx)("div",{className:`${f}__thumbnail`,"aria-hidden":"true",children:(0,i.jsx)("img",{src:n,className:`${f}__thumbnail-icon`})}):(0,i.jsx)("div",{className:`${f}__thumbnail`,"aria-hidden":"true",style:{color:t},children:e.length>0?e.charAt(0).toUpperCase():"\u2733"})}renderActions(){const{entityContext:e}=this.props,{canEdit:t,canDelete:n,onEdit:r,onDelete:o}=e;return(0,i.jsxs)("div",{className:`${f}__actions`,children:[(0,i.jsx)("button",{type:"button",className:s()(`${f}__delete-button`,"reactodia-btn reactodia-btn-default"),title:n?"Delete entity":"Deletion is unavailable for the selected element",disabled:!n,onClick:o,children:void 0===t?(0,i.jsx)(c.HtmlSpinner,{width:15,height:12}):"Delete"}),(0,i.jsx)("button",{type:"button",className:s()(`${f}__edit-button`,"reactodia-btn reactodia-btn-default"),title:t?"Edit entity":"Editing is unavailable for the selected element",disabled:!t,onClick:r,children:void 0===t?(0,i.jsx)(c.HtmlSpinner,{width:15,height:12}):"Edit"})]})}}},(e,t,n)=>{n.r(t),n.d(t,{SemanticTypeStyles:()=>h});const i=n(142),r=n(143),o=n(144),s=n(145),a=n(146),l=n(147),c=n(148),d=n(149),u=n(150),h=e=>-1!==e.indexOf("http://www.w3.org/2002/07/owl#Class")||-1!==e.indexOf("http://www.w3.org/2000/01/rdf-schema#Class")?{color:"#eaac77",icon:i}:-1!==e.indexOf("http://www.w3.org/2002/07/owl#ObjectProperty")?{color:"#34c7f3",icon:r}:-1!==e.indexOf("http://www.w3.org/2002/07/owl#DatatypeProperty")?{color:"#34c7f3",icon:o}:-1!==e.indexOf("http://xmlns.com/foaf/0.1/Person")||-1!==e.indexOf("http://www.wikidata.org/entity/Q5")?{color:"#eb7777",icon:s}:-1!==e.indexOf("http://www.wikidata.org/entity/Q6256")?{color:"#77ca98",icon:a}:-1!==e.indexOf("http://schema.org/Organization")||-1!==e.indexOf("http://dbpedia.org/ontology/Organisation")||-1!==e.indexOf("http://xmlns.com/foaf/0.1/Organization")||-1!==e.indexOf("http://www.wikidata.org/entity/Q43229")?{color:"#77ca98",icon:l}:-1!==e.indexOf("http://www.wikidata.org/entity/Q618123")?{color:"#bebc71",icon:c}:-1!==e.indexOf("http://www.wikidata.org/entity/Q1190554")?{color:"#b4b1fb",icon:d}:-1!==e.indexOf("http://www.wikidata.org/entity/Q488383")?{color:"#53ccb2",icon:u}:void 0},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMyIgeT0iMjIiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjZWFhYzc3Ig0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDI2cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIEMNCiAgICA8L3RleHQ+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMCIgeT0iMjAiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjMzRjN2YzIg0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIE9QDQogICAgPC90ZXh0Pg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMCIgeT0iMjAiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjMzRjN2YzIg0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIERQDQogICAgPC90ZXh0Pg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzNTAgMzUwIj4NCgk8cGF0aCBmaWxsPSIjZWI3Nzc3IiBkPSJNMTc1LDE3MS4xNzNjMzguOTE0LDAsNzAuNDYzLTM4LjMxOCw3MC40NjMtODUuNTg2QzI0NS40NjMsMzguMzE4LDIzNS4xMDUsMCwxNzUsMHMtNzAuNDY1LDM4LjMxOC03MC40NjUsODUuNTg3DQoJCUMxMDQuNTM1LDEzMi44NTUsMTM2LjA4NCwxNzEuMTczLDE3NSwxNzEuMTczeiIvPg0KCTxwYXRoIGZpbGw9IiNlYjc3NzciIGQ9Ik00MS45MDksMzAxLjg1M0M0MS44OTcsMjk4Ljk3MSw0MS44ODUsMzAxLjA0MSw0MS45MDksMzAxLjg1M0w0MS45MDksMzAxLjg1M3oiLz4NCgk8cGF0aCBmaWxsPSIjZWI3Nzc3IiBkPSJNMzA4LjA4NSwzMDQuMTA0QzMwOC4xMjMsMzAzLjMxNSwzMDguMDk4LDI5OC42MywzMDguMDg1LDMwNC4xMDRMMzA4LjA4NSwzMDQuMTA0eiIvPg0KCTxwYXRoIGZpbGw9IiNlYjc3NzciIGQ9Ik0zMDcuOTM1LDI5OC4zOTdjLTEuMzA1LTgyLjM0Mi0xMi4wNTktMTA1LjgwNS05NC4zNTItMTIwLjY1N2MwLDAtMTEuNTg0LDE0Ljc2MS0zOC41ODQsMTQuNzYxDQoJCXMtMzguNTg2LTE0Ljc2MS0zOC41ODYtMTQuNzYxYy04MS4zOTUsMTQuNjktOTIuODAzLDM3LjgwNS05NC4zMDMsMTE3Ljk4MmMtMC4xMjMsNi41NDctMC4xOCw2Ljg5MS0wLjIwMiw2LjEzMQ0KCQljMC4wMDUsMS40MjQsMC4wMTEsNC4wNTgsMC4wMTEsOC42NTFjMCwwLDE5LjU5MiwzOS40OTYsMTMzLjA4LDM5LjQ5NmMxMTMuNDg2LDAsMTMzLjA4LTM5LjQ5NiwxMzMuMDgtMzkuNDk2DQoJCWMwLTIuOTUxLDAuMDAyLTUuMDAzLDAuMDA1LTYuMzk5QzMwOC4wNjIsMzA0LjU3NSwzMDguMDE4LDMwMy42NjQsMzA3LjkzNSwyOTguMzk3eiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj4NCiAgICA8cGF0aCBmaWxsPSIjNzdjYTk4IiBkPSJNNDcyLjkyOCwzNC43NTJjLTQuNDE2LTMuMDA4LTEwLjAxNi0zLjU1Mi0xNC45NDQtMS42Yy0xLjAyNCwwLjQxNi0xMDYuODgsNDIuMDQ4LTE5NS4xNjgsMC4zODQNCgkJCUMxODYuNzItMi40MzIsMTAyLjkxMiwxNC40LDY0LDI1Ljc2VjE2YzAtOC44MzItNy4xNjgtMTYtMTYtMTZjLTguODMyLDAtMTYsNy4xNjgtMTYsMTZ2MzJ2MjU2djE5MmMwLDguODMyLDcuMTY4LDE2LDE2LDE2DQoJCQljOC44MzIsMCwxNi03LjE2OCwxNi0xNlYzMTUuMzI4YzI4LjM4NC05LjE4NCwxMTIuNjA4LTMxLjEzNiwxODUuMTg0LDMuMTM2YzM0LjU5MiwxNi4zNTIsNzAuNzg0LDIxLjc5MiwxMDMuNjQ4LDIxLjc5Mg0KCQkJYzYzLjIsMCwxMTQuMDE2LTIwLjEyOCwxMTcuMTg0LTIxLjQwOGM2LjAxNi0yLjQ2NCw5Ljk4NC04LjMyLDkuOTg0LTE0Ljg0OFY0OEM0ODAsNDIuNjg4LDQ3Ny4zNDQsMzcuNzI4LDQ3Mi45MjgsMzQuNzUyeiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj4NCiAgICA8cGF0aCBmaWxsPSIjNzdjYTk4IiBkPSJNMTU1LDBIMTVDNi43MTYsMCwwLDYuNzE2LDAsMTV2MzVoMTcwVjE1QzE3MCw2LjcxNiwxNjMuMjg0LDAsMTU1LDB6Ii8+DQogICAgPHBhdGggZmlsbD0iIzc3Y2E5OCIgZD0iTTUwNC40NjQsMTQyLjk4OWMtNC42NjItMi42NzQtMTAuMzk3LTIuNjUxLTE1LjAzNiwwLjA2M0wzNDEsMjI5Ljg1MlYxNTZjMC01LjM3NC0yLjg3NS0xMC4zMzctNy41MzYtMTMuMDExDQoJCQljLTQuNjYyLTIuNjc0LTEwLjM5Ny0yLjY1MS0xNS4wMzYsMC4wNjNMMTcwLDIyOS44NTJWODBIMHY0MTdjMCw4LjI4NCw2LjcxNiwxNSwxNSwxNWg0ODJjOC4yODQsMCwxNS02LjcxNiwxNS0xNVYxNTYNCgkJCUM1MTIsMTUwLjYyNiw1MDkuMTI1LDE0NS42NjMsNTA0LjQ2NCwxNDIuOTg5eiBNMjMwLDQwNi41YzAsOC4yODQtNi43MTYsMTUtMTUsMTVoLTYwYy04LjI4NCwwLTE1LTYuNzE2LTE1LTE1di02MA0KCQkJYzAtOC4yODQsNi43MTYtMTUsMTUtMTVoNjBjOC4yODQsMCwxNSw2LjcxNiwxNSwxNVY0MDYuNXogTTQwMSw0MDYuNWMwLDguMjg0LTYuNzE2LDE1LTE1LDE1aC02MGMtOC4yODQsMC0xNS02LjcxNi0xNS0xNXYtNjANCgkJCWMwLTguMjg0LDYuNzE2LTE1LDE1LTE1aDYwYzguMjg0LDAsMTUsNi43MTYsMTUsMTVWNDA2LjV6Ii8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI0Ny44MjVweCIgaGVpZ2h0PSI0Ny44MjVweCIgdmlld0JveD0iMCAwIDQ3LjgyNSA0Ny44MjUiPg0KICAgIDxwYXRoIGZpbGw9IiNiZWJjNzEiIGQ9Ik0zNi40MzksMTIuNjQ2YzAtNi45MTktNS42MDgtMTIuNTI3LTEyLjUyOC0xMi41MjdTMTEuMzg0LDUuNzI3LDExLjM4NCwxMi42NDZjMCw5LjkxMywxMi41MjcsMjQuNTgyLDEyLjUyNywyNC41ODINCgkJCQlTMzYuNDM5LDIyLjUwOCwzNi40MzksMTIuNjQ2eiBNMTcuNzMzLDExLjg5OGMwLTMuNDEzLDIuNzY3LTYuMTc5LDYuMTc5LTYuMTc5czYuMTc5LDIuNzY2LDYuMTc5LDYuMTc5DQoJCQkJYzAsMy40MTMtMi43NjcsNi4xNzktNi4xNzksNi4xNzlTMTcuNzMzLDE1LjMxMSwxNy43MzMsMTEuODk4eiIvPg0KICAgIDxjaXJjbGUgZmlsbD0iI2JlYmM3MSIgY3g9IjIzLjkxMSIgY3k9IjExLjg5OCIgcj0iMy4wMzgiLz4NCiAgICA8cGF0aCBmaWxsPSIjYmViYzcxIiBkPSJNMzAuOTk0LDMyLjg3Yy0xLjAyMSwxLjQ3Ni0xLjk3OSwyLjc2MS0yLjc3NywzLjc5M2M3LjkxNiwwLjQ3NiwxMy4xMDQsMi4xODUsMTUuMDM0LDMuNDU2DQoJCQkJYy0yLjI2MSwxLjQ5MS04Ljk3OSwzLjU4Ny0xOS4zMzgsMy41ODdjLTEwLjM1OCwwLTE3LjA3Ny0yLjA5Ny0xOS4zMzgtMy41ODdjMS45My0xLjI3MSw3LjExNC0yLjk3OSwxNS4wMjItMy40NTUNCgkJCQljLTAuOC0xLjAzMi0xLjc1OS0yLjMxNi0yLjc4MS0zLjc5MkM3LjA3NSwzMy44MzEsMCwzNi43MTMsMCw0MC4xMThjMCw0LjE5LDEwLjcwNyw3LjU4OCwyMy45MTMsNy41ODgNCgkJCQljMTMuMjA3LDAsMjMuOTEyLTMuMzk2LDIzLjkxMi03LjU4OEM0Ny44MjcsMzYuNzExLDQwLjc0NCwzMy44MjgsMzAuOTk0LDMyLjg3eiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI5Ny40NzNweCIgaGVpZ2h0PSI5Ny40NzNweCIgdmlld0JveD0iMCAwIDk3LjQ3MyA5Ny40NzMiPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjQxLjU2OSIgeT0iNDcuNzUzIiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMyIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjQxLjU2OSIgeT0iNjcuNzU0IiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMiIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjE4LjU2OSIgeT0iNjcuNzU0IiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMiIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjE4LjU2OSIgeT0iNDcuNzUzIiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMyIvPg0KCTxwYXRoIGZpbGw9IiNiNGIxZmIiIGQ9Ik05NS40NzIsMTQuNDY2SDg0LjQyN1YyLjcwMWMwLTEuMTA0LTAuODk2LTItMi0ySDY1LjgxMWMtMS4xMDQsMC0yLDAuODk2LTIsMnYxMS43NjVIMzMuNjYyVjIuNzAxYzAtMS4xMDQtMC44OTYtMi0yLTINCgkJCQlIMTUuMDQ1Yy0xLjEwNCwwLTIsMC44OTYtMiwydjExLjc2NUgyYy0xLjEwNCwwLTIsMC44OTYtMiwydjc4LjMwNWMwLDEuMTA0LDAuODk2LDIsMiwyaDkzLjQ3M2MxLjEwNCwwLDItMC44OTYsMi0yVjE2LjQ2Ng0KCQkJCUM5Ny40NzIsMTUuMzYyLDk2LjU3NiwxNC40NjYsOTUuNDcyLDE0LjQ2NnogTTY5LjY0NSw4LjAzN2MwLTAuODI4LDAuNjcyLTEuNSwxLjUtMS41aDUuOTQ3YzAuODI5LDAsMS41LDAuNjcyLDEuNSwxLjV2MjAuMzQNCgkJCQljMCwwLjgyOC0wLjY3MSwxLjUtMS41LDEuNWgtNS45NDdjLTAuODI4LDAtMS41LTAuNjcyLTEuNS0xLjVWOC4wMzd6IE0xOC44OCw4LjAzN2MwLTAuODI4LDAuNjcxLTEuNSwxLjUtMS41aDUuOTQ3DQoJCQkJYzAuODI5LDAsMS41LDAuNjcyLDEuNSwxLjV2MjAuMzRjMCwwLjgyOC0wLjY3MSwxLjUtMS41LDEuNUgyMC4zOGMtMC44MjksMC0xLjUtMC42NzItMS41LTEuNVY4LjAzN3ogTTg3LjA2OCw4NC45MDINCgkJCQljMCwwLjgyOC0wLjY3LDEuNS0xLjUsMS41SDExLjkwM2MtMC44MjksMC0xLjUtMC42NzItMS41LTEuNXYtNDBjMC0wLjgyOCwwLjY3MS0xLjUsMS41LTEuNWg3My42NjZjMC44MywwLDEuNSwwLjY3MiwxLjUsMS41DQoJCQkJVjg0LjkwMnoiLz4NCgk8cmVjdCBmaWxsPSIjYjRiMWZiIiB4PSI2NC41NjgiIHk9IjQ3Ljc1MyIgd2lkdGg9IjE0LjMzNCIgaGVpZ2h0PSIxNC4zMzMiLz4NCgk8cmVjdCBmaWxsPSIjYjRiMWZiIiB4PSI2NC41NjgiIHk9IjY3Ljc1NCIgd2lkdGg9IjE0LjMzNCIgaGVpZ2h0PSIxNC4zMzIiLz4NCjwvc3ZnPg0K"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IiBoZWlnaHQ9IjUwcHgiIHZpZXdCb3g9IjAgMCA1MCA1MCI+DQogICAgPHBhdGggZmlsbD0iIzUzY2NiMiIgZD0iTTI2LjEyLDE0LjQ4OGMwLjg3OS0xLjQ2OCwyLjI3LTMuNTY5LDQuMDI3LTUuNTg1aDAuMDAyYzEuNDg4LTEuNzExLDQuNDAyLTMuOTA3LDQuNDAyLTMuOTA3DQoJCQljMC40MzgtMC4zMzEsMC4zOTEtMC43OTItMC4xMDctMS4wMjRsLTMuNTIyLTEuNjQ2Yy0wLjQ5OC0wLjIzMy0xLjE3NS0wLjA2My0xLjUwNSwwLjM3NmMwLDAtMi42MDUsMy43MzctNS42NzEsMTEuNjkyDQoJCQljLTkuNDgtNC4yODgtMTguNDkxLDEuNzE4LTE4LjQ5MSwxMi4xNjJjMCwxMC45MDksOC4zOTMsMjcuNDgsMTkuNzQzLDIyLjQ3OGMxMS45NTQsNS4xNzMsMTkuNzQ5LTExLjU2OCwxOS43NDktMjIuNDc4DQoJCQlDNDQuNzQ3LDE2LjAyMiwzNi42NDcsOS44NDYsMjYuMTIsMTQuNDg4eiIvPg0KICAgIDxwYXRoIGZpbGw9IiM1M2NjYjIiIGQ9Ik0yMy45OTcsMTAuOTU1YzAuNTQ4LTAuMDQ2LDEuMDMyLTAuNTMxLDEuMDc2LTEuMDc4YzAsMCwwLjM1Mi00LjI2Ni0yLjYyMS03LjI0MmMtMi45ODItMi45NzctNy4yNC0yLjYyMi03LjI0LTIuNjIyDQoJCQljLTAuNTQ4LDAuMDQ2LTEuMDMyLDAuNTMxLTEuMDc3LDEuMDc4YzAsMC0wLjM1OCw0LjI2OCwyLjYxOSw3LjI0NUMxOS43MjksMTEuMzEsMjMuOTk3LDEwLjk1NSwyMy45OTcsMTAuOTU1eiIvPg0KPC9zdmc+DQo="},(e,t,n)=>{n.r(t),n.d(t,{LINK_STYLE_SHOW_IRI:()=>a,OntologyLinkTemplates:()=>h});var i=n(96),r=n(80),o=n(105),s=n(138);const a={...s.DefaultLinkTemplate,renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,prependLabels:(0,i.jsx)(o.LinkLabel,{link:e.link,position:e.getPathPosition(.5),line:1,textStyle:{fill:"gray",fontSize:12,fontWeight:"lighter"},content:e.linkType.id}),propertyLabelStartLine:2})},l={...s.DefaultLinkTemplate,markerTarget:{fill:"#f8a485",stroke:"#cf8e76"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#f8a485",strokeWidth:2}})},c={...s.DefaultLinkTemplate,markerTarget:{fill:"#34c7f3",stroke:"#38b5db"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#34c7f3",strokeWidth:2}})},d={...s.DefaultLinkTemplate,markerTarget:{fill:"#34c7f3",stroke:"#38b5db"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#34c7f3",strokeWidth:2}})},u={...s.DefaultLinkTemplate,markerTarget:{fill:"#8cd965",stroke:"#5b9a3b"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#8cd965",strokeWidth:2}})},h=e=>"http://www.w3.org/2000/01/rdf-schema#subClassOf"===e?l:"http://www.w3.org/2000/01/rdf-schema#domain"===e?c:"http://www.w3.org/2000/01/rdf-schema#range"===e?d:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?u:e===r.PLACEHOLDER_LINK_TYPE?{...s.DefaultLinkTemplate,markerTarget:{fill:"none"}}:void 0},(e,t,n)=>{n.r(t),n.d(t,{ClassTree:()=>i.ClassTree});var i=n(153)},(e,t,n)=>{n.r(t),n.d(t,{ClassTree:()=>m});var i=n(96),r=n(58),o=n(52),s=n(54),a=n(76),l=n(55),c=n(94),d=n(107),u=n(124),h=n(115),p=n(154),g=n(155);const f="reactodia-class-tree";class m extends r.Component{static contextType=h.WorkspaceContext;listener=new l.EventObserver;delayedClassUpdate=new a.Debouncer;delayedSearch=new a.Debouncer(200);fetchedGraph;classTree;loadClassesOperation=new AbortController;refreshOperation=new AbortController;createElementCancellation=new AbortController;constructor(e){super(e),this.state={refreshingState:"none",roots:[],filteredRoots:[],requestedSearchText:"",appliedSearchText:"",constructibleClasses:new Map,showOnlyConstructible:!1}}render(){const{editor:e}=this.context,{refreshingState:t,requestedSearchText:n,appliedSearchText:r,filteredRoots:o,selectedNode:s,constructibleClasses:a,showOnlyConstructible:l}=this.state,c=y(n),h=r?c:void 0;return(0,i.jsxs)("div",{className:f,children:[(0,i.jsx)("div",{className:`${f}__filter`,children:(0,i.jsxs)("div",{className:`${f}__filter-group`,children:[(0,i.jsx)("input",{type:"text",className:"search-input reactodia-form-control",placeholder:"Search for...",name:"reactodia-class-tree-filter",value:this.state.requestedSearchText,onChange:this.onSearchTextChange}),e.inAuthoringMode?(0,i.jsxs)("label",{className:`${f}__only-creatable`,children:[(0,i.jsx)("input",{type:"checkbox",name:"reactodia-class-tree-only-constructible",checked:l,onChange:this.onShowOnlyCreatableChange})," Show only constructible"]}):null]})}),(0,i.jsx)(u.ProgressBar,{state:t,title:"Loading element type tree"}),this.classTree?(0,i.jsx)(g.Forest,{className:`${f}__tree reactodia-scrollable`,nodes:o,searchText:h,selectedNode:s,onSelect:this.onSelectNode,creatableClasses:a,onClickCreate:this.onCreateInstance,onDragCreate:this.onDragCreate}):(0,i.jsx)("div",{className:`${f}__spinner`,children:(0,i.jsx)(d.HtmlSpinner,{width:30,height:30})})]})}componentDidMount(){const{model:e}=this.context;this.listener.listen(e.events,"changeLanguage",(()=>this.refreshClassTree())),this.listener.listen(e.events,"loadingStart",(()=>{this.initClassTree()})),this.listener.listen(e.events,"elementTypeEvent",(({data:e})=>{(e.changeLabel||e.changeCount)&&this.delayedClassUpdate.call(this.refreshClassTree)})),this.initClassTree()}componentWillUnmount(){this.listener.stopListening(),this.delayedClassUpdate.dispose(),this.delayedSearch.dispose(),this.loadClassesOperation.abort(),this.refreshOperation.abort(),this.createElementCancellation.abort()}async initClassTree(){if(this.fetchedGraph&&this.fetchedGraph.dataProvider===this.context.model.dataProvider)this.createElementTypesIfNeeded(this.fetchedGraph.graph),this.refreshClassTree();else if(this.context.model.dataProvider){const e=this.context.model.dataProvider;this.classTree=void 0;const t=new AbortController;this.loadClassesOperation.abort(),this.loadClassesOperation=t;const n=await(0,o.mapAbortedToNull)(e.knownElementTypes({signal:t.signal}),t.signal);if(null===n)return;this.fetchedGraph={dataProvider:e,graph:n},this.classTree=function(e){const t=new Map;for(const s of e.elementTypes){const e={id:s.id,label:s.label,count:s.count,children:[]};t.set(e.id,e)}const n=new Map;for(const[c,d]of e.subtypeOf)(0,s.getOrCreateSetInMap)(n,c).add(d);const i=[],r=new Set,o=new Set,a=e=>{if(o.has(e))return;r.add(e);const t=n.get(e);if(t)for(const n of t)r.has(n)?i.push([e,n]):a(n);r.delete(e)};for(const s of t.keys())a(s);for(const[s,c]of i){const e=n.get(s);e&&e.delete(c)}const l=[];for(const s of t.values()){const e=n.get(s.id);if(e&&0!==e.size)for(const n of e){const e=t.get(n);e&&e.children.push(s)}else l.push(s)}return l}(n),this.createElementTypesIfNeeded(n),this.refreshClassTree()}else this.refreshClassTree()}onSearchTextChange=e=>{const t=e.currentTarget.value;this.setState({requestedSearchText:t}),this.delayedSearch.call(this.performSearch)};performSearch=()=>{const{requestedSearchText:e}=this.state,t=y(e);if(t===this.state.appliedSearchText)return;const n=t.length<3?void 0:t;this.setState((e=>x({...e,appliedSearchText:n})))};onShowOnlyCreatableChange=e=>{this.setState((e=>x({...e,showOnlyConstructible:!e.showOnlyConstructible})))};onSelectNode=e=>{const{instancesSearchCommands:t}=this.props;this.setState({selectedNode:e},(()=>{t?.trigger("setCriteria",{criteria:{elementType:e.model}})}))};onCreateInstance=e=>{this.createInstanceAt(e.model.id)};onDragCreate=e=>{const{view:t}=this.context;t.setHandlerForNextDropOnPaper((t=>{this.createInstanceAt(e.model.id,t)}))};refreshClassTree=()=>{const e=new AbortController,{model:t,editor:n}=this.context;this.refreshOperation.abort(),this.refreshOperation=e,this.setState(((i,r)=>{if(!this.classTree)return{refreshingState:"none"};let o="none";if(n.inAuthoringMode){const t=function(e,t){const n=new Set,i=t=>{e.has(t.id)||n.add(t.id),t.children.forEach(i)};return t.forEach(i),n}(i.constructibleClasses,this.classTree);t.size>0&&(o="loading",this.queryCreatableTypes(t,e.signal))}const s=function(e,t){const n=e=>{const i=[];for(const r of e){const e=t.getElementType(r.id);e&&i.push({model:e,label:t.locale.formatLabel(e.label,e.id),derived:n(r.children)})}return i};return n(e)}(this.classTree,t);return x({...i,roots:b(s),refreshingState:o})}))};createElementTypesIfNeeded(e){const{model:t}=this.context;for(const n of e.elementTypes){if(!t.getElementType(n.id)){const{id:e,label:i,count:r}=n,o=new c.ElementType({id:e,label:i,count:r});t.addElementType(o)}}}async queryCreatableTypes(e,t){const{metadataApi:n}=this.context.editor;if(n)try{const i=await(0,o.mapAbortedToNull)(n.filterConstructibleTypes(e,t),t);if(null===i)return;this.setState((t=>{const n=new Map(t.constructibleClasses);return e.forEach((e=>{n.set(e,i.has(e))})),x({...t,constructibleClasses:n,refreshingState:"completed"})}))}catch(i){console.error(i),this.setState((e=>x({...e,refreshingState:"error"})))}}async createInstanceAt(e,t){const{model:n,view:i,editor:r,overlay:s}=this.context,a=n.history.startBatch(),l=this.createElementCancellation.signal,c=await(0,o.mapAbortedToNull)(r.metadataApi.generateNewElement([e],l),l);if(null===c)return;const d=r.createNewEntity({elementModel:c});let u;if(t)u=[t.source,t.position];else{const e=i.findAnyCanvas();e&&(u=[e,w(e)])}if(u){const[e,t]=u;d.setPosition(t),e.renderingState.syncUpdate(),function(e,t,n){const i=n.getElementSize(e)??{width:0,height:0};e.setPosition({x:t.x-i.width/2,y:t.y-i.height/2})}(d,t,e.renderingState)}a.store(),r.setSelection([d]),s.showEditEntityForm(d)}}function y(e){return e.trim().toLowerCase()}function b(e){function t(e){if(0===e.length)return e;const t=e.map(n);return t.sort(i),t}function n(e){return p.TreeNode.setDerived(e,t(e.derived))}function i(e,t){return e.label.localeCompare(t.label)}return t(e)}function x(e){let t=e.roots;return e.appliedSearchText&&(t=function(e,t){if(0===e.length)return e;function n(e,i){const r=i.derived.reduce(n,[]);return(r.length>0||i.label.toLowerCase().indexOf(t)>=0)&&e.push(p.TreeNode.setDerived(i,r)),e}return e.reduce(n,[])}(t,e.appliedSearchText)),e.showOnlyConstructible&&(t=function(e,t){function n(e,i){const r=i.derived.reduce(n,[]);return(r.length>0||t.get(i.model.id))&&e.push(p.TreeNode.setDerived(i,r)),e}return e.reduce(n,[])}(t,e.constructibleClasses)),{...e,filteredRoots:t}}function w(e){const t=e.metrics.area;return e.metrics.clientToPaperCoords(t.clientWidth/2,t.clientHeight/2)}},(e,t,n)=>{n.r(t),n.d(t,{TreeNode:()=>i});const i={setDerived:(e,t)=>({...e,derived:t})}},(e,t,n)=>{n.r(t),n.d(t,{Forest:()=>u,Leaf:()=>d});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(115),l=n(130);const c="reactodia-class-tree-item";class d extends r.Component{static contextType=a.WorkspaceContext;constructor(e,t){super(e,t),this.state={expanded:Boolean(this.props.searchText)}}componentDidUpdate(e){this.props.searchText!==e.searchText&&this.setState({expanded:Boolean(this.props.searchText)})}render(){const{getElementTypeStyle:e}=this.context,{node:t,...n}=this.props,{selectedNode:r,searchText:o,creatableClasses:a}=n,{expanded:d}=this.state,h=0===t.derived.length?`${c}__toggle`:d?`${c}__toggle-expanded`:`${c}__toggle-collapsed`,{icon:p}=e([t.model.id]),g=Boolean(r&&r.model===t.model),f=s()(`${c}__body`,g?`${c}__body--selected`:void 0),m=(0,l.highlightSubstring)(t.label,o,{className:`${c}__highlighted-term`});return(0,i.jsxs)("div",{className:c,role:"treeitem","aria-expanded":d,"aria-selected":g,children:[(0,i.jsxs)("div",{className:`${c}__row`,children:[(0,i.jsx)("div",{className:h,onClick:this.toggle,role:"button"}),(0,i.jsxs)("a",{className:f,href:t.model.id,onClick:this.onClick,children:[(0,i.jsx)("div",{className:`${c}__icon-container`,children:p?(0,i.jsx)("img",{role:"presentation",className:`${c}__icon`,src:p}):(0,i.jsx)("div",{className:0===t.derived.length?`${c}__default-icon-leaf`:`${c}__default-icon-parent`})}),(0,i.jsx)("span",{className:`${c}__label`,children:m}),t.model.count?(0,i.jsx)("span",{className:`${c}__count reactodia-badge`,children:t.model.count}):null]}),a.get(t.model.id)?(0,i.jsx)("div",{role:"button",title:"Click or drag to create new entity of this type",className:s()(`${c}__create-button`,"reactodia-btn reactodia-btn-default"),draggable:!0,onClick:this.onClickCreate,onDragStart:this.onDragCreate}):null]}),d&&t.derived.length>0?(0,i.jsx)(u,{className:`${c}__children`,nodes:t.derived,...n}):null]})}onClick=e=>{e.preventDefault();const{node:t,onSelect:n}=this.props;n(t)};toggle=()=>{this.setState((e=>({expanded:!e.expanded})))};onClickCreate=()=>{this.props.onClickCreate(this.props.node)};onDragCreate=e=>{e.dataTransfer.setData("text",""),this.props.onDragCreate(this.props.node)}}class u extends r.Component{render(){const{className:e,nodes:t,root:n,...r}=this.props;return(0,i.jsx)("div",{className:e,role:n?"tree":void 0,children:t.map((e=>(0,i.jsx)(d,{node:e,...r},`node-${e.model.id}`)))})}}},(e,t,n)=>{n.r(t),n.d(t,{Canvas:()=>c});var i=n(96),r=n(58),o=n(157),s=n(103),a=n(115);const l="reactodia-canvas";function c(e){const{model:t,view:n}=(0,a.useWorkspace)(),{elementTemplateResolver:c,linkTemplateResolver:d,linkRouter:u,showScrollbars:h,zoomOptions:p,watermarkSvg:g,watermarkUrl:f,children:m}=e,[y]=r.useState((()=>new s.RenderingState({model:t,shared:n,elementTemplateResolver:c,linkTemplateResolver:d,linkRouter:u})));return(0,i.jsx)("div",{className:l,children:(0,i.jsx)(o.PaperArea,{model:t,renderingState:y,zoomOptions:p,hideScrollBars:!h,watermarkSvg:g,watermarkUrl:f,children:m})})}},(e,t,n)=>{n.r(t),n.d(t,{PaperArea:()=>x});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(52),l=n(55),c=n(76),d=n(91),u=n(92),h=n(65),p=n(94),g=n(71),f=n(100),m=n(103),y=n(158);const b="reactodia-paper-area";class x extends r.Component{listener=new l.EventObserver;source=new l.EventSource;events=this.source;area;svgCanvasRef=r.createRef();pageSize={x:1500,y:800};canvasContext;viewportAnimation;cssAnimations=0;movingState;delayedPaperAdjust=new c.Debouncer;scrollBeforeUpdate;get zoomOptions(){const{min:e=.2,max:t=2,step:n=.1,maxFit:i=1,fitPadding:r=20,requireCtrl:o=!0}=this.props.zoomOptions||{};return{min:e,max:t,step:n,maxFit:i,fitPadding:r,requireCtrl:o}}metrics;constructor(e,t){super(e,t),this.state={width:this.pageSize.x,height:this.pageSize.y,originX:0,originY:0,scale:1,paddingX:0,paddingY:0},this.metrics=new class extends w{paperArea;constructor(e){super(),this.paperArea=e}get area(){return this.paperArea.area}get transform(){const{width:e,height:t,originX:n,originY:i,scale:r,paddingX:o,paddingY:s}=this.paperArea.state;return{width:e,height:t,originX:n,originY:i,scale:r,paddingX:o,paddingY:s}}getClientRect(){return this.paperArea.area.getBoundingClientRect()}}(this),this.canvasContext={canvas:this,model:e.model}}get renderingState(){return this.props.renderingState}render(){const{model:e,renderingState:t,hideScrollBars:n,watermarkSvg:r,watermarkUrl:o}=this.props,a=this.metrics.getTransform(),l=s()(b,n?`${b}--hide-scrollbars`:void 0,this.isAnimatingGraph()?`${b}--animated`:void 0),c=Array.from(this.getAllWidgets());return(0,i.jsx)(d.CanvasContext.Provider,{value:this.canvasContext,children:(0,i.jsxs)("div",{className:l,children:[(0,i.jsxs)("div",{className:`${b}__area`,ref:this.onAreaMount,onPointerDown:this.onAreaPointerDown,children:[(0,i.jsx)(f.Paper,{model:e,renderingState:t,paperTransform:a,svgCanvasRef:this.svgCanvasRef,onPointerDown:this.onPaperPointerDown,onContextMenu:this.onContextMenu,onScrollCapture:this.onPaperScrollCapture,linkLayerWidgets:(0,i.jsx)("div",{className:`${b}__widgets`,onPointerDown:this.onWidgetsPointerDown,children:c.filter((e=>"overLinks"===e.attachment)).map((e=>L(e.element)))}),elementLayerWidgets:(0,i.jsx)("div",{className:`${b}__widgets`,onPointerDown:this.onWidgetsPointerDown,children:c.filter((e=>"overElements"===e.attachment)).map((e=>L(e.element)))})}),r?(0,i.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",children:(0,i.jsx)("img",{className:`${b}__watermark`,src:r,draggable:!1})}):null]}),c.filter((e=>"viewport"===e.attachment)).map((e=>L(e.element)))]})})}onAreaMount=e=>{this.area=e};componentDidMount(){this.adjustPaper((()=>this.centerTo()));const{model:e,renderingState:t}=this.props,n=()=>this.delayedPaperAdjust.call(this.adjustPaper);this.listener.listen(e.events,"changeCells",n),this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&n()})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{e.changeVertices&&n()})),this.listener.listen(t.events,"changeElementSize",n),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{e===m.RenderingLayer.PaperArea&&this.delayedPaperAdjust.runSynchronously()})),this.listener.listen(t.shared.events,"changeWidgets",(()=>{this.forceUpdate()})),this.listener.listen(t.shared.events,"findCanvas",(e=>{e.canvases.push(this)})),this.area.addEventListener("dragover",this.onDragOver),this.area.addEventListener("drop",this.onDragDrop),this.area.addEventListener("scroll",this.onScroll,{passive:!0}),this.area.addEventListener("wheel",this.onWheel,{passive:!1})}componentDidUpdate(e,t){if(this.scrollBeforeUpdate){const{scale:e,originX:n,originY:i,paddingX:r,paddingY:o}=this.state,s=(n-t.originX)*e+(r-t.paddingX),a=(i-t.originY)*e+(o-t.paddingY),l=this.scrollBeforeUpdate.left+s,c=this.scrollBeforeUpdate.top+a;this.area.scrollLeft=l,this.area.scrollTop=c,this.scrollBeforeUpdate=void 0}}componentWillUnmount(){this.stopListeningToPointerMove(),this.listener.stopListening(),this.delayedPaperAdjust.dispose(),this.area.removeEventListener("dragover",this.onDragOver),this.area.removeEventListener("drop",this.onDragDrop),this.area.removeEventListener("scroll",this.onScroll),this.area.removeEventListener("wheel",this.onWheel)}*getAllWidgets(){const{renderingState:e,children:t}=this.props;for(const n of r.Children.toArray(t))if(r.isValidElement(n)){const e=(0,u.extractCanvasWidget)(n);e?yield e:console.warn("Unexpected non-widget canvas child: ",n)}yield*e.shared.widgets.values()}onWidgetsPointerDown=e=>{e.stopPropagation()};getContentFittingBox(){const{model:e,renderingState:t}=this.props,{elements:n,links:i}=e;return(0,g.getContentFittingBox)(n,i,t)}computeAdjustedBox(){const e=this.getContentFittingBox(),t=e.x,n=e.y,i=e.x+e.width,r=e.y+e.height,{x:o,y:s}=this.pageSize,a=Math.floor(t/o),l=Math.floor(n/s),c=Math.ceil(i/o),d=Math.ceil(r/s),u=-a*o,h=-l*s;return{width:Math.max(c-a,1)*o,height:Math.max(d-l,1)*s,originX:u,originY:h}}adjustPaper=e=>{const{clientWidth:t,clientHeight:n}=this.area,i={...this.computeAdjustedBox(),paddingX:Math.ceil(t),paddingY:Math.ceil(n)},r=this.state;i.width===r.width&&i.height===r.height&&i.originX===r.originX&&i.originY===r.originY&&i.paddingX===r.paddingX&&i.paddingY===r.paddingY?e&&e():(this.scrollBeforeUpdate={left:this.area.scrollLeft,top:this.area.scrollTop},this.setState(i,e))};onAreaPointerDown=e=>{e.target===this.area&&this.onPaperPointerDown(e,void 0)};onPaperPointerDown=(e,t)=>{if(0!==e.button)return;if(this.movingState)return void this.handleMultiPointerDown(e);const{model:n}=this.props,i=h.RestoreGeometry.capture(n),r=n.history.startBatch(i.title);let o,s;if((t||"mouse"===e.pointerType)&&e.preventDefault(),void 0===t){if(this.shouldStartPanning(e)){const{scrollLeft:e,scrollTop:t}=this.area;o={scrollLeft:e,scrollTop:t},function(){if(document.getSelection){const e=document.getSelection();e?.removeAllRanges?.()}}()}}else if(t instanceof p.Element&&this.shouldStartElementMove(e)){const{x:n,y:i}=this.metrics.pageToPaperCoords(e.pageX,e.pageY),{x:r,y:o}=t.position;s={pointerX:n,pointerY:i,elementX:r,elementY:o}}const{pageX:a,pageY:l}=e;this.movingState={pointers:new Map,pointerMoved:!1,target:t,batch:r,restoreGeometry:i,originPointerId:e.pointerId,origin:{pageX:a,pageY:l},panningOrigin:o,movingElementOrigin:s,pinchOrigin:void 0},this.handleMultiPointerDown(e),document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp),"mouse"!==e.pointerType&&document.addEventListener("pointercancel",this.onPointerCancel),this.source.trigger("pointerDown",{source:this,sourceEvent:e,target:t,panning:Boolean(o)})};handleMultiPointerDown(e){if(!this.movingState)return;const{pointers:t}=this.movingState;t.set(e.pointerId,{x:e.pageX,y:e.pageY}),this.movingState.pinchOrigin||2!==t.size||(e.preventDefault(),this.movingState.pinchOrigin={pointers:new Map(t),metrics:this.metrics.snapshot()})}shouldStartPanning(e){const t=e.ctrlKey||e.shiftKey||e.altKey;return"mouse"===e.pointerType&&!t}shouldStartElementMove(e){return"mouse"===e.pointerType}onPointerMove=e=>{if(!this.movingState||this.scrollBeforeUpdate)return;const{renderingState:t}=this.props,{origin:n,target:i,panningOrigin:r,movingElementOrigin:o}=this.movingState,s=e.pageX-n.pageX,a=e.pageY-n.pageY;e.isPrimary&&Math.abs(s)>=1&&Math.abs(a)>=1&&(this.movingState.pointerMoved=!0);const l=Boolean(r);if(this.handleMultiPointerMove(e));else if(void 0===i)e.preventDefault(),r&&(this.area.scrollLeft=r.scrollLeft-s,this.area.scrollTop=r.scrollTop-a),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l});else if(i instanceof p.Element){if(e.preventDefault(),o){const{x:n,y:r}=this.metrics.pageToPaperCoords(e.pageX,e.pageY),{pointerX:s,pointerY:a,elementX:c,elementY:d}=o;i.setPosition({x:c+n-s,y:d+r-a}),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l}),t.syncUpdate()}}else if(i instanceof p.Link){e.preventDefault();const t=this.metrics.pageToPaperCoords(e.pageX,e.pageY),n=this.generateLinkVertex(i,t);n.createAt(t),this.movingState.target=n}else if(i instanceof p.LinkVertex){e.preventDefault();const n=this.metrics.pageToPaperCoords(e.pageX,e.pageY);i.moveTo(n),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l}),t.syncUpdate()}};handleMultiPointerMove(e){if(!this.movingState)return!1;const{pointers:t,pinchOrigin:n}=this.movingState;if(t.set(e.pointerId,{x:e.pageX,y:e.pageY}),!n)return!1;const[[i,r],[o,s]]=n.pointers,a=t.get(i),l=t.get(o);if(!a||!l)return!1;const c=g.Vector.scale(g.Vector.add(a,l),.5),d=g.Vector.scale(g.Vector.add(r,s),.5),u=g.Vector.length(g.Vector.subtract(l,a))/Math.max(g.Vector.length(g.Vector.subtract(s,r)),1),h=n.metrics,p=h.clientToPaperCoords(h.area.clientWidth/2,h.area.clientHeight/2),f=h.pageToPaperCoords(c.x,c.y),m=h.pageToPaperCoords(d.x,d.y),y=g.Vector.add(m,g.Vector.scale(g.Vector.subtract(p,f),1/u)),b=h.getTransform().scale*u;return this.centerTo(y,{scale:b}),!0}generateLinkVertex(e,t){const{model:n,renderingState:i}=this.props,r=e.vertices,o=r?[...r]:[],s=n.getElement(e.sourceId),a=n.getElement(e.targetId),l=(0,g.computePolyline)((0,g.boundsOf)(s,i),(0,g.boundsOf)(a,i),o),c=(0,g.findNearestSegmentIndex)(l,t);return new p.LinkVertex(e,c)}onPointerUp=e=>{if(this.movingState){const{originPointerId:t,pointers:n,pinchOrigin:i}=this.movingState;n.delete(e.pointerId),(e.pointerId===t||i&&n.size<2)&&this.stopListeningToPointerMove(e)}};onPointerCancel=e=>{this.stopListeningToPointerMove()};onPaperScrollCapture=(e,t)=>{t instanceof p.Element&&this.movingState&&this.stopListeningToPointerMove()};stopListeningToPointerMove=e=>{const t=this.movingState;if(this.movingState=void 0,t&&(document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp),document.removeEventListener("pointercancel",this.onPointerCancel)),e&&t&&!t.pinchOrigin){const{pointerMoved:n,target:i,batch:r,restoreGeometry:o}=t;this.source.trigger("pointerUp",{source:this,sourceEvent:e,target:i,panning:Boolean(t.panningOrigin),triggerAsClick:!n});const s=o.filterOutUnchanged();s.hasChanges()&&r.history.registerToUndo(s),r.store()}};onWheel=e=>{if(this.shouldStartZooming(e)){e.preventDefault();const t=Math.max(-1,Math.min(1,e.deltaY||e.deltaX)),n=this.metrics.pageToPaperCoords(e.pageX,e.pageY);this.zoomBy(.1*-t,{pivot:n})}};shouldStartZooming(e){return Boolean(e.ctrlKey)&&Boolean(this.zoomOptions.requireCtrl)||!this.zoomOptions.requireCtrl}centerTo(e,t={}){const{width:n,height:i}=this.state,r=e||{x:n/2,y:i/2};if("number"==typeof t.scale){const{min:e,max:n}=this.zoomOptions;let i=t.scale;i=Math.max(i,e),i=Math.min(i,n);const o={center:r,scale:{x:i,y:i}};return this.setViewportState(o,t)}{const e={center:r};return this.setViewportState(e,t)}}centerContent(e={}){const t=this.getContentFittingBox();return this.centerTo({x:t.x+t.width/2,y:t.y+t.height/2},e)}getScale(){return this.state.scale}setScale(e,t){let n=e;const{min:i,max:r}=this.zoomOptions;let o;if(n=Math.max(n,i),n=Math.min(n,r),t&&t.pivot){const{x:e,y:i}=t.pivot,r=this.metrics.clientToPaperCoords(this.area.clientWidth/2,this.area.clientHeight/2),s=n/this.state.scale;o={center:{x:e-(e-r.x)/s,y:i-(i-r.y)/s},scale:{x:n,y:n}}}else o={scale:{x:n,y:n}};return this.setViewportState(o,t)}zoomBy(e,t){return this.setScale(this.getScale()+e,t)}zoomIn(e){return this.zoomBy(this.zoomOptions.step,e)}zoomOut(e){return this.zoomBy(-this.zoomOptions.step,e)}zoomToFit(e={}){const{model:t,renderingState:n}=this.props,{elements:i}=t;if(0===i.length)return this.centerTo();const r=(0,g.getContentFittingBox)(i,[],n);return this.zoomToFitRect(r,e)}zoomToFitRect(e,t={}){const{clientWidth:n,clientHeight:i}=this.area;if(0===e.width)return Promise.resolve();const{width:r}=(0,y.fitRectKeepingAspectRatio)(e.width,e.height,n,i);let o=r/e.width;const{min:s,maxFit:a}=this.zoomOptions;o=Math.max(o,s),o=Math.min(o,a);const l={center:{x:e.x+e.width/2,y:e.y+e.height/2},scale:{x:o,y:o}};return this.setViewportState(l,t)}onDragOver=e=>{e.preventDefault&&e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const{x:t,y:n}=k(this.area,e);return!1};onDragDrop=e=>{const{renderingState:t}=this.props,{x:n,y:i}=k(this.area,e),r={source:this,sourceEvent:e,position:this.metrics.clientToPaperCoords(n,i)};t.shared.tryHandleDropOnPaper(r)||this.source.trigger("drop",r)};onScroll=e=>{this.source.trigger("scroll",{source:this,sourceEvent:e})};onContextMenu=(e,t)=>{this.source.trigger("contextMenu",{source:this,sourceEvent:e,target:t})};makeToSVGOptions(e){const{model:t,renderingState:n}=this.props,{removeByCssSelectors:i=[]}=e,r=this.svgCanvasRef.current;if(!r)throw new Error("Cannot find SVG canvas to export");return{model:t,sizeProvider:n,paper:r,contentBox:this.getContentFittingBox(),getOverlaidElement:e=>this.area.querySelector(`[data-element-id='${e}']`),preserveDimensions:!0,convertImagesToDataUris:!0,removeByCssSelectors:[".reactodia-link-vertices__handle",...i],watermarkSvg:this.props.watermarkSvg}}exportSvg(e={}){return(0,y.toSVG)(this.makeToSVGOptions(e))}exportRaster(e={}){return(0,y.toDataURL)({...e,...this.makeToSVGOptions(e)})}isAnimatingGraph(){return this.cssAnimations>0}animateGraph(e,t){this.changeGraphAnimationCount(1),e();const n="number"==typeof t?t:500;return(0,a.delay)(n).then((()=>this.onGraphAnimationEnd()))}onGraphAnimationEnd(){this.changeGraphAnimationCount(-1)}changeGraphAnimationCount(e){const t=this.cssAnimations+e;if(t<0)return;const n=this.isAnimatingGraph();this.cssAnimations=t;n!==this.isAnimatingGraph()&&(this.forceUpdate(),this.source.trigger("changeAnimatingGraph",{source:this,previous:n}))}get viewportState(){const{clientWidth:e,clientHeight:t}=this.area,{originX:n,originY:i,paddingX:r,paddingY:o,scale:s}=this.state;return{center:{x:(this.area.scrollLeft+e/2-r)/s-n,y:(this.area.scrollTop+t/2-o)/s-i},scale:{x:s,y:s}}}setViewportState(e,t){this.viewportAnimation&&this.viewportAnimation.cancellation.abort();const n=this.viewportState,i={...n,...e};if(t&&(t.animate||t.duration&&t.duration>0)){const e={from:n,to:i,cancellation:new AbortController},r="number"==typeof t.duration?t.duration:500,o=(0,c.animateInterval)(r,(e=>{const t=(0,c.easeInOutBezier)(e),r={center:{x:n.center.x+(i.center.x-n.center.x)*t,y:n.center.y+(i.center.y-n.center.y)*t},scale:{x:n.scale.x+(i.scale.x-n.scale.x)*t,y:n.scale.y+(i.scale.y-n.scale.y)*t}};this.applyViewportState(r)}),e.cancellation.signal);return this.viewportAnimation=e,o.then((()=>{this.viewportAnimation=void 0}))}return this.applyViewportState(i),Promise.resolve()}applyViewportState(e){const t=this.state.scale,n=e.scale.x,i=e.center;this.setState({scale:n},(()=>{const{originX:e,originY:r,paddingX:o,paddingY:s}=this.state,a=(i.x+e)*n,l=(i.y+r)*n,{clientWidth:c,clientHeight:d}=this.area;this.area.scrollLeft=a-c/2+o,this.area.scrollTop=l-d/2+s,n!==t&&this.source.trigger("changeScale",{source:this,previous:t})}))}}class w{snapshot(){const{clientWidth:e,clientHeight:t,offsetWidth:n,offsetHeight:i,scrollLeft:r,scrollTop:o}=this.area,{left:s,top:a}=this.getClientRect();return new v({clientWidth:e,clientHeight:t,offsetWidth:n,offsetHeight:i,scrollLeft:r,scrollTop:o},{left:s,top:a},this.transform)}getTransform(){return this.transform}getPaperSize(){const{width:e,height:t,scale:n}=this.transform;return{width:e/n,height:t/n}}pageToPaperCoords(e,t){const{left:n,top:i}=this.getClientRect();return this.clientToPaperCoords(e-(n+window.scrollX),t-(i+window.scrollY))}paperToPageCoords(e,t){const{x:n,y:i}=this.paperToScrollablePaneCoords(e,t),{x:r,y:o}=this.scrollablePaneToClientCoords(n,i),{left:s,top:a}=this.getClientRect();return{x:r+(s+window.scrollX),y:o+(a+window.scrollY)}}clientToPaperCoords(e,t){const{x:n,y:i}=this.clientToScrollablePaneCoords(e,t);return this.scrollablePaneToPaperCoords(n,i)}clientToScrollablePaneCoords(e,t){const{paddingX:n,paddingY:i}=this.transform,{scrollLeft:r,scrollTop:o}=this.area;return{x:e+r-n,y:t+o-i}}scrollablePaneToClientCoords(e,t){const{paddingX:n,paddingY:i}=this.transform,{scrollLeft:r,scrollTop:o}=this.area;return{x:e-r+n,y:t-o+i}}scrollablePaneToPaperCoords(e,t){const{scale:n,originX:i,originY:r}=this.transform;return{x:e/n-i,y:t/n-r}}paperToScrollablePaneCoords(e,t){const{scale:n,originX:i,originY:r}=this.transform;return{x:(e+i)*n,y:(t+r)*n}}}class v extends w{area;clientRect;transform;constructor(e,t,n){super(),this.area=e,this.clientRect=t,this.transform=n}getClientRect(){return this.clientRect}snapshot(){return this}}function k(e,t){const n=(t.target instanceof SVGElement&&null!==t.target.ownerSVGElement?t.target.ownerSVGElement:t.target).getBoundingClientRect(),i=e.getBoundingClientRect();return{x:t.offsetX+(n.left-i.left),y:t.offsetY+(n.top-i.top)}}function L(e){return r.cloneElement(e)}},(e,t,n)=>{n.r(t),n.d(t,{dataURLToBlob:()=>f,fitRectKeepingAspectRatio:()=>g,loadImage:()=>p,toDataURL:()=>h,toSVG:()=>l});var i=n(71);const r="http://www.w3.org/2000/svg",o=2,s={x:100,y:100},a='<?xml version="1.0" encoding="UTF-8"?>';function l(e){return c(e).then((t=>{const n=(new XMLSerializer).serializeToString(t);return e.addXmlHeader?a+n:n}))}function c(e){const{contentBox:t,watermarkSvg:n,removeByCssSelectors:a=[],borderPadding:l=s}=e,{svgClone:c,imageBounds:u}=function(e,t){const{model:n,sizeProvider:o,paper:s,getOverlaidElement:a}=e,l=s.cloneNode(!0);function c(){let e=l.firstChild;for(;e;){if(e instanceof SVGGElement)return e;e=e.nextSibling}}l.removeAttribute("class"),l.removeAttribute("style");const u=c();u.removeAttribute("transform"),u.setAttribute("class","reactodia-exported-canvas");const h={};for(const p of n.elements){const e=a(p.id);if(!e)continue;const n=document.createElementNS(r,"g"),s=e.firstChild.cloneNode(!0);n.setAttribute("class","reactodia-exported-element");const l=document.createElementNS(r,"foreignObject");l.appendChild(s);const{x:c,y:g,width:f,height:m}=(0,i.boundsOf)(p,o);l.setAttribute("transform",`translate(${c},${g})`),l.setAttribute("width",(f+t).toString()),l.setAttribute("height",(m+t).toString()),n.appendChild(l),u.appendChild(n);const y=s.querySelectorAll("img");d(e.querySelectorAll("img"),((e,t)=>{const n=`export-key-${t}`;y[t].setAttribute("export-key",n),h[n]={width:e.clientWidth,height:e.clientHeight}}))}return{svgClone:l,imageBounds:h}}(e,o),h=t.width+2*l.x,p=t.height+2*l.y;e.preserveDimensions?(c.setAttribute("width",h.toString()),c.setAttribute("height",p.toString())):(c.setAttribute("width","100%"),c.setAttribute("height","100%"));const g={x:t.x-l.x,y:t.y-l.y,width:h,height:p};c.setAttribute("viewBox",`${g.x} ${g.y} ${g.width} ${g.height}`),n&&function(e,t,n){const i="reactodia-exported-watermark",o=120,s=20,a=document.createElementNS(r,"image");a.setAttributeNS("http://www.w3.org/1999/xlink","href",n),a.setAttribute("class",i);const l=Math.min(.2*t.width,o),c=t.x+t.width-l-s,d=t.y+s;a.setAttribute("x",c.toString()),a.setAttribute("y",d.toString()),a.setAttribute("width",l.toString()),a.setAttribute("opacity","0.3"),e.insertBefore(a,e.firstChild)}(c,g,n);const f=[];d(c.querySelectorAll("img"),(e=>f.push(e)));const m=Promise.all(f.map((t=>{const n=t.getAttribute("export-key");if(t.removeAttribute("export-key"),n){const{width:i,height:r}=u[n];return t.setAttribute("width",i.toString()),t.setAttribute("height",r.toString()),e.convertImagesToDataUris?async function(e){const t=e.src;if(!t||t.startsWith("data:"))return t;const n=t.match(/\.([a-zA-Z0-9]+)[^.a-zA-Z0-9]?[^.]*$/),i=n?n[1].toLowerCase():void 0;if("svg"===i)try{const e=await fetch(t),n=await e.text();if(n.length>0)return"data:image/svg+xml,"+encodeURIComponent(n)}catch(s){}const r=await function(e){const t=new Image;t.crossOrigin="anonymous";const n=new Promise(((e,n)=>{t.onload=()=>e(t),t.onerror=e=>n(e)}));return t.src=e,n}(e.src),o=document.createElement("canvas");o.width=r.width,o.height=r.height;o.getContext("2d").drawImage(r,0,0);try{const e="image/"+("jpg"===i?"jpeg":"png");return o.toDataURL(e)}catch(a){throw new Error(`Failed to convert image to data URI: ${t}`,{cause:a})}}(t).then((e=>{e&&"data:image/svg+xml,"!==e&&(t.src=e)})).catch((e=>{console.warn("Failed to export image: "+t.src,e)})):Promise.resolve()}return Promise.resolve()})));return m.then((()=>{const e=function(e){const t=new Set;for(let r=0;r<document.styleSheets.length;r++){let n;try{const e=document.styleSheets[r];if(n=e.cssRules||e.rules,!n)continue}catch(i){continue}for(let i=0;i<n.length;i++){const r=n[i];if(r instanceof CSSStyleRule){const n=r.selectorText.replace(/::[a-zA-Z-]+$/,"");e.querySelector(n)&&t.add(r)}}}const n=[];return t.forEach((e=>n.push(e.cssText))),n.join("\n")}(c),t=document.createElementNS("http://www.w3.org/2000/svg","defs");t.innerHTML=`<style>${e}</style>`,c.insertBefore(t,c.firstChild);for(const n of a)for(const e of c.querySelectorAll(n))e.remove();return c}))}function d(e,t){for(let n=0;n<e.length;n++)t(e[n],n)}const u={width:4096,height:4096};async function h(e){const{mimeType:t="image/png",maxFallbackSize:n=u}=e,i={...e,convertImagesToDataUris:!0,mockImages:!1,preserveDimensions:!0},r=await c(i),o={width:Number(r.getAttribute("width")),height:Number(r.getAttribute("height"))},s="number"==typeof e.width||"number"==typeof e.height?{width:e.width,height:e.height}:function(e,t){const n=Math.min(t.width/e.width,t.height/e.height),i=Math.min(2,n),r=Math.floor(e.width*i),o=Math.floor(e.height*i);return{width:r,height:o}}(o,n),{innerSize:a,outerSize:l,offset:d}=function(e,t){const n=g(e.width,e.height,t.width,t.height),i={width:Math.floor(n.width),height:Math.floor(n.height)},r={width:"number"==typeof t.width?t.width:i.width,height:"number"==typeof t.height?t.height:i.height},o={x:Math.round((r.width-i.width)/2),y:Math.round((r.height-i.height)/2)};return{innerSize:i,outerSize:r,offset:o}}(o,s);r.setAttribute("width",a.width.toString()),r.setAttribute("height",a.height.toString());const h=(new XMLSerializer).serializeToString(r),{canvas:f,context:m}=function(e,t,n){const i=document.createElement("canvas");i.width=e,i.height=t;const r=i.getContext("2d");n&&(r.fillStyle=n,r.fillRect(0,0,e,t));return{canvas:i,context:r}}(l.width,l.height,e.backgroundColor),y=await p("data:image/svg+xml,"+encodeURIComponent(h));return m.drawImage(y,d.x,d.y,a.width,a.height),f.toDataURL(t,e.quality)}function p(e){return new Promise(((t,n)=>{const i=new Image;i.onload=function(){t(i)},i.onerror=function(e){n(e)},i.src=e}))}function g(e,t,n,i){if("number"!=typeof n&&"number"!=typeof i)return{width:e,height:t};const r=e/t;return n="number"==typeof n?n:i*r,(i="number"==typeof i?i:n/r)*r<=n?{width:i*r,height:i}:{width:n,height:n/r}}function f(e){const t=";base64,";if(-1===e.indexOf(t)){const t=e.split(","),n=t[0].split(":")[1],i=decodeURIComponent(t[1]);return new Blob([i],{type:n})}{const n=e.split(t),i=n[0].split(":")[1],r=window.atob(n[1]),o=r.length,s=new Uint8Array(o);for(let e=0;e<o;++e)s[e]=r.charCodeAt(e);return new Blob([s],{type:i})}}},(e,t,n)=>{n.r(t),n.d(t,{ConnectionsMenu:()=>v});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(55),l=n(67),c=n(91),d=n(92),u=n(65),h=n(94),p=n(71),g=n(64),f=n(108),m=n(136),y=n(124),b=n(115),x=n(130),w=n(129);function v(e){const{commands:t}=e,n=(0,b.useWorkspace)(),{canvas:o}=(0,c.useCanvas)();return r.useEffect((()=>{const r=new a.EventObserver;return r.listen(t,"show",(({targets:t})=>{if(0===t.length)return;const{model:r,overlay:s}=n,a=t.length>1?new k(t,r,o):void 0,l=a?a.target:t[0],c=()=>{a?.remove(),s.hideDialog()};s.showDialog({target:l,dialogType:"connectionsMenu",content:(0,i.jsx)(S,{...e,placeTarget:l,targets:t,onClose:c,workspace:n,canvas:o}),onClose:c})})),()=>r.stopListening()}),[t]),null}(0,d.defineCanvasWidget)(v,(e=>({element:e,attachment:"viewport"})));class k{model;target;constructor(e,t,n){this.model=t;const i=new h.Element({data:h.Element.placeholderData(""),temporary:!0});this.target=i;const r=new Set(e),o=()=>{const{x:t,y:r,width:o,height:s}=(0,p.getContentFittingBox)(e,[],n.renderingState);i.setPosition({x:t+o,y:r+s/2})};o();const s=t.history.startBatch();t.addElement(i),s.discard();const l=new a.EventObserver;l.listen(t.events,"changeCells",(e=>{(e.changedElement===i||e.updateAll)&&(t.elements.includes(i)||l.stopListening())})),l.listen(t.events,"elementEvent",(({data:e})=>{e.changePosition&&r.has(e.changePosition.source)&&o()})),l.listen(n.renderingState.events,"changeElementSize",(e=>{r.has(e.source)&&o()}))}remove(){if(this.model.getElement(this.target.id)){const e=this.model.history.startBatch();this.model.removeElement(this.target.id),e.discard()}}}const L="reactodia-connections-menu",_=100;class S extends r.Component{ALL_RELATED_ELEMENTS_LINK;handler=new a.EventObserver;linkTypesListener=new a.EventObserver;constructor(e){super(e);const{workspace:{model:t}}=this.props;this.ALL_RELATED_ELEMENTS_LINK=new h.LinkType({id:"urn:reactodia:allLinks",label:[t.factory.literal("All")]}),this.state={loadingState:"none",filterKey:"",panel:"connections",sortMode:"alphabet"}}updateAll=()=>this.forceUpdate();componentDidMount(){const{workspace:{model:e}}=this.props;this.handler.listen(e.events,"changeLanguage",this.updateAll),this.loadLinks()}componentWillUnmount(){this.handler.stopListening(),this.linkTypesListener.stopListening()}async loadLinks(){const{targets:e,workspace:{model:t,triggerWorkspaceEvent:n}}=this.props;this.setState({loadingState:"loading",connections:{links:[],counts:new Map}});const i=e.length>1,r=new Map;try{await Promise.all(e.map((e=>t.dataProvider.connectedLinkStats({elementId:e.iri,inexactCount:i}).then((e=>{for(const{id:t,inCount:n,outCount:o,inexact:s}of e){const e=r.get(t)??{inCount:0,outCount:0,inexact:!1};r.set(t,{inexact:Boolean(i||e.inexact||s),inCount:e.inCount+n,outCount:e.outCount+o})}})))))}catch(s){return console.error(s),void this.setState({loadingState:"error"})}const o=Array.from(r.keys(),(e=>t.createLinkType(e)));r.set(this.ALL_RELATED_ELEMENTS_LINK.id,Array.from(r.values()).reduce(((e,t)=>({inexact:Boolean(e.inexact||t.inexact),inCount:e.inCount+t.inCount,outCount:e.outCount+t.outCount})),{inCount:0,outCount:0,inexact:!1})),this.setState({loadingState:"completed",connections:{links:o,counts:r}},(()=>{this.resubscribeOnLinkTypeEvents(),n(b.WorkspaceEventKey.connectionsLoadLinks)}))}resubscribeOnLinkTypeEvents(){const{connections:e}=this.state;if(this.linkTypesListener.stopListening(),e)for(const t of e.links)this.linkTypesListener.listen(t.events,"changeLabel",this.updateAll),this.linkTypesListener.listen(t.events,"changeVisibility",this.updateAll)}async loadObjects(e){const{targets:t,workspace:{model:n,triggerWorkspaceEvent:i}}=this.props,{link:r,direction:o,pageCount:s}=e;this.setState({loadingState:"loading",objects:{chunk:e,elements:[]}});const a=new Map;try{await Promise.all(t.map((e=>n.dataProvider.lookup({refElementId:e.iri,refElementLinkId:r===this.ALL_RELATED_ELEMENTS_LINK?void 0:r.id,linkDirection:o,limit:s*_}).then((e=>{for(const{element:t}of e)a.set(t.id,t)})))))}catch(d){return console.error(d),void this.setState({loadingState:"error"})}const l=new Set(n.elements.map((e=>e.iri))),c=Array.from(a.values(),(e=>({model:e,presentOnDiagram:l.has(e.id)})));this.setState({loadingState:"completed",objects:{chunk:e,elements:c}},(()=>{i(b.WorkspaceEventKey.connectionsLoadElements)}))}render(){const{loadingState:e,filterKey:t}=this.state;return(0,i.jsxs)("div",{className:L,children:[(0,i.jsx)("span",{id:"reactodia-dialog-caption",className:`reactodia-label ${L}__title-label`,children:this.getTitle()}),this.getBreadCrumbs(),(0,i.jsxs)("div",{className:`${L}__search-line`,children:[(0,i.jsx)("input",{type:"text",className:`search-input reactodia-form-control ${L}__search-line-input`,name:"reactodia-connection-menu-filter",value:t,onChange:this.onChangeFilter,placeholder:"Search for..."}),this.renderSortSwitches()]}),(0,i.jsx)(y.ProgressBar,{state:e,title:"Loading element connections",height:10}),this.getBody()]})}onChangeFilter=e=>{const t=e.currentTarget.value;this.setState({filterKey:t})};getTitle(){const{connections:e,objects:t,panel:n}=this.state;return t&&"objects"===n?"Objects":e&&"connections"===n?"Connections":"Error"}getBreadCrumbs(){const{workspace:{model:e}}=this.props,{objects:t,panel:n}=this.state;if(t&&"objects"===n){const{link:n,direction:r}=t.chunk,o=e.locale.formatLabel(n.label,n.id);return(0,i.jsxs)("span",{className:`${L}__breadcrumbs`,children:[(0,i.jsx)("a",{className:`${L}__breadcrumbs-link`,onClick:this.onCollapseLink,children:"Connections"}),"\xa0/\xa0",o," ",r?`(${r})`:null]})}return null}onExpandLink=e=>{const{workspace:{triggerWorkspaceEvent:t}}=this.props,{objects:n}=this.state;this.setState({filterKey:"",panel:"objects"});n&&n.chunk.link===e.link&&n.chunk.direction===e.direction||this.loadObjects(e),t(b.WorkspaceEventKey.connectionsExpandLink)};onCollapseLink=()=>{this.setState({filterKey:"",panel:"connections"})};getBody(){const{targets:e,suggestProperties:t,instancesSearchCommands:n,workspace:{model:r}}=this.props,{loadingState:o,objects:s,connections:a,filterKey:l,panel:c,sortMode:d}=this.state;return"error"===o?(0,i.jsx)("label",{className:`reactodia-label ${L}__error`,children:"Error"}):s&&"objects"===c?(0,i.jsx)(T,{data:s,onMoveToFilter:this.onMoveToFilter,model:r,filterKey:l,loading:"loading"===o,onPressAddSelected:this.onAddSelectedElements}):a&&"connections"===c?"loading"===o?(0,i.jsx)("label",{className:`reactodia-label ${L}__loading`,children:"Loading..."}):(0,i.jsx)(M,{targets:e,data:a,model:r,filterKey:l,allRelatedLink:this.ALL_RELATED_ELEMENTS_LINK,onExpandLink:this.onExpandLink,onMoveToFilter:n&&1===e.length?this.onMoveToFilter:void 0,propertySuggestionCall:t,sortMode:d}):(0,i.jsx)("div",{})}onAddSelectedElements=e=>{const{onClose:t}=this.props,{objects:n}=this.state,i=e.map((e=>e.model.id)),r=n?n.chunk.link:void 0,o=n&&r!==this.ALL_RELATED_ELEMENTS_LINK;this.placeElements(i,o?r:void 0),t()};placeElements(e,t){const{placeTarget:n,workspace:{model:i,triggerWorkspaceEvent:r},canvas:o}=this.props,s=i.history.startBatch("Add connected elements"),a=e.map((e=>i.createElement(e)));o.renderingState.syncUpdate(),(0,g.placeElementsAround)({elements:a,model:i,sizeProvider:o.renderingState,targetElement:n,preferredLinksLength:300}),t&&"hidden"===t.visibility&&s.history.execute((0,u.changeLinkTypeVisibility)(t,"visible")),s.history.execute((0,f.requestElementData)(i,e)),s.history.execute((0,f.restoreLinksBetweenElements)(i)),s.store(),r(b.WorkspaceEventKey.editorAddElements)}onMoveToFilter=e=>{const{targets:t,instancesSearchCommands:n,workspace:{model:i}}=this.props,{link:r,direction:o}=e,s=1===t.length?t[0]:void 0;if(s)if(r===this.ALL_RELATED_ELEMENTS_LINK)n?.trigger("setCriteria",{criteria:{refElement:s}});else{const e=i.getElement(s.id);n?.trigger("setCriteria",{criteria:{refElement:e,refElementLink:r,linkDirection:o}})}};renderSortSwitches(){const{suggestProperties:e}=this.props,{panel:t}=this.state;return"connections"===t&&e?(0,i.jsxs)("div",{className:`${L}__sort-switches`,children:[this.renderSortSwitch("alphabet",`${L}__sort-label-alpha`,"Sort alphabetically"),this.renderSortSwitch("smart",`${L}__sort-label-smart`,"Smart sort")]}):null}renderSortSwitch(e,t,n){return(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"radio",name:"sort",id:e,value:e,className:`${L}__sort-switch`,onChange:this.onSortChange,checked:this.state.sortMode===e}),(0,i.jsx)("label",{htmlFor:e,title:n,className:s()(`${L}__sort-switch-label`,t)})]})}onSortChange=e=>{const t=e.target.value;this.state.sortMode!==t&&this.setState({sortMode:t})}}class M extends r.Component{suggestionCancellation=new AbortController;constructor(e){super(e),this.state={scores:new Map},this.tryUpdateScores()}componentDidUpdate(e){this.props.filterKey===e.filterKey&&this.props.sortMode===e.sortMode||this.tryUpdateScores()}componentWillUnmount(){this.suggestionCancellation.abort()}tryUpdateScores(){const{propertySuggestionCall:e,filterKey:t,sortMode:n,targets:i,data:r,model:o}=this.props;if(e&&(t||"smart"===n)&&1===i.length){const n=i[0],s=o.language,a=t.trim(),l=r.links.map((e=>e.id));this.suggestionCancellation.abort(),this.suggestionCancellation=new AbortController;const c=this.suggestionCancellation.signal;e({elementId:n.id,token:a,properties:l,lang:s,signal:c}).then((e=>{const t=new Map;for(const n of e)t.set(n.propertyIri,n);this.setState({scores:t})}))}}isSmartMode(){return"smart"===this.props.sortMode&&!this.props.filterKey}compareLinks=(e,t)=>{const{model:n}=this.props,i=n.locale.formatLabel(e.label,e.id),r=n.locale.formatLabel(t.label,t.id);return i.localeCompare(r)};compareLinksByWeight=(e,t)=>{const{model:n}=this.props,{scores:i}=this.state,r=n.locale.formatLabel(e.label,e.id),o=n.locale.formatLabel(t.label,t.id),s=i.has(e.id)?i.get(e.id).score:0,a=i.has(t.id)?i.get(t.id).score:0;return s>a?-1:s<a?1:r.localeCompare(o)};getLinks(){const{model:e,data:t,filterKey:n}=this.props;return(t.links||[]).filter((t=>{const i=e.locale.formatLabel(t.label,t.id).toLowerCase();return!n||i.indexOf(n.toLowerCase())>=0})).sort(this.compareLinks)}getProbableLinks(){const{data:e}=this.props,{scores:t}=this.state,n=this.isSmartMode();return(e.links??[]).filter((e=>t.has(e.id)&&(t.get(e.id).score>0||n))).sort(this.compareLinksByWeight)}getViews=(e,t)=>{const{model:n,data:r}=this.props,{scores:o}=this.state,s=[],a=(e,a)=>{const{inCount:l,outCount:c,inexact:d}=r.counts.get(e.id)??{inCount:0,outCount:0,inexact:!1},u="in"===a?l:c;if(0===u)return;const h=t?"-probable":"";s.push((0,i.jsx)(I,{link:e,onExpandLink:this.props.onExpandLink,model:n,count:d&&u>0?"some":u,direction:a,filterKey:t?"":this.props.filterKey,onMoveToFilter:this.props.onMoveToFilter,probability:o.has(e.id)&&t?o.get(e.id).score:0},`${a}-${e.id}-${h}`))};for(const i of e)a(i,"in"),a(i,"out");return s};render(){const{model:e,allRelatedLink:t}=this.props,n=this.isSmartMode(),r=n?[]:this.getLinks(),o=this.getProbableLinks().filter((e=>-1===r.indexOf(e))),a=this.getViews(r),l=this.getViews(o,!0);let c;if(0===a.length&&0===l.length)c=(0,i.jsx)("label",{className:`reactodia-label ${L}__empty-label`,children:"List empty"});else if(c=a,a.length>1||n&&l.length>1){const n=this.props.data.counts,{inCount:r,outCount:o,inexact:s}=n.get(t.id),a=r+o;c=[(0,i.jsx)(I,{link:t,onExpandLink:this.props.onExpandLink,model:e,count:s&&a>0?"some":a,onMoveToFilter:this.props.onMoveToFilter},t.id),(0,i.jsx)("hr",{className:`${L}__links-list-hr`},"reactodia-hr-line")].concat(c)}let d=null;return 0!==l.length&&(d=[n?null:(0,i.jsx)("li",{children:(0,i.jsx)("span",{className:"reactodia-label",children:"Probably, you are looking for.."})},"probable-links"),l]),(0,i.jsxs)("ul",{className:s()(`${L}__links-list`,0===a.length&&0===l.length?`${L}__links-list-empty`:void 0),children:[c,d]})}}class I extends r.Component{render(){const{model:e,link:t,filterKey:n,direction:r,count:o,probability:s=0}=this.props,a=e.locale.formatLabel(t.label,t.id),l=Math.round(100*s),c=(0,x.highlightSubstring)(a+(l>0?" ("+l+"%)":""),n),d="in"===r?"source":"out"===r?"target":"all connected";return(0,i.jsxs)("li",{"data-linktypeid":t.id,className:`${L}__link`,title:`${d} of "${a}" ${e.locale.formatIri(t.id)}`,onClick:()=>this.onExpandLink(),children:["in"===r||"out"===r?(0,i.jsxs)("div",{className:`${L}__link-direction`,children:["in"===r&&(0,i.jsx)("div",{className:`${L}__link-direction-in`}),"out"===r&&(0,i.jsx)("div",{className:`${L}__link-direction-out`})]}):null,(0,i.jsx)(m.WithFetchStatus,{type:"linkType",target:t.id,children:(0,i.jsx)("div",{className:`${L}__link-title`,children:c})}),"some"===o?null:(0,i.jsx)("span",{className:`reactodia-badge ${L}__link-count`,children:o<=_?o:"100+"}),this.props.onMoveToFilter?(0,i.jsx)("div",{className:`${L}__link-filter-button`,onClick:this.onMoveToFilter,title:"Set as filter in the Instances panel"}):null,(0,i.jsx)("div",{className:`${L}__link-navigate-button`,title:`Navigate to ${d} "${a}" elements`})]})}onExpandLink(){const{count:e,direction:t}=this.props;this.props.onExpandLink({chunkId:(0,l.generate128BitID)(),link:this.props.link,direction:t,expectedCount:e,pageCount:1})}onMoveToFilter=e=>{e.stopPropagation();const{link:t,count:n,direction:i,onMoveToFilter:r}=this.props;r?.({chunkId:(0,l.generate128BitID)(),link:t,direction:i,expectedCount:n,pageCount:1})}}class T extends r.Component{constructor(e){super(e),this.state=T.makeStateFromProps(e)}static getDerivedStateFromProps(e,t){return t&&t.chunkId===e.data.chunk.chunkId?null:T.makeStateFromProps(e)}static makeStateFromProps(e){return{chunkId:e.data.chunk.chunkId,selection:new Set}}onSelectAll=()=>{const e=this.props.data.elements;if(0===e.length)return;const t=E(e,this.state.selection)?new Set:function(e){const t=new Set;for(const n of e)n.presentOnDiagram||t.add(n.model.id);return t}(this.props.data.elements);this.updateSelection(t)};getFilteredObjects(){if(!this.props.filterKey)return this.props.data.elements;const e=this.props.filterKey.toLowerCase();return this.props.data.elements.filter((t=>{const n=this.props.model.locale.formatLabel(t.model.label,t.model.id).toLowerCase();return n&&n.indexOf(e)>=0}))}getItems(e){const t={},n=[];for(const i of e)t[i.model.id]||(t[i.model.id]=!0,n.push(i.model));return n}updateSelection=e=>{this.setState({selection:e})};renderCounter(e){const{data:{chunk:t,elements:n}}=this.props,r=`${e}\xa0of\xa0${n.length}`;let o=null;if("some"!==t.expectedCount){const e=Math.min(_,t.expectedCount)-n.length,r=Math.abs(e)>_?"100+":Math.abs(e).toString();o=(0,i.jsx)("span",{className:`${L}__objects-extra`,title:0===e?void 0:e>0?"Unavailable nodes":"Extra nodes",children:0===e?null:`\xa0(${r})`})}return(0,i.jsxs)("div",{className:`reactodia-label ${L}__objects-count`,children:[(0,i.jsx)("span",{children:r}),o]})}render(){const{data:e,filterKey:t,onPressAddSelected:n,onMoveToFilter:r}=this.props,{selection:o}=this.state,a=this.getFilteredObjects(),l=E(a,o),c=a.filter((e=>!e.presentOnDiagram)),d=c.filter((e=>o.has(e.model.id)));return(0,i.jsxs)("div",{className:`${L}__objects`,children:[(0,i.jsx)("div",{className:`${L}__objects-select-all`,children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",name:"reactodia-connections-menu-select-all",checked:l&&c.length>0,onChange:this.onSelectAll,disabled:0===c.length}),"Select All"]})}),this.props.loading?(0,i.jsx)("label",{className:`reactodia-label ${L}__objects-loading`,children:"Loading..."}):0===a.length?(0,i.jsx)("label",{className:`reactodia-label ${L}__objects-loading`,children:"No available nodes"}):(0,i.jsxs)("div",{className:`${L}__objects-list`,children:[(0,i.jsx)(w.SearchResults,{items:this.getItems(a),selection:this.state.selection,onSelectionChanged:this.updateSelection,highlightText:t}),"some"!==e.chunk.expectedCount&&e.chunk.expectedCount>_?r?(0,i.jsx)("div",{className:`${L}__move-to-filter`,onClick:()=>r(e.chunk),children:"The list was truncated, for more data click here to use the filter panel"}):(0,i.jsx)("div",{className:`${L}__move-to-filter`,children:"The list was truncated."}):null]}),(0,i.jsxs)("div",{className:`${L}__objects-statusbar`,children:[this.renderCounter(d.length),(0,i.jsx)("button",{className:s()(`${L}__objects-add-button`,"reactodia-btn reactodia-btn-primary pull-right"),disabled:this.props.loading||0===c.length,onClick:()=>n(d.length>0?d:c),children:d.length>0?"Add selected":"Add all"})]})]})}}function E(e,t){let n=!0;for(const i of e)i.presentOnDiagram||(n=n&&t.has(i.model.id));return n}},(e,t,n)=>{n.r(t),n.d(t,{DropOnCanvas:()=>d});var i=n(58),r=n(55),o=n(91),s=n(92),a=n(71),l=n(108),c=n(115);function d(e){const{canvas:t}=(0,o.useCanvas)(),{model:n,editor:s,triggerWorkspaceEvent:d}=(0,c.useWorkspace)();return i.useEffect((()=>{const e=new r.EventObserver;return e.listen(t.events,"drop",(e=>{e.sourceEvent.preventDefault();const i=function(e){const t=(t,n=!1)=>{try{const i=e.dataTransfer.getData(t);if(!i)return;let r;try{r=JSON.parse(i)}catch(e){r=[n?decodeURI(i):i]}return 0===r.length?void 0:r}catch(e){return}};return t("application/x-reactodia-elements")||t("text/uri-list",!0)||t("text")||[]}(e.sourceEvent);if(i.length>0){const r=n.history.startBatch("Drag and drop onto diagram"),o=function({canvas:e,model:t},n,i){const r=n.map((e=>t.createElement(e)));for(const a of r)a.setPosition(i);e.renderingState.syncUpdate();let{x:o,y:s}=i,l=!0;for(const c of r){let{width:t,height:n}=(0,a.boundsOf)(c,e.renderingState);0===t&&(t=100),0===n&&(n=50),l&&(l=!1,o-=t/2,s-=n/2),c.setPosition({x:o,y:s}),s+=n+20}return r}({canvas:t,model:n},i,e.position),u=o.map((e=>e.iri));r.history.execute((0,l.requestElementData)(n,u)),r.history.execute((0,l.restoreLinksBetweenElements)(n)),r.store(),o.length>0&&o[o.length-1].focus(),s.setSelection(o),d(c.WorkspaceEventKey.editorAddElements)}})),()=>e.stopListening()}),[]),null}(0,s.defineCanvasWidget)(d,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{Halo:()=>p});var i=n(96),r=n(58),o=n(55),s=n(57),a=n(91),l=n(92),c=n(94),d=n(71),u=n(115),h=n(162);function p(e){const{canvas:t}=(0,a.useCanvas)(),{editor:n}=(0,u.useWorkspace)(),r=(0,s.useObservedProperty)(n.events,"changeSelection",(()=>n.selection));if(1===r.length){const[n]=r;if(n instanceof c.Element)return(0,i.jsx)(g,{...e,target:n,canvas:t})}return null}(0,l.defineCanvasWidget)(p,(e=>({element:e,attachment:"overElements"})));class g extends r.Component{targetListener=new o.EventObserver;constructor(e){super(e),this.state={}}componentDidMount(){const{target:e}=this.props;this.listenToElement(e)}componentDidUpdate(e){e.target!==this.props.target&&this.listenToElement(this.props.target)}componentWillUnmount(){this.listenToElement(void 0)}listenToElement(e){const{canvas:t}=this.props;this.targetListener.stopListening(),e&&(this.targetListener.listenAny(e.events,this.onElementEvent),this.targetListener.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.forceUpdate()})))}onElementEvent=e=>{(e.changePosition||e.changeExpanded)&&this.forceUpdate()};render(){const{target:e,canvas:t,margin:n=5,connectionsMenuCommands:r,instancesSearchCommands:o,children:s}=this.props,a=(0,d.boundsOf)(e,t.renderingState),{x:l,y:c}=t.metrics.paperToScrollablePaneCoords(a.x,a.y),{x:u,y:p}=t.metrics.paperToScrollablePaneCoords(a.x+a.width,a.y+a.height),g={left:l-n,top:c-n,width:u-l+2*n,height:p-c+2*n};return(0,i.jsx)("div",{className:"reactodia-halo",style:g,children:s??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.SelectionActionRemove,{dock:"ne"}),(0,i.jsx)(h.SelectionActionExpand,{dock:"s"}),(0,i.jsx)(h.SelectionActionAnchor,{dock:"w"}),(0,i.jsx)(h.SelectionActionConnections,{dock:"e",commands:r}),(0,i.jsx)(h.SelectionActionAddToFilter,{dock:"se",commands:o}),(0,i.jsx)(h.SelectionActionEstablishLink,{dock:"sw"})]})})}}},(e,t,n)=>{n.r(t),n.d(t,{SelectionAction:()=>b,SelectionActionAddToFilter:()=>T,SelectionActionAnchor:()=>M,SelectionActionConnections:()=>I,SelectionActionEstablishLink:()=>E,SelectionActionExpand:()=>S,SelectionActionLayout:()=>_,SelectionActionRemove:()=>k,SelectionActionSpinner:()=>v,SelectionActionZoomToFit:()=>L});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(52),l=n(55),c=n(57),d=n(91),u=n(65),h=n(94),p=n(71),g=n(107),f=n(116),m=n(115);const y="reactodia-selection-action";function b(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a,disabled:l,onSelect:c,onMouseDown:d,children:u}=e;return(0,i.jsx)("button",{type:"button",className:s()(y,x(t),o),style:w(n,r),title:a,disabled:l,onClick:c,onMouseDown:d,children:u})}function x(e){switch(e){case"nw":return`${y}--dock-nw`;case"n":return`${y}--dock-n`;case"ne":return`${y}--dock-ne`;case"e":return`${y}--dock-e`;case"se":return`${y}--dock-se`;case"s":return`${y}--dock-s`;case"sw":return`${y}--dock-sw`;case"w":return`${y}--dock-w`;default:return}}function w(e,t){return{"--reactodia-dock-x":t??0,"--reactodia-dock-y":e??0}}function v(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a}=e;return(0,i.jsx)("div",{role:"button",className:s()(o,x(t),`${y}__spinner`),style:w(n,r),title:a,children:(0,i.jsx)(g.HtmlSpinner,{width:20,height:20})})}function k(e){const{className:t,title:n,...r}=e,{editor:o}=(0,m.useWorkspace)(),a=o.selection.filter((e=>e instanceof h.Element)),l=Boolean(1===a.length&&f.AuthoringState.isNewElement(o.authoringState,a[0].iri));return(0,i.jsx)(b,{...r,className:s()(t,l?`${y}__delete`:`${y}__remove`),title:n||(l?"Delete new element":1===a.length?"Remove an element from the diagram":"Remove selected elements from the diagram"),onSelect:()=>o.removeSelectedElements()})}function L(e){const{className:t,title:n,...r}=e,{model:o,editor:a}=(0,m.useWorkspace)(),{canvas:l}=(0,d.useCanvas)(),c=a.selection.filter((e=>e instanceof h.Element));return c.length<=1?null:(0,i.jsx)(b,{...r,className:s()(t,`${y}__zoomToFit`),title:n??"Zoom to fit selected elements into view",onSelect:()=>{const e=new Set;for(const n of c)for(const t of o.getElementLinks(n))e.add(t);const t=(0,p.getContentFittingBox)(c,e,l.renderingState);l.zoomToFitRect(t,{animate:!0})}})}function _(e){const{className:t,title:n,...r}=e,{editor:o,performLayout:a}=(0,m.useWorkspace)(),{canvas:l}=(0,d.useCanvas)(),c=o.selection.filter((e=>e instanceof h.Element));return c.length<=1?null:(0,i.jsx)(b,{...r,className:s()(t,`${y}__layout`),title:n??"Layout selected elements using force-directed algorithm",onSelect:()=>{a({canvas:l,selectedElements:new Set(c),animate:!0})}})}function S(e){const{className:t,title:n,...o}=e,{model:a,editor:d}=(0,m.useWorkspace)(),p=d.selection.filter((e=>e instanceof h.Element)),g=function(e,t){return r.useCallback((n=>{if(0===t.length)return()=>{};const i=new Set(t),r=new l.EventObserver;return r.listen(e.events,"elementEvent",(({data:e})=>{e.changeExpanded&&i.has(e.changeExpanded.source)&&n()})),()=>r.stopListening()}),[e.events,t])}(a,p),f=(0,c.useFrameDebouncedStore)(g),x=(0,c.useSyncStore)(f,(()=>p.every((e=>e.isExpanded))));return(0,i.jsx)(b,{...o,className:s()(t,x?`${y}__collapse`:`${y}__expand`),title:n??(1===p.length?"Expand an element to reveal additional properties":"Expand all elements  to reveal additional properties"),onSelect:()=>{if(1===p.length){const e=p[0];a.history.execute((0,u.setElementExpanded)(e,!e.isExpanded))}else{const e=a.history.startBatch(x?"Collapse elements":"Expand elements");for(const t of p)e.history.execute((0,u.setElementExpanded)(t,!x));e.store()}}})}function M(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a}=e,{view:l,editor:c}=(0,m.useWorkspace)(),d=c.selection.filter((e=>e instanceof h.Element));if(1!==d.length)return null;const[u]=d;return(0,i.jsx)("a",{role:"button",className:s()(y,x(t),o,`${y}__link`),style:w(n,r),href:u.iri,title:a??"Jump to resource",onClick:e=>l.onIriClick(u.iri,u,"jumpToEntity",e)})}function I(e){const{className:t,title:n,commands:r,...o}=e,{editor:a,overlay:l}=(0,m.useWorkspace)(),c=a.selection.filter((e=>e instanceof h.Element));if(!r)return null;const{openedDialog:d}=l,u=Boolean(d&&"connectionsMenu"===d.knownType);return(0,i.jsx)(b,{...o,className:s()(t,u?`${y}__navigate-close`:`${y}__navigate-open`),title:n??"Navigate to connected elements",onSelect:()=>{u?l.hideDialog():r.trigger("show",{targets:c})}})}function T(e){const{className:t,title:n,commands:r,...o}=e,{editor:a}=(0,m.useWorkspace)(),l=a.selection.filter((e=>e instanceof h.Element));if(!r||1!==l.length)return null;const[c]=l;return(0,i.jsx)(b,{...o,className:s()(t,`${y}__add-to-filter`),title:n??"Search for connected elements",onSelect:()=>{r.trigger("setCriteria",{criteria:{refElement:c}})}})}function E(e){const{className:t,title:n,...o}=e,{editor:l,overlay:u}=(0,m.useWorkspace)(),{canvas:p}=(0,d.useCanvas)(),g=(0,c.useObservedProperty)(l.events,"changeMode",(()=>l.inAuthoringMode)),f=l.selection.filter((e=>e instanceof h.Element)),x=1===f.length?f[0]:void 0,w=function(e,t){const[n,i]=r.useState(),o=(0,c.useEventStore)(e.events,"changeAuthoringState"),s=(0,c.useFrameDebouncedStore)(o),l=(0,c.useSyncStore)(s,(()=>e.authoringState)),d=t?l.elements.get(t.iri):void 0;return r.useEffect((()=>{const n=new AbortController;if(e.metadataApi&&t){if(d&&d.deleted)i(!1);else{i(void 0);const r=n.signal;(0,a.mapAbortedToNull)(e.metadataApi.canLinkElement(t.data,r),r).then((e=>{null!==e&&i(e)}))}return()=>n.abort()}i(!1)}),[t,d]),n}(l,x);if(!x||!g)return null;if(void 0===w){const{dock:t,dockRow:n,dockColumn:r}=e;return(0,i.jsx)(v,{dock:t,dockRow:n,dockColumn:r})}return(0,i.jsx)(b,{...o,className:s()(t,`${y}__establish-link`),disabled:!w,title:n??(w?"Establish link":"Establishing link is not allowed for the element"),onMouseDown:e=>{const t=p.metrics.pageToPaperCoords(e.pageX,e.pageY);u.startEditing({target:x,mode:"establishLink",point:t})}})}},(e,t,n)=>{n.r(t),n.d(t,{HaloLink:()=>g});var i=n(96),r=n(58),o=n(55),s=n(57),a=n(91),l=n(92),c=n(94),d=n(71),u=n(100),h=n(115),p=n(164);function g(e){const{canvas:t,model:n}=(0,a.useCanvas)(),{editor:r}=(0,h.useWorkspace)(),o=(0,s.useEventStore)(r.events,"changeSelection");if(1===(0,s.useSyncStore)(o,(()=>r.selection)).length){const[o]=r.selection;if(o instanceof c.Link)return(0,i.jsx)(x,{...e,target:o,model:n,canvas:t})}return null}(0,l.defineCanvasWidget)(g,(e=>({element:e,attachment:"overElements"})));const f="reactodia-halo-link",m=0,y=20,b=5;class x extends r.Component{targetListener=new o.EventObserver;constructor(e){super(e),this.state={actionContext:x.makeActionContext(this.props)}}static makeActionContext(e){const{target:t,model:n,canvas:i,buttonSize:r=y,buttonMargin:o=b}=e,s=function(e,t,n){const i=t.getElement(e.sourceId),r=t.getElement(e.targetId);if(!i||!r)return;const o=n.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s;return(0,d.computePolyline)((0,d.boundsOf)(i,n),(0,d.boundsOf)(r,n),a)}(t,n,i.renderingState);if(!s)return null;const a=(0,d.computePolylineLength)(s);return{link:t,polyline:s,buttonSize:r,getPosition:(e,t)=>{const n=(r+o)*t,l=(0,d.getPointAlongPolyline)(s,"source"===e?n:a-n),{x:c,y:u}=i.metrics.paperToScrollablePaneCoords(l.x,l.y);return{top:u-r/2,left:c-r/2}},getAngleInDegrees:e=>{const t=s["source"===e?1:s.length-1],n=s["source"===e?0:s.length-2],i=d.Vector.normalize(d.Vector.subtract(n,t));return Math.atan2(i.y,i.x)*(180/Math.PI)}}}componentDidMount(){const{target:e}=this.props;this.listenToTarget(e)}componentDidUpdate(e){this.props.target!==e.target&&this.listenToTarget(this.props.target),this.props.target===e.target&&this.props.buttonSize===e.buttonSize&&this.props.buttonMargin===e.buttonMargin||this.updateActionContext()}componentWillUnmount(){this.listenToTarget(void 0)}listenToTarget(e){const{model:t,canvas:n}=this.props;if(this.targetListener.stopListening(),e){const i=t.getElement(e.sourceId),r=t.getElement(e.targetId);this.targetListener.listen(i.events,"changePosition",this.updateActionContext),this.targetListener.listen(r.events,"changePosition",this.updateActionContext),this.targetListener.listen(e.events,"changeVertices",this.updateActionContext),this.targetListener.listen(n.renderingState.events,"changeElementSize",(e=>{e.source!==i&&e.source!==r||this.updateActionContext()}))}}updateActionContext=()=>{this.setState(((e,t)=>({actionContext:x.makeActionContext(t)})))};render(){const{canvas:e,highlightMargin:t=m,buttonSize:n=y,buttonMargin:r=b,children:o}=this.props,{actionContext:s}=this.state;if(!s)return null;const a={"--reactodia-link-button-size":`${n}px`,"--reactodia-link-button-margin":`${r}px`};return(0,i.jsxs)("div",{className:`${f}`,style:a,children:[(0,i.jsx)(w,{actionContext:s,margin:t,canvas:e}),(0,i.jsx)(p.LinkActionContext.Provider,{value:s,children:o??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.LinkActionMoveEndpoint,{dockSide:"target"}),(0,i.jsx)(p.LinkActionMoveEndpoint,{dockSide:"source"}),(0,i.jsx)(p.LinkActionEdit,{dockSide:"target",dockIndex:1}),(0,i.jsx)(p.LinkActionDelete,{dockSide:"target",dockIndex:2}),(0,i.jsx)(p.LinkActionRename,{})]})})]})}}function w(e){const{actionContext:{link:t,polyline:n},margin:r,canvas:o}=e,a=(0,s.useEventStore)(o.renderingState.events,"changeLinkLabelBounds"),l=(0,s.useSyncStore)(a,(()=>o.renderingState.getLinkLabelBounds(t)));if(!l)return null;const{x:c,y:h}=o.metrics.paperToScrollablePaneCoords(l.x,l.y),{x:p,y:g}=o.metrics.paperToScrollablePaneCoords(l.x+l.width,l.y+l.height),m={left:c-r,top:h-r,width:p-c+2*r,height:g-h+2*r},y=(0,d.pathFromPolyline)(n);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:`${f}__label-highlight`,style:m}),(0,i.jsx)(u.TransformedSvgCanvas,{paperTransform:o.metrics.getTransform(),style:{overflow:"visible",pointerEvents:"none"},children:(0,i.jsx)("path",{className:`${f}__path-highlight`,d:y})})]})}},(e,t,n)=>{n.r(t),n.d(t,{LinkAction:()=>f,LinkActionContext:()=>h,LinkActionDelete:()=>b,LinkActionEdit:()=>y,LinkActionMoveEndpoint:()=>x,LinkActionRename:()=>w,LinkActionSpinner:()=>m,useLinkActionContext:()=>p});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(52),l=n(57),c=n(91),d=n(107),u=n(115);const h=r.createContext(null);function p(){const e=r.useContext(h);if(!e)throw new Error("Missing context for LinkAction");return e}const g="reactodia-link-action";function f(e){const{dockSide:t,dockIndex:n,className:r,title:o,onSelect:a,onMouseDown:l,children:c}=e,{getPosition:d}=p();return(0,i.jsx)("button",{role:"button",className:s()(r,g),style:d(t,n),title:o,onClick:a,onMouseDown:l,children:c})}function m(e){const{dockSide:t,dockIndex:n,className:r,title:o}=e,{buttonSize:a,getPosition:l}=p();return(0,i.jsx)("div",{className:s()(r,`${g}__spinner`),style:l(t,n),title:o,children:(0,i.jsx)(d.HtmlSpinner,{width:a,height:a})})}function y(e){const{className:t,title:n,...o}=e,{link:c}=p(),{model:d,editor:h,overlay:y}=(0,u.useWorkspace)(),b=function(e,t,n){const[i,o]=r.useState(),s=(0,l.useEventStore)(n.events,"changeAuthoringState"),c=(0,l.useFrameDebouncedStore)(s),d=(0,l.useSyncStore)(c,(()=>n.authoringState));return r.useEffect((()=>{const i=new AbortController;if(n.metadataApi){if(v(d,e))o(!1);else{o(void 0);const r=t.getElement(e.sourceId),s=t.getElement(e.targetId),l=i.signal;(0,a.mapAbortedToNull)(n.metadataApi.canDeleteLink(e.data,r.data,s.data,l),l).then((e=>{null!==e&&o(e)}))}return()=>i.abort()}o(!1)}),[e,d]),i}(c,d,h),x=v(h.authoringState,c);if(!h.inAuthoringMode||x)return null;if(void 0===b){const{dockSide:t,dockIndex:n}=e;return(0,i.jsx)(m,{dockSide:t,dockIndex:n})}return(0,i.jsx)(f,{...o,className:s()(t,`${g}__button`,`${g}__edit`),title:n??(b?"Edit link":"Editing is unavailable for the selected link"),disabled:!b,onSelect:()=>y.showEditLinkForm(c)})}function b(e){const{className:t,title:n,...o}=e,{link:c}=p(),{model:d,editor:h}=(0,u.useWorkspace)(),y=function(e,t,n){const[i,o]=r.useState(),s=(0,l.useEventStore)(n.events,"changeAuthoringState"),c=(0,l.useFrameDebouncedStore)(s),d=(0,l.useSyncStore)(c,(()=>n.authoringState));return r.useEffect((()=>{const i=new AbortController;if(n.metadataApi){if(L(d,e))o(!1);else{o(void 0);const r=t.getElement(e.sourceId),s=t.getElement(e.targetId),l=i.signal;(0,a.mapAbortedToNull)(n.metadataApi.canDeleteLink(e.data,r.data,s.data,l),l).then((e=>{null!==e&&o(e)}))}return()=>i.abort()}o(!1)}),[e,d]),i}(c,d,h),b=k(h.authoringState,c)||L(h.authoringState,c);if(!h.inAuthoringMode||b)return null;if(void 0===y){const{dockSide:t,dockIndex:n}=e;return(0,i.jsx)(m,{dockSide:t,dockIndex:n})}return(0,i.jsx)(f,{...o,className:s()(t,`${g}__button`,`${g}__delete`),title:n??(y?"Delete link":"Deletion is unavailable for the selected link"),disabled:!y,onSelect:()=>h.deleteLink(c.data)})}function x(e){const{dockSide:t,className:n,title:r,...o}=e,{link:a,buttonSize:l,getAngleInDegrees:d}=p(),{canvas:h}=(0,c.useCanvas)(),{editor:m,overlay:y}=(0,u.useWorkspace)();if(!m.inAuthoringMode)return null;const b=d(t);return(0,i.jsx)(f,{...o,dockSide:t,dockIndex:0,className:s()(n,`${g}__endpoint`),title:r??("source"===t?"Move link source":"Move link target"),disabled:!v(m.authoringState,a),onMouseDown:e=>{const n=h.metrics.pageToPaperCoords(e.pageX,e.pageY);y.startEditing({target:a,mode:"source"===t?"moveLinkSource":"moveLinkTarget",point:n})},children:(0,i.jsx)("svg",{width:l,height:l,style:{transform:`rotate(${b}deg)`},children:(0,i.jsx)("g",{transform:`scale(${l})`,children:"source"===t?(0,i.jsx)("circle",{r:.5,cx:.5,cy:.5,fill:"#198AD3"}):(0,i.jsx)("polygon",{points:"0,0.5 1,1 1,0",fill:"#198AD3"})})})})}function w(e){const{className:t,title:n}=e,{link:r}=p(),{canvas:o}=(0,c.useCanvas)(),{model:a,overlay:d}=(0,u.useWorkspace)(),h=(0,l.useEventStore)(o.renderingState.events,"changeLinkLabelBounds"),f=(0,l.useSyncStore)(h,(()=>o.renderingState.getLinkLabelBounds(r))),m=a.getLinkType(r.typeId);if(!m)return null;if(!o.renderingState.createLinkTemplate(m).editableLabel||!f)return null;const{x:y,y:b,width:x,height:w}=f,{x:v,y:k}=o.metrics.paperToScrollablePaneCoords(y+x,b+w/2),L=17,_={width:15,height:L,left:v,top:k-L/2};return(0,i.jsx)("button",{className:s()(t,`${g}__rename`),style:_,title:n??"Rename link",onClick:()=>d.showRenameLinkForm(r)})}function v(e,t){return k(e,t)||L(e,t)}function k(e,t){const n=e.links.get(t.data);return n&&n.deleted}function L(e,t){const n=e.elements.get(t.data.sourceId),i=e.elements.get(t.data.targetId);return n&&n.deleted||i&&i.deleted}},(e,t,n)=>{n.r(t),n.d(t,{Dropdown:()=>c,DropdownItem:()=>u,useInsideDropdown:()=>h});var i=n(96),r=n(58),o=n(106),s=n.n(o);const a="reactodia-dropdown",l=r.createContext(null);function c(e){const{className:t,title:n,children:o}=e,c=r.useRef(null),[d,u]=r.useState(!1),h=r.useMemo((()=>({closeMenu:()=>u(!1)})),[u]);return r.useLayoutEffect((()=>{if(d){const e=e=>{e.target instanceof Node&&!c.current?.contains(e.target)&&u(!1)};return document.body.addEventListener("click",e),()=>document.body.removeEventListener("click",e)}}),[d]),(0,i.jsx)(l.Provider,{value:h,children:(0,i.jsxs)("nav",{ref:c,className:s()(t,a,d?`${a}--expanded`:`${a}--collapsed`),children:[(0,i.jsx)("button",{type:"button",className:`${a}__toggle reactodia-btn reactodia-btn-default`,title:n,onClick:()=>u((e=>!e))}),(0,i.jsx)("ul",{role:"menu",className:`${a}__items`,children:o})]})})}const d="reactodia-dropdown-item";function u(e){const{className:t,title:n,disabled:o,onSelect:a,children:c}=e,u=r.useContext(l),h=r.useCallback((()=>{u?.closeMenu(),a?.()}),[a,u]);return(0,i.jsx)("li",{role:"menuitem",className:s()(t,d,o?`${d}--disabled`:void 0,"reactodia-btn reactodia-btn-default"),title:n,onClick:o?void 0:h,children:c})}function h(){const e=r.useContext(l);return Boolean(e)}},(e,t,n)=>{n.r(t),n.d(t,{LinkTypesToolbox:()=>b});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(76),l=n(55),c=n(65),d=n(94),u=n(136),h=n(115),p=n(130),g=n(124);const f="link-types-toolbox";class m extends r.Component{onPressFilter=()=>{this.props.onPressFilter&&this.props.onPressFilter(this.props.link)};changeState(e){x(this.props.model.history,e,[this.props.link])}isChecked(e){return this.props.link.visibility===e}getText(){const{link:e,model:t,filterKey:n}=this.props,i=t.locale.formatLabel(e.label,e.id);return(0,p.highlightSubstring)(i,n)}render(){return(0,i.jsxs)("li",{"data-linktypeid":this.props.link.id,className:s()(`${f}__link-item`,"clearfix"),children:[(0,i.jsxs)("span",{"data-toggle":"buttons",className:s()(`${f}__link-buttons`,"reactodia-btn-group reactodia-btn-group-xs"),children:[(0,i.jsx)("button",{id:"hidden",title:"Hide links and labels",className:s()(`${f}__toggle-invisible`,"reactodia-btn reactodia-btn-default",this.isChecked("hidden")?"active":void 0),onClick:()=>this.changeState("hidden")}),(0,i.jsx)("button",{id:"withoutLabel",title:"Show only lines for links (without labels)",className:s()(`${f}__toggle-lines-only`,"reactodia-btn reactodia-btn-default",this.isChecked("withoutLabel")?"active":void 0),onClick:()=>this.changeState("withoutLabel")}),(0,i.jsx)("button",{id:"visible",title:"Show links with labels",className:s()(`${f}__toggle-visible`,"reactodia-btn reactodia-btn-default",this.isChecked("visible")?"active":void 0),onClick:()=>this.changeState("visible")})]}),(0,i.jsx)(u.WithFetchStatus,{type:"linkType",target:this.props.link.id,children:(0,i.jsx)("div",{className:`${f}__link-title`,children:this.getText()})}),0===this.props.count?null:(0,i.jsx)("span",{className:s()(`${f}__count-badge`,"reactodia-badge"),children:this.props.count}),this.props.onPressFilter?(0,i.jsx)("div",{className:`${f}__filter-button`,onClick:this.onPressFilter}):null]})}}class y extends r.Component{constructor(e){super(e),this.state={filterKey:""}}compareLinks=(e,t)=>{const{model:n}=this.props,i=n.locale.formatLabel(e.label,e.id),r=n.locale.formatLabel(t.label,t.id);return i.localeCompare(r)};onChangeInput=e=>{this.setState({filterKey:e.currentTarget.value})};onDropFilter=()=>{this.setState({filterKey:""})};getLinks(){const{model:e,links:t=[]}=this.props;return t.filter((t=>{const n=e.locale.formatLabel(t.label,t.id).toLowerCase();return!this.state.filterKey||n.indexOf(this.state.filterKey.toLowerCase())>=0})).sort(this.compareLinks)}getViews(e){const t=this.props.countMap||{},n=[];for(const r of e)n.push((0,i.jsx)(m,{model:this.props.model,link:r,onPressFilter:this.props.filterCallback,count:t[r.id]||0,filterKey:this.state.filterKey},r.id));return n}render(){const{model:e,dataState:t,selectedElement:n}=this.props,r=e.history,o=this.getLinks(),a=this.getViews(o);let l=null;if(n){const t=e.locale.formatLabel(n.data.label,n.iri);l=(0,i.jsxs)("span",{role:"heading",className:`${f}__links-heading`,style:{display:"block"},children:["Connected to","\xa0",(0,i.jsx)("span",{children:t})]})}let c=null;this.state.filterKey&&(c=(0,i.jsx)("button",{type:"button",className:`${f}__clearSearch`,onClick:this.onDropFilter,children:(0,i.jsx)("span",{"aria-hidden":"true"})}));const d=o.length>0;return(0,i.jsxs)("div",{className:f,children:[(0,i.jsxs)("div",{className:`${f}__heading`,children:[(0,i.jsxs)("div",{className:`${f}__searching-box`,children:[(0,i.jsx)("input",{className:"search-input reactodia-form-control",type:"text",value:this.state.filterKey,onChange:this.onChangeInput,placeholder:"Search for..."}),c]}),(0,i.jsxs)("div",{className:`${f}__switch-all`,children:[(0,i.jsxs)("div",{className:"reactodia-btn-group reactodia-btn-group-xs",children:[(0,i.jsx)("button",{title:"Hide links and labels",className:s()(`${f}__toggle-invisible`,"reactodia-btn reactodia-btn-default"),disabled:!d,onClick:()=>x(r,"hidden",o)}),(0,i.jsx)("button",{title:"Show only lines for links (without labels)",className:s()(`${f}__toggle-lines-only`,"reactodia-btn reactodia-btn-default"),disabled:!d,onClick:()=>x(r,"withoutLabel",o)}),(0,i.jsx)("button",{title:"Show links with labels",className:s()(`${f}__toggle-visible`,"reactodia-btn reactodia-btn-default"),disabled:!d,onClick:()=>x(r,"visible",o)})]}),(0,i.jsx)("span",{children:"\xa0Switch all"})]})]}),(0,i.jsx)(g.ProgressBar,{state:t,title:"Loading connected links for the selected element"}),(0,i.jsxs)("div",{className:`${f}__rest`,children:[l,(0,i.jsx)("div",{className:"reactodia-scrollable",children:(0,i.jsx)("ul",{className:`${f}__connected-links`,children:a})})]})]})}}class b extends r.Component{static contextType=h.WorkspaceContext;listener=new l.EventObserver;linkListener=new l.EventObserver;debounceSelection=new a.Debouncer(50);currentRequest;constructor(e,t){super(e,t);const{model:n,editor:i}=this.context;this.listener.listen(n.events,"loadingSuccess",this.updateOnCurrentSelection),this.listener.listen(n.events,"changeLanguage",this.updateOnCurrentSelection),this.listener.listen(i.events,"changeSelection",(()=>{this.debounceSelection.call(this.updateOnCurrentSelection)})),this.state={dataState:"none"}}componentDidMount(){this.updateOnCurrentSelection()}componentWillUnmount(){this.listener.stopListening(),this.linkListener.stopListening(),this.debounceSelection.dispose()}updateOnCurrentSelection=()=>{const{editor:e}=this.context,t=1===e.selection.length?e.selection[0]:null;t!==this.state.selectedElement&&t instanceof d.Element&&this.requestLinksOf(t)};requestLinksOf(e){const{model:t}=this.context;if(e){const n={elementId:e.iri};this.currentRequest=n,this.setState({dataState:"loading",selectedElement:e}),t.dataProvider.connectedLinkStats(n).then((e=>{if(this.currentRequest!==n)return;const{linksOfElement:t,countMap:i}=this.computeStateFromRequestResult(e);this.subscribeOnLinksEvents(t),this.setState({dataState:"completed",linksOfElement:t,countMap:i})})).catch((e=>{this.currentRequest===n&&(console.error(e),this.setState({dataState:"error",linksOfElement:void 0,countMap:{}}))}))}else this.currentRequest=void 0,this.setState({dataState:"completed",selectedElement:e,linksOfElement:void 0,countMap:{}})}computeStateFromRequestResult(e){const{model:t}=this.context,n=[],i={};for(const r of e){const e=t.createLinkType(r.id);n.push(e),i[r.id]=r.inCount+r.outCount}return{linksOfElement:n,countMap:i}}subscribeOnLinksEvents(e){this.linkListener.stopListening();const t=this.linkListener;for(const n of e)t.listen(n.events,"changeLabel",this.onLinkChanged),t.listen(n.events,"changeVisibility",this.onLinkChanged)}onLinkChanged=()=>{this.forceUpdate()};render(){const{instancesSearchCommands:e}=this.props,{model:t}=this.context,{selectedElement:n,dataState:r,linksOfElement:o,countMap:s}=this.state;return(0,i.jsx)(y,{model:t,dataState:r,links:o,countMap:s,filterCallback:e?this.onAddToFilter:void 0,selectedElement:n})}onAddToFilter=e=>{const{instancesSearchCommands:t}=this.props,{selectedElement:n}=this.state;t?.trigger("setCriteria",{criteria:{refElement:n,refElementLink:e}})}}function x(e,t,n){const i=e.startBatch("Change link types visibility");for(const r of n)e.execute((0,c.changeLinkTypeVisibility)(r,t));i.store()}},(e,t,n)=>{n.r(t),n.d(t,{Navigator:()=>h});var i=n(96),r=n(58),o=n(76),s=n(55),a=n(91),l=n(92),c=n(71),d=n(100),u=n(115);function h(e){const{canvas:t}=(0,a.useCanvas)(),n=(0,u.useWorkspace)();return(0,i.jsx)(L,{...e,canvas:t,workspace:n})}const p="reactodia-navigator",g=!0,f=300,m=160,y=.2,b="#F5F5F5",x="#F5F5F5",w="#FFFFFF",v={color:"#EEEEEE",width:2},k={color:"#EEEEEE",width:2,dash:[5,5]};class L extends r.Component{delayedRedraw=new o.Debouncer;listener=new s.EventObserver;canvas;transform;isDraggingViewport=!1;constructor(e){super(e);const{expanded:t=g}=this.props;this.state={expanded:t}}componentDidMount(){const{canvas:e,workspace:{model:t}}=this.props,{renderingState:n}=e;this.listener.listen(t.events,"changeCells",this.scheduleRedraw),this.listener.listen(t.events,"elementEvent",this.scheduleRedraw),this.listener.listen(e.events,"pointerMove",this.scheduleRedraw),this.listener.listen(e.events,"scroll",this.scheduleRedraw),this.listener.listen(n.shared.events,"changeHighlight",this.scheduleRedraw),this.listener.listen(n.events,"changeElementSize",this.scheduleRedraw)}shouldComponentUpdate(e,t){return!(e.width===this.props.width&&e.height===this.props.height&&t===this.state)}componentWillUnmount(){this.delayedRedraw.dispose(),this.listener.stopListening(),this.stopDragViewport()}scheduleRedraw=()=>{this.state.expanded&&this.delayedRedraw.call(this.draw)};draw=()=>{const{canvas:e,workspace:{model:t},width:n=f,height:i=m,backgroundFill:r=b,scrollablePaneFill:o=x}=this.props,s=e.metrics.getTransform();this.calculateTransform(s);const a=this.canvas.getContext("2d");if(a.fillStyle=r,a.clearRect(0,0,n,i),a.fillRect(0,0,n,i),0===t.elements.length)return;const l=(0,d.paneTopLeft)(s),u=c.Vector.add(l,(0,d.totalPaneSize)(s)),h=S(l,s,this.transform),p=S(u,s,this.transform);a.fillStyle=o,a.fillRect(h.x,h.y,p.x-h.x,p.y-h.y),a.save();const{clientWidth:g,clientHeight:y}=e.metrics.area,w=e.metrics.clientToScrollablePaneCoords(0,0),v=e.metrics.clientToScrollablePaneCoords(g,y),{x:k,y:L}=S(w,s,this.transform),{x:_,y:M}=S(v,s,this.transform),I={x:k,y:L,width:_-k,height:M-L};this.fillViewport(a,I),this.drawElements(a,s),this.strokeViewport(a,I),a.restore()};drawElements(e,t){const{canvas:n,workspace:{model:i}}=this.props;i.elements.forEach((i=>{const{x:r,y:o,width:s,height:a}=(0,c.boundsOf)(i,n.renderingState);e.fillStyle=this.chooseElementColor(i);const{x:l,y:d}=M({x:r,y:o},t,this.transform),{x:u,y:h}=M({x:r+s,y:o+a},t,this.transform);e.fillRect(l,d,u-l,h-d)}))}chooseElementColor(e){const{canvas:t,workspace:{getElementTypeStyle:n}}=this.props,{highlighter:i}=t.renderingState.shared;if(i&&!i(e))return"lightgray";const{color:r}=n(e.data.types);return r}fillViewport(e,t){const{viewportFill:n=w}=this.props;e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)}strokeViewport(e,t){const{width:n=f,height:i=m,viewportStroke:r=v,overflowStroke:o=k}=this.props,{x:s,y:a}=t,l=s+t.width,c=a+t.height;if(_(e,r),e.strokeRect(s,a,l-s,c-a),e.beginPath(),s<0){const t=e.lineWidth;e.moveTo(t,a),e.lineTo(t,c)}if(a<0){const t=e.lineWidth;e.moveTo(s,t),e.lineTo(l,t)}if(l>n){const t=n-e.lineWidth;e.moveTo(t,a),e.lineTo(t,c)}if(c>i){const t=i-e.lineWidth;e.moveTo(s,t),e.lineTo(l,t)}_(e,o),e.stroke()}calculateTransform(e){const{canvas:t,workspace:{model:n},width:i=f,height:r=m,scalePadding:o=y}=this.props,s=(0,c.getContentFittingBox)(n.elements,n.links,t.renderingState),a=Math.max(s.width,i/.25)*o,l=Math.max(s.height,r/.25)*o,u=(0,d.paneFromPaperCoords)({x:s.x-a,y:s.y-l},e),h=(0,d.paneFromPaperCoords)({x:s.x+s.width+a,y:s.y+s.height+l},e),p=h.x-u.x,g=h.y-u.y,b=Math.min(i/p,r/g),x={x:(i-p*b)/2,y:(r-g*b)/2};this.transform={scale:b,canvasOffset:x,paneOffset:u}}canvasFromPageCoords(e,t){const{top:n,left:i}=this.canvas.getBoundingClientRect();return{x:e-i-window.scrollX,y:t-n-window.scrollY}}render(){const{width:e=f,height:t=m}=this.props,{expanded:n}=this.state;return(0,i.jsxs)("div",{className:`${p} ${p}--${n?"expanded":"collapsed"}`,style:n?{width:e,height:t}:void 0,children:[(0,i.jsx)("canvas",{ref:this.onCanvasMount,width:e,height:t,onMouseDown:e=>{this.startDragViewport(),this.onDragViewport(e)},onWheel:this.onWheel}),(0,i.jsx)("button",{type:"button",className:`${p}__toggle`,title:n?"Collapse navigator":"Expand navigator",onClick:this.onToggleClick,children:(0,i.jsx)("div",{className:`${p}__toggle-icon`})})]})}onCanvasMount=e=>{this.canvas=e};startDragViewport(){this.isDraggingViewport||(this.isDraggingViewport=!0,document.addEventListener("mousemove",this.onDragViewport),document.addEventListener("mouseup",this.onMouseUp))}stopDragViewport(){this.isDraggingViewport&&(this.isDraggingViewport=!1,document.removeEventListener("mousemove",this.onDragViewport),document.removeEventListener("mouseup",this.onMouseUp))}onDragViewport=e=>{if(e.preventDefault(),this.isDraggingViewport){const{canvas:t}=this.props,n=function(e,t,n){const i={x:n.paneOffset.x+(e.x-n.canvasOffset.x)/n.scale,y:n.paneOffset.y+(e.y-n.canvasOffset.y)/n.scale};return(0,d.paperFromPaneCoords)(i,t)}(this.canvasFromPageCoords(e.pageX,e.pageY),t.metrics.getTransform(),this.transform);t.centerTo(n)}};onMouseUp=()=>{this.stopDragViewport()};onWheel=e=>{e.preventDefault();const{canvas:t}=this.props,n=Math.max(-1,Math.min(1,e.deltaY||e.deltaX));t.zoomBy(.1*-n)};onToggleClick=()=>{this.setState((e=>({expanded:!e.expanded})),this.scheduleRedraw)}}function _(e,t){const{color:n="transparent",width:i=1,dash:r=[]}=t;e.strokeStyle=n,e.lineWidth=i,e.setLineDash(r)}function S(e,t,n){return{x:n.canvasOffset.x+(e.x-n.paneOffset.x)*n.scale,y:n.canvasOffset.y+(e.y-n.paneOffset.y)*n.scale}}function M(e,t,n){return S((0,d.paneFromPaperCoords)(e,t),0,n)}(0,l.defineCanvasWidget)(h,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{Selection:()=>f});var i=n(96),r=n(58),o=n(54),s=n(55),a=n(57),l=n(91),c=n(92),d=n(94),u=n(71),h=n(115),p=n(162);const g="reactodia-selection";function f(e){const{canvas:t}=(0,l.useCanvas)(),{model:n,editor:c}=(0,h.useWorkspace)(),u=(0,a.useEventStore)(c.events,"changeSelection"),p=(0,a.useSyncStore)(u,(()=>c.selection.filter((e=>e instanceof d.Element))),o.shallowArrayEqual),[g,f]=r.useState();return r.useEffect((()=>{let e;const i=new s.EventObserver;let r;i.listen(t.events,"pointerDown",(n=>{if(!n.target&&!n.panning&&n.sourceEvent.shiftKey){n.sourceEvent.preventDefault();const{pageX:i,pageY:r}=n.sourceEvent;e={pageX:i,pageY:r},f(m(e,e,t.metrics)),o()}}));const o=()=>{r?.stopListening(),r=new s.EventObserver,r.listen(t.events,"pointerMove",(n=>{const{pageX:i,pageY:r}=n.sourceEvent;e&&f(m(e,{pageX:i,pageY:r},t.metrics))}))};return i.listen(t.events,"pointerUp",(i=>{const{pageX:o,pageY:s}=i.sourceEvent;if(r?.stopListening(),f(void 0),i.triggerAsClick)i.target instanceof d.Element&&b(i.target,c);else if(e){!function(e,t,n,i){const r=new Set(n.selection),o=Array.from(y(t.elements,e,r,i.renderingState));o.length>0&&n.setSelection([...n.selection,...o])}(m(e,{pageX:o,pageY:s},t.metrics),n,c,t)}e=void 0})),()=>{i.stopListening(),r?.stopListening()}}),[]),g||p.length>1?(0,i.jsx)(x,{...e,model:n,canvas:t,editor:c,selectedElements:p,highlightedBox:g}):null}function m(e,t,n){const{x:i,y:r}=n.pageToPaperCoords(e.pageX,e.pageY),{x:o,y:s}=n.pageToPaperCoords(t.pageX,t.pageY);return{x:Math.min(i,o),y:Math.min(r,s),width:Math.abs(o-i),height:Math.abs(s-r)}}function*y(e,t,n,i){for(const r of e){const e=(0,u.boundsOf)(r,i);!n.has(r)&&u.Rect.intersects(t,e)&&(yield r)}}function b(e,t){const{selection:n}=t,i=n.includes(e)?n.filter((t=>t!=e)):[...n,e];t.setSelection(i)}function x(e){const{model:t,canvas:n,editor:o,selectedElements:l,highlightedBox:c,boxMargin:d=5,itemMargin:h=2,connectionsMenuCommands:f,children:m}=e,b=function(e,t,n){return r.useCallback((i=>{if(0===n.length)return()=>{};const r=new Set(n),o=new s.EventObserver;return o.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&r.has(e.changePosition.source)&&i()})),o.listen(t.renderingState.events,"changeElementSize",(e=>{r.has(e.source)&&i()})),()=>o.stopListening()}),[e.events,t.renderingState.events,n])}(t,n,l),x=(0,a.useFrameDebouncedStore)(b),k=w((0,a.useSyncStore)(x,(()=>(0,u.getContentFittingBox)(l,[],n.renderingState)),u.Rect.equals),d,n.metrics),L=c?Array.from(y(t.elements,c,new Set(l),n.renderingState)):[],_=r.useRef();_.current||(_.current=new v(n,t,o));const S=_.current;return S.setElements(l),(0,i.jsxs)("div",{className:g,children:[l.length>1?(0,i.jsxs)(i.Fragment,{children:[l.map((e=>(0,i.jsx)("div",{className:`${g}__selectedItem`,style:w((0,u.boundsOf)(e,n.renderingState),h,n.metrics)},e.id))),(0,i.jsx)("div",{className:`${g}__selectedActions`,style:k,children:m??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.SelectionActionRemove,{dock:"ne",dockRow:1}),(0,i.jsx)(p.SelectionActionZoomToFit,{dock:"ne",dockRow:2}),(0,i.jsx)(p.SelectionActionLayout,{dock:"ne",dockRow:3}),(0,i.jsx)(p.SelectionActionConnections,{dock:"ne",dockRow:4,commands:f}),(0,i.jsx)(p.SelectionActionExpand,{dock:"s"})]})}),(0,i.jsx)("div",{className:`${g}__selectedBox`,style:k,onClick:S.onClick,onPointerDown:S.onPointerDown,onPointerMove:S.onPointerMove,onPointerUp:S.onPointerUp,onPointerCancel:S.onPointerUp})]}):null,c?(0,i.jsx)("div",{className:`${g}__highlightedBox`,style:w(c,0,n.metrics)}):null,L.map((e=>(0,i.jsx)("div",{className:`${g}__highlightedItem`,style:w((0,u.boundsOf)(e,n.renderingState),h,n.metrics)},e.id)))]})}function w(e,t,n){const{x:i,y:r}=n.paperToScrollablePaneCoords(e.x,e.y),{x:o,y:s}=n.paperToScrollablePaneCoords(e.x+e.width,e.y+e.height);return{left:i-t,top:r-t,width:o-i+2*t,height:s-r+2*t}}(0,c.defineCanvasWidget)(f,(e=>({element:e,attachment:"overElements"})));class v{canvas;model;editor;elements=[];moveState;constructor(e,t,n){this.canvas=e,this.model=t,this.editor=n}setElements(e){this.elements=e}onClick=e=>{if(this.isToggleSelectionEvent(e)){e.preventDefault();const t=this.canvas.metrics.pageToPaperCoords(e.pageX,e.pageY),n=(0,u.findElementAtPoint)(this.model.elements,t,this.canvas.renderingState);n&&b(n,this.editor)}};onPointerDown=e=>{const{canvas:t,elements:n}=this;if(this.isToggleSelectionEvent(e))return;e.preventDefault(),e.currentTarget.setPointerCapture(e.pointerId);const i=t.metrics.pageToPaperCoords(e.pageX,e.pageY),r=new Map;for(const o of n)r.set(o,o.position);this.moveState={origin:i,positions:r}};isToggleSelectionEvent(e){return e.shiftKey}onPointerMove=e=>{const{canvas:t,moveState:n}=this;if(n){e.preventDefault();const{x:i,y:r}=t.metrics.pageToPaperCoords(e.pageX,e.pageY),o=i-n.origin.x,s=r-n.origin.y;for(const[e,t]of n.positions)e.setPosition({x:t.x+o,y:t.y+s});t.renderingState.syncUpdate()}};onPointerUp=e=>{this.moveState&&(e.preventDefault(),this.moveState=void 0)}}},(e,t,n)=>{n.r(t),n.d(t,{Toolbar:()=>l});var i=n(96),r=n(92),o=n(165),s=n(170);const a="reactodia-toolbar";function l(e){const{menu:t,children:n,languages:r=[]}=e,l=null===t?null:t??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.ToolbarActionClearAll,{}),(0,i.jsx)(s.ToolbarActionExport,{kind:"exportRaster"}),(0,i.jsx)(s.ToolbarActionExport,{kind:"exportSvg"}),(0,i.jsx)(s.ToolbarActionExport,{kind:"print"})]}),c=null===n?null:n??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.ToolbarActionUndo,{}),(0,i.jsx)(s.ToolbarActionRedo,{}),(0,i.jsx)(s.ToolbarActionLayout,{}),(0,i.jsx)(s.ToolbarLanguageSelector,{languages:r})]});return(0,i.jsxs)("div",{className:a,children:[l?(0,i.jsx)(o.Dropdown,{className:`${a}__menu`,title:"Open menu",children:l}):null,c?(0,i.jsx)("div",{className:`${a}__quick-access-group reactodia-btn-group reactodia-btn-group-sm`,children:c}):null]})}(0,r.defineCanvasWidget)(l,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{ToolbarAction:()=>f,ToolbarActionClearAll:()=>b,ToolbarActionExport:()=>x,ToolbarActionLayout:()=>k,ToolbarActionOpen:()=>m,ToolbarActionRedo:()=>v,ToolbarActionSave:()=>y,ToolbarActionUndo:()=>w,ToolbarLanguageSelector:()=>L});var i=n(96),r=n(58),o=n(106),s=n.n(o),a=n(171),l=n(57),c=n(91),d=n(158),u=n(116),h=n(165),p=n(115);const g="reactodia-toolbar-action";function f(e){const{className:t,title:n,disabled:r,onSelect:o,children:a}=e;return(0,h.useInsideDropdown)()?(0,i.jsx)(h.DropdownItem,{className:t,title:n,disabled:r,onSelect:o,children:a}):(0,i.jsx)("button",{type:"button",className:s()(t,"reactodia-btn reactodia-btn-default"),title:n,disabled:r,onClick:o,children:a})}function m(e){const{className:t,fileAccept:n,onSelect:o,children:a,...l}=e,c=r.useRef(null);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.DropdownItem,{...l,className:s()(t,`${g}__open`),onSelect:()=>{c.current?.click()},children:a}),(0,i.jsx)("input",{ref:c,type:"file",className:`${g}__open-input`,accept:n,onChange:e=>{if(e.currentTarget.files){const t=e.currentTarget.files[0];o(t)}}})]})}function y(e){const{className:t,mode:n,onSelect:r,children:o,...a}=e,{model:c,editor:d}=(0,p.useWorkspace)(),f=(0,l.useObservedProperty)(c.history.events,"historyChanged",(()=>c.history.undoStack.length>0)),m=(0,l.useObservedProperty)(d.events,"changeAuthoringState",(()=>!u.AuthoringState.isEmpty(d.authoringState)));let y=!0;return"layout"===n?y=f&&!m:"authoring"===n&&(y=m),(0,i.jsx)(h.DropdownItem,{...a,className:s()(t,`${g}__save`),disabled:!y,onSelect:r,children:o})}function b(e){const{className:t,title:n,...r}=e,{model:o,editor:a}=(0,p.useWorkspace)();return(0,i.jsx)(f,{...r,className:s()(t,`${g}__clear-all`),title:n??"Remove all elements and links from the diagram",onSelect:()=>{const e=o.history.startBatch("Clear all");a.removeItems([...o.elements]),e.store()},children:"Clear All"})}function x(e){const{className:t,title:n,kind:r,fileName:o="diagram",rasterOptions:l,...u}=e,{canvas:h}=(0,c.useCanvas)();return"exportRaster"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__export-image`),title:n??"Export the diagram as a PNG image",onSelect:()=>{const e=l??{backgroundColor:"white"};h.exportRaster(e).then((e=>{const t=(0,d.dataURLToBlob)(e);(0,a.saveAs)(t,`${o}.png`)}))},children:"Export as PNG"}):"exportSvg"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__export-image`),title:n??"Export the diagram as an SVG image",onSelect:()=>{h.exportSvg({addXmlHeader:!0}).then((e=>{const t=new Blob([e],{type:"image/svg+xml"});(0,a.saveAs)(t,`${o}.svg`)}))},children:"Export as SVG"}):"print"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__print`),title:n??"Print the diagram",onSelect:()=>{const e=window.open("",void 0,"width=1280,height=720");h.exportSvg().then((t=>{e.document.write(t),e.document.close(),e.print()}))},children:"Print"}):null}function w(e){const{className:t,title:n,...r}=e,{model:{history:o}}=(0,c.useCanvas)(),a=(0,h.useInsideDropdown)(),d=(0,l.useObservedProperty)(o.events,"historyChanged",(()=>{const{undoStack:e}=o;return 0===e.length?void 0:e[e.length-1]}));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__undo`),disabled:!d,title:n??(d&&d.title?`Undo: ${d.title}`:"Undo last command"),onSelect:()=>o.undo(),children:a?"Undo":null})}function v(e){const{className:t,title:n,...r}=e,{model:{history:o}}=(0,c.useCanvas)(),a=(0,h.useInsideDropdown)(),d=(0,l.useObservedProperty)(o.events,"historyChanged",(()=>{const{redoStack:e}=o;return 0===o.redoStack.length?void 0:e[e.length-1]}));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__redo`),disabled:!d,title:n??(d&&d.title?`Redo: ${d.title}`:"Redo last command"),onSelect:()=>o.redo(),children:a?"Redo":null})}function k(e){const{className:t,title:n,...r}=e,{performLayout:o}=(0,p.useWorkspace)(),{model:a,canvas:d}=(0,c.useCanvas)(),u=(0,l.useObservedProperty)(a.events,"changeCells",(()=>a.elements.length));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__layout`),title:n??"Layout diagram using force-directed algorithm",disabled:0===u,onSelect:()=>{o({canvas:d,animate:!0})},children:"Layout"})}function L(e){const{className:t,title:n,languages:r}=e,{model:o}=(0,c.useCanvas)(),a=(0,l.useObservedProperty)(o.events,"changeLanguage",(()=>o.language));return 0===r.length?null:(0,i.jsxs)("div",{className:s()(t,`${g}__language-selector`),title:n??"Select language for the data (labels, properties, etc)",children:[(0,i.jsx)("label",{htmlFor:"reactodia-language-selector"}),(0,i.jsx)("select",{id:"reactodia-language-selector",value:a,onChange:e=>o.setLanguage(e.currentTarget.value),children:r.map((({code:e,label:t})=>(0,i.jsx)("option",{value:e,children:t},e)))})]})}},e=>{e.exports=be},(e,t,n)=>{n.r(t),n.d(t,{ZoomControl:()=>c});var i=n(96),r=n(106),o=n.n(r),s=n(91),a=n(92);const l="reactodia-zoom-control";function c(e){const{canvas:t}=(0,s.useCanvas)();return(0,i.jsxs)("div",{className:l,children:[(0,i.jsx)("button",{type:"button",className:o()(`${l}__zoom-in-button`,"reactodia-btn reactodia-btn-default"),title:"Zoom In",onClick:()=>t.zoomIn()}),(0,i.jsx)("button",{type:"button",className:o()(`${l}__zoom-out-button`,"reactodia-btn reactodia-btn-default"),title:"Zoom Out",onClick:()=>t.zoomOut()}),(0,i.jsx)("button",{type:"button",className:o()(`${l}__zoom-fit-button`,"reactodia-btn reactodia-btn-default"),title:"Fit to Screen",onClick:()=>t.zoomToFit({animate:!0})})]})}(0,a.defineCanvasWidget)(c,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{DefaultWorkspace:()=>w});var i=n(96),r=n(58),o=n(55),s=n(156),a=n(152),l=n(159),c=n(160),d=n(161),u=n(163),h=n(128),p=n(166),g=n(167),f=n(168),m=n(169),y=n(172),b=n(174),x=n(177);function w(e){const{leftColumn:t,rightColumn:n,canvas:w,connectionsMenu:v,dropOnCanvas:k,halo:L,haloLink:_,selection:S,navigator:M,zoomControl:I,toolbar:T,classTree:E,instancesSearch:N,linkToolbox:j}=e,[C]=r.useState((()=>e.connectionsMenuCommands??new o.EventSource)),[A]=r.useState((()=>e.instancesSearchCommands??new o.EventSource));return(0,i.jsx)(x.WorkspaceRoot,{children:(0,i.jsxs)(b.WorkspaceLayoutRow,{children:[(0,i.jsxs)(b.WorkspaceLayoutColumn,{defaultSize:275,...t,children:[(0,i.jsx)(b.WorkspaceLayoutItem,{id:"classes",heading:"Classes",children:(0,i.jsx)(a.ClassTree,{...E,instancesSearchCommands:A})}),(0,i.jsx)(b.WorkspaceLayoutItem,{id:"instances",heading:"Instances",children:(0,i.jsx)(h.InstancesSearch,{...N,commands:A})})]}),(0,i.jsx)(b.WorkspaceLayoutItem,{id:"canvas",children:(0,i.jsxs)(s.Canvas,{...w,children:[null===v?null:(0,i.jsx)(l.ConnectionsMenu,{...v,commands:C,instancesSearchCommands:A}),null===k?null:(0,i.jsx)(c.DropOnCanvas,{...k}),null===L?null:(0,i.jsx)(d.Halo,{...L,instancesSearchCommands:A,connectionsMenuCommands:null===v?void 0:C}),null===_?null:(0,i.jsx)(u.HaloLink,{..._}),null===S?null:(0,i.jsx)(f.Selection,{...S,connectionsMenuCommands:null===v?void 0:C}),null===M?null:(0,i.jsx)(g.Navigator,{...M}),null===T?null:(0,i.jsx)(m.Toolbar,{...T}),null===I?null:(0,i.jsx)(y.ZoomControl,{...I})]})}),(0,i.jsx)(b.WorkspaceLayoutColumn,{defaultSize:275,defaultCollapsed:!0,...n,children:(0,i.jsx)(b.WorkspaceLayoutItem,{id:"connections",heading:"Connections",children:(0,i.jsx)(p.LinkTypesToolbox,{...j,instancesSearchCommands:A})})})]})})}},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceLayoutColumn:()=>c,WorkspaceLayoutItem:()=>d,WorkspaceLayoutResizeContext:()=>u,WorkspaceLayoutRow:()=>l});var i=n(96),r=n(58),o=n(175),s=n(176);const a=28;function l(e){return h(e,"row")}function c(e){return h(e,"column")}function d(e){return e.children}const u=r.createContext(null);function h(e,t){const{animationDuration:n,children:l}=e,c=r.useContext(u),h=r.Children.count(l),p=r.Children.map(l,((e,n)=>{let r;"row"!==t||e.props.undocked||(0===n?r=s.DockSide.Left:n===h-1&&(r=s.DockSide.Right));let o=e.props.collapsedSize;return void 0===o&&"row"===t&&(o=a),(0,i.jsx)(s.AccordionItem,{heading:e.type===d?e.props.heading:void 0,dockSide:r,defaultSize:e.props.defaultSize,defaultCollapsed:e.props.defaultCollapsed,collapsedSize:o,minSize:e.props.minSize,children:e},e.type===d?e.props.id:n)}));return(0,i.jsx)(o.Accordion,{direction:"row"===t?"horizontal":"vertical",onStartResize:c?.onStartResize,onResize:c?.onResize,animationDuration:n,children:p})}},(e,t,n)=>{n.r(t),n.d(t,{Accordion:()=>s});var i=n(96),r=n(58);const o="reactodia-accordion";class s extends r.Component{static defaultProps={direction:"vertical",animationDuration:300};element;items=[];dragOrigin;defaultProps;isScrollable=!1;constructor(e){super(e);const t=r.Children.count(this.props.children);this.state={sizes:[],collapsed:[],resizing:!1,percents:r.Children.map(this.props.children,(()=>100/t+"%"))}}componentDidMount(){this.updateSizes()}componentDidUpdate(e,t){const{direction:n,children:i,onResize:o,animationDuration:s}=this.props;r.Children.count(i)!==r.Children.count(e.children)&&this.updateSizes();const{sizes:a,resizing:l}=this.state;a!==t.sizes&&o&&(l?o(n):setTimeout((()=>o(n)),s))}get isVertical(){return"vertical"===this.props.direction}clientSize(e){const{clientWidth:t,clientHeight:n}=e;return this.isVertical?n:t}offsetSize(e){const{offsetWidth:t,offsetHeight:n}=e;return this.isVertical?n:t}updateSizes(){const{children:e}=this.props,t=new Map;r.Children.forEach(e,((e,n)=>{if("object"!=typeof e)return;const{defaultSize:i,defaultCollapsed:r,collapsedSize:o,minSize:s}=e.props;void 0!==s&&(this.isScrollable=!0),t.set(n,{defaultSize:i,defaultCollapsed:r,collapsedSize:o,minSize:s})})),this.defaultProps=t,this.setState((({collapsed:t})=>{const n=this.clientSize(this.element.parentElement);let i=n,o=r.Children.count(e);const s=[];this.defaultProps.forEach((({defaultSize:e,defaultCollapsed:n=!1},r)=>{let a=void 0===t[r]?n:t[r];const l=r===this.defaultProps.size-1,c=s.findIndex((e=>!e))<0;l&&c&&(a=!1);const d=a?this.sizeWhenCollapsed(r):e;d&&(i-=d,o-=1),s.push(a)}));const a=[],l=[];return this.defaultProps.forEach((({defaultSize:e,minSize:t},r)=>{let c=i/o;const d=this.sizeWhenCollapsed(r);s[r]?c=d:void 0!==e?c=e:void 0!==t&&c<t&&(c=d+t),c<d&&(c=d,s[r]=!0);const u=100*c/n+"%";a.push(c),l.push(u)})),{sizes:a,percents:l,collapsed:s}}))}render(){const{direction:e}=this.props,{resizing:t}=this.state,n=t?`${o}--resizing`:"",r=this.isScrollable?`${o}--scrollable`:"";return(0,i.jsx)("div",{className:`${o} ${o}--${e} ${n} ${r}`,ref:this.onElementMount,children:this.renderItems()})}onElementMount=e=>{this.element=e};renderItems(){const{sizes:e,percents:t,collapsed:n}=this.state,{children:i,direction:o}=this.props;return r.Children.map(i,((s,a)=>{if("object"!=typeof s)throw new Error("Accordion should have only AccordionItem elements as children");const l=a===r.Children.count(i)-1,c=n[a]?e[a]:t[a],d={ref:e=>{e&&(this.items[a]=e)},collapsed:n[a],size:c,direction:o,onChangeCollapsed:e=>this.onItemChangeCollapsed({itemIndex:a,itemCollapsed:e}),onBeginDragHandle:l?void 0:()=>this.onBeginDragHandle(a),onDragHandle:l?void 0:(e,t)=>this.onDragHandle(a,e,t),onEndDragHandle:this.onEndDragHandle};return r.cloneElement(s,d)}))}onBeginDragHandle(e){this.dragOrigin={totalSize:this.clientSize(this.element),sizes:this.computeEffectiveItemSizes(),collapsed:[...this.state.collapsed]},this.setState({resizing:!0},(()=>{const{direction:e,onStartResize:t}=this.props;t&&t(e)}))}onEndDragHandle=()=>{this.setState({resizing:!1})};computeEffectiveItemSizes(){const e=[];return this.items.forEach(((t,n)=>{if(t)if(this.state.collapsed[n]){const t=this.sizeWhenCollapsed(n);e.push(t)}else e.push(this.offsetSize(t.element))})),e}sizeWhenCollapsed=e=>{const t=this.items[e],{collapsedSize:n}=this.defaultProps.get(e);if(void 0!==n)return n;return(t.header?this.clientSize(t.header):0)+(this.offsetSize(t.element)-this.clientSize(t.element))};onDragHandle(e,t,n){const i=[...this.dragOrigin.sizes],r=[...this.dragOrigin.collapsed],o=this.dragOrigin.totalSize;new a(i,r,o,this.sizeWhenCollapsed).distribute(e+1,this.isVertical?n:t);const s=i.map((e=>100*e/o+"%"));this.setState({sizes:i,percents:s,collapsed:r})}onItemChangeCollapsed({itemIndex:e,itemCollapsed:t}){const n=this.clientSize(this.element),i=this.computeEffectiveItemSizes();if(1===i.length)return;const r=[...this.state.collapsed],o=i[e],s=this.sizeWhenCollapsed(e),l=new a(i,r,n,this.sizeWhenCollapsed);if(t){const t=Math.max(o-s,0);i[e]=s,e===i.length-1?l.expand(t,e-1):l.expand(t,e+1)}else{const{defaultSize:t,minSize:r}=this.defaultProps.get(e),o=(t||n/i.length)-s;let a=0;a=e===i.length-1?l.collapseForward({shift:o,from:e-1,to:e}):l.collapseForward({shift:o,from:e+1,to:i.length}),a=Math.max(a,l.leftoverSize()),a<o&&(a+=l.collapseForward({shift:o-a,from:0,to:e})),void 0!==r&&a<r&&(a=r),i[e]=Math.round(s+a)}r[e]=t;const c=i.map((e=>100*e/n+"%"));this.setState({sizes:i,percents:c,collapsed:r})}}class a{sizes;collapsed;totalSize;sizeWhenCollapsed;constructor(e,t,n,i){this.sizes=e,this.collapsed=t,this.totalSize=n,this.sizeWhenCollapsed=i}distribute(e,t){if(t>0){let n=this.collapseForward({shift:t,from:e,to:this.sizes.length});n=Math.max(n,this.leftoverSize()),this.expand(n,e-1)}else{let n=this.collapseBackward({shift:-t,from:0,to:e});n=Math.max(n,this.leftoverSize()),this.expand(n,e)}}collapseForward({shift:e,from:t,to:n}){if(e<=0)return 0;let i=e;for(let r=t;r<n;r++)i=this.collapse(i,r);return e-i}collapseBackward({shift:e,from:t,to:n}){if(e<=0)return 0;let i=e;for(let r=n-1;r>=t;r--)i=this.collapse(i,r);return e-i}collapse(e,t){if(this.collapsed[t])return e;const n=this.sizes[t],i=this.sizeWhenCollapsed(t),r=Math.round(Math.max(n-e,i));return this.sizes[t]=r,this.collapsed[t]=r<=i,e-(n-r)}expand(e,t){if(e<=0)return 0;const n=this.sizes[t],i=Math.round(n+e);return this.sizes[t]=i,this.collapsed[t]=i<=this.sizeWhenCollapsed(t),i-n}leftoverSize(){const e=this.sizes.reduce(((e,t)=>e+t),0);return Math.max(this.totalSize-e,0)}}},(e,t,n)=>{n.r(t),n.d(t,{AccordionItem:()=>l,DockSide:()=>i});var i,r=n(96),o=n(58),s=n(121);!function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"}(i||(i={}));const a="reactodia-accordion-item";class l extends o.Component{static defaultProps={direction:"vertical"};_element;_header;constructor(e){super(e),this.state={resizing:!1}}get element(){return this._element}get header(){return this._header}get isVertical(){return"vertical"===this.props.direction}renderToggleButton(){const{collapsed:e,dockSide:t,onChangeCollapsed:n}=this.props;if(!t)return null;const o=t===i.Left?"left":"right";return(0,r.jsx)("div",{className:`${a}__handle-btn ${a}__handle-btn-${o}`,onClick:()=>n(!e)})}render(){const{heading:e,bodyClassName:t,children:n,bodyRef:i,collapsed:o,size:l,direction:c,onBeginDragHandle:d,onDragHandle:u,onEndDragHandle:h,dockSide:p}=this.props,{resizing:g}=this.state,f=d&&u&&h,m=this.isVertical?{height:l}:{width:l},y=!(o&&p);return(0,r.jsxs)("div",{className:`${a} ${a}--${o?"collapsed":"expanded"} ${a}--${c}\n                    ${g?`${a}--resizing`:""}`,ref:e=>this._element=e,style:m,children:[(0,r.jsxs)("div",{className:`${a}__inner`,children:[e?(0,r.jsx)("div",{className:`${a}__header`,ref:e=>this._header=e,onClick:()=>this.props.onChangeCollapsed(!o),children:e}):null,(0,r.jsx)("div",{className:`${a}__body`,children:n&&y?n:(0,r.jsx)("div",{ref:i,className:`${t||""}`})})]}),f?(0,r.jsx)(s.DraggableHandle,{className:`${a}__handle ${a}__handle-${c}`,onBeginDragHandle:e=>{this.setState({resizing:!0}),d()},onDragHandle:(e,t,n)=>u(t,n),onEndDragHandle:e=>{this.setState({resizing:!1}),h()}}):null,this.renderToggleButton()]})}}},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceRoot:()=>a});var i=n(96),r=n(106),o=n.n(r);const s="reactodia-workspace";function a(e){return(0,i.jsx)("div",{className:o()(s,e.className),style:e.style,children:e.children})}},(e,t,n)=>{n.r(t),n.d(t,{Workspace:()=>v,useLoadedWorkspace:()=>k});var i=n(96),r=n(58),o=n(131),s=n(55),a=n(67),l=n(65),c=n(72),d=n(64),u=n(74),h=n(179),p=n(108),g=n(117),f=n(119),m=n(138),y=n(140),b=n(115);const x="en",w=e=>{};class v extends r.Component{listener=new s.EventObserver;cancellation=new AbortController;resolveTypeStyle;cachedTypeStyles;workspaceContext;constructor(e){super(e);const{history:t=new c.InMemoryHistory,metadataApi:n,validationApi:i,propertyEditor:r,groupBy:o=[],typeStyleResolver:s,selectLabelLanguage:a,defaultLanguage:l=x,defaultLayout:d,onWorkspaceEvent:b=(()=>{})}=this.props;this.resolveTypeStyle=s??w,this.cachedTypeStyles=new WeakMap;const v=new p.AsyncModel({history:t,selectLabelLanguage:a,groupBy:o});v.setLanguage(l);const k=new h.SharedCanvasState({defaultElementTemplate:y.StandardTemplate,defaultLinkTemplate:m.DefaultLinkTemplate,defaultLayout:d??u.blockingDefaultLayout}),L=new g.EditorController({model:v,validationApi:i});L.setMetadataApi(n);const _=new f.OverlayController({model:v,view:k,editor:L,propertyEditor:r});this.workspaceContext={model:v,view:k,editor:L,overlay:_,disposeSignal:this.cancellation.signal,getElementTypeStyle:this.getElementTypeStyle,performLayout:this.onPerformLayout,triggerWorkspaceEvent:b},d||console.warn('Reactodia.Workspace: "defaultLayout" prop is not provided, using synchronous fallback which may freeze the execution for large diagrams. It is recommended to use layout worker via Reactodia.defineDefaultLayouts() and Reactodia.useWorker().')}getContext(){return this.workspaceContext}render(){const{children:e}=this.props;return(0,i.jsx)(b.WorkspaceContext.Provider,{value:this.workspaceContext,children:e})}componentDidMount(){const{onWorkspaceEvent:e}=this.props,{model:t,view:n,editor:i,overlay:r}=this.workspaceContext;this.listener.listen(t.events,"loadingSuccess",(()=>{for(const e of n.findAllCanvases())e.renderingState.syncUpdate(),e.zoomToFit()})),this.listener.listen(n.events,"iriClick",(e=>{const{onIriClick:t}=this.props;t?.(e)})),e&&(this.listener.listen(i.events,"changeSelection",(()=>e(b.WorkspaceEventKey.editorChangeSelection))),this.listener.listen(r.events,"changeOpenedDialog",(()=>e(b.WorkspaceEventKey.editorToggleDialog))))}componentDidUpdate(e){const{editor:t}=this.workspaceContext;this.props.metadataApi!==t.metadataApi&&t.setMetadataApi(this.props.metadataApi)}componentWillUnmount(){this.listener.stopListening();const{view:e,editor:t,overlay:n}=this.workspaceContext;e.dispose(),t.dispose(),n.dispose()}getElementTypeStyle=e=>{let t=this.cachedTypeStyles.get(e);if(!t){const n=this.resolveTypeStyle(e),i=n?n.icon:void 0;let r;if(n&&n.color)r=(0,o.hcl)(n.color).toString();else{const t=function(e,t){let n=t;for(const i of e)n=(0,a.hashFnv32a)(i,n);return(void 0===n?0:n)/2147483647*360}(e,195935983);r=(0,o.hcl)(t,40,75).toString()}t={icon:i,color:r},this.cachedTypeStyles.set(e,t)}return t};onPerformLayout=async e=>{const{canvas:t,layoutFunction:n,selectedElements:i,animate:r,signal:o}=e,{model:s,view:a,disposeSignal:c}=this.workspaceContext,u=t??a.findAnyCanvas();if(!u)throw new Error("Failed to find any canvas to perform layout");u.renderingState.syncUpdate();const h=await(0,d.calculateLayout)({layoutFunction:n??a.defaultLayout,model:s,selectedElements:i,sizeProvider:u.renderingState,signal:o??c}),p=s.history.startBatch("Graph layout");p.history.registerToUndo(l.RestoreGeometry.capture(s));for(const l of s.links)l.setVertices([]);p.history.registerToUndo((0,l.restoreViewport)(u)),r?await Promise.all([u.animateGraph((()=>{(0,d.applyLayout)(h,s),p.store()})),u.zoomToFit({animate:!0})]):((0,d.applyLayout)(h,s),p.store(),u.zoomToFit())}}function k(e,t){const[n,i]=r.useState(),o=r.useRef();if(o.current)o.current.latestOnLoad=e;else{const t={latestOnLoad:e,context:void 0,loadedWorkspace:{getContext:()=>{if(!t.context)throw new Error("Cannot get Reactodia Workspace context: it is not mounted yet");return t.context},onMount:e=>{const n=e?.getContext();t.context=n,i(n)}}};o.current=t}return r.useEffect((()=>{if(n){const e=o.current.latestOnLoad,t=new AbortController;return(async()=>{const i=n.overlay._startTask();try{await e({context:n,signal:t.signal})}catch(r){t.signal.aborted||(i.setError(r),console.error("Reactodia: failed to load a workspace",r))}finally{i.end()}})(),()=>{t.abort(),n.model.discardLayout()}}}),[n,...t]),o.current.loadedWorkspace}},(e,t,n)=>{n.r(t),n.d(t,{SharedCanvasState:()=>o});var i=n(58),r=n(55);class o{listener=new r.EventObserver;source=new r.EventSource;events=this.source;disposed=!1;_canvasWidgets;dropOnPaperHandler;_highlighter;_elementDecorator;defaultElementTemplate;defaultLinkTemplate;defaultLayout;constructor(e){const{defaultElementTemplate:t,defaultLinkTemplate:n,defaultLayout:i}=e;this._canvasWidgets=new Map,this.defaultElementTemplate=t,this.defaultLinkTemplate=n,this.defaultLayout=i}dispose(){this.disposed||(this.source.trigger("dispose",{source:this}),this.listener.stopListening(),this.disposed=!0)}findAllCanvases(){const e={canvases:[]};return this.source.trigger("findCanvas",e),e.canvases}findAnyCanvas(){const e=this.findAllCanvases();return e.length>0?e[0]:void 0}onIriClick(e,t,n,i){i.persist(),i.preventDefault(),this.source.trigger("iriClick",{iri:e,element:t,clickIntent:n,originalEvent:i})}get widgets(){return this._canvasWidgets}setCanvasWidget(e,t){const n=this._canvasWidgets,r=new Map(n);if(t){const n={element:i.cloneElement(t.element,{key:e}),attachment:t.attachment};r.set(e,n)}else r.delete(e);this._canvasWidgets=r,this.source.trigger("changeWidgets",{source:this,previous:n})}setHandlerForNextDropOnPaper(e){this.dropOnPaperHandler=e}tryHandleDropOnPaper(e){const{dropOnPaperHandler:t}=this;return!!t&&(this.dropOnPaperHandler=void 0,e.sourceEvent.preventDefault(),t(e),!0)}get highlighter(){return this._highlighter}setHighlighter(e){const t=this._highlighter;t!==e&&(this._highlighter=e,this.source.trigger("changeHighlight",{source:this,previous:t}))}_setElementDecorator(e){this._elementDecorator=e}_decorateElement(e){return this._elementDecorator?.(e)}}}],Me={};function Ie(e){var t=Me[e];if(void 0!==t)return t.exports;var n=Me[e]={id:e,exports:{}};return Se[e](n,n.exports,Ie),n.exports}Ie.m=Se,Ie.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return Ie.d(t,{a:t}),t},Ie.d=(e,t)=>{for(var n in t)Ie.o(t,n)&&!Ie.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ie.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Ie.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Ie.b=document.baseURI||self.location.href,Ie.nc=void 0;var Te={};(()=>{Ie.r(Te),Ie.d(Te,{AbortScope:()=>e.AbortScope,AsyncModel:()=>C.AsyncModel,AuthoringKind:()=>D.AuthoringKind,AuthoringState:()=>D.AuthoringState,BatchingScheduler:()=>d.BatchingScheduler,BufferingQueue:()=>d.BufferingQueue,Canvas:()=>H.Canvas,CanvasContext:()=>v.CanvasContext,ClassTree:()=>Z.ClassTree,ClassicTemplate:()=>U.ClassicTemplate,Command:()=>I.Command,CompositeDataProvider:()=>p.CompositeDataProvider,ConnectionsMenu:()=>V.ConnectionsMenu,DBPediaSettings:()=>w.DBPediaSettings,DIAGRAM_CONTEXT_URL_V1:()=>h.DIAGRAM_CONTEXT_URL_V1,Debouncer:()=>d.Debouncer,DecoratedDataProvider:()=>g.DecoratedDataProvider,DefaultLinkPathTemplate:()=>$.DefaultLinkPathTemplate,DefaultLinkTemplate:()=>$.DefaultLinkTemplate,DefaultWorkspace:()=>ue.DefaultWorkspace,DraggableHandle:()=>he.DraggableHandle,DropOnCanvas:()=>G.DropOnCanvas,Dropdown:()=>J.Dropdown,DropdownItem:()=>J.DropdownItem,EditorController:()=>P.EditorController,Element:()=>_.Element,EmbeddedLayer:()=>S.EmbeddedLayer,EventObserver:()=>n.EventObserver,EventSource:()=>n.EventSource,GroupTemplate:()=>W.GroupTemplate,Halo:()=>q.Halo,HaloLink:()=>X.HaloLink,HashMap:()=>i.HashMap,HashSet:()=>i.HashSet,HtmlSpinner:()=>j.HtmlSpinner,InMemoryHistory:()=>I.InMemoryHistory,IndexQuadBy:()=>m.IndexQuadBy,IndexedDbCachedProvider:()=>f.IndexedDbCachedProvider,InstancesSearch:()=>K.InstancesSearch,KeyedObserver:()=>o.KeyedObserver,LINK_STYLE_SHOW_IRI:()=>Q.LINK_STYLE_SHOW_IRI,Link:()=>_.Link,LinkAction:()=>ee.LinkAction,LinkActionDelete:()=>ee.LinkActionDelete,LinkActionEdit:()=>ee.LinkActionEdit,LinkActionMoveEndpoint:()=>ee.LinkActionMoveEndpoint,LinkActionRename:()=>ee.LinkActionRename,LinkActionSpinner:()=>ee.LinkActionSpinner,LinkLabel:()=>T.LinkLabel,LinkPath:()=>T.LinkPath,LinkTypesToolbox:()=>te.LinkTypesToolbox,LinkVertex:()=>_.LinkVertex,LinkVertices:()=>T.LinkVertices,ListElementView:()=>ne.ListElementView,MoveDirection:()=>t.MoveDirection,Navigator:()=>ie.Navigator,OntologyLinkTemplates:()=>Q.OntologyLinkTemplates,OrderedMap:()=>t.OrderedMap,OverlayController:()=>O.OverlayController,OwlRdfsSettings:()=>w.OwlRdfsSettings,OwlRdfsSettingsOverride:()=>w.OwlRdfsSettingsOverride,OwlStatsSettings:()=>w.OwlStatsSettings,PLACEHOLDER_ELEMENT_TYPE:()=>h.PLACEHOLDER_ELEMENT_TYPE,PLACEHOLDER_LINK_TYPE:()=>h.PLACEHOLDER_LINK_TYPE,ProgressBar:()=>re.ProgressBar,Rdf:()=>b,RdfDataProvider:()=>y.RdfDataProvider,RdfSettings:()=>w.RdfSettings,Rect:()=>M.Rect,RenderingLayer:()=>N.RenderingLayer,RestoreGeometry:()=>L.RestoreGeometry,SearchResults:()=>oe.SearchResults,Selection:()=>se.Selection,SelectionAction:()=>ae.SelectionAction,SelectionActionAddToFilter:()=>ae.SelectionActionAddToFilter,SelectionActionAnchor:()=>ae.SelectionActionAnchor,SelectionActionConnections:()=>ae.SelectionActionConnections,SelectionActionEstablishLink:()=>ae.SelectionActionEstablishLink,SelectionActionExpand:()=>ae.SelectionActionExpand,SelectionActionLayout:()=>ae.SelectionActionLayout,SelectionActionRemove:()=>ae.SelectionActionRemove,SelectionActionSpinner:()=>ae.SelectionActionSpinner,SelectionActionZoomToFit:()=>ae.SelectionActionZoomToFit,SemanticTypeStyles:()=>F.SemanticTypeStyles,SparqlDataProvider:()=>x.SparqlDataProvider,Spinner:()=>j.Spinner,StandardTemplate:()=>Y.StandardTemplate,TemplateProperties:()=>h.TemplateProperties,TemporaryState:()=>D.TemporaryState,Toolbar:()=>le.Toolbar,ToolbarAction:()=>ce.ToolbarAction,ToolbarActionClearAll:()=>ce.ToolbarActionClearAll,ToolbarActionExport:()=>ce.ToolbarActionExport,ToolbarActionLayout:()=>ce.ToolbarActionLayout,ToolbarActionOpen:()=>ce.ToolbarActionOpen,ToolbarActionRedo:()=>ce.ToolbarActionRedo,ToolbarActionSave:()=>ce.ToolbarActionSave,ToolbarActionUndo:()=>ce.ToolbarActionUndo,ToolbarLanguageSelector:()=>ce.ToolbarLanguageSelector,TransformedSvgCanvas:()=>E.TransformedSvgCanvas,ValidationState:()=>z.ValidationState,Vector:()=>M.Vector,WikidataSettings:()=>w.WikidataSettings,WithFetchStatus:()=>R.WithFetchStatus,Workspace:()=>pe.Workspace,WorkspaceContext:()=>ge.WorkspaceContext,WorkspaceEventKey:()=>ge.WorkspaceEventKey,WorkspaceLayoutColumn:()=>fe.WorkspaceLayoutColumn,WorkspaceLayoutItem:()=>fe.WorkspaceLayoutItem,WorkspaceLayoutResizeContext:()=>fe.WorkspaceLayoutResizeContext,WorkspaceLayoutRow:()=>fe.WorkspaceLayoutRow,WorkspaceRoot:()=>me.WorkspaceRoot,ZoomControl:()=>de.ZoomControl,animateInterval:()=>d.animateInterval,applyLayout:()=>a.applyLayout,blockingDefaultLayout:()=>c.blockingDefaultLayout,boundsOf:()=>M.boundsOf,calculateAveragePosition:()=>a.calculateAveragePosition,calculateLayout:()=>a.calculateLayout,colaFlowLayout:()=>c.colaFlowLayout,colaForceLayout:()=>c.colaForceLayout,colaRemoveOverlaps:()=>c.colaRemoveOverlaps,computeGrouping:()=>M.computeGrouping,computePolyline:()=>M.computePolyline,computePolylineLength:()=>M.computePolylineLength,defineCanvasWidget:()=>k.defineCanvasWidget,defineLayoutWorker:()=>l.defineLayoutWorker,defineWorker:()=>s.defineWorker,delay:()=>e.delay,easeInOutBezier:()=>d.easeInOutBezier,equalElements:()=>u.equalElements,equalLinks:()=>u.equalLinks,equalSubtypeEdges:()=>u.equalSubtypeEdges,findElementAtPoint:()=>M.findElementAtPoint,findNearestSegmentIndex:()=>M.findNearestSegmentIndex,getContentFittingBox:()=>M.getContentFittingBox,getContentFittingBoxForLayout:()=>c.getContentFittingBoxForLayout,getOrCreateArrayInMap:()=>t.getOrCreateArrayInMap,getOrCreateSetInMap:()=>t.getOrCreateSetInMap,getPointAlongPolyline:()=>M.getPointAlongPolyline,hashLink:()=>u.hashLink,hashSubtypeEdge:()=>u.hashSubtypeEdge,highlightSubstring:()=>ne.highlightSubstring,isEncodedBlank:()=>u.isEncodedBlank,isLinkConnectedToElement:()=>D.isLinkConnectedToElement,isPolylineEqual:()=>M.isPolylineEqual,layoutPadded:()=>c.layoutPadded,layoutPaddedBiasFree:()=>c.layoutPaddedBiasFree,makeDelayProviderDecorator:()=>g.makeDelayProviderDecorator,makeIndexedDataset:()=>m.makeIndexedDataset,makeMoveComparator:()=>t.makeMoveComparator,makeSerializedDiagram:()=>B.makeSerializedDiagram,makeSerializedLayout:()=>B.makeSerializedLayout,mapAbortedToNull:()=>e.mapAbortedToNull,observeElementTypes:()=>o.observeElementTypes,observeLinkTypes:()=>o.observeLinkTypes,observeProperties:()=>o.observeProperties,paneTopLeft:()=>E.paneTopLeft,pathFromPolyline:()=>M.pathFromPolyline,placeElementsAround:()=>a.placeElementsAround,raceAbortSignal:()=>e.raceAbortSignal,requestElementData:()=>C.requestElementData,restoreLinksBetweenElements:()=>C.restoreLinksBetweenElements,setElementData:()=>L.setElementData,setElementExpanded:()=>L.setElementExpanded,setLinkData:()=>L.setLinkData,shallowArrayEqual:()=>t.shallowArrayEqual,startDragElements:()=>ne.startDragElements,totalPaneSize:()=>E.totalPaneSize,translateToPositiveQuadrant:()=>a.translateToPositiveQuadrant,uniformGrid:()=>a.uniformGrid,useAuthoredEntity:()=>A.useAuthoredEntity,useCanvas:()=>v.useCanvas,useLinkActionContext:()=>ee.useLinkActionContext,useLoadedWorkspace:()=>pe.useLoadedWorkspace,useObservedProperty:()=>r.useObservedProperty,useWorker:()=>s.useWorker,useWorkspace:()=>ge.useWorkspace});var e=Ie(52),t=Ie(54),n=Ie(55),i=Ie(56),r=Ie(57),o=Ie(62),s=Ie(63),a=Ie(64),l=Ie(73),c=Ie(74),d=Ie(76),u=Ie(66),h=(Ie(77),Ie(78),Ie(79),Ie(80)),p=Ie(81),g=Ie(83),f=Ie(84),m=Ie(85),y=Ie(86),b=Ie(68),x=Ie(87),w=Ie(90),v=Ie(91),k=Ie(92),L=Ie(65),_=(Ie(93),Ie(94)),S=Ie(95),M=Ie(71),I=Ie(72),T=Ie(105),E=Ie(100),N=Ie(103),j=Ie(107),C=Ie(108),A=Ie(114),D=Ie(116),P=Ie(117),O=Ie(119),z=Ie(118),R=Ie(136),B=Ie(113),U=Ie(137),$=Ie(138),W=Ie(139),Y=Ie(140),F=Ie(141),Q=Ie(151),Z=Ie(152),H=Ie(156),V=Ie(159),G=Ie(160),q=Ie(161),X=Ie(163),J=Ie(165),K=Ie(128),ee=Ie(164),te=Ie(166),ne=Ie(130),ie=Ie(167),re=Ie(124),oe=Ie(129),se=Ie(168),ae=Ie(162),le=Ie(169),ce=Ie(170),de=Ie(172),ue=Ie(173),he=Ie(121),pe=Ie(178),ge=Ie(115),fe=Ie(174),me=Ie(177);Ie(1)})();var Ee=Te.AbortScope,Ne=Te.AsyncModel,je=Te.AuthoringKind,Ce=Te.AuthoringState,Ae=Te.BatchingScheduler,De=Te.BufferingQueue,Pe=Te.Canvas,Oe=Te.CanvasContext,ze=Te.ClassTree,Re=Te.ClassicTemplate,Be=Te.Command,Ue=Te.CompositeDataProvider,$e=Te.ConnectionsMenu,We=Te.DBPediaSettings,Ye=Te.DIAGRAM_CONTEXT_URL_V1,Fe=Te.Debouncer,Qe=Te.DecoratedDataProvider,Ze=Te.DefaultLinkPathTemplate,He=Te.DefaultLinkTemplate,Ve=Te.DefaultWorkspace,Ge=Te.DraggableHandle,qe=Te.DropOnCanvas,Xe=Te.Dropdown,Je=Te.DropdownItem,Ke=Te.EditorController,et=Te.Element,tt=Te.EmbeddedLayer,nt=Te.EventObserver,it=Te.EventSource,rt=Te.GroupTemplate,ot=Te.Halo,st=Te.HaloLink,at=Te.HashMap,lt=Te.HashSet,ct=Te.HtmlSpinner,dt=Te.InMemoryHistory,ut=Te.IndexQuadBy,ht=Te.IndexedDbCachedProvider,pt=Te.InstancesSearch,gt=Te.KeyedObserver,ft=Te.LINK_STYLE_SHOW_IRI,mt=Te.Link,yt=Te.LinkAction,bt=Te.LinkActionDelete,xt=Te.LinkActionEdit,wt=Te.LinkActionMoveEndpoint,vt=Te.LinkActionRename,kt=Te.LinkActionSpinner,Lt=Te.LinkLabel,_t=Te.LinkPath,St=Te.LinkTypesToolbox,Mt=Te.LinkVertex,It=Te.LinkVertices,Tt=Te.ListElementView,Et=Te.MoveDirection,Nt=Te.Navigator,jt=Te.OntologyLinkTemplates,Ct=Te.OrderedMap,At=Te.OverlayController,Dt=Te.OwlRdfsSettings,Pt=Te.OwlRdfsSettingsOverride,Ot=Te.OwlStatsSettings,zt=Te.PLACEHOLDER_ELEMENT_TYPE,Rt=Te.PLACEHOLDER_LINK_TYPE,Bt=Te.ProgressBar,Ut=Te.Rdf,$t=Te.RdfDataProvider,Wt=Te.RdfSettings,Yt=Te.Rect,Ft=Te.RenderingLayer,Qt=Te.RestoreGeometry,Zt=Te.SearchResults,Ht=Te.Selection,Vt=Te.SelectionAction,Gt=Te.SelectionActionAddToFilter,qt=Te.SelectionActionAnchor,Xt=Te.SelectionActionConnections,Jt=Te.SelectionActionEstablishLink,Kt=Te.SelectionActionExpand,en=Te.SelectionActionLayout,tn=Te.SelectionActionRemove,nn=Te.SelectionActionSpinner,rn=Te.SelectionActionZoomToFit,on=Te.SemanticTypeStyles,sn=Te.SparqlDataProvider,an=Te.Spinner,ln=Te.StandardTemplate,cn=Te.TemplateProperties,dn=Te.TemporaryState,un=Te.Toolbar,hn=Te.ToolbarAction,pn=Te.ToolbarActionClearAll,gn=Te.ToolbarActionExport,fn=Te.ToolbarActionLayout,mn=Te.ToolbarActionOpen,yn=Te.ToolbarActionRedo,bn=Te.ToolbarActionSave,xn=Te.ToolbarActionUndo,wn=Te.ToolbarLanguageSelector,vn=Te.TransformedSvgCanvas,kn=Te.ValidationState,Ln=Te.Vector,_n=Te.WikidataSettings,Sn=Te.WithFetchStatus,Mn=Te.Workspace,In=Te.WorkspaceContext,Tn=Te.WorkspaceEventKey,En=Te.WorkspaceLayoutColumn,Nn=Te.WorkspaceLayoutItem,jn=Te.WorkspaceLayoutResizeContext,Cn=Te.WorkspaceLayoutRow,An=Te.WorkspaceRoot,Dn=Te.ZoomControl,Pn=Te.animateInterval,On=Te.applyLayout,zn=Te.blockingDefaultLayout,Rn=Te.boundsOf,Bn=Te.calculateAveragePosition,Un=Te.calculateLayout,$n=Te.colaFlowLayout,Wn=Te.colaForceLayout,Yn=Te.colaRemoveOverlaps,Fn=Te.computeGrouping,Qn=Te.computePolyline,Zn=Te.computePolylineLength,Hn=Te.defineCanvasWidget,Vn=Te.defineLayoutWorker,Gn=Te.defineWorker,qn=Te.delay,Xn=Te.easeInOutBezier,Jn=Te.equalElements,Kn=Te.equalLinks,ei=Te.equalSubtypeEdges,ti=Te.findElementAtPoint,ni=Te.findNearestSegmentIndex,ii=Te.getContentFittingBox,ri=Te.getContentFittingBoxForLayout,oi=Te.getOrCreateArrayInMap,si=Te.getOrCreateSetInMap,ai=Te.getPointAlongPolyline,li=Te.hashLink,ci=Te.hashSubtypeEdge,di=Te.highlightSubstring,ui=Te.isEncodedBlank,hi=Te.isLinkConnectedToElement,pi=Te.isPolylineEqual,gi=Te.layoutPadded,fi=Te.layoutPaddedBiasFree,mi=Te.makeDelayProviderDecorator,yi=Te.makeIndexedDataset,bi=Te.makeMoveComparator,xi=Te.makeSerializedDiagram,wi=Te.makeSerializedLayout,vi=Te.mapAbortedToNull,ki=Te.observeElementTypes,Li=Te.observeLinkTypes,_i=Te.observeProperties,Si=Te.paneTopLeft,Mi=Te.pathFromPolyline,Ii=Te.placeElementsAround,Ti=Te.raceAbortSignal,Ei=Te.requestElementData,Ni=Te.restoreLinksBetweenElements,ji=Te.setElementData,Ci=Te.setElementExpanded,Ai=Te.setLinkData,Di=Te.shallowArrayEqual,Pi=Te.startDragElements,Oi=Te.totalPaneSize,zi=Te.translateToPositiveQuadrant,Ri=Te.uniformGrid,Bi=Te.useAuthoredEntity,Ui=Te.useCanvas,$i=Te.useLinkActionContext,Wi=Te.useLoadedWorkspace,Yi=Te.useObservedProperty,Fi=Te.useWorker,Qi=Te.useWorkspace},25568:e=>{"use strict";const{AbortController:t,AbortSignal:n}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=n,e.exports.default=t},78478:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});n(96540);var i=n(92303),r=n(74848);function o(e){let{children:t,fallback:n}=e;return(0,i.A)()?(0,r.jsx)(r.Fragment,{children:t?.()}):n??null}},67526:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],l=o[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),d=0,u=l>0?s-4:s;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===l&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===l&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,o=[],s=16383,a=0,c=i-r;a<c;a+=s)o.push(l(e,a,a+s>c?c:a+s));1===r?(t=e[i-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,i){for(var r,o,s=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},48287:(e,t,n)=>{"use strict";const i=n(67526),r=n(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|f(e,t);let i=a(n);const r=i.write(e,t);r!==n&&(i=i.slice(0,r));return i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,n);const r=function(e){if(l.isBuffer(e)){const t=0|g(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||q(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),a(e<0?0:0|g(e))}function h(e){const t=e.length<0?0:0|g(e.length),n=a(t);for(let i=0;i<t;i+=1)n[i]=255&e[i];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(i,l.prototype),i}function g(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return i?-1:Z(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function b(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),q(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:x(e,t,n,i,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):x(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function x(e,t,n,i,r){let o,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){let i=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===i?0:o-i)){if(-1===i&&(i=o),o-i+1===l)return i*s}else-1!==i&&(o-=o-i),i=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){let n=!0;for(let i=0;i<l;i++)if(c(e,o+i)!==c(t,i)){n=!1;break}if(n)return o}return-1}function w(e,t,n,i){n=Number(n)||0;const r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;const o=t.length;let s;for(i>o/2&&(i=o/2),s=0;s<i;++s){const i=parseInt(t.substr(2*s,2),16);if(q(i))return s;e[n+s]=i}return s}function v(e,t,n,i){return V(Z(t,e.length-n),e,n,i)}function k(e,t,n,i){return V(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function L(e,t,n,i){return V(H(t),e,n,i)}function _(e,t,n,i){return V(function(e,t){let n,i,r;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function S(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);const i=[];let r=t;for(;r<n;){const t=e[r];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(r+s<=n){let n,i,a,l;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[r+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[r+1],i=e[r+2],128==(192&n)&&128==(192&i)&&(l=(15&t)<<12|(63&n)<<6|63&i,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[r+1],i=e[r+2],a=e[r+3],128==(192&n)&&128==(192&i)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&i)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|1023&o),i.push(o),r+=s}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=I));return n}(i)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const i=l.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(G(t,Uint8Array))r+t.length>i.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(i,r)):Uint8Array.prototype.set.call(i,t,r);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,r)}r+=t.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?M(this,0,e):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,i,r){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),c=this.slice(i,r),d=e.slice(t,n);for(let l=0;l<a;++l)if(c[l]!==d[l]){o=c[l],s=d[l];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":case"latin1":case"binary":return k(this,e,t,n);case"base64":return L(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function E(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function N(e,t,n){const i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);let r="";for(let o=t;o<n;++o)r+=X[e[o]];return r}function j(e,t,n){const i=e.slice(t,n);let r="";for(let o=0;o<i.length-1;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function D(e,t,n,i,r){W(t,i,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function P(e,t,n,i,r){W(t,i,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function O(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,i,o){return t=+t,n>>>=0,o||O(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function R(e,t,n,i,o){return t=+t,n>>>=0,o||O(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e],r=1,o=0;for(;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e+--t],r=1;for(;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(i)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(i)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e],r=1,o=0;for(;++o<t&&(r*=256);)i+=this[e+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=t,r=1,o=this[e+--i];for(;i>0&&(r*=256);)o+=this[e+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t>>>=0,n>>>=0,!i){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t>>>=0,n>>>=0,!i){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}let r=0,o=1,s=0;for(this[t]=255&e;++r<n&&(o*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/o|0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}let r=n-1,o=1,s=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/o|0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return R(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return R(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);const r=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{const o=l.isBuffer(e)?e:l.from(e,i),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=o[r%s]}return this};const B={};function U(e,t,n){B[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function $(e){let t="",n=e.length;const i="-"===e[0]?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function W(e,t,n,i,r,o){if(e>n||e<t){const i="bigint"==typeof t?"n":"";let r;throw r=o>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(o+1)}${i}`:`>= -(2${i} ** ${8*(o+1)-1}${i}) and < 2 ** ${8*(o+1)-1}${i}`:`>= ${t}${i} and <= ${n}${i}`,new B.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){Y(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||F(t,e.length-(n+1))}(i,r,o)}function Y(e,t){if("number"!=typeof e)throw new B.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,n){if(Math.floor(e)!==e)throw Y(e,n),new B.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new B.ERR_BUFFER_OUT_OF_BOUNDS;throw new B.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){let i=`The value of "${e}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=$(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=$(r)),r+="n"),i+=` It must be ${t}. Received ${r}`,i}),RangeError);const Q=/[^+/0-9A-Za-z-_]/g;function Z(e,t){let n;t=t||1/0;const i=e.length;let r=null;const o=[];for(let s=0;s<i;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,i){let r;for(r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const i=16*n;for(let r=0;r<16;++r)t[i+r]=e[n]+e[r]}return t}();function J(e){return"undefined"==typeof BigInt?K:e}function K(){throw new Error("BigInt not supported")}},37007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&f(e,"error",t,n)}(e,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,s,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=l(e))>0&&s.length>r&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,c=d,console&&console.warn&&console.warn(c)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function h(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):g(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var c=l.length,d=g(l,c);for(n=0;n<c;++n)i(d[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4213:function(e,t,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){l(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,t,n){var a=s.URL||s.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):r(l.href)?i(e,t,n):o(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),n);else if(r(e))i(e,n,s);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout((function(){o(a)}))}}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,n);var o="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&l||a)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=s.URL||s.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});s.saveAs=l.saveAs=l,e.exports=l})?i.apply(t,r):i)||(e.exports=o)},251:(e,t)=>{t.read=function(e,t,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,d=-7,u=n?r-1:0,h=n?-1:1,p=e[t+u];for(u+=h,o=p&(1<<-d)-1,p>>=-d,d+=a;d>0;o=256*o+e[t+u],u+=h,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=i;d>0;s=256*s+e[t+u],u+=h,d-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var s,a,l,c=8*o-r-1,d=(1<<c)-1,u=d>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,g=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(t*l-1)*Math.pow(2,r),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&a,p+=g,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;e[n+p]=255&s,p+=g,s/=256,c-=8);e[n+p-g]|=128*f}},30810:(e,t,n)=>{"use strict";const{SymbolDispose:i}=n(74641),{AbortError:r,codes:o}=n(68526),{isNodeStream:s,isWebStream:a,kControllerErrorFunction:l}=n(136),c=n(89365),{ERR_INVALID_ARG_TYPE:d}=o;let u;e.exports.addAbortSignal=function(t,n){if(((e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new d(t,"AbortSignal",e)})(t,"signal"),!s(n)&&!a(n))throw new d("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;const o=s(t)?()=>{t.destroy(new r(void 0,{cause:e.reason}))}:()=>{t[l](new r(void 0,{cause:e.reason}))};if(e.aborted)o();else{u=u||n(56017).addAbortListener;const r=u(e,o);c(t,r[i])}return t}},85586:(e,t,n)=>{"use strict";const{StringPrototypeSlice:i,SymbolIterator:r,TypedArrayPrototypeSet:o,Uint8Array:s}=n(74641),{Buffer:a}=n(48287),{inspect:l}=n(56017);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;for(;null!==(t=t.next);)n+=e+t.data;return n}concat(e){if(0===this.length)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let n=this.head,i=0;for(;n;)o(t,n.data,i),i+=n.data.length,n=n.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[r](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,r=0;do{const o=n.data;if(!(e>o.length)){e===o.length?(t+=o,++r,n.next?this.head=n.next:this.head=this.tail=null):(t+=i(o,0,e),this.head=n,n.data=i(o,e));break}t+=o,e-=o.length,++r}while(null!==(n=n.next));return this.length-=r,t}_getBuffer(e){const t=a.allocUnsafe(e),n=e;let i=this.head,r=0;do{const a=i.data;if(!(e>a.length)){e===a.length?(o(t,a,n-e),++r,i.next?this.head=i.next:this.head=this.tail=null):(o(t,new s(a.buffer,a.byteOffset,e),n-e),this.head=i,i.data=a.slice(e));break}o(t,a,n-e),e-=a.length,++r}while(null!==(i=i.next));return this.length-=r,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},8489:(e,t,n)=>{"use strict";const{pipeline:i}=n(28431),r=n(43559),{destroyer:o}=n(57647),{isNodeStream:s,isReadable:a,isWritable:l,isWebStream:c,isTransformStream:d,isWritableStream:u,isReadableStream:h}=n(136),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:g,ERR_MISSING_ARGS:f}}=n(68526),m=n(89365);e.exports=function(...e){if(0===e.length)throw new f("streams");if(1===e.length)return r.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=r.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=r.from(e[t])}for(let i=0;i<e.length;++i)if(s(e[i])||c(e[i])){if(i<e.length-1&&!(a(e[i])||h(e[i])||d(e[i])))throw new g(`streams[${i}]`,t[i],"must be readable");if(i>0&&!(l(e[i])||u(e[i])||d(e[i])))throw new g(`streams[${i}]`,t[i],"must be writable")}let n,y,b,x,w;const v=e[0],k=i(e,(function(e){const t=x;x=null,t?t(e):e?w.destroy(e):_||L||w.destroy()})),L=!!(l(v)||u(v)||d(v)),_=!!(a(k)||h(k)||d(k));if(w=new r({writableObjectMode:!(null==v||!v.writableObjectMode),readableObjectMode:!(null==k||!k.readableObjectMode),writable:L,readable:_}),L){if(s(v))w._write=function(e,t,i){v.write(e,t)?i():n=i},w._final=function(e){v.end(),y=e},v.on("drain",(function(){if(n){const e=n;n=null,e()}}));else if(c(v)){const e=(d(v)?v.writable:v).getWriter();w._write=async function(t,n,i){try{await e.ready,e.write(t).catch((()=>{})),i()}catch(r){i(r)}},w._final=async function(t){try{await e.ready,e.close().catch((()=>{})),y=t}catch(n){t(n)}}}const e=d(k)?k.readable:k;m(e,(()=>{if(y){const e=y;y=null,e()}}))}if(_)if(s(k))k.on("readable",(function(){if(b){const e=b;b=null,e()}})),k.on("end",(function(){w.push(null)})),w._read=function(){for(;;){const e=k.read();if(null===e)return void(b=w._read);if(!w.push(e))return}};else if(c(k)){const e=(d(k)?k.readable:k).getReader();w._read=async function(){for(;;)try{const{value:t,done:n}=await e.read();if(!w.push(t))return;if(n)return void w.push(null)}catch{return}}}return w._destroy=function(e,t){e||null===x||(e=new p),b=null,n=null,y=null,null===x?t(e):(x=t,s(k)&&o(k,e))},w}},57647:(e,t,n)=>{"use strict";const i=n(65606),{aggregateTwoErrors:r,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:s}=n(68526),{Symbol:a}=n(74641),{kIsDestroyed:l,isDestroyed:c,isFinished:d,isServerRequest:u}=n(136),h=a("kDestroy"),p=a("kConstruct");function g(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function f(e,t,n){let r=!1;function o(t){if(r)return;r=!0;const o=e._readableState,s=e._writableState;g(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(t),t?i.nextTick(m,e,t):i.nextTick(y,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function m(e,t){b(e,t),y(e)}function y(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=n&&n.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function b(e,t){const n=e._readableState,i=e._writableState;null!=i&&i.errorEmitted||null!=n&&n.errorEmitted||(i&&(i.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function x(e,t,n){const r=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=r&&r.destroyed)return this;null!=r&&r.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),r&&!r.errored&&(r.errored=t),n?i.nextTick(b,e,t):b(e,t))}function w(e){let t=!1;function n(n){if(t)return void x(e,null!=n?n:new o);t=!0;const r=e._readableState,s=e._writableState,a=s||r;r&&(r.constructed=!0),s&&(s.constructed=!0),a.destroyed?e.emit(h,n):n?x(e,n,!0):i.nextTick(v,e)}try{e._construct((e=>{i.nextTick(n,e)}))}catch(r){i.nextTick(n,r)}}function v(e){e.emit(p)}function k(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function L(e){e.emit("close")}function _(e,t){e.emit("error",t),i.nextTick(L,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(p,t),e.listenerCount(p)>1||i.nextTick(w,e)},destroyer:function(e,t){e&&!c(e)&&(t||d(e)||(t=new s),u(e)?(e.socket=null,e.destroy(t)):k(e)?e.abort():k(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?i.nextTick(_,e,t):i.nextTick(L,e),e.destroyed||(e[l]=!0))},destroy:function(e,t){const n=this._readableState,i=this._writableState,o=i||n;return null!=i&&i.destroyed||null!=n&&n.destroyed?("function"==typeof t&&t(),this):(g(e,i,n),i&&(i.destroyed=!0),n&&(n.destroyed=!0),o.constructed?f(this,e,t):this.once(h,(function(n){f(this,r(n,e),t)})),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:x}},43559:(e,t,n)=>{"use strict";const{ObjectDefineProperties:i,ObjectGetOwnPropertyDescriptor:r,ObjectKeys:o,ObjectSetPrototypeOf:s}=n(74641);e.exports=c;const a=n(23125),l=n(77221);s(c.prototype,a.prototype),s(c,a);{const e=o(l.prototype);for(let t=0;t<e.length;t++){const n=e[t];c.prototype[n]||(c.prototype[n]=l.prototype[n])}}function c(e){if(!(this instanceof c))return new c(e);a.call(this,e),l.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let d,u;function h(){return void 0===d&&(d={}),d}i(c.prototype,{writable:{__proto__:null,...r(l.prototype,"writable")},writableHighWaterMark:{__proto__:null,...r(l.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...r(l.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...r(l.prototype,"writableBuffer")},writableLength:{__proto__:null,...r(l.prototype,"writableLength")},writableFinished:{__proto__:null,...r(l.prototype,"writableFinished")},writableCorked:{__proto__:null,...r(l.prototype,"writableCorked")},writableEnded:{__proto__:null,...r(l.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...r(l.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),c.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},c.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},c.from=function(e){return u||(u=n(21973)),u(e,"body")}},21973:(e,t,n)=>{const i=n(65606),r=n(48287),{isReadable:o,isWritable:s,isIterable:a,isNodeStream:l,isReadableNodeStream:c,isWritableNodeStream:d,isDuplexNodeStream:u,isReadableStream:h,isWritableStream:p}=n(136),g=n(89365),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=n(68526),{destroyer:b}=n(57647),x=n(43559),w=n(23125),v=n(77221),{createDeferredPromise:k}=n(56017),L=n(40333),_=globalThis.Blob||r.Blob,S=void 0!==_?function(e){return e instanceof _}:function(e){return!1},M=globalThis.AbortController||n(25568).AbortController,{FunctionPrototypeCall:I}=n(74641);class T extends x{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function E(e){const t=e.readable&&"function"!=typeof e.readable.read?w.wrap(e.readable):e.readable,n=e.writable;let i,r,a,l,c,d=!!o(t),u=!!s(n);function h(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new T({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==n||!n.writableObjectMode),readable:d,writable:u}),u&&(g(n,(e=>{u=!1,e&&b(t,e),h(e)})),c._write=function(e,t,r){n.write(e,t)?r():i=r},c._final=function(e){n.end(),r=e},n.on("drain",(function(){if(i){const e=i;i=null,e()}})),n.on("finish",(function(){if(r){const e=r;r=null,e()}}))),d&&(g(t,(e=>{d=!1,e&&b(t,e),h(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){c.push(null)})),c._read=function(){for(;;){const e=t.read();if(null===e)return void(a=c._read);if(!c.push(e))return}}),c._destroy=function(e,o){e||null===l||(e=new f),a=null,i=null,r=null,null===l?o(e):(l=o,b(n,e),b(t,e))},c}e.exports=function e(t,n){if(u(t))return t;if(c(t))return E({readable:t});if(d(t))return E({writable:t});if(l(t))return E({writable:!1,readable:!1});if(h(t))return E({readable:w.fromWeb(t)});if(p(t))return E({writable:v.fromWeb(t)});if("function"==typeof t){const{value:e,write:r,final:o,destroy:s}=function(e){let{promise:t,resolve:n}=k();const r=new M,o=r.signal,s=e(async function*(){for(;;){const e=t;t=null;const{chunk:r,done:s,cb:a}=await e;if(i.nextTick(a),s)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:n}=k()),yield r}}(),{signal:o});return{value:s,write(e,t,i){const r=n;n=null,r({chunk:e,done:!1,cb:i})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){r.abort(),t(e)}}}(t);if(a(e))return L(T,e,{objectMode:!0,write:r,final:o,destroy:s});const l=null==e?void 0:e.then;if("function"==typeof l){let t;const n=I(l,e,(e=>{if(null!=e)throw new y("nully","body",e)}),(e=>{b(t,e)}));return t=new T({objectMode:!0,readable:!1,write:r,final(e){o((async()=>{try{await n,i.nextTick(e,null)}catch(t){i.nextTick(e,t)}}))},destroy:s})}throw new y("Iterable, AsyncIterable or AsyncFunction",n,e)}if(S(t))return e(t.arrayBuffer());if(a(t))return L(T,t,{objectMode:!0,writable:!1});if(h(null==t?void 0:t.readable)&&p(null==t?void 0:t.writable))return T.fromWeb(t);if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable)){return E({readable:null!=t&&t.readable?c(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?d(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0})}const r=null==t?void 0:t.then;if("function"==typeof r){let e;return I(r,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{b(e,t)})),e=new T({objectMode:!0,writable:!1,read(){}})}throw new m(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},89365:(e,t,n)=>{const i=n(65606),{AbortError:r,codes:o}=n(68526),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:a}=o,{kEmptyObject:l,once:c}=n(56017),{validateAbortSignal:d,validateFunction:u,validateObject:h,validateBoolean:p}=n(2224),{Promise:g,PromisePrototypeThen:f,SymbolDispose:m}=n(74641),{isClosed:y,isReadable:b,isReadableNodeStream:x,isReadableStream:w,isReadableFinished:v,isReadableErrored:k,isWritable:L,isWritableNodeStream:_,isWritableStream:S,isWritableFinished:M,isWritableErrored:I,isNodeStream:T,willEmitClose:E,kIsClosedPromise:N}=n(136);let j;const C=()=>{};function A(e,t,o){var p,g;if(2===arguments.length?(o=t,t=l):null==t?t=l:h(t,"options"),u(o,"callback"),d(t.signal,"options.signal"),o=c(o),w(e)||S(e))return function(e,t,o){let s=!1,a=C;if(t.signal)if(a=()=>{s=!0,o.call(e,new r(void 0,{cause:t.signal.reason}))},t.signal.aborted)i.nextTick(a);else{j=j||n(56017).addAbortListener;const i=j(t.signal,a),r=o;o=c(((...t)=>{i[m](),r.apply(e,t)}))}const l=(...t)=>{s||i.nextTick((()=>o.apply(e,t)))};return f(e[N].promise,l,l),C}(e,t,o);if(!T(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);const A=null!==(p=t.readable)&&void 0!==p?p:x(e),D=null!==(g=t.writable)&&void 0!==g?g:_(e),P=e._writableState,O=e._readableState,z=()=>{e.writable||U()};let R=E(e)&&x(e)===A&&_(e)===D,B=M(e,!1);const U=()=>{B=!0,e.destroyed&&(R=!1),(!R||e.readable&&!A)&&(A&&!$||o.call(e))};let $=v(e,!1);const W=()=>{$=!0,e.destroyed&&(R=!1),(!R||e.writable&&!D)&&(D&&!B||o.call(e))},Y=t=>{o.call(e,t)};let F=y(e);const Q=()=>{F=!0;const t=I(e)||k(e);return t&&"boolean"!=typeof t?o.call(e,t):A&&!$&&x(e,!0)&&!v(e,!1)?o.call(e,new a):!D||B||M(e,!1)?void o.call(e):o.call(e,new a)},Z=()=>{F=!0;const t=I(e)||k(e);if(t&&"boolean"!=typeof t)return o.call(e,t);o.call(e)},H=()=>{e.req.on("finish",U)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?D&&!P&&(e.on("end",z),e.on("close",z)):(e.on("complete",U),R||e.on("abort",Q),e.req?H():e.on("request",H)),R||"boolean"!=typeof e.aborted||e.on("aborted",Q),e.on("end",W),e.on("finish",U),!1!==t.error&&e.on("error",Y),e.on("close",Q),F?i.nextTick(Q):null!=P&&P.errorEmitted||null!=O&&O.errorEmitted?R||i.nextTick(Z):(A||R&&!b(e)||!B&&!1!==L(e))&&(D||R&&!L(e)||!$&&!1!==b(e))?O&&e.req&&e.aborted&&i.nextTick(Z):i.nextTick(Z);const V=()=>{o=C,e.removeListener("aborted",Q),e.removeListener("complete",U),e.removeListener("abort",Q),e.removeListener("request",H),e.req&&e.req.removeListener("finish",U),e.removeListener("end",z),e.removeListener("close",z),e.removeListener("finish",U),e.removeListener("end",W),e.removeListener("error",Y),e.removeListener("close",Q)};if(t.signal&&!F){const s=()=>{const n=o;V(),n.call(e,new r(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)i.nextTick(s);else{j=j||n(56017).addAbortListener;const i=j(t.signal,s),r=o;o=c(((...t)=>{i[m](),r.apply(e,t)}))}}return V}e.exports=A,e.exports.finished=function(e,t){var n;let i=!1;return null===t&&(t=l),null!==(n=t)&&void 0!==n&&n.cleanup&&(p(t.cleanup,"cleanup"),i=t.cleanup),new g(((n,r)=>{const o=A(e,t,(e=>{i&&o(),e?r(e):n()}))}))}},40333:(e,t,n)=>{"use strict";const i=n(65606),{PromisePrototypeThen:r,SymbolAsyncIterator:o,SymbolIterator:s}=n(74641),{Buffer:a}=n(48287),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:c}=n(68526).codes;e.exports=function(e,t,n){let d,u;if("string"==typeof t||t instanceof a)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});if(t&&t[o])u=!0,d=t[o]();else{if(!t||!t[s])throw new l("iterable",["Iterable"],t);u=!1,d=t[s]()}const h=new e({objectMode:!0,highWaterMark:1,...n});let p=!1;return h._read=function(){p||(p=!0,async function(){for(;;){try{const{value:e,done:t}=u?await d.next():d.next();if(t)h.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw p=!1,new c;if(h.push(t))continue;p=!1}}catch(e){h.destroy(e)}break}}())},h._destroy=function(e,t){r(async function(e){const t=null!=e,n="function"==typeof d.throw;if(t&&n){const{value:t,done:n}=await d.throw(e);if(await t,n)return}if("function"==typeof d.return){const{value:e}=await d.return();await e}}(e),(()=>i.nextTick(t,e)),(n=>i.nextTick(t,n||e)))},h}},80334:(e,t,n)=>{"use strict";const{ArrayIsArray:i,ObjectSetPrototypeOf:r}=n(74641),{EventEmitter:o}=n(37007);function s(e){o.call(this,e)}function a(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}r(s.prototype,o.prototype),r(s,o),s.prototype.pipe=function(e,t){const n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function d(e){u(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function u(){n.removeListener("data",i),e.removeListener("drain",r),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",d),e.removeListener("error",d),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return a(n,"error",d),a(e,"error",d),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e},e.exports={Stream:s,prependListener:a}},1284:(e,t,n)=>{"use strict";const i=globalThis.AbortController||n(25568).AbortController,{codes:{ERR_INVALID_ARG_VALUE:r,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:s,ERR_OUT_OF_RANGE:a},AbortError:l}=n(68526),{validateAbortSignal:c,validateInteger:d,validateObject:u}=n(2224),h=n(74641).Symbol("kWeak"),p=n(74641).Symbol("kResistStopPropagation"),{finished:g}=n(89365),f=n(8489),{addAbortSignalNoValidate:m}=n(30810),{isWritable:y,isNodeStream:b}=n(136),{deprecate:x}=n(56017),{ArrayPrototypePush:w,Boolean:v,MathFloor:k,Number:L,NumberIsNaN:_,Promise:S,PromiseReject:M,PromiseResolve:I,PromisePrototypeThen:T,Symbol:E}=n(74641),N=E("kEmpty"),j=E("kEof");function C(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal");let i=1;null!=(null==t?void 0:t.concurrency)&&(i=k(t.concurrency));let r=i-1;return null!=(null==t?void 0:t.highWaterMark)&&(r=k(t.highWaterMark)),d(i,"options.concurrency",1),d(r,"options.highWaterMark",0),r+=i,async function*(){const o=n(56017).AbortSignalAny([null==t?void 0:t.signal].filter(v)),s=this,a=[],c={signal:o};let d,u,h=!1,p=0;function g(){h=!0,f()}function f(){p-=1,m()}function m(){u&&!h&&p<i&&a.length<r&&(u(),u=null)}!async function(){try{for await(let n of s){if(h)return;if(o.aborted)throw new l;try{if(n=e(n,c),n===N)continue;n=I(n)}catch(t){n=M(t)}p+=1,T(n,f,g),a.push(n),d&&(d(),d=null),!h&&(a.length>=r||p>=i)&&await new S((e=>{u=e}))}a.push(j)}catch(t){const e=M(t);T(e,f,g),a.push(e)}finally{h=!0,d&&(d(),d=null)}}();try{for(;;){for(;a.length>0;){const e=await a[0];if(e===j)return;if(o.aborted)throw new l;e!==N&&(yield e),a.shift(),m()}await new S((e=>{d=e}))}}finally{h=!0,u&&(u(),u=null)}}.call(this)}async function A(e,t=void 0){for await(const n of D.call(this,e,t))return!0;return!1}function D(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return C.call(this,(async function(t,n){return await e(t,n)?t:N}),t)}class P extends s{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function O(e){if(e=L(e),_(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:x((function(e=void 0){return null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&c(e.signal,"options.signal"),async function*(){let t=0;for await(const i of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l({cause:e.signal.reason});yield[t++,i]}}.call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const r of this){var i;if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;e--<=0&&(yield r)}}.call(this)},filter:D,flatMap:function(e,t){const n=C.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)},map:C,take:function(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const r of this){var i;if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;if(e-- >0&&(yield r),e<=0)return}}.call(this)},compose:function(e,t){if(null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),b(e)&&!y(e))throw new r("stream",e,"must be writable");const n=f(this,e);return null!=t&&t.signal&&m(t.signal,n),n}},e.exports.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await A.call(this,(async(...t)=>!await e(...t)),t)},forEach:async function(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);for await(const n of C.call(this,(async function(t,n){return await e(t,n),N}),t));},reduce:async function(e,t,n){var r;if("function"!=typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=n&&u(n,"options"),null!=(null==n?void 0:n.signal)&&c(n.signal,"options.signal");let s=arguments.length>1;if(null!=n&&null!==(r=n.signal)&&void 0!==r&&r.aborted){const e=new l(void 0,{cause:n.signal.reason});throw this.once("error",(()=>{})),await g(this.destroy(e)),e}const a=new i,d=a.signal;if(null!=n&&n.signal){const e={once:!0,[h]:this,[p]:!0};n.signal.addEventListener("abort",(()=>a.abort()),e)}let f=!1;try{for await(const i of this){var m;if(f=!0,null!=n&&null!==(m=n.signal)&&void 0!==m&&m.aborted)throw new l;s?t=await e(t,i,{signal:d}):(t=i,s=!0)}if(!f&&!s)throw new P}finally{a.abort()}return t},toArray:async function(e){null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&c(e.signal,"options.signal");const t=[];for await(const i of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l(void 0,{cause:e.signal.reason});w(t,i)}return t},some:A,find:async function(e,t){for await(const n of D.call(this,e,t))return n}}},62091:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:i}=n(74641);e.exports=o;const r=n(68649);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i(o.prototype,r.prototype),i(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},28431:(e,t,n)=>{const i=n(65606),{ArrayIsArray:r,Promise:o,SymbolAsyncIterator:s,SymbolDispose:a}=n(74641),l=n(89365),{once:c}=n(56017),d=n(57647),u=n(43559),{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:g,ERR_MISSING_ARGS:f,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=n(68526),{validateFunction:x,validateAbortSignal:w}=n(2224),{isIterable:v,isReadable:k,isReadableNodeStream:L,isNodeStream:_,isTransformStream:S,isWebStream:M,isReadableStream:I,isReadableFinished:T}=n(136),E=globalThis.AbortController||n(25568).AbortController;let N,j,C;function A(e,t,n){let i=!1;e.on("close",(()=>{i=!0}));return{destroy:t=>{i||(i=!0,d.destroyer(e,t||new m("pipe")))},cleanup:l(e,{readable:t,writable:n},(e=>{i=!e}))}}function D(e){if(v(e))return e;if(L(e))return async function*(e){j||(j=n(23125));yield*j.prototype[s].call(e)}(e);throw new p("val",["Readable","Iterable","AsyncIterable"],e)}async function P(e,t,n,{end:i}){let r,s=null;const a=e=>{if(e&&(r=e),s){const e=s;s=null,e()}},c=()=>new o(((e,t)=>{r?t(r):s=()=>{r?t(r):e()}}));t.on("drain",a);const d=l(t,{readable:!1},a);try{t.writableNeedDrain&&await c();for await(const n of e)t.write(n)||await c();i&&(t.end(),await c()),n()}catch(u){n(r!==u?h(r,u):u)}finally{d(),t.off("drain",a)}}async function O(e,t,n,{end:i}){S(t)&&(t=t.writable);const r=t.getWriter();try{for await(const t of e)await r.ready,r.write(t).catch((()=>{}));await r.ready,i&&await r.close(),n()}catch(o){try{await r.abort(o),n(o)}catch(o){n(o)}}}function z(e,t,o){if(1===e.length&&r(e[0])&&(e=e[0]),e.length<2)throw new f("streams");const s=new E,l=s.signal,c=null==o?void 0:o.signal,d=[];function h(){U(new b)}let m,y,x;w(c,"options.signal"),C=C||n(56017).addAbortListener,c&&(m=C(c,h));const T=[];let j,z=0;function B(e){U(e,0==--z)}function U(e,n){var r;if(!e||y&&"ERR_STREAM_PREMATURE_CLOSE"!==y.code||(y=e),y||n){for(;T.length;)T.shift()(y);null===(r=m)||void 0===r||r[a](),s.abort(),n&&(y||d.forEach((e=>e())),i.nextTick(t,y,x))}}for(let F=0;F<e.length;F++){const Q=e[F],Z=F<e.length-1,H=F>0,V=Z||!1!==(null==o?void 0:o.end),G=F===e.length-1;if(_(Q)){if(V){const{destroy:q,cleanup:X}=A(Q,Z,H);T.push(q),k(Q)&&G&&d.push(X)}function $(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&B(e)}Q.on("error",$),k(Q)&&G&&d.push((()=>{Q.removeListener("error",$)}))}if(0===F)if("function"==typeof Q){if(j=Q({signal:l}),!v(j))throw new g("Iterable, AsyncIterable or Stream","source",j)}else j=v(Q)||L(Q)||S(Q)?Q:u.from(Q);else if("function"==typeof Q){var W;if(S(j))j=D(null===(W=j)||void 0===W?void 0:W.readable);else j=D(j);if(j=Q(j,{signal:l}),Z){if(!v(j,!0))throw new g("AsyncIterable",`transform[${F-1}]`,j)}else{var Y;N||(N=n(62091));const J=new N({objectMode:!0}),K=null===(Y=j)||void 0===Y?void 0:Y.then;if("function"==typeof K)z++,K.call(j,(e=>{x=e,null!=e&&J.write(e),V&&J.end(),i.nextTick(B)}),(e=>{J.destroy(e),i.nextTick(B,e)}));else if(v(j,!0))z++,P(j,J,B,{end:V});else{if(!I(j)&&!S(j))throw new g("AsyncIterable or Promise","destination",j);{const ne=j.readable||j;z++,P(ne,J,B,{end:V})}}j=J;const{destroy:ee,cleanup:te}=A(j,!1,!0);T.push(ee),G&&d.push(te)}}else if(_(Q)){if(L(j)){z+=2;const ie=R(j,Q,B,{end:V});k(Q)&&G&&d.push(ie)}else if(S(j)||I(j)){const re=j.readable||j;z++,P(re,Q,B,{end:V})}else{if(!v(j))throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],j);z++,P(j,Q,B,{end:V})}j=Q}else if(M(Q)){if(L(j))z++,O(D(j),Q,B,{end:V});else if(I(j)||v(j))z++,O(j,Q,B,{end:V});else{if(!S(j))throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],j);z++,O(j.readable,Q,B,{end:V})}j=Q}else j=u.from(Q)}return(null!=l&&l.aborted||null!=c&&c.aborted)&&i.nextTick(h),j}function R(e,t,n,{end:r}){let o=!1;if(t.on("close",(()=>{o||n(new y)})),e.pipe(t,{end:!1}),r){function s(){o=!0,t.end()}T(e)?i.nextTick(s):e.once("end",s)}else n();return l(e,{readable:!0,writable:!1},(t=>{const i=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&i&&i.ended&&!i.errored&&!i.errorEmitted?e.once("end",n).once("error",n):n(t)})),l(t,{readable:!1,writable:!0},n)}e.exports={pipelineImpl:z,pipeline:function(...e){return z(e,c(function(e){return x(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}},23125:(e,t,n)=>{const i=n(65606),{ArrayPrototypeIndexOf:r,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:a,ObjectDefineProperties:l,ObjectKeys:c,ObjectSetPrototypeOf:d,Promise:u,SafeSet:h,SymbolAsyncDispose:p,SymbolAsyncIterator:g,Symbol:f}=n(74641);e.exports=G,G.ReadableState=V;const{EventEmitter:m}=n(37007),{Stream:y,prependListener:b}=n(80334),{Buffer:x}=n(48287),{addAbortSignal:w}=n(30810),v=n(89365);let k=n(56017).debuglog("stream",(e=>{k=e}));const L=n(85586),_=n(57647),{getHighWaterMark:S,getDefaultHighWaterMark:M}=n(13920),{aggregateTwoErrors:I,codes:{ERR_INVALID_ARG_TYPE:T,ERR_METHOD_NOT_IMPLEMENTED:E,ERR_OUT_OF_RANGE:N,ERR_STREAM_PUSH_AFTER_EOF:j,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:C},AbortError:A}=n(68526),{validateObject:D}=n(2224),P=f("kPaused"),{StringDecoder:O}=n(83141),z=n(40333);d(G.prototype,y.prototype),d(G,y);const R=()=>{},{errorOrDestroy:B}=_,U=1,$=16,W=32,Y=64,F=2048,Q=4096,Z=65536;function H(e){return{enumerable:!1,get(){return!!(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function V(e,t,i){"boolean"!=typeof i&&(i=t instanceof n(43559)),this.state=F|Q|$|W,e&&e.objectMode&&(this.state|=U),i&&e&&e.readableObjectMode&&(this.state|=U),this.highWaterMark=e?S(this,e,"readableHighWaterMark",i):M(!1),this.buffer=new L,this.length=0,this.pipes=[],this.flowing=null,this[P]=null,e&&!1===e.emitClose&&(this.state&=~F),e&&!1===e.autoDestroy&&(this.state&=~Q),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new O(e.encoding),this.encoding=e.encoding)}function G(e){if(!(this instanceof G))return new G(e);const t=this instanceof n(43559);this._readableState=new V(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&w(e.signal,this)),y.call(this,e),_.construct(this,(()=>{this._readableState.needReadable&&te(this,this._readableState)}))}function q(e,t,n,i){k("readableAddChunk",t);const r=e._readableState;let o;if(r.state&U||("string"==typeof t?(n=n||r.defaultEncoding,r.encoding!==n&&(i&&r.encoding?t=x.from(t,n).toString(r.encoding):(t=x.from(t,n),n=""))):t instanceof x?n="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),n=""):null!=t&&(o=new T("chunk",["string","Buffer","Uint8Array"],t))),o)B(e,o);else if(null===t)r.state&=-9,function(e,t){if(k("onEofChunk"),t.ended)return;if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?K(e):(t.needReadable=!1,t.emittedReadable=!0,ee(e))}(e,r);else if(r.state&U||t&&t.length>0)if(i)if(4&r.state)B(e,new C);else{if(r.destroyed||r.errored)return!1;X(e,r,t,!0)}else if(r.ended)B(e,new j);else{if(r.destroyed||r.errored)return!1;r.state&=-9,r.decoder&&!n?(t=r.decoder.write(t),r.objectMode||0!==t.length?X(e,r,t,!1):te(e,r)):X(e,r,t,!1)}else i||(r.state&=-9,te(e,r));return!r.ended&&(r.length<r.highWaterMark||0===r.length)}function X(e,t,n,i){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.state&Z?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.state&Y&&K(e)),te(e,t)}l(V.prototype,{objectMode:H(U),ended:H(2),endEmitted:H(4),reading:H(8),constructed:H($),sync:H(W),needReadable:H(Y),emittedReadable:H(128),readableListening:H(256),resumeScheduled:H(512),errorEmitted:H(1024),emitClose:H(F),autoDestroy:H(Q),destroyed:H(8192),closed:H(16384),closeEmitted:H(32768),multiAwaitDrain:H(Z),readingMore:H(1<<17),dataEmitted:H(1<<18)}),G.prototype.destroy=_.destroy,G.prototype._undestroy=_.undestroy,G.prototype._destroy=function(e,t){t(e)},G.prototype[m.captureRejectionSymbol]=function(e){this.destroy(e)},G.prototype[p]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new A,this.destroy(e)),new u(((t,n)=>v(this,(i=>i&&i!==e?n(i):t(null)))))},G.prototype.push=function(e,t){return q(this,e,t,!1)},G.prototype.unshift=function(e,t){return q(this,e,t,!0)},G.prototype.isPaused=function(){const e=this._readableState;return!0===e[P]||!1===e.flowing},G.prototype.setEncoding=function(e){const t=new O(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let i="";for(const r of n)i+=t.write(r);return n.clear(),""!==i&&n.push(i),this._readableState.length=i.length,this};function J(e,t){return e<=0||0===t.length&&t.ended?0:t.state&U?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function K(e){const t=e._readableState;k("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(k("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(ee,e))}function ee(e){const t=e._readableState;k("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,se(e)}function te(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,i.nextTick(ne,e,t))}function ne(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const n=t.length;if(k("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function ie(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[P]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function re(e){k("readable nexttick read 0"),e.read(0)}function oe(e,t){k("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),se(e),t.flowing&&!t.reading&&e.read(0)}function se(e){const t=e._readableState;for(k("flow",t.flowing);t.flowing&&null!==e.read(););}function ae(e,t){"function"!=typeof e.read&&(e=G.wrap(e,{objectMode:!0}));const n=async function*(e,t){let n,i=R;function r(t){this===e?(i(),i=R):i=t}e.on("readable",r);const o=v(e,{writable:!1},(e=>{n=e?I(n,e):null,i(),i=R}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new u(r)}}}catch(s){throw n=I(n,s),n}finally{!n&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",r),o()):_.destroyer(e,null)}}(e,t);return n.stream=e,n}function le(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function ce(e){const t=e._readableState;k("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(de,t,e))}function de(e,t){if(k("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)i.nextTick(ue,t);else if(e.autoDestroy){const e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}function ue(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let he;function pe(){return void 0===he&&(he={}),he}G.prototype.read=function(e){k("read",e),void 0===e?e=NaN:o(e)||(e=a(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new N("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return k("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ce(this):K(this),null;if(0===(e=J(e,t))&&t.ended)return 0===t.length&&ce(this),null;let i,r=!!(t.state&Y);if(k("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,k("length less than watermark",r)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)r=!1,k("reading, ended or constructing",r);else if(r){k("do read"),t.state|=8|W,0===t.length&&(t.state|=Y);try{this._read(t.highWaterMark)}catch(s){B(this,s)}t.state&=~W,t.reading||(e=J(n,t))}return i=e>0?le(e,t):null,null===i?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&ce(this)),null===i||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",i)),i},G.prototype._read=function(e){throw new E("_read()")},G.prototype.pipe=function(e,t){const n=this,r=this._readableState;1===r.pipes.length&&(r.multiAwaitDrain||(r.multiAwaitDrain=!0,r.awaitDrainWriters=new h(r.awaitDrainWriters?[r.awaitDrainWriters]:[]))),r.pipes.push(e),k("pipe count=%d opts=%j",r.pipes.length,t);const o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?a:m;function s(t,i){k("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,function(){k("cleanup"),e.removeListener("close",g),e.removeListener("finish",f),l&&e.removeListener("drain",l);e.removeListener("error",p),e.removeListener("unpipe",s),n.removeListener("end",a),n.removeListener("end",m),n.removeListener("data",u),c=!0,l&&r.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&l()}())}function a(){k("onend"),e.end()}let l;r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);let c=!1;function d(){c||(1===r.pipes.length&&r.pipes[0]===e?(k("false write response, pause",0),r.awaitDrainWriters=e,r.multiAwaitDrain=!1):r.pipes.length>1&&r.pipes.includes(e)&&(k("false write response, pause",r.awaitDrainWriters.size),r.awaitDrainWriters.add(e)),n.pause()),l||(l=function(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(k("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(k("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,e),e.on("drain",l))}function u(t){k("ondata");const n=e.write(t);k("dest.write",n),!1===n&&d()}function p(t){if(k("onerror",t),m(),e.removeListener("error",p),0===e.listenerCount("error")){const n=e._writableState||e._readableState;n&&!n.errorEmitted?B(e,t):e.emit("error",t)}}function g(){e.removeListener("finish",f),m()}function f(){k("onfinish"),e.removeListener("close",g),m()}function m(){k("unpipe"),n.unpipe(e)}return n.on("data",u),b(e,"error",p),e.once("close",g),e.once("finish",f),e.emit("pipe",n),!0===e.writableNeedDrain?d():r.flowing||(k("pipe resume"),n.resume()),e},G.prototype.unpipe=function(e){const t=this._readableState;if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=r(t.pipes,e);return-1===n||(t.pipes.splice(n,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},G.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,k("on readable",r.length,r.reading),r.length?K(this):r.reading||i.nextTick(re,this))),n},G.prototype.addListener=G.prototype.on,G.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(ie,this),n},G.prototype.off=G.prototype.removeListener,G.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(ie,this),t},G.prototype.resume=function(){const e=this._readableState;return e.flowing||(k("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(oe,e,t))}(this,e)),e[P]=!1,this},G.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[P]=!0,this},G.prototype.wrap=function(e){let t=!1;e.on("data",(n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{B(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=c(e);for(let i=1;i<n.length;i++){const t=n[i];void 0===this[t]&&"function"==typeof e[t]&&(this[t]=e[t].bind(e))}return this},G.prototype[g]=function(){return ae(this)},G.prototype.iterator=function(e){return void 0!==e&&D(e,"options"),ae(this,e)},l(G.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),l(V.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[P]},set(e){this[P]=!!e}}}),G._fromList=le,G.from=function(e,t){return z(G,e,t)},G.fromWeb=function(e,t){return pe().newStreamReadableFromReadableStream(e,t)},G.toWeb=function(e,t){return pe().newReadableStreamFromStreamReadable(e,t)},G.wrap=function(e,t){var n,i;return new G({objectMode:null===(n=null!==(i=e.readableObjectMode)&&void 0!==i?i:e.objectMode)||void 0===n||n,...t,destroy(t,n){_.destroyer(e,t),n(t)}}).wrap(e)}},13920:(e,t,n)=>{"use strict";const{MathFloor:i,NumberIsInteger:r}=n(74641),{validateInteger:o}=n(2224),{ERR_INVALID_ARG_VALUE:s}=n(68526).codes;let a=16384,l=16;function c(e){return e?l:a}e.exports={getHighWaterMark:function(e,t,n,o){const a=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,o,n);if(null!=a){if(!r(a)||a<0){throw new s(o?`options.${n}`:"options.highWaterMark",a)}return i(a)}return c(e.objectMode)},getDefaultHighWaterMark:c,setDefaultHighWaterMark:function(e,t){o(t,"value",0),e?l=t:a=t}}},68649:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:i,Symbol:r}=n(74641);e.exports=c;const{ERR_METHOD_NOT_IMPLEMENTED:o}=n(68526).codes,s=n(43559),{getHighWaterMark:a}=n(13920);i(c.prototype,s.prototype),i(c,s);const l=r("kCallback");function c(e){if(!(this instanceof c))return new c(e);const t=e?a(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),s.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function d(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())}))}function u(){this._final!==d&&d.call(this)}c.prototype._final=d,c.prototype._transform=function(e,t,n){throw new o("_transform()")},c.prototype._write=function(e,t,n){const i=this._readableState,r=this._writableState,o=i.length;this._transform(e,t,((e,t)=>{e?n(e):(null!=t&&this.push(t),r.ended||o===i.length||i.length<i.highWaterMark?n():this[l]=n)}))},c.prototype._read=function(){if(this[l]){const e=this[l];this[l]=null,e()}}},136:(e,t,n)=>{"use strict";const{SymbolAsyncIterator:i,SymbolIterator:r,SymbolFor:o}=n(74641),s=o("nodejs.stream.destroyed"),a=o("nodejs.stream.errored"),l=o("nodejs.stream.readable"),c=o("nodejs.stream.writable"),d=o("nodejs.stream.disturbed"),u=o("nodejs.webstream.isClosedPromise"),h=o("nodejs.webstream.controllerErrorFunction");function p(e,t=!1){var n;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function g(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function f(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function m(e){return!(!e||f(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function y(e){return!(!e||f(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function b(e){return!(!e||f(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function x(e){if(!f(e))return null;const t=e._writableState,n=e._readableState,i=t||n;return!!(e.destroyed||e[s]||null!=i&&i.destroyed)}function w(e){if(!g(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function v(e,t){if(!p(e))return null;const n=e._readableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function k(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!x(e)&&(p(e)&&e.readable&&!v(e))}function L(e){return e&&null!=e[c]?e[c]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!x(e)&&(g(e)&&e.writable&&!w(e))}function _(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function S(e){return"boolean"==typeof e._sent100&&_(e)}e.exports={isDestroyed:x,kIsDestroyed:s,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[d])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:d,isErrored:function(e){var t,n,i,r,o,s,l,c,d,u;return!(!e||!(null!==(t=null!==(n=null!==(i=null!==(r=null!==(o=null!==(s=e[a])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==r?r:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==i?i:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(d=e._readableState)||void 0===d?void 0:d.errored)&&void 0!==t?t:null===(u=e._writableState)||void 0===u?void 0:u.errored))},kIsErrored:a,isReadable:k,kIsReadable:l,kIsClosedPromise:u,kControllerErrorFunction:h,kIsWritable:c,isClosed:function(e){if(!f(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==n?void 0:n.closed)?(null==t?void 0:t.closed)||(null==n?void 0:n.closed):"boolean"==typeof e._closed&&_(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return f(e)?!!x(e)||(!1===(null==t?void 0:t.readable)||!k(e))&&(!1===(null==t?void 0:t.writable)||!L(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[i]:!1===t?"function"==typeof e[r]:"function"==typeof e[i]||"function"==typeof e[r])},isReadableNodeStream:p,isReadableStream:m,isReadableEnded:function(e){if(!p(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:v,isReadableErrored:function(e){var t,n;return f(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isNodeStream:f,isWebStream:function(e){return m(e)||y(e)||b(e)},isWritable:L,isWritableNodeStream:g,isWritableStream:y,isWritableEnded:w,isWritableFinished:function(e,t){if(!g(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))},isWritableErrored:function(e){var t,n;return f(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:S,willEmitClose:function(e){if(!f(e))return null;const t=e._writableState,n=e._readableState,i=t||n;return!i&&S(e)||!!(i&&i.autoDestroy&&i.emitClose&&!1===i.closed)},isTransformStream:b}},77221:(e,t,n)=>{const i=n(65606),{ArrayPrototypeSlice:r,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:a,ObjectDefineProperties:l,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:d,Symbol:u,SymbolHasInstance:h}=n(74641);e.exports=D,D.WritableState=C;const{EventEmitter:p}=n(37007),g=n(80334).Stream,{Buffer:f}=n(48287),m=n(57647),{addAbortSignal:y}=n(30810),{getHighWaterMark:b,getDefaultHighWaterMark:x}=n(13920),{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:v,ERR_MULTIPLE_CALLBACK:k,ERR_STREAM_CANNOT_PIPE:L,ERR_STREAM_DESTROYED:_,ERR_STREAM_ALREADY_FINISHED:S,ERR_STREAM_NULL_VALUES:M,ERR_STREAM_WRITE_AFTER_END:I,ERR_UNKNOWN_ENCODING:T}=n(68526).codes,{errorOrDestroy:E}=m;function N(){}c(D.prototype,g.prototype),c(D,g);const j=u("kOnFinished");function C(e,t,i){"boolean"!=typeof i&&(i=t instanceof n(43559)),this.objectMode=!(!e||!e.objectMode),i&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?b(this,e,"writableHighWaterMark",i):x(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const r=!(!e||!1!==e.decodeStrings);this.decodeStrings=!r,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=R.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,A(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[j]=[]}function A(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function D(e){const t=this instanceof n(43559);if(!t&&!s(D,this))return new D(e);this._writableState=new C(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&y(e.signal,this)),g.call(this,e),m.construct(this,(()=>{const e=this._writableState;e.writing||W(this,e),Q(this,e)}))}function P(e,t,n,r){const o=e._writableState;if("function"==typeof n)r=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!f.isEncoding(n))throw new T(n)}else n=o.defaultEncoding;"function"!=typeof r&&(r=N)}if(null===t)throw new M;if(!o.objectMode)if("string"==typeof t)!1!==o.decodeStrings&&(t=f.from(t,n),n="buffer");else if(t instanceof f)n="buffer";else{if(!g._isUint8Array(t))throw new w("chunk",["string","Buffer","Uint8Array"],t);t=g._uint8ArrayToBuffer(t),n="buffer"}let s;return o.ending?s=new I:o.destroyed&&(s=new _("write")),s?(i.nextTick(r,s),E(e,s,!0),s):(o.pendingcb++,function(e,t,n,i,r){const o=t.objectMode?1:n.length;t.length+=o;const s=t.length<t.highWaterMark;s||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:i,callback:r}),t.allBuffers&&"buffer"!==i&&(t.allBuffers=!1),t.allNoop&&r!==N&&(t.allNoop=!1)):(t.writelen=o,t.writecb=r,t.writing=!0,t.sync=!0,e._write(n,i,t.onwrite),t.sync=!1);return s&&!t.errored&&!t.destroyed}(e,o,t,n,r))}function O(e,t,n,i,r,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new _("write")):n?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function z(e,t,n,i){--t.pendingcb,i(n),$(t),E(e,n)}function R(e,t){const n=e._writableState,r=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),r?i.nextTick(z,e,n,t,o):z(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&W(e,n),r?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},i.nextTick(B,n.afterWriteTickInfo)):U(e,n,1,o))):E(e,new k)}function B({stream:e,state:t,count:n,cb:i}){return t.afterWriteTickInfo=null,U(e,t,n,i)}function U(e,t,n,i){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));n-- >0;)t.pendingcb--,i();t.destroyed&&$(t),Q(e,t)}function $(e){if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new _("write"))}const n=e[j].splice(0);for(let r=0;r<n.length;r++){var i;n[r](null!==(i=e.errored)&&void 0!==i?i:new _("end"))}A(e)}function W(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:n,bufferedIndex:i,objectMode:o}=t,s=n.length-i;if(!s)return;let a=i;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;const i=t.allNoop?N:e=>{for(let t=a;t<n.length;++t)n[t].callback(e)},o=t.allNoop&&0===a?n:r(n,a);o.allBuffers=t.allBuffers,O(e,t,!0,t.length,o,"",i),A(t)}else{do{const{chunk:i,encoding:r,callback:s}=n[a];n[a++]=null;O(e,t,!1,o?1:i.length,i,r,s)}while(a<n.length&&!t.writing);a===n.length?A(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}function Y(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function F(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let n=!1;function r(r){if(n)E(e,null!=r?r:k());else if(n=!0,t.pendingcb--,r){const n=t[j].splice(0);for(let e=0;e<n.length;e++)n[e](r);E(e,r,t.sync)}else Y(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,i.nextTick(Z,e,t))}t.sync=!0,t.pendingcb++;try{e._final(r)}catch(o){r(o)}t.sync=!1}(e,t)))}function Q(e,t,n){Y(t)&&(F(e,t),0===t.pendingcb&&(n?(t.pendingcb++,i.nextTick(((e,t)=>{Y(t)?Z(e,t):t.pendingcb--}),e,t)):Y(t)&&(t.pendingcb++,Z(e,t))))}function Z(e,t){t.pendingcb--,t.finished=!0;const n=t[j].splice(0);for(let i=0;i<n.length;i++)n[i]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}C.prototype.getBuffer=function(){return r(this.buffered,this.bufferedIndex)},a(C.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),a(D,h,{__proto__:null,value:function(e){return!!s(this,e)||this===D&&(e&&e._writableState instanceof C)}}),D.prototype.pipe=function(){E(this,new L)},D.prototype.write=function(e,t,n){return!0===P(this,e,t,n)},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||W(this,e))},D.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=d(e)),!f.isEncoding(e))throw new T(e);return this._writableState.defaultEncoding=e,this},D.prototype._write=function(e,t,n){if(!this._writev)throw new v("_write()");this._writev([{chunk:e,encoding:t}],n)},D.prototype._writev=null,D.prototype.end=function(e,t,n){const r=this._writableState;let s;if("function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e){const n=P(this,e,t);n instanceof o&&(s=n)}return r.corked&&(r.corked=1,this.uncork()),s||(r.errored||r.ending?r.finished?s=new S("end"):r.destroyed&&(s=new _("end")):(r.ending=!0,Q(this,r,!0),r.ended=!0)),"function"==typeof n&&(s||r.finished?i.nextTick(n,s):r[j].push(n)),this},l(D.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const H=m.destroy;let V;function G(){return void 0===V&&(V={}),V}D.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[j].length)&&i.nextTick($,n),H.call(this,e,t),this},D.prototype._undestroy=m.undestroy,D.prototype._destroy=function(e,t){t(e)},D.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},D.fromWeb=function(e,t){return G().newStreamWritableFromWritableStream(e,t)},D.toWeb=function(e){return G().newWritableStreamFromStreamWritable(e)}},2224:(e,t,n)=>{"use strict";const{ArrayIsArray:i,ArrayPrototypeIncludes:r,ArrayPrototypeJoin:o,ArrayPrototypeMap:s,NumberIsInteger:a,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:d,NumberParseInt:u,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:p,String:g,StringPrototypeToUpperCase:f,StringPrototypeTrim:m}=n(74641),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:x,ERR_INVALID_ARG_VALUE:w,ERR_OUT_OF_RANGE:v,ERR_UNKNOWN_SIGNAL:k}}=n(68526),{normalizeEncoding:L}=n(56017),{isAsyncFunction:_,isArrayBufferView:S}=n(56017).types,M={};const I=/^[0-7]+$/;const T=y(((e,t,n=d,i=c)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);if(e<n||e>i)throw new v(t,`>= ${n} && <= ${i}`,e)})),E=y(((e,t,n=-2147483648,i=2147483647)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);if(e<n||e>i)throw new v(t,`>= ${n} && <= ${i}`,e)})),N=y(((e,t,n=!1)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);const i=n?1:0,r=4294967295;if(e<i||e>r)throw new v(t,`>= ${i} && <= ${r}`,e)}));function j(e,t){if("string"!=typeof e)throw new x(t,"string",e)}const C=y(((e,t,n)=>{if(!r(n,e)){const i=o(s(n,(e=>"string"==typeof e?`'${e}'`:g(e))),", ");throw new w(t,e,"must be one of: "+i)}}));function A(e,t){if("boolean"!=typeof e)throw new x(t,"boolean",e)}function D(e,t,n){return null!=e&&h(e,t)?e[t]:n}const P=y(((e,t,n=null)=>{const r=D(n,"allowArray",!1),o=D(n,"allowFunction",!1);if(!D(n,"nullable",!1)&&null===e||!r&&i(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new x(t,"Object",e)})),O=y(((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new x(t,"a dictionary",e)})),z=y(((e,t,n=0)=>{if(!i(e))throw new x(t,"Array",e);if(e.length<n){throw new w(t,e,`must be longer than ${n}`)}}));const R=y(((e,t="buffer")=>{if(!S(e))throw new x(t,["Buffer","TypedArray","DataView"],e)}));const B=y(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new x(t,"AbortSignal",e)})),U=y(((e,t)=>{if("function"!=typeof e)throw new x(t,"Function",e)})),$=y(((e,t)=>{if("function"!=typeof e||_(e))throw new x(t,"Function",e)})),W=y(((e,t)=>{if(void 0!==e)throw new x(t,"undefined",e)}));const Y=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function F(e,t){if(void 0===e||!p(Y,e))throw new w(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,n){if(void 0===e&&(e=n),"string"==typeof e){if(null===p(I,e))throw new w(t,e,"must be a 32-bit unsigned integer or an octal string");e=u(e,8)}return N(e,t),e},validateArray:z,validateStringArray:function(e,t){z(e,t);for(let n=0;n<e.length;n++)j(e[n],`${t}[${n}]`)},validateBooleanArray:function(e,t){z(e,t);for(let n=0;n<e.length;n++)A(e[n],`${t}[${n}]`)},validateAbortSignalArray:function(e,t){z(e,t);for(let n=0;n<e.length;n++){const i=e[n],r=`${t}[${n}]`;if(null==i)throw new x(r,"AbortSignal",i);B(i,r)}},validateBoolean:A,validateBuffer:R,validateDictionary:O,validateEncoding:function(e,t){const n=L(t),i=e.length;if("hex"===n&&i%2!=0)throw new w("encoding",t,`is invalid for data of length ${i}`)},validateFunction:U,validateInt32:E,validateInteger:T,validateNumber:function(e,t,n=void 0,i){if("number"!=typeof e)throw new x(t,"number",e);if(null!=n&&e<n||null!=i&&e>i||(null!=n||null!=i)&&l(e))throw new v(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=i?" && ":""}${null!=i?`<= ${i}`:""}`,e)},validateObject:P,validateOneOf:C,validatePlainFunction:$,validatePort:function(e,t="Port",n=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===m(e).length||+e!=+e>>>0||e>65535||0===e&&!n)throw new b(t,e,n);return 0|e},validateSignalName:function(e,t="signal"){if(j(e,t),void 0===M[e]){if(void 0!==M[f(e)])throw new k(e+" (signals must use all capital letters)");throw new k(e)}},validateString:j,validateUint32:N,validateUndefined:W,validateUnion:function(e,t,n){if(!r(n,e))throw new x(t,`('${o(n,"|")}')`,e)},validateAbortSignal:B,validateLinkHeaderValue:function(e){if("string"==typeof e)return F(e,"hints"),e;if(i(e)){const t=e.length;let n="";if(0===t)return n;for(let i=0;i<t;i++){const r=e[i];F(r,"hints"),n+=r,i!==t-1&&(n+=", ")}return n}throw new w("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},85721:(e,t,n)=>{"use strict";const i=n(42825),r=n(25018),o=i.Readable.destroy;e.exports=i.Readable,e.exports._uint8ArrayToBuffer=i._uint8ArrayToBuffer,e.exports._isUint8Array=i._isUint8Array,e.exports.isDisturbed=i.isDisturbed,e.exports.isErrored=i.isErrored,e.exports.isReadable=i.isReadable,e.exports.Readable=i.Readable,e.exports.Writable=i.Writable,e.exports.Duplex=i.Duplex,e.exports.Transform=i.Transform,e.exports.PassThrough=i.PassThrough,e.exports.addAbortSignal=i.addAbortSignal,e.exports.finished=i.finished,e.exports.destroy=i.destroy,e.exports.destroy=o,e.exports.pipeline=i.pipeline,e.exports.compose=i.compose,Object.defineProperty(i,"promises",{configurable:!0,enumerable:!0,get:()=>r}),e.exports.Stream=i.Stream,e.exports.default=e.exports},68526:(e,t,n)=>{"use strict";const{format:i,inspect:r,AggregateError:o}=n(56017),s=globalThis.AggregateError||o,a=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,d={};function u(e,t){if(!e)throw new d.ERR_INTERNAL_ASSERTION(t)}function h(e){let t="",n=e.length;const i="-"===e[0]?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function p(e,t,n){n||(n=Error);class r extends n{constructor(...n){super(function(e,t,n){if("function"==typeof t)return u(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return u(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),0===n.length?t:i(t,...n)}(e,t,n))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[a]=!0,d[e]=r}function g(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class f extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new d.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}p("ERR_ASSERTION","%s",Error),p("ERR_INVALID_ARG_TYPE",((e,t,n)=>{u("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let i="The ";e.endsWith(" argument")?i+=`${e} `:i+=`"${e}" ${e.includes(".")?"property":"argument"} `,i+="must be ";const o=[],s=[],a=[];for(const r of t)u("string"==typeof r,"All expected entries have to be of type string"),l.includes(r)?o.push(r.toLowerCase()):c.test(r)?s.push(r):(u("object"!==r,'The value "object" should be written as "Object"'),a.push(r));if(s.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:i+=`of type ${o[0]}`;break;case 2:i+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();i+=`one of type ${o.join(", ")}, or ${e}`}}(s.length>0||a.length>0)&&(i+=" or ")}if(s.length>0){switch(s.length){case 1:i+=`an instance of ${s[0]}`;break;case 2:i+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();i+=`an instance of ${s.join(", ")}, or ${e}`}}a.length>0&&(i+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(i+="an "),i+=`${a[0]}`;break;case 2:i+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();i+=`one of ${a.join(", ")}, or ${e}`}}if(null==n)i+=`. Received ${n}`;else if("function"==typeof n&&n.name)i+=`. Received function ${n.name}`;else if("object"==typeof n){var d;if(null!==(d=n.constructor)&&void 0!==d&&d.name)i+=`. Received an instance of ${n.constructor.name}`;else{i+=`. Received ${r(n,{depth:-1})}`}}else{let e=r(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),i+=`. Received type ${typeof n} (${e})`}return i}),TypeError),p("ERR_INVALID_ARG_VALUE",((e,t,n="is invalid")=>{let i=r(t);i.length>128&&(i=i.slice(0,128)+"...");return`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${i}`}),TypeError),p("ERR_INVALID_RETURN_VALUE",((e,t,n)=>{var i;return`Expected ${e} to be returned from the "${t}" function but got ${null!=n&&null!==(i=n.constructor)&&void 0!==i&&i.name?`instance of ${n.constructor.name}`:"type "+typeof n}.`}),TypeError),p("ERR_MISSING_ARGS",((...e)=>{let t;u(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}}return`${t} must be specified`}),TypeError),p("ERR_OUT_OF_RANGE",((e,t,n)=>{let i;return u(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32?i=h(String(n)):"bigint"==typeof n?(i=String(n),(n>2n**32n||n<-(2n**32n))&&(i=h(i)),i+="n"):i=r(n),`The value of "${e}" is out of range. It must be ${t}. Received ${i}`}),RangeError),p("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),p("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),p("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),p("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),p("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),p("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),p("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),p("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),p("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),p("ERR_STREAM_WRITE_AFTER_END","write after end",Error),p("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:f,aggregateTwoErrors:g((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new s([t,e],t.message);return n.code=t.code,n}return e||t})),hideStackFrames:g,codes:d}},74641:e=>{"use strict";e.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,n)=>e.slice(t,n),Error:Error,FunctionPrototypeCall:(e,t,...n)=>e.call(t,...n),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,n)=>Object.defineProperty(e,t,n),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,n)=>e.then(t,n),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,n)=>e.slice(t,n),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,n)=>e.set(t,n),Boolean:Boolean,Uint8Array:Uint8Array}},56017:(e,t,n)=>{"use strict";const i=n(48287),{kResistStopPropagation:r,SymbolDispose:o}=n(74641),s=globalThis.AbortSignal||n(25568).AbortSignal,a=globalThis.AbortController||n(25568).AbortController,l=Object.getPrototypeOf((async function(){})).constructor,c=globalThis.Blob||i.Blob,d=void 0!==c?function(e){return e instanceof c}:function(e){return!1},u=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new ERR_INVALID_ARG_TYPE(t,"AbortSignal",e)};class h extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:h,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((n,i)=>{e=n,t=i})),resolve:e,reject:t}},promisify:e=>new Promise(((t,n)=>{e(((e,...i)=>e?n(e):t(...i)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,n]){const i=t.shift();if("f"===n)return i.toFixed(6);if("j"===n)return JSON.stringify(i);if("s"===n&&"object"==typeof i){return`${i.constructor!==Object?i.constructor.name:""} {}`.trim()}return i.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof l,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:d,deprecate:(e,t)=>e,addAbortListener:n(37007).addAbortListener||function(e,t){if(void 0===e)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);let n;return u(e,"signal"),((e,t)=>{if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"Function",e)})(t,"listener"),e.aborted?queueMicrotask((()=>t())):(e.addEventListener("abort",t,{__proto__:null,once:!0,[r]:!0}),n=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[o](){var e;null===(e=n)||void 0===e||e()}}},AbortSignalAny:s.any||function(e){if(1===e.length)return e[0];const t=new a,n=()=>t.abort();return e.forEach((e=>{u(e,"signals"),e.addEventListener("abort",n,{once:!0})})),t.signal.addEventListener("abort",(()=>{e.forEach((e=>e.removeEventListener("abort",n)))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},42825:(e,t,n)=>{const{Buffer:i}=n(48287),{ObjectDefineProperty:r,ObjectKeys:o,ReflectApply:s}=n(74641),{promisify:{custom:a}}=n(56017),{streamReturningOperators:l,promiseReturningOperators:c}=n(1284),{codes:{ERR_ILLEGAL_CONSTRUCTOR:d}}=n(68526),u=n(8489),{setDefaultHighWaterMark:h,getDefaultHighWaterMark:p}=n(13920),{pipeline:g}=n(28431),{destroyer:f}=n(57647),m=n(89365),y=n(25018),b=n(136),x=e.exports=n(80334).Stream;x.isDestroyed=b.isDestroyed,x.isDisturbed=b.isDisturbed,x.isErrored=b.isErrored,x.isReadable=b.isReadable,x.isWritable=b.isWritable,x.Readable=n(23125);for(const k of o(l)){const L=l[k];function w(...e){if(new.target)throw d();return x.Readable.from(s(L,this,e))}r(w,"name",{__proto__:null,value:L.name}),r(w,"length",{__proto__:null,value:L.length}),r(x.Readable.prototype,k,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(const _ of o(c)){const S=c[_];function w(...e){if(new.target)throw d();return s(S,this,e)}r(w,"name",{__proto__:null,value:S.name}),r(w,"length",{__proto__:null,value:S.length}),r(x.Readable.prototype,_,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}x.Writable=n(77221),x.Duplex=n(43559),x.Transform=n(68649),x.PassThrough=n(62091),x.pipeline=g;const{addAbortSignal:v}=n(30810);x.addAbortSignal=v,x.finished=m,x.destroy=f,x.compose=u,x.setDefaultHighWaterMark=h,x.getDefaultHighWaterMark=p,r(x,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>y}),r(g,a,{__proto__:null,enumerable:!0,get:()=>y.pipeline}),r(m,a,{__proto__:null,enumerable:!0,get:()=>y.finished}),x.Stream=x,x._isUint8Array=function(e){return e instanceof Uint8Array},x._uint8ArrayToBuffer=function(e){return i.from(e.buffer,e.byteOffset,e.byteLength)}},25018:(e,t,n)=>{"use strict";const{ArrayPrototypePop:i,Promise:r}=n(74641),{isIterable:o,isNodeStream:s,isWebStream:a}=n(136),{pipelineImpl:l}=n(28431),{finished:c}=n(89365);n(42825),e.exports={finished:c,pipeline:function(...e){return new r(((t,n)=>{let r,c;const d=e[e.length-1];if(d&&"object"==typeof d&&!s(d)&&!o(d)&&!a(d)){const t=i(e);r=t.signal,c=t.end}l(e,((e,i)=>{e?n(e):t(i)}),{signal:r,end:c})}))}}},65852:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});const i="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r="http://www.w3.org/2001/XMLSchema#",o="http://www.w3.org/2000/10/swap/",s={xsd:{decimal:`${r}decimal`,boolean:`${r}boolean`,double:`${r}double`,integer:`${r}integer`,string:`${r}string`},rdf:{type:`${i}type`,nil:`${i}nil`,first:`${i}first`,rest:`${i}rest`,langString:`${i}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${o}reify#forSome`,forAll:`${o}reify#forAll`},log:{implies:`${o}log#implies`}}},28612:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>d,FL:()=>b,PB:()=>g,Yo:()=>h,iN:()=>y,kO:()=>x,n7:()=>x,rT:()=>f,uS:()=>p,x1:()=>u,yV:()=>m});var i=n(65852),r=n(69980);const{rdf:o,xsd:s}=i.A;let a,l=0;const c={namedNode:function(e){return new h(e)},blankNode:function(e){return new g(e||"n3-"+l++)},variable:function(e){return new f(e)},literal:function(e,t){if("string"==typeof t)return new p(`"${e}"@${t.toLowerCase()}`);let n=t?t.value:"";""===n&&("boolean"==typeof e?n=s.boolean:"number"==typeof e&&(Number.isFinite(e)?n=Number.isInteger(e)?s.integer:s.double:(n=s.double,Number.isNaN(e)||(e=e>0?"INF":"-INF"))));return""===n||n===s.string?new p(`"${e}"`):new p(`"${e}"^^${n}`)},defaultGraph:function(){return a},quad:w,triple:w},d=c;class u{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof u?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class h extends u{get termType(){return"NamedNode"}}class p extends u{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new h(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?s.string:o.langString}equals(e){return e instanceof p?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class g extends u{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class f extends u{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class m extends u{constructor(){return super(""),a||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}function y(e,t,n){if(t=t||c,!e)return t.defaultGraph();switch(e[0]){case"?":return t.variable(e.substr(1));case"_":return t.blankNode(e.substr(2));case'"':if(t===c)return new p(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));const i=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,i-1),"@"===e[i+1]?e.substr(i+2):t.namedNode(e.substr(i+3)));case"[":e=JSON.parse(e);break;default:if(!n||!Array.isArray(e))return t.namedNode(e)}return t.quad(y(e[0],t,!0),y(e[1],t,!0),y(e[2],t,!0),e[3]&&y(e[3],t,!0))}function b(e,t){if("string"==typeof e)return e;if(e instanceof u&&"Quad"!==e.termType)return e.id;if(!e)return a.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==s.string?`^^${e.datatype.value}`:""}`;case"Quad":const n=[b(e.subject,!0),b(e.predicate,!0),b(e.object,!0)];return(0,r.isDefaultGraph)(e.graph)||n.push(b(e.graph,!0)),t?n:JSON.stringify(n);default:throw new Error(`Unexpected termType: ${e.termType}`)}}a=new m;class x extends u{constructor(e,t,n,i){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=i||a}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function w(e,t,n,i){return new x(e,t,n,i)}},3524:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(65852),r=n(79596),o=n.n(r);const{xsd:s}=i.A,a=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,l={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,d={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},u=/$0^/;class h{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in d)&&this[e]instanceof RegExp&&(this[e]=u)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input,i=n.length;for(;;){let e,a;for(;e=this._newline.exec(n);)this._comments&&(a=this._comment.exec(e[0]))&&r("comment",a[1],"",this._line,e[0].length),n=n.substr(e[0].length,n.length),i=n.length,this._line++;if(!e&&(e=this._whitespace.exec(n))&&(n=n.substr(e[0].length,n.length)),this._endOfFile.test(n))return t&&(this._comments&&(a=this._comment.exec(n))&&r("comment",a[1],"",this._line,n.length),n=null,r("eof","","",this._line,0)),this._input=n;const l=this._line,d=n[0];let u="",h="",p="",g=null,f=0,m=!1;switch(d){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(f=1,u="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){m=!0;break}case"<":if(g=this._unescapedIri.exec(n))u="IRI",h=g[1];else if(g=this._iri.exec(n)){if(h=this._unescape(g[1]),null===h||c.test(h))return o(this);u="IRI"}else n.length>1&&"<"===n[1]?(u="<<",f=2):this._n3Mode&&n.length>1&&"="===n[1]&&(u="inverse",f=2,h=">");break;case">":n.length>1&&">"===n[1]&&(u=">>",f=2);break;case"_":((g=this._blank.exec(n))||t&&(g=this._blank.exec(`${n} `)))&&(u="blank",p="_",h=g[1]);break;case'"':if(g=this._simpleQuotedString.exec(n))h=g[1];else if(({value:h,matchLength:f}=this._parseLiteral(n)),null===h)return o(this);null===g&&0===f||(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(g=this._simpleApostropheString.exec(n))h=g[1];else if(({value:h,matchLength:f}=this._parseLiteral(n)),null===h)return o(this);null===g&&0===f||(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(g=this._variable.exec(n))&&(u="var",h=g[0]);break;case"@":"literal"===this._previousMarker&&(g=this._langcode.exec(n))?(u="langcode",h=g[1]):(g=this._keyword.exec(n))&&(u=g[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){u=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(g=this._number.exec(n)||t&&(g=this._number.exec(`${n} `)))&&(u="literal",h=g[0],p="string"==typeof g[1]?s.double:"string"==typeof g[2]?s.decimal:s.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(g=this._sparqlKeyword.exec(n))?u=g[0].toUpperCase():m=!0;break;case"f":case"t":(g=this._boolean.exec(n))?(u="literal",h=g[0],p=s.boolean):m=!0;break;case"a":(g=this._shortPredicates.exec(n))?(u="abbreviation",h="a"):m=!0;break;case"=":this._n3Mode&&n.length>1&&(u="abbreviation",">"!==n[1]?(f=1,h="="):(f=2,h=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(f=1,u=d);break;case"{":!this._lineMode&&n.length>=2&&("|"===n[1]?(u="{|",f=2):(u=d,f=1));break;case"|":n.length>=2&&"}"===n[1]&&(u="|}",f=2);break;default:m=!0}if(m&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(g=this._prefix.exec(n))?((g=this._prefixed.exec(n))||t&&(g=this._prefixed.exec(`${n} `)))&&(u="prefixed",p=g[1]||"",h=this._unescape(g[2])):(u="prefix",h=g[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?o(this):this._input=n;const y=f||g[0].length,b=r(u,h,p,l,y);this.previousToken=b,this._previousMarker=u,n=n.substr(y,n.length)}function r(t,r,o,s,a){const l=n?i-n.length:i,c={type:t,value:r,prefix:o,line:s,start:l,end:l+a};return e(null,c),c}function o(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(a,((e,n,i,r)=>{if("string"==typeof n)return String.fromCharCode(Number.parseInt(n,16));if("string"==typeof i){let e=Number.parseInt(i,16);return e<=65535?String.fromCharCode(Number.parseInt(i,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return r in l?l[r]:(t=!0,"")}));return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let i=Math.max(this._literalClosingPos,n);for(;(i=e.indexOf(t,i))>0;){let t=0;for(;"\\"===e[i-t-1];)t++;if(t%2==0){const t=e.substring(n,i),r=t.split(/\r\n|\r|\n/).length-1,o=i+n;if(1===n&&0!==r||3===n&&this._lineMode)break;return this._line+=r,{value:this._unescape(t),matchLength:o}}i++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const e=[];let t;if(this._tokenizeToEnd(((n,i)=>n?t=n:e.push(i)),!0),t)throw t;return e}o()((()=>this._tokenizeToEnd(t,!0)))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=Buffer.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(t,!1)))})),e.on("end",(()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)})),e.on("error",t)}}},33291:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(3524),r=n(28612),o=n(65852);let s=0;class a{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&c(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),r=/trig/.test(t),o=/triple/.test(t),s=/quad/.test(t),a=this._n3Mode=/n3/.test(t),l=o||s;(this._supportsNamedGraphs=!(n||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||r||o||a),this._supportsRDFStar=""===t||/star|\*$/.test(t),l&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new i.A({lineMode:l,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){s=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,i,r){const o=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:i,object:r,graph:t,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);n=this._namedNode(t);break;case"type":case"prefixed":const i=this._prefixes[e.prefix];if(void 0===i)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._namedNode(i+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,i=this._readListItem;const r=this._subject,o=this._contextStack,s=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blankNode()),null===r?null===s.predicate?s.subject=n:s.object=n:this._emit(r,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._literal(this._literalValue,n),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const i=this._subject,r=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,r&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF* syntax",e);const o=this._predicate,s=this._object;this._subject=this._quad(i,o,s,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if("Quad"!==this._subject.termType)return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==i){const e=this._predicate,t=this._object;r?this._emit(t,e,i,n):this._emit(i,e,t,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const t=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const i=this._blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=i):(t=this._object,this._object=i),this._emit(t,n,i,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let n,i;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=t):(i=this._object,this._object=t),this._emit(t,n,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,i){this._callback(null,this._quad(e,t,n,i||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=l}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",i=-1,r=-1,o=0,s="/";for(;i<t;){switch(s){case":":if(r<0&&"/"===e[++i]&&"/"===e[++i])for(;(r=i+1)<t&&"/"!==e[r];)i=r;break;case"?":case"#":i=t;break;case"/":if("."===e[i+1])switch(s=e[1+ ++i],s){case"/":n+=e.substring(o,i-1),o=i+1;break;case void 0:case"?":case"#":return n+e.substring(o,i)+e.substr(i+1);case".":if(s=e[1+ ++i],void 0===s||"/"===s||"?"===s||"#"===s){if(n+=e.substring(o,i-2),(o=n.lastIndexOf("/"))>=r&&(n=n.substr(0,o)),"/"!==s)return`${n}/${e.substr(i+1)}`;o=i+1}}}s=e[++i]}return n+e.substring(o)}parse(e,t,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${s++}_`,this._prefixCallback=n||l,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let n;if(this._callback=(e,i)=>{e?n=e:i&&t.push(i)},this._lexer.tokenize(e).every((e=>this._readCallback=this._readCallback(e))),n)throw n;return t}this._callback=t,this._lexer.tokenize(e,((e,t)=>{null!==e?(this._callback(e),this._callback=l):this._readCallback&&(this._readCallback=this._readCallback(t))}))}}function l(){}function c(e,t){const n=t.namedNode;e._namedNode=n,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=n(o.A.rdf.first),e.RDF_REST=n(o.A.rdf.rest),e.RDF_NIL=n(o.A.rdf.nil),e.N3_FORALL=n(o.A.r.forAll),e.N3_FORSOME=n(o.A.r.forSome),e.ABBREVIATIONS={a:n(o.A.rdf.type),"=":n(o.A.owl.sameAs),">":n(o.A.log.implies)},e.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}c(a.prototype,r.Ay)},69980:(e,t,n)=>{"use strict";n.r(t),n.d(t,{inDefaultGraph:()=>c,isBlankNode:()=>o,isDefaultGraph:()=>l,isLiteral:()=>s,isNamedNode:()=>r,isVariable:()=>a,prefix:()=>d,prefixes:()=>u});var i=n(28612);function r(e){return!!e&&"NamedNode"===e.termType}function o(e){return!!e&&"BlankNode"===e.termType}function s(e){return!!e&&"Literal"===e.termType}function a(e){return!!e&&"Variable"===e.termType}function l(e){return!!e&&"DefaultGraph"===e.termType}function c(e){return l(e.graph)}function d(e,t){return u({"":e.value||e},t)("")}function u(e,t){const n=Object.create(null);for(const i in e)r(i,e[i]);function r(e,i){if("string"==typeof i){const r=Object.create(null);n[e]=e=>r[e]||(r[e]=t.namedNode(i+e))}else if(!(e in n))throw new Error(`Unknown prefix: ${e}`);return n[e]}return t=t||i.Ay,r}},48640:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BlankNode:()=>s.PB,DataFactory:()=>s.Ay,DefaultGraph:()=>s.yV,Lexer:()=>i.A,Literal:()=>s.uS,NamedNode:()=>s.Yo,Parser:()=>r.A,Quad:()=>s.kO,Store:()=>x,StreamParser:()=>v,StreamWriter:()=>k,Term:()=>s.x1,Triple:()=>s.n7,Util:()=>a,Variable:()=>s.rT,Writer:()=>f,default:()=>L,termFromId:()=>s.iN,termToId:()=>s.FL});var i=n(3524),r=n(33291),o=n(65852),s=n(28612),a=n(69980);const l=s.Ay.defaultGraph(),{rdf:c,xsd:d}=o.A,u=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,h=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,p={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class g extends s.x1{equals(e){return e===this}}class f{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,n,i){e+=t,i&&i()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=l,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),t.baseIRI&&(this._baseMatcher=new RegExp(`^${y(t.baseIRI)}${t.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=t.baseIRI.length))}get _inDefaultGraph(){return l.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,n,i,r){try{i.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(l.equals(i)?"":`${this._encodeIriOrBlank(i)} {\n`)),this._graph=i,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,r):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,r):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,r)}catch(o){r&&r(o)}}_writeQuadLine(e,t,n,i,r){delete this._prefixMatch,this._write(this.quadToString(e,t,n,i),r)}quadToString(e,t,n,i){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(n)}${i&&i.value?` ${this._encodeIriOrBlank(i)} .\n`:" .\n"}`}quadsToString(e){return e.map((e=>this.quadToString(e.subject,e.predicate,e.object,e.graph))).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseMatcher&&this._baseMatcher.test(t)&&(t=t.substr(this._baseLength)),u.test(t)&&(t=t.replace(h,m));const n=this._prefixRegex.exec(t);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(u.test(t)&&(t=t.replace(h,m)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===d.string)return`"${t}"`}else switch(e.datatype.value){case d.string:return`"${t}"`;case d.boolean:if("true"===t||"false"===t)return t;break;case d.integer:if(/^[+-]?\d+$/.test(t))return t;break;case d.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case d.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===c.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:n,graph:i}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(n)}${(0,a.isDefaultGraph)(i)?"":` ${this._encodeIriOrBlank(i)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,n,i,r){void 0===n?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof i?this._writeQuad(e,t,n,l,i):this._writeQuad(e,t,n,i||l,r)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,n){const i={};i[e]=t,this.addPrefixes(i,n)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let n=!1;for(let i in e){let t=e[i];"string"!=typeof t&&(t=t.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[t]=i+=":",this._write(`@prefix ${i} <${t}>.\n`)}if(n){let e="",t="";for(const n in this._prefixIRIs)e+=e?`|${n}`:n,t+=(t?"|":"")+this._prefixIRIs[n];e=y(e),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([_a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",t)}blank(e,t){let n,i,r=e;switch(void 0===e?r=[]:e.termType?r=[{predicate:e,object:t}]:"length"in e||(r=[e]),i=r.length){case 0:return new g("[]");case 1:if(n=r[0],!(n.object instanceof g))return new g(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let t="[";for(let o=0;o<i;o++)n=r[o],n.predicate.equals(e)?t+=`, ${this._encodeObject(n.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,e=n.predicate);return new g(`${t}\n]`)}}list(e){const t=e&&e.length||0,n=new Array(t);for(let i=0;i<t;i++)n[i]=this._encodeObject(e[i]);return new g(`(${n.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((n,i)=>{t=null,e(n,i)});if(this._endStream)try{return this._outputStream.end(t)}catch(n){}t&&t()}}function m(e){let t=p[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function y(e){return e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var b=n(85721);class x{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._factory=t.factory||s.Ay,e&&this.addQuads(e)}_termFromId(e,t){if("."===e[0]){const t=this._entities,n=e.split(".");return this._factory.quad(this._termFromId(t[n[1]]),this._termFromId(t[n[2]]),this._termFromId(t[n[3]]),n[4]&&this._termFromId(t[n[4]]))}return(0,s.iN)(e,t)}_termToNumericId(e){if("Quad"===e.termType){const t=this._termToNumericId(e.subject),n=this._termToNumericId(e.predicate),i=this._termToNumericId(e.object);let r;return t&&n&&i&&((0,a.isDefaultGraph)(e.graph)||(r=this._termToNumericId(e.graph)))&&this._ids[r?`.${t}.${n}.${i}.${r}`:`.${t}.${n}.${i}`]}return this._ids[(0,s.FL)(e)]}_termToNewNumericId(e){const t=e&&"Quad"===e.termType?`.${this._termToNewNumericId(e.subject)}.${this._termToNewNumericId(e.predicate)}.${this._termToNewNumericId(e.object)}${(0,a.isDefaultGraph)(e.graph)?"":`.${this._termToNewNumericId(e.graph)}`}`:(0,s.FL)(e);return this._ids[t]||(this._ids[this._entities[++this._id]=t]=this._id)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let n,i;for(const r in t)for(const o in n=t[r].subjects)for(const t in i=n[o])e+=Object.keys(i[t]).length;return this._size=e}_addToIndex(e,t,n,i){const r=e[t]||(e[t]={}),o=r[n]||(r[n]={}),s=i in o;return s||(o[i]=null),!s}_removeFromIndex(e,t,n,i){const r=e[t],o=r[n];delete o[i];for(const s in o)return;delete r[n];for(const s in r)return;delete e[t]}*_findInIndex(e,t,n,i,r,o,s,a){let l,c,d;const u=this._entities,h=this._termFromId(a,this._factory),p={subject:null,predicate:null,object:null};t&&((l=e,e={})[t]=l[t]);for(const g in e)if(c=e[g]){p[r]=this._termFromId(u[g],this._factory),n&&((l=c,c={})[n]=l[n]);for(const e in c)if(d=c[e]){p[o]=this._termFromId(u[e],this._factory);const t=i?i in d?[i]:[]:Object.keys(d);for(let e=0;e<t.length;e++)p[s]=this._termFromId(u[t[e]],this._factory),yield this._factory.quad(p.subject,p.predicate,p.object,h)}}}_loop(e,t){for(const n in e)t(n)}_loopByKey0(e,t,n){let i,r;if(i=e[t])for(r in i)n(r)}_loopByKey1(e,t,n){let i,r;for(i in e)r=e[i],r[t]&&n(i)}_loopBy2Keys(e,t,n,i){let r,o,s;if((r=e[t])&&(o=r[n]))for(s in o)i(s)}_countInIndex(e,t,n,i){let r,o,s,a=0;t&&((r=e,e={})[t]=r[t]);for(const l in e)if(o=e[l]){n&&((r=o,o={})[n]=r[n]);for(const e in o)(s=o[e])&&(i?i in s&&a++:a+=Object.keys(s).length)}return a}_getGraphs(e){if(!("string"==typeof(t=e)||t instanceof String))return this._graphs;var t;const n={};return n[e]=this._graphs[e],n}_uniqueEntities(e){const t=Object.create(null);return n=>{n in t||(t[n]=!0,e(this._termFromId(this._entities[n],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,n,i){t||(i=e.graph,n=e.object,t=e.predicate,e=e.subject),i=(0,s.FL)(i);let r=this._graphs[i];r||(r=this._graphs[i]={subjects:{},predicates:{},objects:{}},Object.freeze(r)),e=this._termToNewNumericId(e),t=this._termToNewNumericId(t),n=this._termToNewNumericId(n);const o=this._addToIndex(r.subjects,e,t,n);return this._addToIndex(r.predicates,t,n,e),this._addToIndex(r.objects,n,e,t),this._size=null,o}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e,t,n,i){return e&&e.subject&&({subject:e,predicate:t,object:n,graph:i}=e),!this.readQuads(e,t,n,i).next().done}import(e){return e.on("data",(e=>{this.addQuad(e)})),e}removeQuad(e,t,n,i){t||(i=e.graph,n=e.object,t=e.predicate,e=e.subject),i=(0,s.FL)(i);const r=this._graphs;let o,a,l;if(!((e=e&&this._termToNumericId(e))&&(t=t&&this._termToNumericId(t))&&(n=n&&this._termToNumericId(n))&&(o=r[i])&&(a=o.subjects[e])&&(l=a[t])&&n in l))return!1;for(e in this._removeFromIndex(o.subjects,e,t,n),this._removeFromIndex(o.predicates,t,n,e),this._removeFromIndex(o.objects,n,e,t),null!==this._size&&this._size--,o.subjects)return!0;return delete r[i],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",(e=>{this.removeQuad(e)})),e}removeMatches(e,t,n,i){const r=new b.Readable({objectMode:!0});return r._read=()=>{for(const o of this.readQuads(e,t,n,i))r.push(o);r.push(null)},this.remove(r)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,n,i){return[...this.readQuads(e,t,n,i)]}*readQuads(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l,c;if(!(e&&!(a=this._termToNumericId(e))||t&&!(l=this._termToNumericId(t))||n&&!(c=this._termToNumericId(n))))for(const s in r)(o=r[s])&&(a?c?yield*this._findInIndex(o.objects,c,a,l,"object","subject","predicate",s):yield*this._findInIndex(o.subjects,a,l,null,"subject","predicate","object",s):l?yield*this._findInIndex(o.predicates,l,c,null,"predicate","object","subject",s):c?yield*this._findInIndex(o.objects,c,null,null,"object","subject","predicate",s):yield*this._findInIndex(o.subjects,null,null,null,"subject","predicate","object",s))}match(e,t,n,i){return new w(this,e,t,n,i)}countQuads(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l,c,d=0;if(e&&!(a=this._termToNumericId(e))||t&&!(l=this._termToNumericId(t))||n&&!(c=this._termToNumericId(n)))return 0;for(const s in r)(o=r[s])&&(d+=e?n?this._countInIndex(o.objects,c,a,l):this._countInIndex(o.subjects,a,l,c):t?this._countInIndex(o.predicates,l,c,a):this._countInIndex(o.objects,c,a,l));return d}forEach(e,t,n,i,r){this.some((t=>(e(t),!1)),t,n,i,r)}every(e,t,n,i,r){let o=!1;const s=!this.some((t=>(o=!0,!e(t))),t,n,i,r);return o&&s}some(e,t,n,i,r){for(const o of this.readQuads(t,n,i,r))if(e(o))return!0;return!1}getSubjects(e,t,n){const i=[];return this.forSubjects((e=>{i.push(e)}),e,t,n),i}forSubjects(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.predicates,a,l,e):this._loopByKey1(o.subjects,a,e):l?this._loopByKey0(o.objects,l,e):this._loop(o.subjects,e))}getPredicates(e,t,n){const i=[];return this.forPredicates((e=>{i.push(e)}),e,t,n),i}forPredicates(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.objects,l,a,e):this._loopByKey0(o.subjects,a,e):l?this._loopByKey1(o.predicates,l,e):this._loop(o.predicates,e))}getObjects(e,t,n){const i=[];return this.forObjects((e=>{i.push(e)}),e,t,n),i}forObjects(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.subjects,a,l,e):this._loopByKey1(o.objects,a,e):l?this._loopByKey0(o.predicates,l,e):this._loop(o.objects,e))}getGraphs(e,t,n){const i=[];return this.forGraphs((e=>{i.push(e)}),e,t,n),i}forGraphs(e,t,n,i){for(const r in this._graphs)this.some((t=>(e(t.graph),!0)),t,n,i,r)}createBlankNode(e){let t,n;if(e)for(t=e=`_:${e}`,n=1;this._ids[t];)t=e+n++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const n={},i=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},r=this.getQuads(null,o.A.rdf.rest,o.A.rdf.nil,null),s=e?[...r]:[];return r.forEach((t=>{const r=[];let a,l,c=!1;const d=t.graph;let u=t.subject;for(;u&&!c;){const e=this.getQuads(null,null,u,null),t=this.getQuads(u,null,null,null);let n,h=null,p=null,g=null;for(let r=0;r<t.length&&!c;r++)n=t[r],n.graph.equals(d)?a?c=i(u,"has non-list arcs out"):n.predicate.value===o.A.rdf.first?h?c=i(u,"has multiple rdf:first arcs"):s.push(h=n):n.predicate.value===o.A.rdf.rest?p?c=i(u,"has multiple rdf:rest arcs"):s.push(p=n):e.length?c=i(u,"can't be subject and object"):(a=n,l="subject"):c=i(u,"not confined to single graph");for(let r=0;r<e.length&&!c;++r)n=e[r],a?c=i(u,"can't have coreferences"):n.predicate.value===o.A.rdf.rest?g?c=i(u,"has incoming rdf:rest arcs"):g=n:(a=n,l="object");h?r.unshift(h.object):c=i(u,"has no list head"),u=g&&g.subject}c?e=!1:a&&(n[a[l].value]=r)})),e&&this.removeQuads(s),n}*[Symbol.iterator](){yield*this.readQuads()}}class w extends b.Readable{constructor(e,t,n,i,r){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:n,object:i,graph:r})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:n,predicate:i,subject:r}=this,o=this._filtered=new x({factory:e._factory});for(const s of e.readQuads(r,i,n,t))o.addQuad(s)}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this)this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,n,i){return new w(this.filtered,e,t,n,i)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class v extends b.Transform{constructor(e){super({decodeStrings:!0}),this._readableState.objectMode=!0;let t,n;new r.A(e).parse({on:(e,i)=>{switch(e){case"data":t=i;break;case"end":n=i}}},((e,t)=>{e&&this.emit("error",e)||t&&this.push(t)}),((e,t)=>{this.emit("prefix",e,t)})),this._transform=(e,n,i)=>{t(e),i()},this._flush=e=>{n(),e()}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),this}}class k extends b.Transform{constructor(e){super({encoding:"utf8",writableObjectMode:!0});const t=this._writer=new f({write:(e,t,n)=>{this.push(e),n&&n()},end:e=>{this.push(null),e&&e()}},e);this._transform=(e,n,i)=>{t.addQuad(e,i)},this._flush=e=>{t.end(e)}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),e.on("prefix",((e,t)=>{this._writer.addPrefix(e,t)})),this}}const L={Lexer:i.A,Parser:r.A,Writer:f,Store:x,StreamParser:v,StreamWriter:k,Util:a,DataFactory:s.Ay,Term:s.x1,NamedNode:s.Yo,Literal:s.uS,BlankNode:s.PB,Variable:s.rT,DefaultGraph:s.yV,Quad:s.kO,Triple:s.n7,termFromId:s.iN,termToId:s.FL}},65606:e=>{var t,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,l=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?l=a.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=s(u);c=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},79596:(e,t,n)=>{let i;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(i||(i=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},92861:(e,t,n)=>{var i=n(48287),r=i.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=s),s.prototype=Object.create(r.prototype),o(r,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},83141:(e,t,n)=>{"use strict";var i=n(92861).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=d,this.end=u,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function d(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=s(t[i]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if(r=s(t[i]),r>=0)return r>0&&(e.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if(r=s(t[i]),r>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}}}]);