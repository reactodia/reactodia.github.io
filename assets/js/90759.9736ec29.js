/*! For license information please see 90759.9736ec29.js.LICENSE.txt */
(self.webpackChunk_reactodia_reactodia_github_io=self.webpackChunk_reactodia_reactodia_github_io||[]).push([[90759],{19738:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbortScope:()=>Ee,AuthoringState:()=>je,BuiltinDialogType:()=>Ne,Canvas:()=>Ce,CanvasContext:()=>Ae,ClassTree:()=>De,ClassicTemplate:()=>Pe,ClassicToolbar:()=>Oe,ClassicWorkspace:()=>Re,Command:()=>ze,CompositeDataProvider:()=>$e,ConnectionsMenu:()=>Ue,DBPediaSettings:()=>Be,DIAGRAM_CONTEXT_URL_V1:()=>We,DataDiagramModel:()=>Ye,Debouncer:()=>Fe,DecoratedDataProvider:()=>Qe,DefaultLinkPathTemplate:()=>Ve,DefaultLinkTemplate:()=>Ge,DefaultWorkspace:()=>Ze,DraggableHandle:()=>He,DropOnCanvas:()=>qe,DropdownMenu:()=>Xe,DropdownMenuItem:()=>Je,EditorController:()=>Ke,Element:()=>et,ElementType:()=>tt,EmptyDataProvider:()=>nt,EntityElement:()=>it,EntityGroup:()=>rt,EventObserver:()=>ot,EventSource:()=>st,GroupPaginator:()=>at,Halo:()=>lt,HaloLink:()=>ct,HashMap:()=>dt,HashSet:()=>ut,HtmlSpinner:()=>ht,InMemoryHistory:()=>pt,IndexQuadBy:()=>gt,IndexedDbCachedProvider:()=>ft,InstancesSearch:()=>mt,KeyedObserver:()=>yt,LINK_STYLE_SHOW_IRI:()=>bt,Link:()=>xt,LinkAction:()=>wt,LinkActionDelete:()=>vt,LinkActionEdit:()=>kt,LinkActionMoveEndpoint:()=>St,LinkActionRename:()=>Lt,LinkActionSpinner:()=>_t,LinkLabel:()=>Mt,LinkPath:()=>It,LinkType:()=>Tt,LinkTypesToolbox:()=>Et,LinkVertex:()=>jt,LinkVertices:()=>Nt,ListElementView:()=>Ct,Navigator:()=>At,OntologyLinkTemplates:()=>Dt,OverlayController:()=>Pt,OwlRdfsSettings:()=>Ot,OwlStatsSettings:()=>Rt,PLACEHOLDER_ELEMENT_TYPE:()=>zt,PLACEHOLDER_LINK_TYPE:()=>$t,ProgressBar:()=>Ut,PropertyType:()=>Bt,Rdf:()=>Wt,RdfDataProvider:()=>Yt,RdfSettings:()=>Ft,Rect:()=>Qt,RelationGroup:()=>Vt,RelationLink:()=>Gt,RenameLinkToLinkStateProvider:()=>Zt,RenderingLayer:()=>Ht,RestoreGeometry:()=>qt,SearchResults:()=>Xt,SearchSectionElementTypes:()=>Jt,SearchSectionEntities:()=>Kt,SearchSectionLinkTypes:()=>en,Selection:()=>tn,SelectionAction:()=>nn,SelectionActionAddToFilter:()=>rn,SelectionActionAnchor:()=>on,SelectionActionConnections:()=>sn,SelectionActionEstablishLink:()=>an,SelectionActionExpand:()=>ln,SelectionActionGroup:()=>cn,SelectionActionLayout:()=>dn,SelectionActionRemove:()=>un,SelectionActionSpinner:()=>hn,SelectionActionZoomToFit:()=>pn,SemanticTypeStyles:()=>gn,SparqlDataProvider:()=>fn,Spinner:()=>mn,StandardTemplate:()=>yn,TemplateProperties:()=>bn,TemporaryState:()=>xn,Toolbar:()=>wn,ToolbarAction:()=>vn,ToolbarActionClearAll:()=>kn,ToolbarActionExport:()=>Sn,ToolbarActionLayout:()=>Ln,ToolbarActionOpen:()=>_n,ToolbarActionRedo:()=>Mn,ToolbarActionSave:()=>In,ToolbarActionUndo:()=>Tn,ToolbarLanguageSelector:()=>En,TransformedSvgCanvas:()=>jn,UnifiedSearch:()=>Nn,ValidationState:()=>Cn,Vector:()=>An,ViewportDock:()=>Dn,VisualAuthoring:()=>Pn,VoidElement:()=>On,WikidataSettings:()=>Rn,WithFetchStatus:()=>zn,Workspace:()=>$n,WorkspaceContext:()=>Un,WorkspaceEventKey:()=>Bn,WorkspaceLayoutColumn:()=>Wn,WorkspaceLayoutItem:()=>Yn,WorkspaceLayoutResizeContext:()=>Fn,WorkspaceLayoutRow:()=>Qn,WorkspaceRoot:()=>Vn,ZoomControl:()=>Gn,animateInterval:()=>Zn,applyLayout:()=>Hn,blockingDefaultLayout:()=>qn,boundsOf:()=>Xn,calculateAveragePosition:()=>Jn,calculateLayout:()=>Kn,changeEntityData:()=>ei,changeLinkTypeVisibility:()=>ti,changeRelationData:()=>ni,colaFlowLayout:()=>ii,colaForceLayout:()=>ri,colaRemoveOverlaps:()=>oi,computePolyline:()=>si,computePolylineLength:()=>ai,defineCanvasWidget:()=>li,defineLayoutWorker:()=>ci,defineWorker:()=>di,delay:()=>ui,delayProviderDecorator:()=>hi,equalElements:()=>pi,equalLinks:()=>gi,equalProperties:()=>fi,equalSubtypeEdges:()=>mi,findElementAtPoint:()=>yi,findNearestSegmentIndex:()=>bi,getContentFittingBox:()=>xi,getContentFittingBoxForLayout:()=>wi,getPointAlongPolyline:()=>vi,hashLink:()=>ki,hashSubtypeEdge:()=>Si,highlightSubstring:()=>Li,indexedDataset:()=>_i,isEncodedBlank:()=>Mi,isPolylineEqual:()=>Ii,iterateEntitiesOf:()=>Ti,iterateRelationsOf:()=>Ei,layoutPadded:()=>ji,layoutPaddedBiasFree:()=>Ni,mapAbortedToNull:()=>Ci,moveComparator:()=>Ai,paneTopLeft:()=>Di,pathFromPolyline:()=>Pi,placeElementsAroundTarget:()=>Oi,raceAbortSignal:()=>Ri,requestElementData:()=>zi,restoreCapturedLinkGeometry:()=>$i,restoreLinksBetweenElements:()=>Ui,restoreViewport:()=>Bi,setElementExpanded:()=>Wi,setElementState:()=>Yi,setEntityElementData:()=>Fi,setEntityGroupItems:()=>Qi,setLinkState:()=>Vi,setRelationGroupItems:()=>Gi,setRelationLinkData:()=>Zi,shallowArrayEqual:()=>Hi,startDragElements:()=>qi,subscribeElementTypes:()=>Xi,subscribeLinkTypes:()=>Ji,subscribePropertyTypes:()=>Ki,totalPaneSize:()=>er,translateToPositiveQuadrant:()=>tr,uniformGrid:()=>nr,useAuthoredEntity:()=>ir,useCanvas:()=>rr,useEventStore:()=>or,useFrameDebouncedStore:()=>sr,useKeyedSyncStore:()=>ar,useLinkActionContext:()=>lr,useLoadedWorkspace:()=>cr,useObservedProperty:()=>dr,useSearchInputStore:()=>ur,useSyncStore:()=>hr,useSyncStoreWithComparator:()=>pr,useUnifiedSearchSection:()=>gr,useWorker:()=>fr,useWorkspace:()=>mr});var i={};function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function o(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function s(){}n.r(i),n.d(i,{color:()=>k,cubehelix:()=>me,gray:()=>q,hcl:()=>oe,hsl:()=>P,lab:()=>X,lch:()=>re,rgb:()=>M});var a=.7,l=1/a,c="\\s*([+-]?\\d+)\\s*",d="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,p=new RegExp(`^rgb\\(${c},${c},${c}\\)$`),g=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),f=new RegExp(`^rgba\\(${c},${c},${c},${d}\\)$`),m=new RegExp(`^rgba\\(${u},${u},${u},${d}\\)$`),y=new RegExp(`^hsl\\(${d},${u},${u}\\)$`),b=new RegExp(`^hsla\\(${d},${u},${u},${d}\\)$`),x={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function w(){return this.rgb().formatHex()}function v(){return this.rgb().formatRgb()}function k(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=h.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?S(t):3===n?new I(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?L(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?L(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=p.exec(e))?new I(t[1],t[2],t[3],1):(t=g.exec(e))?new I(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=f.exec(e))?L(t[1],t[2],t[3],t[4]):(t=m.exec(e))?L(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=y.exec(e))?A(t[1],t[2]/100,t[3]/100,1):(t=b.exec(e))?A(t[1],t[2]/100,t[3]/100,t[4]):x.hasOwnProperty(e)?S(x[e]):"transparent"===e?new I(NaN,NaN,NaN,0):null}function S(e){return new I(e>>16&255,e>>8&255,255&e,1)}function L(e,t,n,i){return i<=0&&(e=t=n=NaN),new I(e,t,n,i)}function _(e){return e instanceof s||(e=k(e)),e?new I((e=e.rgb()).r,e.g,e.b,e.opacity):new I}function M(e,t,n,i){return 1===arguments.length?_(e):new I(e,t,n,null==i?1:i)}function I(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function T(){return`#${C(this.r)}${C(this.g)}${C(this.b)}`}function E(){const e=j(this.opacity);return`${1===e?"rgb(":"rgba("}${N(this.r)}, ${N(this.g)}, ${N(this.b)}${1===e?")":`, ${e})`}`}function j(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function N(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function C(e){return((e=N(e))<16?"0":"")+e.toString(16)}function A(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new O(e,t,n,i)}function D(e){if(e instanceof O)return new O(e.h,e.s,e.l,e.opacity);if(e instanceof s||(e=k(e)),!e)return new O;if(e instanceof O)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,l=o-r,c=(o+r)/2;return l?(a=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=c<.5?o+r:2-o-r,a*=60):l=c>0&&c<1?0:a,new O(a,l,c,e.opacity)}function P(e,t,n,i){return 1===arguments.length?D(e):new O(e,t,n,null==i?1:i)}function O(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function R(e){return(e=(e||0)%360)<0?e+360:e}function z(e){return Math.max(0,Math.min(1,e||0))}function $(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r(s,k,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:w,formatHex:w,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return D(this).formatHsl()},formatRgb:v,toString:v}),r(I,M,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new I(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new I(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new I(N(this.r),N(this.g),N(this.b),j(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatHex8:function(){return`#${C(this.r)}${C(this.g)}${C(this.b)}${C(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:E,toString:E})),r(O,P,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new O(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new O(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new I($(e>=240?e-240:e+120,r,i),$(e,r,i),$(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new O(R(this.h),z(this.s),z(this.l),j(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=j(this.opacity);return`${1===e?"hsl(":"hsla("}${R(this.h)}, ${100*z(this.s)}%, ${100*z(this.l)}%${1===e?")":`, ${e})`}`}}));const U=Math.PI/180,B=180/Math.PI,W=.96422,Y=1,F=.82521,Q=4/29,V=6/29,G=3*V*V,Z=V*V*V;function H(e){if(e instanceof J)return new J(e.l,e.a,e.b,e.opacity);if(e instanceof se)return ae(e);e instanceof I||(e=_(e));var t,n,i=ne(e.r),r=ne(e.g),o=ne(e.b),s=K((.2225045*i+.7168786*r+.0606169*o)/Y);return i===r&&r===o?t=n=s:(t=K((.4360747*i+.3850649*r+.1430804*o)/W),n=K((.0139322*i+.0971045*r+.7141733*o)/F)),new J(116*s-16,500*(t-s),200*(s-n),e.opacity)}function q(e,t){return new J(e,0,0,null==t?1:t)}function X(e,t,n,i){return 1===arguments.length?H(e):new J(e,t,n,null==i?1:i)}function J(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function K(e){return e>Z?Math.pow(e,1/3):e/G+Q}function ee(e){return e>V?e*e*e:G*(e-Q)}function te(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ne(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ie(e){if(e instanceof se)return new se(e.h,e.c,e.l,e.opacity);if(e instanceof J||(e=H(e)),0===e.a&&0===e.b)return new se(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*B;return new se(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function re(e,t,n,i){return 1===arguments.length?ie(e):new se(n,t,e,null==i?1:i)}function oe(e,t,n,i){return 1===arguments.length?ie(e):new se(e,t,n,null==i?1:i)}function se(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function ae(e){if(isNaN(e.h))return new J(e.l,0,0,e.opacity);var t=e.h*U;return new J(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}r(J,X,o(s,{brighter(e){return new J(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new J(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new I(te(3.1338561*(t=W*ee(t))-1.6168667*(e=Y*ee(e))-.4906146*(n=F*ee(n))),te(-.9787684*t+1.9161415*e+.033454*n),te(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),r(se,oe,o(s,{brighter(e){return new se(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new se(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return ae(this).rgb()}}));var le=-.14861,ce=1.78277,de=-.29227,ue=-.90649,he=1.97294,pe=he*ue,ge=he*ce,fe=ce*de-ue*le;function me(e,t,n,i){return 1===arguments.length?function(e){if(e instanceof ye)return new ye(e.h,e.s,e.l,e.opacity);e instanceof I||(e=_(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(fe*i+pe*t-ge*n)/(fe+pe-ge),o=i-r,s=(he*(n-r)-de*o)/ue,a=Math.sqrt(s*s+o*o)/(he*r*(1-r)),l=a?Math.atan2(s,o)*B-120:NaN;return new ye(l<0?l+360:l,a,r,e.opacity)}(e):new ye(e,t,n,null==i?1:i)}function ye(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}r(ye,me,o(s,{brighter(e){return e=null==e?l:Math.pow(l,e),new ye(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new ye(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*U,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new I(255*(t+n*(le*i+ce*r)),255*(t+n*(de*i+ue*r)),255*(t+n*(he*i)),this.opacity)}}));var be=n(4213),xe=n(48640),we=n(96540),ve=n.t(we,2),ke=n(40961),Se=n.t(ke,2),Le=n(78109),_e=[(e,t,n)=>{n.r(t),n.d(t,{AbortScope:()=>i.AbortScope,AuthoringState:()=>O.AuthoringState,BuiltinDialogType:()=>R.BuiltinDialogType,Canvas:()=>re.Canvas,CanvasContext:()=>k.CanvasContext,ClassTree:()=>ie.ClassTree,ClassicTemplate:()=>Q.ClassicTemplate,ClassicToolbar:()=>we.ClassicToolbar,ClassicWorkspace:()=>we.ClassicWorkspace,Command:()=>I.Command,CompositeDataProvider:()=>p.CompositeDataProvider,ConnectionsMenu:()=>oe.ConnectionsMenu,DBPediaSettings:()=>v.DBPediaSettings,DIAGRAM_CONTEXT_URL_V1:()=>h.DIAGRAM_CONTEXT_URL_V1,DataDiagramModel:()=>z.DataDiagramModel,Debouncer:()=>d.Debouncer,DecoratedDataProvider:()=>g.DecoratedDataProvider,DefaultLinkPathTemplate:()=>V.DefaultLinkPathTemplate,DefaultLinkTemplate:()=>V.DefaultLinkTemplate,DefaultWorkspace:()=>ve.DefaultWorkspace,DraggableHandle:()=>ke.DraggableHandle,DropOnCanvas:()=>se.DropOnCanvas,DropdownMenu:()=>X.DropdownMenu,DropdownMenuItem:()=>X.DropdownMenuItem,EditorController:()=>U.EditorController,Element:()=>_.Element,ElementType:()=>$.ElementType,EmptyDataProvider:()=>f.EmptyDataProvider,EntityElement:()=>$.EntityElement,EntityGroup:()=>$.EntityGroup,EventObserver:()=>o.EventObserver,EventSource:()=>o.EventSource,GroupPaginator:()=>G.GroupPaginator,Halo:()=>ae.Halo,HaloLink:()=>le.HaloLink,HashMap:()=>s.HashMap,HashSet:()=>s.HashSet,HtmlSpinner:()=>P.HtmlSpinner,InMemoryHistory:()=>I.InMemoryHistory,IndexQuadBy:()=>y.IndexQuadBy,IndexedDbCachedProvider:()=>m.IndexedDbCachedProvider,InstancesSearch:()=>ce.InstancesSearch,KeyedObserver:()=>l.KeyedObserver,LINK_STYLE_SHOW_IRI:()=>q.LINK_STYLE_SHOW_IRI,Link:()=>_.Link,LinkAction:()=>de.LinkAction,LinkActionDelete:()=>de.LinkActionDelete,LinkActionEdit:()=>de.LinkActionEdit,LinkActionMoveEndpoint:()=>de.LinkActionMoveEndpoint,LinkActionRename:()=>de.LinkActionRename,LinkActionSpinner:()=>de.LinkActionSpinner,LinkLabel:()=>N.LinkLabel,LinkPath:()=>N.LinkPath,LinkType:()=>$.LinkType,LinkTypesToolbox:()=>ue.LinkTypesToolbox,LinkVertex:()=>_.LinkVertex,LinkVertices:()=>N.LinkVertices,ListElementView:()=>J.ListElementView,Navigator:()=>he.Navigator,OntologyLinkTemplates:()=>q.OntologyLinkTemplates,OverlayController:()=>W.OverlayController,OwlRdfsSettings:()=>v.OwlRdfsSettings,OwlStatsSettings:()=>v.OwlStatsSettings,PLACEHOLDER_ELEMENT_TYPE:()=>h.PLACEHOLDER_ELEMENT_TYPE,PLACEHOLDER_LINK_TYPE:()=>h.PLACEHOLDER_LINK_TYPE,ProgressBar:()=>K.ProgressBar,PropertyType:()=>$.PropertyType,Rdf:()=>x,RdfDataProvider:()=>b.RdfDataProvider,RdfSettings:()=>v.RdfSettings,Rect:()=>M.Rect,RelationGroup:()=>$.RelationGroup,RelationLink:()=>$.RelationLink,RenameLinkToLinkStateProvider:()=>D.RenameLinkToLinkStateProvider,RenderingLayer:()=>A.RenderingLayer,RestoreGeometry:()=>L.RestoreGeometry,SearchResults:()=>te.SearchResults,SearchSectionElementTypes:()=>ye.SearchSectionElementTypes,SearchSectionEntities:()=>ye.SearchSectionEntities,SearchSectionLinkTypes:()=>ye.SearchSectionLinkTypes,Selection:()=>pe.Selection,SelectionAction:()=>ge.SelectionAction,SelectionActionAddToFilter:()=>ge.SelectionActionAddToFilter,SelectionActionAnchor:()=>ge.SelectionActionAnchor,SelectionActionConnections:()=>ge.SelectionActionConnections,SelectionActionEstablishLink:()=>ge.SelectionActionEstablishLink,SelectionActionExpand:()=>ge.SelectionActionExpand,SelectionActionGroup:()=>ge.SelectionActionGroup,SelectionActionLayout:()=>ge.SelectionActionLayout,SelectionActionRemove:()=>ge.SelectionActionRemove,SelectionActionSpinner:()=>ge.SelectionActionSpinner,SelectionActionZoomToFit:()=>ge.SelectionActionZoomToFit,SemanticTypeStyles:()=>H.SemanticTypeStyles,SparqlDataProvider:()=>w.SparqlDataProvider,Spinner:()=>P.Spinner,StandardTemplate:()=>Z.StandardTemplate,TemplateProperties:()=>h.TemplateProperties,TemporaryState:()=>O.TemporaryState,Toolbar:()=>fe.Toolbar,ToolbarAction:()=>me.ToolbarAction,ToolbarActionClearAll:()=>me.ToolbarActionClearAll,ToolbarActionExport:()=>me.ToolbarActionExport,ToolbarActionLayout:()=>me.ToolbarActionLayout,ToolbarActionOpen:()=>me.ToolbarActionOpen,ToolbarActionRedo:()=>me.ToolbarActionRedo,ToolbarActionSave:()=>me.ToolbarActionSave,ToolbarActionUndo:()=>me.ToolbarActionUndo,ToolbarLanguageSelector:()=>me.ToolbarLanguageSelector,TransformedSvgCanvas:()=>C.TransformedSvgCanvas,UnifiedSearch:()=>ye.UnifiedSearch,ValidationState:()=>Y.ValidationState,Vector:()=>M.Vector,ViewportDock:()=>ne.ViewportDock,VisualAuthoring:()=>be.VisualAuthoring,VoidElement:()=>_.VoidElement,WikidataSettings:()=>v.WikidataSettings,WithFetchStatus:()=>F.WithFetchStatus,Workspace:()=>Se.Workspace,WorkspaceContext:()=>Le.WorkspaceContext,WorkspaceEventKey:()=>Le.WorkspaceEventKey,WorkspaceLayoutColumn:()=>_e.WorkspaceLayoutColumn,WorkspaceLayoutItem:()=>_e.WorkspaceLayoutItem,WorkspaceLayoutResizeContext:()=>_e.WorkspaceLayoutResizeContext,WorkspaceLayoutRow:()=>_e.WorkspaceLayoutRow,WorkspaceRoot:()=>Me.WorkspaceRoot,ZoomControl:()=>xe.ZoomControl,animateInterval:()=>d.animateInterval,applyLayout:()=>T.applyLayout,blockingDefaultLayout:()=>j.blockingDefaultLayout,boundsOf:()=>M.boundsOf,calculateAveragePosition:()=>M.calculateAveragePosition,calculateLayout:()=>T.calculateLayout,changeEntityData:()=>$.changeEntityData,changeLinkTypeVisibility:()=>L.changeLinkTypeVisibility,changeRelationData:()=>$.changeRelationData,colaFlowLayout:()=>j.colaFlowLayout,colaForceLayout:()=>j.colaForceLayout,colaRemoveOverlaps:()=>j.colaRemoveOverlaps,computePolyline:()=>M.computePolyline,computePolylineLength:()=>M.computePolylineLength,defineCanvasWidget:()=>S.defineCanvasWidget,defineLayoutWorker:()=>E.defineLayoutWorker,defineWorker:()=>c.defineWorker,delay:()=>i.delay,delayProviderDecorator:()=>g.delayProviderDecorator,equalElements:()=>u.equalElements,equalLinks:()=>u.equalLinks,equalProperties:()=>u.equalProperties,equalSubtypeEdges:()=>u.equalSubtypeEdges,findElementAtPoint:()=>M.findElementAtPoint,findNearestSegmentIndex:()=>M.findNearestSegmentIndex,getContentFittingBox:()=>M.getContentFittingBox,getContentFittingBoxForLayout:()=>j.getContentFittingBoxForLayout,getPointAlongPolyline:()=>M.getPointAlongPolyline,hashLink:()=>u.hashLink,hashSubtypeEdge:()=>u.hashSubtypeEdge,highlightSubstring:()=>J.highlightSubstring,indexedDataset:()=>y.indexedDataset,isEncodedBlank:()=>u.isEncodedBlank,isPolylineEqual:()=>M.isPolylineEqual,iterateEntitiesOf:()=>$.iterateEntitiesOf,iterateRelationsOf:()=>$.iterateRelationsOf,layoutPadded:()=>j.layoutPadded,layoutPaddedBiasFree:()=>j.layoutPaddedBiasFree,mapAbortedToNull:()=>i.mapAbortedToNull,moveComparator:()=>r.moveComparator,paneTopLeft:()=>C.paneTopLeft,pathFromPolyline:()=>M.pathFromPolyline,placeElementsAroundTarget:()=>L.placeElementsAroundTarget,raceAbortSignal:()=>i.raceAbortSignal,requestElementData:()=>z.requestElementData,restoreCapturedLinkGeometry:()=>L.restoreCapturedLinkGeometry,restoreLinksBetweenElements:()=>z.restoreLinksBetweenElements,restoreViewport:()=>L.restoreViewport,setElementExpanded:()=>L.setElementExpanded,setElementState:()=>L.setElementState,setEntityElementData:()=>$.setEntityElementData,setEntityGroupItems:()=>$.setEntityGroupItems,setLinkState:()=>L.setLinkState,setRelationGroupItems:()=>$.setRelationGroupItems,setRelationLinkData:()=>$.setRelationLinkData,shallowArrayEqual:()=>r.shallowArrayEqual,startDragElements:()=>J.startDragElements,subscribeElementTypes:()=>B.subscribeElementTypes,subscribeLinkTypes:()=>B.subscribeLinkTypes,subscribePropertyTypes:()=>B.subscribePropertyTypes,totalPaneSize:()=>C.totalPaneSize,translateToPositiveQuadrant:()=>T.translateToPositiveQuadrant,uniformGrid:()=>T.uniformGrid,useAuthoredEntity:()=>be.useAuthoredEntity,useCanvas:()=>k.useCanvas,useEventStore:()=>a.useEventStore,useFrameDebouncedStore:()=>a.useFrameDebouncedStore,useKeyedSyncStore:()=>l.useKeyedSyncStore,useLinkActionContext:()=>de.useLinkActionContext,useLoadedWorkspace:()=>Se.useLoadedWorkspace,useObservedProperty:()=>a.useObservedProperty,useSearchInputStore:()=>ee.useSearchInputStore,useSyncStore:()=>a.useSyncStore,useSyncStoreWithComparator:()=>a.useSyncStoreWithComparator,useUnifiedSearchSection:()=>ye.useUnifiedSearchSection,useWorker:()=>c.useWorker,useWorkspace:()=>Le.useWorkspace});var i=n(56),r=n(57),o=n(58),s=n(59),a=n(60),l=n(65),c=n(66),d=n(67),u=n(68),h=(n(73),n(74)),p=n(75),g=n(77),f=n(78),m=n(79),y=n(83),b=n(84),x=n(70),w=n(85),v=n(89),k=n(90),S=n(91),L=n(92),_=(n(95),n(96)),M=n(93),I=n(94),T=n(97),E=n(98),j=n(99),N=n(101),C=n(109),A=n(107),D=n(112),P=n(113),O=n(114),R=n(115),z=n(116),$=n(119),U=n(123),B=n(125),W=n(126),Y=n(124),F=n(129),Q=n(131),V=n(132),G=n(133),Z=n(134),H=n(136),q=n(146),X=n(147),J=n(148),K=n(150),ee=n(151),te=n(152),ne=n(153),ie=n(154),re=n(159),oe=n(162),se=n(163),ae=n(164),le=n(167),ce=n(169),de=n(168),ue=n(171),he=n(172),pe=n(173),ge=n(165),fe=n(174),me=n(175),ye=n(177),be=n(181),xe=n(192),we=n(193),ve=n(198),ke=n(128),Se=n(199),Le=n(130),_e=n(194),Me=n(197);n(1)},(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(4),l=n.n(a),c=n(5),d=n.n(c),u=n(6),h=n.n(u),p=n(7),g=n.n(p),f=n(8),m={};m.styleTagTransform=g(),m.setAttributes=d(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=h();r()(f.default,m);const y=f.default&&f.default.locals?f.default.locals:void 0},e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=i.base?l[0]+i.base:l[0],d=o[c]||0,u="".concat(c," ").concat(d);o[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=r(p,i);i.byIndex=a,t.splice(a,0,{identifier:u,updater:g,references:1})}s.push(u)}return s}function r(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=i(e,r),c=0;c<o.length;c++){var d=n(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=l}}},e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(i){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},(e,t,n)=>{n.r(t),n.d(t,{default:()=>Fe});var i=n(9),r=n.n(i),o=n(10),s=n.n(o),a=n(11),l=n.n(a),c=new URL(n(12),n.b),d=new URL(n(13),n.b),u=new URL(n(14),n.b),h=new URL(n(15),n.b),p=new URL(n(16),n.b),g=new URL(n(17),n.b),f=new URL(n(18),n.b),m=new URL(n(19),n.b),y=new URL(n(20),n.b),b=new URL(n(21),n.b),x=new URL(n(22),n.b),w=new URL(n(23),n.b),v=new URL(n(24),n.b),k=new URL(n(25),n.b),S=new URL(n(26),n.b),L=new URL(n(27),n.b),_=new URL(n(28),n.b),M=new URL(n(29),n.b),I=new URL(n(30),n.b),T=new URL(n(31),n.b),E=new URL(n(32),n.b),j=new URL(n(33),n.b),N=new URL(n(34),n.b),C=new URL(n(35),n.b),A=new URL(n(36),n.b),D=new URL(n(37),n.b),P=new URL(n(38),n.b),O=new URL(n(39),n.b),R=new URL(n(40),n.b),z=new URL(n(41),n.b),$=new URL(n(42),n.b),U=new URL(n(43),n.b),B=new URL(n(44),n.b),W=new URL(n(45),n.b),Y=new URL(n(46),n.b),F=new URL(n(47),n.b),Q=new URL(n(48),n.b),V=new URL(n(49),n.b),G=new URL(n(50),n.b),Z=new URL(n(51),n.b),H=new URL(n(52),n.b),q=new URL(n(53),n.b),X=new URL(n(54),n.b),J=new URL(n(55),n.b),K=s()(r()),ee=l()(c),te=l()(d),ne=l()(u),ie=l()(h),re=l()(p),oe=l()(g),se=l()(f),ae=l()(m),le=l()(y),ce=l()(b),de=l()(x),ue=l()(w),he=l()(v),pe=l()(k),ge=l()(S),fe=l()(L),me=l()(_),ye=l()(M),be=l()(I),xe=l()(T),we=l()(E),ve=l()(j),ke=l()(N),Se=l()(C),Le=l()(A),_e=l()(D),Me=l()(P),Ie=l()(O),Te=l()(R),Ee=l()(z),je=l()($),Ne=l()(U),Ce=l()(B),Ae=l()(W),De=l()(Y),Pe=l()(F),Oe=l()(Q),Re=l()(V),ze=l()(G),$e=l()(Z),Ue=l()(H),Be=l()(q),We=l()(X),Ye=l()(J);K.push([e.id,`@charset "UTF-8";\n.reactodia-badge {\n  display: inline-block;\n  min-width: 10px;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 1;\n  color: rgb(255, 255, 255);\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  background-color: rgb(119, 119, 119);\n  padding: 3px 7px;\n  border-radius: 10px;\n}\n\n.reactodia-btn {\n  display: inline-block;\n  padding: 6px 12px;\n  margin-bottom: 0;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.42857143;\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  touch-action: manipulation;\n  cursor: pointer;\n  background-image: none;\n  border: 1px solid transparent;\n  text-transform: none;\n  transition: background-color 0.3s;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-btn[disabled] {\n  cursor: not-allowed;\n  opacity: 0.65;\n}\n\n.reactodia-btn-default {\n  background-color: #fff;\n  border-color: #ccc;\n  color: #333;\n}\n.reactodia-btn-default:hover {\n  background-color: #e0e0e0;\n}\n.reactodia-btn-default.active {\n  background-color: #e0e0e0;\n  border-color: #dbdbdb;\n}\n.reactodia-btn-default.active:hover {\n  background-color: #d4d4d4;\n  border-color: #8c8c8c;\n}\n.reactodia-btn-default[disabled], .reactodia-btn-default[disabled]:hover, .reactodia-btn-default[disabled].active, .reactodia-btn-default[disabled].active:hover {\n  background-color: #e0e0e0;\n}\n\n.reactodia-btn-primary {\n  color: rgb(255, 255, 255);\n  background-color: rgb(51, 122, 183);\n  border-color: #245580;\n}\n.reactodia-btn-primary:hover, .reactodia-btn-primary:focus, .reactodia-btn-primary:active {\n  background-color: #265a88;\n}\n.reactodia-btn-primary:hover, .reactodia-btn-primary:focus {\n  border-color: #204d74;\n}\n.reactodia-btn-primary.active {\n  border-color: #245580;\n}\n.reactodia-btn-primary[disabled], .reactodia-btn-primary[disabled]:hover, .reactodia-btn-primary[disabled]:focus, .reactodia-btn-primary[disabled]:active, .reactodia-btn-primary[disabled].active {\n  background-color: #265a88;\n}\n\n.reactodia-btn-success {\n  background-color: #5cb85c;\n  border-color: #5cb85c;\n  color: #fff;\n  transition: 0.3s;\n}\n.reactodia-btn-success:hover {\n  background: #47a447;\n}\n\n.reactodia-btn-danger {\n  background-color: #c9302c;\n  border-color: #c9302c;\n  color: #fff;\n  transition: 0.3s;\n}\n.reactodia-btn-danger:hover {\n  background: #a82825;\n}\n\n.reactodia-btn-group {\n  position: relative;\n  display: inline-block;\n  vertical-align: middle;\n}\n.reactodia-btn-group > .reactodia-btn, .reactodia-btn-group > .reactodia-btn-group {\n  position: relative;\n  float: left;\n}\n.reactodia-btn-group > .reactodia-btn:hover,\n.reactodia-btn-group > .reactodia-btn:focus,\n.reactodia-btn-group > .reactodia-btn.active,\n.reactodia-btn-group > .reactodia-btn.active:hover {\n  z-index: 2;\n}\n.reactodia-btn-group .reactodia-btn + .reactodia-btn,\n.reactodia-btn-group .reactodia-btn + .reactodia-btn-group,\n.reactodia-btn-group .reactodia-btn-group + .reactodia-btn,\n.reactodia-btn-group .reactodia-btn-group + .reactodia-btn-group {\n  margin-left: -1px;\n}\n.reactodia-btn-group > .reactodia-btn:first-child {\n  margin-left: 0;\n}\n.reactodia-btn-group-sm > .reactodia-btn {\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 5px 10px;\n}\n.reactodia-btn-group-xs > .reactodia-btn {\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 1px 5px;\n}\n\n.reactodia-form-control {\n  display: block;\n  width: 100%;\n  height: 34px;\n  margin: 0;\n  padding: 6px 12px;\n  font: inherit;\n  font-size: 14px;\n  line-height: 1.42857143;\n  color: #555;\n  background: #fff;\n  border: 1px solid #ccc;\n  transition: border-color ease-in-out 0.15s;\n}\n.reactodia-form-control:focus {\n  border-color: #66afe9;\n  outline: 0;\n}\n.reactodia-form-control:disabled {\n  background-color: #eee;\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.reactodia-overlaid-element {\n  cursor: move;\n  outline: none;\n}\n.reactodia-overlaid-element--blurred {\n  filter: grayscale(100%);\n  opacity: 0.5;\n}\n\n.reactodia-overlaid-element img,\n.reactodia-exported-element img {\n  vertical-align: middle;\n}\n\n.reactodia-link--blurred {\n  opacity: 0.5;\n}\n\n.reactodia-link-path__wrap {\n  stroke-width: 12px;\n  stroke-linejoin: round;\n  stroke-linecap: round;\n  stroke: transparent;\n  fill: none;\n}\n.reactodia-link:hover .reactodia-link-path__wrap {\n  stroke: rgba(140, 140, 140, 0.44);\n}\n\n.reactodia-link-vertices__vertex {\n  cursor: all-scroll;\n}\n.reactodia-link:not(:hover) .reactodia-link-vertices__vertex {\n  fill: transparent;\n}\n.reactodia-link-vertices__handle {\n  opacity: 0;\n  cursor: pointer;\n}\n.reactodia-link-vertices__handle > circle {\n  fill: gray;\n}\n.reactodia-link-vertices__handle > path {\n  stroke: white;\n}\n.reactodia-link-vertices__handle:hover > circle {\n  fill: black;\n}\n.reactodia-link:hover .reactodia-link-vertices__handle {\n  opacity: 0.8;\n}\n\n.reactodia-paper-area {\n  flex: auto;\n  width: 0;\n  display: flex;\n  position: relative;\n  cursor: default;\n  background: #fff;\n}\n.reactodia-paper-area__area {\n  flex: auto;\n  overflow: scroll;\n  touch-action: pan-x pan-y;\n}\n.reactodia-paper-area--hide-scrollbars .reactodia-paper-area__area {\n  /* For Firefox */\n  scrollbar-width: none;\n  /* For Safari, Chrome, etc */\n}\n.reactodia-paper-area--hide-scrollbars .reactodia-paper-area__area::-webkit-scrollbar {\n  display: none;\n}\n.reactodia-paper-area--panning {\n  cursor: grabbing;\n}\n.reactodia-paper-area__widgets {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.reactodia-paper-area__watermark {\n  background-size: cover;\n  width: 8%;\n  max-width: 130px;\n  min-width: 50px;\n  position: absolute;\n  top: 15px;\n  right: 25px;\n  cursor: pointer;\n  opacity: 0.3;\n  transition: opacity 0.3s;\n}\n.reactodia-paper-area__watermark:hover {\n  opacity: 0.5;\n}\n.reactodia-paper-area--animated .reactodia-overlaid-element {\n  transition: transform 0.5s ease-in-out;\n}\n.reactodia-paper-area--animated .reactodia-link-layer {\n  transition: none;\n  opacity: 0;\n}\n.reactodia-paper-area--animated .reactodia-paper-area__widgets {\n  transition: none;\n  opacity: 0;\n}\n\n.reactodia-paper {\n  position: relative;\n}\n\n.reactodia-exported-watermark {\n  opacity: 0.3;\n  transition: opacity 0.3s;\n}\n\n.reactodia-exported-canvas {\n  /* Defaults for inheritable properties */\n  box-sizing: border-box;\n  white-space: initial;\n  color: #333;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: 14px;\n  line-height: 1.42857;\n}\n.reactodia-exported-canvas *, .reactodia-exported-canvas *:before, .reactodia-exported-canvas *:after {\n  box-sizing: inherit;\n}\n\n.reactodia-spinner__arrow {\n  animation-name: reactodia-spinner-rotation;\n  animation-duration: 1.5s;\n  animation-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1);\n  animation-iteration-count: infinite;\n}\n.reactodia-spinner[data-error=true] .reactodia-spinner__arrow {\n  animation-iteration-count: 1;\n}\n\n@keyframes reactodia-spinner-rotation {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.reactodia-authoring-state__item-validation {\n  align-self: flex-end;\n  margin: 0px 5px;\n  display: flex;\n  align-items: center;\n  cursor: help;\n}\n.reactodia-authoring-state__item-validation-icon {\n  height: 15px;\n  width: 17px;\n}\n.reactodia-authoring-state--severity-info .reactodia-authoring-state__item-validation-icon {\n  background: cornflowerblue;\n  -webkit-mask: url(${ee});\n  mask: url(${ee});\n}\n.reactodia-authoring-state--severity-warning .reactodia-authoring-state__item-validation-icon {\n  background: orange;\n  -webkit-mask: url(${te});\n  mask: url(${te});\n}\n.reactodia-authoring-state--severity-error .reactodia-authoring-state__item-validation-icon {\n  background: red;\n  -webkit-mask: url(${te});\n  mask: url(${te});\n}\n.reactodia-authoring-state__state-label {\n  font-weight: bold;\n  margin-right: 5px;\n}\n.reactodia-authoring-state__state-cancel {\n  color: #3f87a6;\n  cursor: pointer;\n}\n.reactodia-authoring-state__state-cancel:hover {\n  text-decoration: underline;\n}\n.reactodia-authoring-state__state-indicator {\n  position: absolute;\n}\n.reactodia-authoring-state__state-indicator-container {\n  position: relative;\n}\n.reactodia-authoring-state__state-indicator-body {\n  position: absolute;\n  white-space: nowrap;\n  display: flex;\n  align-items: center;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.7);\n  border-radius: 5px;\n}\n\n.reactodia-form {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-form__body {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  padding: 8px;\n}\n.reactodia-form__controls {\n  border-top: 1px solid #ccc;\n  padding: 8px;\n  text-align: right;\n  flex: 0 0 auto;\n}\n.reactodia-form__controls button + button {\n  margin-left: 5px;\n}\n.reactodia-form__row {\n  display: block;\n  margin-bottom: 8px;\n}\n.reactodia-form__progress {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactodia-form__control-row {\n  position: relative;\n  padding-bottom: 18px;\n}\n.reactodia-form__control-error {\n  color: red;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n}\n\n.reactodia-element-selector {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-element-selector__search {\n  flex-shrink: 0;\n  position: relative;\n}\n.reactodia-element-selector__search-icon {\n  background-image: url(${ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  opacity: 0.6;\n  position: absolute;\n  top: 50%;\n  left: 10px;\n  margin-top: -7px;\n}\n.reactodia-element-selector__search-input {\n  padding-left: 33px;\n}\n.reactodia-element-selector__existing-elements-list {\n  flex: 1 1 0;\n  margin-top: 7px;\n  padding-right: 10px;\n  overflow-y: scroll;\n}\n.reactodia-element-selector__results-spinner {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-element-selector__separator {\n  margin: 7px 0;\n  overflow: hidden;\n  text-align: center;\n}\n.reactodia-element-selector__separator-text {\n  color: #555;\n  display: inline-block;\n  font-size: 13px;\n  position: relative;\n}\n.reactodia-element-selector__separator-text:before, .reactodia-element-selector__separator-text:after {\n  content: "";\n  border-top: 1px solid;\n  position: absolute;\n  top: 50%;\n  margin: 0 10px;\n  width: 500px;\n}\n.reactodia-element-selector__separator-text:before {\n  left: 100%;\n}\n.reactodia-element-selector__separator-text:after {\n  right: 100%;\n}\n\n.reactodia-loading-widget {\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.9);\n  z-index: 30;\n}\n\n.reactodia-fetch-status--loading {\n  animation: reactodia-loading-pulse 2s linear infinite;\n}\n.reactodia-fetch-status--error::before {\n  content: "\u26a0 ";\n  color: rgba(255, 0, 0, 0.5);\n}\n\n@keyframes reactodia-loading-pulse {\n  0% {\n    opacity: 1;\n    stroke-opacity: 1;\n  }\n  50% {\n    opacity: 0.3;\n    stroke-opacity: 0.3;\n  }\n  100% {\n    opacity: 1;\n    stroke-opacity: 1;\n  }\n}\n.reactodia-dropdown {\n  position: relative;\n  float: left;\n  z-index: 40;\n}\n.reactodia-dropdown__content {\n  position: absolute;\n  opacity: 1;\n  background: white;\n  display: flex;\n  flex-direction: column;\n  transition: opacity 0.1s ease-in-out;\n}\n.reactodia-dropdown--expanded .reactodia-dropdown__content {\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n}\n.reactodia-dropdown--collapsed .reactodia-dropdown__content {\n  height: 0;\n  opacity: 0;\n  pointer-events: none;\n  transition: none;\n}\n\n.reactodia-dropdown--expanded .reactodia-dropdown-menu__toggle {\n  border-bottom: none;\n  background-color: #bfbfbf;\n}\n.reactodia-dropdown-menu__toggle::before {\n  background-image: url(${ie});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-dropdown-menu__items {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  display: flex;\n  flex-direction: column;\n}\n\n.reactodia-dropdown-menu-item ~ .reactodia-dropdown-menu-item {\n  margin-top: -1px;\n  border-top-color: #eee;\n}\n.reactodia-dropdown-menu-item--disabled, .reactodia-dropdown-menu-item--disabled:hover {\n  background-color: #e0e0e0;\n  cursor: not-allowed;\n  opacity: 0.65;\n}\n\n.reactodia-inline-entity {\n  border: 1px solid var(--reactodia-inline-entity-color);\n  background: var(--reactodia-inline-entity-color);\n  padding-left: 5px;\n  word-wrap: break-word;\n  line-height: 1.3;\n}\n.reactodia-inline-entity__label {\n  background: white;\n  padding: 0 2px;\n}\n\n.reactodia-list-element-view {\n  position: relative;\n  display: block;\n  background: #808080;\n  padding: 1px 1px 1px 10px;\n  border-radius: 2px;\n  margin: 0 0 2px 0;\n  opacity: 1;\n  cursor: move;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-list-element-view--disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n.reactodia-list-element-view__label {\n  background: white;\n  border-radius: 0 2px 2px 0;\n  font-family: "Andale Mono", sans-serif;\n  font-size: 15px;\n  min-height: 1.3em;\n  padding-left: 7px;\n  padding-right: 5px;\n  overflow-wrap: break-word;\n}\n\n.reactodia-text-highlight {\n  font-weight: bold;\n}\n\n.reactodia-no-search-results {\n  text-align: center;\n  font-style: italic;\n  color: #757575;\n}\n\n@keyframes reactodia-progress-bar-stripes {\n  from {\n    background-position: 40px 0;\n  }\n  to {\n    background-position: 0 0;\n  }\n}\n.reactodia-progress-bar {\n  flex-shrink: 0;\n  width: 100%;\n  background-color: #f5f5f5;\n  background-image: linear-gradient(to bottom, #ebebeb 0%, #f5f5f5 100%);\n  background-repeat: repeat-x;\n  overflow: hidden;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n.reactodia-progress-bar__bar {\n  float: left;\n  height: 100%;\n  font-size: 12px;\n  line-height: 20px;\n  color: #fff;\n  text-align: center;\n  transition: width 0.6s ease;\n  background-color: #337ab7;\n  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n  background-repeat: repeat-x;\n  background-size: 40px 40px;\n  animation: reactodia-progress-bar-stripes 2s linear infinite;\n}\n.reactodia-progress-bar--error .reactodia-progress-bar__bar {\n  background-color: #E72F2F;\n}\n.reactodia-progress-bar--loading, .reactodia-progress-bar--error {\n  /* property name | duration | delay */\n  transition: height 300ms 300ms;\n}\n.reactodia-progress-bar--completed {\n  /* property name | duration | delay */\n  transition: height 200ms 0ms;\n}\n\n.reactodia-search-input {\n  display: flex;\n}\n.reactodia-search-input__clear-container {\n  width: 0;\n  overflow: visible;\n  display: flex;\n  align-items: center;\n}\n.reactodia-search-input__clear {\n  position: relative;\n  left: -33px;\n  padding: 8px;\n  cursor: pointer;\n  background: 0 0;\n  border: 0;\n  transition: background-color 0.3s;\n}\n.reactodia-search-input__clear:hover {\n  background-color: #eeeeee;\n}\n.reactodia-search-input__clear::after {\n  background-image: url(${re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-search-input__submit {\n  margin-left: -1px;\n}\n.reactodia-search-input__submit::before {\n  background-image: url(${ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-search-results {\n  margin: 0;\n  padding: 0;\n  outline: none;\n}\n\n.reactodia-viewport-dock--row-n, .reactodia-viewport-dock--row-s, .reactodia-viewport-dock--column-w, .reactodia-viewport-dock--column-e {\n  /* Make dock row/column clickable through invisible parts */\n  pointer-events: none;\n}\n.reactodia-viewport-dock--row-n > *, .reactodia-viewport-dock--row-s > *, .reactodia-viewport-dock--column-w > *, .reactodia-viewport-dock--column-e > * {\n  pointer-events: auto;\n}\n.reactodia-viewport-dock--row-n, .reactodia-viewport-dock--row-s {\n  position: absolute;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: center;\n}\n.reactodia-viewport-dock--row-n {\n  top: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n.reactodia-viewport-dock--row-s {\n  bottom: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n.reactodia-viewport-dock--column-w, .reactodia-viewport-dock--column-e {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.reactodia-viewport-dock--column-w {\n  left: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n}\n.reactodia-viewport-dock--column-e {\n  right: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n}\n.reactodia-viewport-dock--corner {\n  display: contents;\n}\n.reactodia-viewport-dock--dock-nw {\n  position: absolute;\n  left: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n  top: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n.reactodia-viewport-dock--dock-ne {\n  position: absolute;\n  right: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n  top: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n.reactodia-viewport-dock--dock-se {\n  position: absolute;\n  right: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n  bottom: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n.reactodia-viewport-dock--dock-sw {\n  position: absolute;\n  left: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-x, 0px));\n  bottom: calc(var(--reactodia-viewport-dock-margin, 10px) + var(--reactodia-viewport-dock-offset-y, 0px));\n}\n\n.reactodia-canvas {\n  flex: 1 1 0px;\n  width: 100%;\n  display: flex;\n  overflow: hidden;\n}\n\n.reactodia-class-tree {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-class-tree__filter {\n  flex-shrink: 0;\n  margin: 10px 0 10px 0;\n}\n.reactodia-class-tree--controlled .reactodia-class-tree__filter {\n  margin-top: 0;\n}\n.reactodia-class-tree__filter-group {\n  margin-left: 10px;\n  margin-right: 10px;\n}\n.reactodia-class-tree__only-creatable {\n  display: block;\n  margin-top: 5px;\n}\n.reactodia-class-tree__tree {\n  border-top: 1px solid rgb(221, 221, 221);\n}\n.reactodia-class-tree__no-results {\n  margin-top: 10px;\n}\n.reactodia-class-tree__spinner {\n  align-self: center;\n  /* center vertically in flexbox */\n  margin: auto;\n}\n\n.reactodia-class-tree-item {\n  margin: 1px 0;\n}\n.reactodia-class-tree-item__row {\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-class-tree-item__row > * {\n  flex-shrink: 0;\n}\n.reactodia-class-tree-item__body {\n  display: flex;\n  align-items: center;\n  text-decoration: none;\n  font-size: 15px;\n  padding: 1px;\n  border: 1px solid;\n  border-color: transparent;\n}\n.reactodia-class-tree-item__body:hover {\n  background: rgba(220, 235, 255, 0.568627451);\n  border-color: #ccefff;\n  cursor: pointer;\n}\n.reactodia-class-tree-item__body--selected {\n  background-color: #beebff;\n  border-color: #8edcff;\n}\n.reactodia-class-tree-item__icon-container {\n  height: 20px;\n}\n.reactodia-class-tree-item__icon {\n  display: block;\n  height: 100%;\n}\n.reactodia-class-tree-item__default-icon-leaf, .reactodia-class-tree-item__default-icon-parent {\n  background-image: url(${oe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 20px;\n  height: 20px;\n}\n.reactodia-class-tree-item__label {\n  margin-left: 5px;\n  color: black;\n}\n.reactodia-class-tree-item__highlighted-term {\n  font-weight: bold;\n}\n.reactodia-class-tree-item__count {\n  margin-left: 5px;\n}\n.reactodia-class-tree-item__children {\n  margin-left: 20px;\n}\n.reactodia-class-tree-item__toggle, .reactodia-class-tree-item__toggle-expanded, .reactodia-class-tree-item__toggle-collapsed {\n  margin: 2px;\n}\n.reactodia-class-tree-item__toggle-expanded, .reactodia-class-tree-item__toggle-collapsed {\n  opacity: 0.5;\n}\n.reactodia-class-tree-item__toggle-expanded:hover, .reactodia-class-tree-item__toggle-collapsed:hover {\n  cursor: pointer;\n  opacity: 1;\n  transition: opacity 0.3s;\n}\n.reactodia-class-tree-item__toggle::before {\n  display: block;\n  content: "";\n  width: 16px;\n  height: 16px;\n}\n.reactodia-class-tree-item__toggle-expanded::before {\n  background-image: url(${se});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-class-tree-item__toggle-collapsed::before {\n  background-image: url(${ae});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-class-tree-item__create-button {\n  margin-left: 5px;\n  padding: 5px;\n  cursor: move;\n}\n.reactodia-class-tree-item__create-button::before {\n  background-image: url(${le});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 12px;\n  height: 12px;\n}\n\n.reactodia-connections-menu {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-connections-menu__breadcrumbs {\n  padding: 10px;\n  padding-bottom: 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  height: 27px;\n  min-height: 27px;\n  flex-grow: 0;\n}\n.reactodia-connections-menu__breadcrumbs-link {\n  color: #337ab7;\n  cursor: pointer;\n  text-decoration: none;\n}\n.reactodia-connections-menu__breadcrumbs-link:hover {\n  text-decoration: underline;\n}\n.reactodia-connections-menu__search {\n  padding: 10px;\n  align-items: center;\n  flex: 0 0 auto;\n}\n.reactodia-connections-menu__sort-switches {\n  flex: 0 0 20px;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__sort-switch {\n  display: none;\n}\n.reactodia-connections-menu__sort-switch:checked + .reactodia-connections-menu__sort-switch-label {\n  color: #337ab7;\n  opacity: 1;\n}\n.reactodia-connections-menu__sort-switch-label {\n  cursor: pointer;\n  display: block;\n  margin: 0;\n  opacity: 0.4;\n  text-align: center;\n}\n.reactodia-connections-menu__sort-switch-label:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__sort-label-alpha::before {\n  background-image: url(${ce});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-connections-menu__sort-label-smart::before {\n  background-image: url(${de});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-connections-menu__spinner {\n  align-self: center;\n  margin: auto;\n}\n.reactodia-connections-menu__links-list {\n  padding: 5px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  border-top: 1px solid #dbdbdb;\n  flex-grow: 1;\n  margin: 0;\n}\n.reactodia-connections-menu__links-list-empty {\n  display: flex;\n  align-items: center;\n}\n.reactodia-connections-menu__links-no-results {\n  width: 100%;\n  font-size: x-large;\n  font-weight: 700;\n  color: #cbcbcb;\n  text-align: center;\n}\n.reactodia-connections-menu__links-probably-label {\n  font-weight: 700;\n  margin: 5px 0;\n}\n.reactodia-connections-menu__links-list-hr {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin-top: 6px;\n  margin-bottom: 6px;\n}\n.reactodia-connections-menu__link {\n  display: flex;\n  overflow: hidden;\n  padding: 0 5px 0 0;\n  align-items: center;\n  margin-bottom: 4px;\n  background: #f7f7f7;\n}\n.reactodia-connections-menu__link:hover {\n  background-color: #e2e2e2;\n}\n.reactodia-connections-menu__link-direction {\n  flex-shrink: 0;\n  background: rgba(219, 219, 219, 0.35);\n  min-height: 30px;\n  padding: 5px 0px 5px 10px;\n  display: flex;\n  align-items: center;\n}\n.reactodia-connections-menu__link-direction-in {\n  background: url(${ue}) 0 0 no-repeat;\n  flex-shrink: 0;\n  width: 20px;\n  height: 20px;\n  margin: 0 14px 0 0;\n  background-size: contain;\n  opacity: 0.5;\n}\n.reactodia-connections-menu__link-direction-out {\n  background: url(${he}) 0 0 no-repeat;\n  flex-shrink: 0;\n  width: 20px;\n  height: 20px;\n  margin: 0 8px 0 6px;\n  background-size: contain;\n  opacity: 0.5;\n}\n.reactodia-connections-menu__link-title {\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin: 5px 0px 5px 5px;\n}\n.reactodia-connections-menu__link-count {\n  flex-shrink: 0;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__link-navigate-button {\n  flex-shrink: 0;\n  float: right;\n  background-image: url(${pe});\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n  margin-left: 10px;\n  min-width: 16px;\n  background-size: cover;\n}\n.reactodia-connections-menu__link-navigate-button:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__link-filter-button {\n  flex-shrink: 0;\n  background-image: url(${ge});\n  background-size: 20px 20px;\n  width: 20px;\n  height: 20px;\n  opacity: 0.4;\n  margin-left: 10px;\n}\n.reactodia-connections-menu__link-filter-button:hover {\n  opacity: 1;\n}\n.reactodia-connections-menu__move-to-filter {\n  display: flex;\n  padding: 5px 10px;\n  cursor: pointer;\n  -webkit-user-select: none;\n  user-select: none;\n}\n.reactodia-connections-menu__move-to-filter:hover {\n  background-color: #e6e6e6;\n}\n.reactodia-connections-menu__objects {\n  flex-grow: 1;\n  padding: 10px;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  padding-top: 0px;\n}\n.reactodia-connections-menu__objects-select-all {\n  white-space: nowrap;\n  margin-bottom: 5px;\n  display: flex;\n}\n.reactodia-connections-menu__objects-select-all input {\n  margin-right: 5px;\n}\n.reactodia-connections-menu__objects-select-all input:disabled {\n  opacity: 0.3;\n}\n.reactodia-connections-menu__objects-loading, .reactodia-connections-menu__objects-no-results {\n  flex-grow: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid #ccc;\n  margin-bottom: 5px;\n}\n.reactodia-connections-menu__objects-no-results {\n  position: relative;\n  font-size: x-large;\n  font-weight: 700;\n  color: #cbcbcb;\n}\n.reactodia-connections-menu__objects-list {\n  border: 1px solid #ccc;\n  height: 0;\n  flex-grow: 1;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  padding: 5px;\n  margin-bottom: 5px;\n}\n.reactodia-connections-menu__objects-statusbar {\n  height: 25px;\n  white-space: nowrap;\n  display: flex;\n}\n.reactodia-connections-menu__objects-count {\n  height: 25px;\n  padding: 0px 5px;\n  font-size: larger;\n  display: flex;\n  align-items: center;\n  font-weight: 700;\n}\n.reactodia-connections-menu__objects-extra {\n  color: gray;\n  cursor: help;\n}\n.reactodia-connections-menu__objects-spacer {\n  flex: auto;\n}\n.reactodia-connections-menu__objects-add-button {\n  height: 25px;\n  padding-top: 1px;\n  padding-bottom: 2px;\n}\n.reactodia-connections-menu__objects-add-button:not(:last-child) {\n  margin-right: 5px;\n}\n\n.reactodia-dialog {\n  background: #fff;\n  border: 1px solid #ccc;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-dialog__header {\n  display: flex;\n}\n.reactodia-dialog__caption {\n  flex: auto;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  font-weight: bold;\n  margin: 8px 0 0 8px;\n}\n.reactodia-dialog__close-button {\n  border: none;\n  padding: 6px;\n  background: none;\n  transition: background-color 0.3s;\n}\n.reactodia-dialog__close-button::before {\n  background-image: url(${re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-dialog__close-button:hover {\n  background-color: #eeeeee;\n}\n.reactodia-dialog__bottom-handle {\n  position: absolute;\n  opacity: 0;\n  background-color: black;\n  bottom: 0;\n  width: 100%;\n  height: 5px;\n  cursor: ns-resize;\n}\n.reactodia-dialog__bottom-handle:hover {\n  opacity: 0.1;\n}\n.reactodia-dialog__right-handle {\n  position: absolute;\n  opacity: 0;\n  background-color: black;\n  top: 0;\n  right: 0;\n  width: 5px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.reactodia-dialog__right-handle:hover {\n  opacity: 0.1;\n}\n.reactodia-dialog__bottom-right-handle {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 10px 10px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n  cursor: nwse-resize;\n}\n.reactodia-dialog__bottom-right-handle::before {\n  content: "";\n  position: absolute;\n  bottom: -10px;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 5px 5px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n}\n.reactodia-dialog__bottom-right-handle:hover {\n  border-color: transparent transparent rgba(0, 0, 0, 0.5) transparent;\n}\n\n.reactodia-viewport-dialog-overlay {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  z-index: 60;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.55);\n}\n\n.reactodia-halo {\n  position: absolute;\n  pointer-events: none;\n  border: 1.5px dashed #d8956d;\n  border-radius: 2px;\n  box-shadow: 0 0 5px 0 #d8956d inset;\n}\n\n.reactodia-halo-link__label-highlight {\n  position: absolute;\n  pointer-events: none;\n  border-bottom: 2px solid #d8956d;\n}\n.reactodia-halo-link__path-highlight {\n  fill: none;\n  /* Invisible by default but allows to be customized externally */\n}\n\n.reactodia-instances-search {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.reactodia-instances-search__criteria {\n  flex-shrink: 0;\n  margin: 10px 0 10px 0;\n}\n.reactodia-instances-search--controlled .reactodia-instances-search__criteria {\n  margin-top: 0;\n  margin-bottom: 0;\n}\n.reactodia-instances-search__criterions {\n  padding-left: 15px;\n  margin-bottom: 10px;\n}\n.reactodia-instances-search__criterions:empty {\n  margin-bottom: 0;\n}\n.reactodia-instances-search__criterion {\n  display: block;\n  position: relative;\n  width: 100%;\n}\n.reactodia-instances-search__criterion-class {\n  border: black 1px dashed;\n  background: rgb(255, 210, 33);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__criterion-element {\n  border: black 1px dashed;\n  background: rgb(255, 131, 92);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__criterion-link-type {\n  border: black 1px dashed;\n  background: rgb(202, 255, 206);\n  padding: 0 0.5em 0 0.5em;\n  word-wrap: break-word;\n}\n.reactodia-instances-search__link-direction {\n  height: 1em;\n  opacity: 0.5;\n  vertical-align: middle;\n}\n.reactodia-instances-search__criterion-remove {\n  float: right;\n  margin: 0 10px 4px 4px;\n}\n.reactodia-instances-search__criterion-remove-button::before {\n  background-image: url(${re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-instances-search__text-criteria {\n  margin: 0 10px;\n}\n.reactodia-instances-search__search-button {\n  height: 34px;\n}\n.reactodia-instances-search__search-button::before {\n  background-image: url(${ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-instances-search__rest {\n  padding: 10px 10px 0 10px;\n  border-top: 1px solid rgb(221, 221, 221);\n}\n.reactodia-instances-search__results {\n  padding-left: 0;\n  padding-top: 10px;\n  margin: 0 10px 0 10px;\n  outline: none;\n}\n.reactodia-instances-search[data-state=finished] .reactodia-instances-search__results:empty:before {\n  content: "No items correspond to the specified criteria.";\n  font-style: italic;\n}\n.reactodia-instances-search__rest-end {\n  margin: 5px 0 10px 0;\n}\n.reactodia-instances-search__load-more {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-instances-search__load-more::before {\n  background-image: url(${fe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 5px;\n  filter: invert(100%);\n}\n.reactodia-instances-search__actions {\n  display: flex;\n  justify-content: flex-end;\n  height: 40px;\n  border-top: 1px solid rgb(221, 221, 221);\n  transition: height 200ms 0ms;\n}\n.reactodia-instances-search__actions-hidden {\n  height: 0;\n  padding: 0;\n}\n.reactodia-instances-search__action {\n  padding-top: 1px;\n  padding-bottom: 2px;\n  margin-top: 6px;\n  margin-bottom: 6px;\n  margin-left: 6px;\n}\n.reactodia-instances-search__action:last-child {\n  margin-right: 6px;\n}\n\n.reactodia-link-action {\n  position: absolute;\n  cursor: pointer;\n  border: 0 none;\n  padding: 0;\n  opacity: 0.8;\n  outline: none;\n  transition: opacity 0.3s;\n}\n.reactodia-link-action:hover {\n  opacity: 1;\n}\n.reactodia-link-action[disabled] {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n.reactodia-link-action__spinner {\n  position: absolute;\n}\n.reactodia-link-action__button {\n  background-color: #ccc;\n  background-position: 50%;\n  background-repeat: no-repeat;\n  background-size: 65%;\n  border-radius: calc(var(--reactodia-link-button-size) * 0.5);\n  height: var(--reactodia-link-button-size);\n  width: var(--reactodia-link-button-size);\n}\n.reactodia-link-action__endpoint {\n  background: transparent;\n}\n.reactodia-link-action__edit {\n  background-image: url(${me});\n}\n.reactodia-link-action__delete {\n  background-image: url(${ye});\n}\n.reactodia-link-action__rename {\n  background: white url(${me}) no-repeat;\n  background-size: 80%;\n  background-position: center;\n  filter: invert();\n  position: absolute;\n  margin-left: 5px;\n  padding: 0;\n  border: 0 none;\n  border-radius: 2px;\n  outline: none;\n  cursor: pointer;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-link-action__rename:hover {\n  opacity: 1;\n}\n\n.reactodia-links-toolbox {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 0;\n}\n.reactodia-links-toolbox__heading {\n  padding: 10px;\n}\n.reactodia-links-toolbox__filter {\n  margin-bottom: 5px;\n}\n.reactodia-links-toolbox__rest {\n  border-top: 1px solid #dddddd;\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-links-toolbox__toggle-invisible, .reactodia-links-toolbox__toggle-lines-only, .reactodia-links-toolbox__toggle-visible {\n  border-color: rgb(195, 195, 195);\n}\n.reactodia-links-toolbox__toggle-invisible::before {\n  background-image: url(${be});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-links-toolbox__toggle-lines-only::before {\n  background-image: url(${xe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-links-toolbox__toggle-visible::before {\n  background-image: url(${we});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-links-toolbox__links-heading {\n  font-size: 14px;\n  margin: 4px 6px;\n}\n.reactodia-links-toolbox__links {\n  display: flex;\n  flex-direction: column;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n.reactodia-links-toolbox__link-item {\n  padding: 0 0 0 5px;\n  word-break: break-word;\n}\n.reactodia-links-toolbox__link-item:last-child {\n  margin-bottom: 0;\n}\n.reactodia-links-toolbox__link-item > div {\n  display: inline;\n}\n.reactodia-links-toolbox__link-title {\n  font-size: 16px;\n  color: black;\n  display: inline;\n}\n.reactodia-links-toolbox__link-buttons {\n  float: left;\n  margin-top: 2px;\n  margin-right: 6px;\n  margin-bottom: 2px;\n}\n.reactodia-links-toolbox__link-item:hover .reactodia-links-toolbox__filter-button {\n  opacity: 1;\n  transition: opacity 200ms 0ms;\n}\n.reactodia-links-toolbox__filter-button {\n  display: none;\n  float: right;\n  background-image: url(${ge});\n  background-size: 20px 20px;\n  width: 20px;\n  height: 20px;\n  margin: 3px;\n  cursor: pointer;\n  opacity: 0.4;\n  transition: opacity 200ms 0ms;\n}\n.reactodia-links-toolbox__no-results {\n  margin-top: 10px;\n}\n\n.reactodia-navigator {\n  display: block;\n  overflow: hidden;\n  background: #fff;\n  border: 1px solid #ddd;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n  transition: width 0.3s, height 0.3s;\n}\n.reactodia-navigator--collapsed {\n  width: 24px;\n  height: 24px;\n}\n.reactodia-navigator > canvas {\n  transition: opacity 0.3s;\n}\n.reactodia-navigator--expanded > canvas {\n  opacity: 1;\n}\n.reactodia-navigator--collapsed > canvas {\n  opacity: 0;\n}\n.reactodia-navigator__toggle {\n  position: absolute;\n  background: transparent;\n  border: none;\n  outline: none;\n  padding: 4px;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-navigator__toggle:not(:disabled):hover {\n  opacity: 1;\n}\n.reactodia-navigator__toggle:disabled {\n  opacity: 0.2;\n}\n.reactodia-navigator--expanded .reactodia-navigator__toggle {\n  top: 5px;\n  left: 5px;\n}\n.reactodia-navigator--collapsed .reactodia-navigator__toggle {\n  top: 0px;\n  left: 0px;\n}\n.reactodia-navigator__toggle-icon {\n  width: 18px;\n  height: 18px;\n  background-size: 18px 18px;\n  background-repeat: no-repeat;\n}\n.reactodia-navigator--expanded .reactodia-navigator__toggle-icon {\n  background-image: url(${ve});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-navigator--collapsed .reactodia-navigator__toggle-icon {\n  background-image: url(${ke});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-selection {\n  position: absolute;\n  --reactodia-dock-margin-x: 2px;\n  --reactodia-dock-margin-y: 2px;\n}\n.reactodia-selection__selectedBox {\n  position: absolute;\n  background-color: rgba(255, 166, 0, 0.06);\n  border: 1px solid orange;\n  border-radius: 2px;\n  box-shadow: 0 0 7px 7px rgba(51, 51, 51, 0.13);\n  cursor: move;\n  user-select: none;\n  -webkit-user-select: none;\n}\n.reactodia-selection__selectedActions {\n  position: absolute;\n}\n.reactodia-selection__selectedItem {\n  position: absolute;\n  border: 1px dashed orange;\n  background-color: rgba(255, 166, 0, 0.16);\n}\n.reactodia-selection__highlightedBox {\n  position: absolute;\n  background-color: rgba(0, 219, 255, 0.13);\n  border: 2px dashed rgb(0, 179, 209);\n  border-radius: 2px;\n}\n.reactodia-selection__highlightedItem {\n  position: absolute;\n  border: 1px dashed rgb(0, 188, 126);\n  background: rgba(0, 188, 126, 0.33);\n}\n\n.reactodia-selection-action {\n  position: absolute;\n  background-color: transparent;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n  border: 0 none;\n  cursor: pointer;\n  outline: none;\n  padding: 0;\n  pointer-events: auto;\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n  transition: opacity 0.3s;\n}\n.reactodia-selection-action:hover {\n  opacity: 1;\n}\n.reactodia-selection-action[disabled] {\n  cursor: not-allowed;\n  opacity: 0.2;\n}\n.reactodia-selection-action--dock-nw {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-n {\n  left: 50%;\n  margin-left: calc(-11px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-ne {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-e {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: 50%;\n  margin-top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-se {\n  right: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-s {\n  left: 50%;\n  margin-left: calc(-11px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-sw {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  bottom: calc(-22px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action--dock-w {\n  left: calc(-22px - var(--reactodia-dock-margin-x, 0px) + var(--reactodia-dock-x) * 22px);\n  top: 50%;\n  margin-top: calc(-11px - var(--reactodia-dock-margin-y, 0px) + var(--reactodia-dock-y) * 22px);\n}\n.reactodia-selection-action__spinner {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n}\n.reactodia-selection-action__remove {\n  background-image: url(${Se});\n}\n.reactodia-selection-action__delete {\n  background-image: url(${ye});\n}\n.reactodia-selection-action__zoomToFit {\n  background-image: url(${Le});\n}\n.reactodia-selection-action__layout {\n  background-image: url(${_e});\n}\n.reactodia-selection-action__expand {\n  background-image: url(${fe});\n}\n.reactodia-selection-action__collapse {\n  background-image: url(${Me});\n}\n.reactodia-selection-action__link {\n  background-image: url(${Ie});\n}\n.reactodia-selection-action__navigate-open {\n  background-image: url(${Te});\n}\n.reactodia-selection-action__navigate-close {\n  background-image: url(${Ee});\n}\n.reactodia-selection-action__add-to-filter {\n  background-image: url(${ge});\n}\n.reactodia-selection-action__group {\n  background-image: url(${je});\n}\n.reactodia-selection-action__ungroup {\n  background-image: url(${Ne});\n}\n.reactodia-selection-action__establish-link {\n  background-image: url(${Ce});\n}\n\n.reactodia-toolbar {\n  /* Prevent buttons to wrap after menu button if width is too small */\n  white-space: nowrap;\n  /* Make transparent toolbar parts "click-through" while keeping buttons clickable */\n  pointer-events: none;\n}\n.reactodia-toolbar > * {\n  pointer-events: auto;\n  white-space: normal;\n}\n.reactodia-toolbar__menu {\n  margin-right: 5px;\n  z-index: 50;\n}\n\n.reactodia-toolbar-action__open {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__open::before {\n  background-image: url(${Ae});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__open-input {\n  display: none;\n}\n.reactodia-toolbar-action__save {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__save::before {\n  background-image: url(${De});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__clear-all {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__clear-all::before {\n  background-image: url(${ye});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__export-image {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__export-image::before {\n  background-image: url(${Pe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__print {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__print::before {\n  background-image: url(${Oe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__undo:empty::before {\n  background-image: url(${Re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 18px;\n  height: 18px;\n}\n.reactodia-toolbar-action__undo:not(:empty) {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__undo:not(:empty)::before {\n  background-image: url(${Re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__redo:empty::before {\n  background-image: url(${ze});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  width: 18px;\n  height: 18px;\n}\n.reactodia-toolbar-action__redo:not(:empty) {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__redo:not(:empty)::before {\n  background-image: url(${ze});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar-action__layout {\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__layout::before {\n  background-image: url(${_e});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-toolbar__quick-access-group .reactodia-toolbar-action__layout {\n  margin-right: 5px;\n}\n.reactodia-toolbar-action__language-selector {\n  float: left;\n  position: relative;\n  height: 30px;\n  background: white;\n  border: 1px solid #ccc;\n  padding: 0 5px;\n  display: flex;\n  align-items: center;\n}\n.reactodia-toolbar-action__language-selector:focus-within {\n  border-color: #66afe9;\n}\n.reactodia-toolbar-action__language-selector select {\n  height: 30px;\n  background: none;\n  border: none;\n  outline: none;\n  color: inherit;\n  margin: 0;\n  font: inherit;\n  line-height: inherit;\n}\n.reactodia-toolbar-action__language-selector label {\n  display: inline-block;\n  margin-right: 5px;\n}\n.reactodia-toolbar-action__language-selector label::before {\n  background-image: url(${$e});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-unified-search {\n  border: 1px solid #ccc;\n  background: #fff;\n  transition: border-color ease-in-out 0.15s;\n}\n.reactodia-unified-search:focus-within {\n  border-color: #66afe9;\n}\n.reactodia-unified-search.reactodia-dropdown--expanded {\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n}\n.reactodia-unified-search__toggle {\n  height: 28px;\n  display: flex;\n  align-items: stretch;\n}\n.reactodia-unified-search__search-input {\n  flex: auto;\n  display: block;\n  margin: 0;\n  padding: 6px 44px 6px 12px;\n  font: inherit;\n  font-size: inherit;\n  line-height: inherit;\n  font-size: 14px;\n  line-height: 1.42857143;\n  background: white;\n  color: #555;\n  border: none;\n}\n.reactodia-unified-search__search-input:focus {\n  outline: 0;\n}\n.reactodia-unified-search__search-icon {\n  position: absolute;\n  right: 0;\n  padding: 0 8px;\n  align-self: center;\n  border: none;\n  background: none;\n  cursor: text;\n}\n.reactodia-unified-search__search-icon::before {\n  background-image: url(${ne});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-unified-search__collapse-button, .reactodia-unified-search__clear-button {\n  position: absolute;\n  right: 0;\n  padding: 6px;\n  align-self: center;\n  background: 0 0;\n  border: 0;\n  transition: background-color 0.3s;\n}\n.reactodia-unified-search__collapse-button:hover, .reactodia-unified-search__clear-button:hover {\n  background-color: #eeeeee;\n}\n.reactodia-unified-search__collapse-button::after {\n  background-image: url(${Me});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-unified-search__clear-button::after {\n  background-image: url(${re});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-unified-search .reactodia-dropdown__content {\n  position: unset;\n  box-shadow: unset;\n}\n.reactodia-unified-search__panel {\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-unified-search__bottom-handle {\n  position: absolute;\n  opacity: 0;\n  background-color: black;\n  bottom: 0;\n  width: 100%;\n  height: 5px;\n  cursor: ns-resize;\n}\n.reactodia-unified-search__bottom-handle:hover {\n  opacity: 0.1;\n}\n.reactodia-unified-search__right-handle {\n  position: absolute;\n  opacity: 0;\n  background-color: black;\n  top: 0;\n  right: 0;\n  width: 5px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.reactodia-unified-search__right-handle:hover {\n  opacity: 0.1;\n}\n.reactodia-unified-search__corner-handle {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 10px 10px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n  cursor: nwse-resize;\n}\n.reactodia-unified-search__corner-handle::before {\n  content: "";\n  position: absolute;\n  bottom: -10px;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 0 5px 5px;\n  border-color: transparent transparent rgba(0, 0, 0, 0.38) transparent;\n}\n.reactodia-unified-search__corner-handle:hover {\n  border-color: transparent transparent rgba(0, 0, 0, 0.5) transparent;\n}\n.reactodia-unified-search__section-tabs {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n  margin: 8px 10px;\n}\n.reactodia-unified-search__section-tab {\n  padding: 4px;\n  font-size: 13px;\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  touch-action: manipulation;\n  cursor: pointer;\n  user-select: none;\n  border-width: 1px;\n  border-style: solid;\n  transition: background-color 0.3s;\n}\n.reactodia-unified-search__section {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-unified-search__section:not(.reactodia-unified-search__section--active) {\n  display: none;\n}\n\n.reactodia-zoom-control {\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 4px 15px 7px rgba(51, 51, 51, 0.05);\n}\n.reactodia-zoom-control .reactodia-btn {\n  padding: 3px;\n}\n.reactodia-zoom-control .reactodia-btn + .reactodia-btn {\n  margin-top: -1px;\n}\n.reactodia-zoom-control__zoom-in-button::before {\n  background-image: url(${Ue});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-zoom-control__zoom-out-button::before {\n  background-image: url(${Be});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-zoom-control__zoom-fit-button::before {\n  background-image: url(${Le});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n.reactodia-zoom-control__selection-mode-button::before {\n  background-image: url(${We});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n}\n\n.reactodia-accordion {\n  flex: auto;\n  display: flex;\n  height: 100%;\n  width: 100%;\n}\n.reactodia-accordion--scrollable {\n  overflow: auto;\n}\n.reactodia-accordion--vertical {\n  flex-direction: column;\n}\n.reactodia-accordion--vertical:not(.reactodia-accordion--resizing) > .reactodia-accordion-item {\n  transition: height 0.3s ease-in-out;\n}\n\n.reactodia-accordion-item {\n  display: flex;\n  position: relative;\n  flex: auto;\n}\n.reactodia-accordion-item--resizing > .reactodia-accordion-item__handle, .reactodia-accordion-item__handle:hover {\n  background: rgba(0, 0, 0, 0.1);\n}\n.reactodia-accordion-item--vertical {\n  border-top: 1px solid lightgray;\n}\n.reactodia-accordion-item--vertical:first-child {\n  border-top-width: 0;\n}\n.reactodia-accordion-item--horizontal {\n  border-right: 1px solid lightgray;\n}\n.reactodia-accordion-item--horizontal:last-child {\n  border-right-width: 0;\n}\n.reactodia-accordion-item__handle {\n  position: absolute;\n  z-index: 10;\n}\n.reactodia-accordion-item__handle-vertical {\n  height: 5px;\n  bottom: -2.5px;\n  left: 0;\n  width: 100%;\n  cursor: ns-resize;\n}\n.reactodia-accordion-item__handle-horizontal {\n  height: 100%;\n  top: 0;\n  right: -2.5px;\n  width: 5px;\n  cursor: ew-resize;\n}\n.reactodia-accordion-item__handle-btn {\n  background: #fff;\n  border: 2px solid #17b;\n  box-shadow: 0 0 0 1px rgba(9, 30, 66, 0.08), 0 2px 4px 1px rgba(9, 30, 66, 0.08);\n  border-radius: 10px;\n  cursor: pointer;\n  height: 20px;\n  position: absolute;\n  top: 50%;\n  margin-top: -10px;\n  width: 20px;\n  z-index: 20;\n  transition: 0.3s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.reactodia-accordion-item__handle-btn::before {\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  background-size: cover;\n  content: "";\n  height: 16px;\n  width: 16px;\n  opacity: 0.3;\n  transition: opacity filter 0.3s;\n}\n.reactodia-accordion-item__handle-btn:hover {\n  background: #17b;\n}\n.reactodia-accordion-item__handle-btn:hover::before {\n  opacity: 1;\n  filter: invert();\n}\n.reactodia-accordion-item__handle-btn-left {\n  left: 100%;\n  margin-left: -10px;\n}\n.reactodia-accordion-item__handle-btn-left::before {\n  background-image: url(${Ye});\n}\n.reactodia-accordion-item__handle-btn-right {\n  right: 100%;\n  margin-right: -10px;\n}\n.reactodia-accordion-item__handle-btn-right:before {\n  background-image: url(${pe});\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__handle-btn:before {\n  transform: rotate(180deg);\n}\n.reactodia-accordion-item__inner {\n  flex: auto;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.reactodia-accordion-item__body {\n  flex: 1 1 0px;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-accordion-item__header {\n  padding-left: 20px;\n  position: relative;\n  flex-shrink: 0;\n  font-size: 16px;\n  background: #E4E4E4;\n  cursor: default;\n  /* unselectable */\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.reactodia-accordion-item__header:before {\n  border-top: 6px solid #555555;\n  border-left: 3.5px solid transparent;\n  border-right: 3.5px solid transparent;\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 7px;\n  margin-top: -3px;\n  -webkit-transition: 0.1s;\n  -moz-transition: 0.1s;\n  transition: 0.1s;\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__header:before {\n  -webkit-transform: rotate(-90deg);\n  -moz-transform: rotate(-90deg);\n  -ms-transform: rotate(-90deg);\n  transform: rotate(-90deg);\n}\n.reactodia-accordion-item--collapsed .reactodia-accordion-item__body {\n  display: none;\n}\n\n.reactodia-workspace {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* Defaults for inheritable properties */\n  box-sizing: border-box;\n  white-space: initial;\n  color: #333;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: 14px;\n  line-height: 1.42857;\n}\n.reactodia-workspace *, .reactodia-workspace *:before, .reactodia-workspace *:after {\n  box-sizing: inherit;\n}\n\n.reactodia-scrollable {\n  flex: 1 1 0px;\n  overflow-y: scroll;\n}\n\n.reactodia-scrollable > * {\n  position: relative;\n}\n\n.reactodia-classic-template {\n  max-width: 450px;\n  float: left;\n  border-radius: 12px;\n  border-style: solid;\n  border-width: 1px;\n}\n.reactodia-classic-template__thumbnail {\n  text-align: center;\n}\n.reactodia-classic-template__thumbnail-image {\n  max-width: 200px;\n}\n.reactodia-classic-template--expanded .reactodia-classic-template__thumbnail-image {\n  max-width: 350px;\n}\n.reactodia-classic-template__type-line {\n  padding: 0px 7px;\n  color: white;\n  height: 18px;\n  margin-bottom: 2px;\n  overflow: hidden;\n  display: flex;\n  align-items: baseline;\n  margin-top: -3px;\n}\n.reactodia-classic-template__type-line-icon {\n  position: inherit !important;\n  margin-right: 4px;\n}\n.reactodia-classic-template__type-line-text-container {\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  width: 0;\n}\n.reactodia-classic-template__type-line-text {\n  display: inline;\n  white-space: nowrap;\n  font-size: 12px;\n}\n.reactodia-classic-template__body {\n  border-bottom-left-radius: 12px;\n  border-bottom-right-radius: 12px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  background: white;\n  padding: 7px 10px 8px 10px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.reactodia-classic-template__label {\n  font-size: 19px;\n  font-weight: 100;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 0;\n  white-space: nowrap;\n  word-wrap: break-word;\n}\n.reactodia-classic-template__expander {\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n}\n.reactodia-classic-template__iri-heading {\n  font-size: 12px;\n  font-weight: 100;\n  margin-right: 15px;\n  color: #b6b6b6;\n}\n.reactodia-classic-template__iri-container {\n  font-size: 12px;\n  width: 100%;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n.reactodia-classic-template__iri {\n  color: #b6b6b6;\n}\n.reactodia-classic-template__divider {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin: 5px 0px 5px 0px;\n}\n.reactodia-classic-template__property-table {\n  font-size: 15px;\n  font-weight: 100;\n  margin-bottom: 5px;\n  max-height: 200px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n.reactodia-classic-template__property-row {\n  white-space: nowrap;\n}\n.reactodia-classic-template__property-label {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  vertical-align: top;\n}\n.reactodia-classic-template__property-values {\n  display: inline-block;\n  width: 50%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.reactodia-classic-template__property-value {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: initial;\n  padding-right: 10px;\n}\n\n.reactodia-default-link--group .reactodia-link-path {\n  stroke-width: 2px;\n}\n.reactodia-default-link__label-text {\n  fill: black;\n  stroke: none;\n  stroke-width: 0;\n  font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;\n  font-size: inherit;\n  font-weight: bold;\n}\n.reactodia-default-link--renamed .reactodia-default-link__label-text {\n  font-style: italic;\n  font-weight: normal;\n}\n.reactodia-default-link__label-background {\n  fill: white;\n  stroke: none;\n  stroke-width: 0;\n}\n.reactodia-default-link__source-count .reactodia-default-link__label-text, .reactodia-default-link__target-count .reactodia-default-link__label-text {\n  fill: gray;\n  font-size: 12px;\n}\n.reactodia-default-link__source-count .reactodia-default-link__label-background, .reactodia-default-link__target-count .reactodia-default-link__label-background {\n  opacity: 80%;\n}\n\n.reactodia-group-paginator {\n  display: flex;\n}\n.reactodia-group-paginator__previous, .reactodia-group-paginator__next {\n  height: 22px;\n  padding: 0 5px;\n}\n.reactodia-group-paginator__previous {\n  display: flex;\n  align-items: center;\n}\n.reactodia-group-paginator__previous::before {\n  background-image: url(${Ye});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-group-paginator__next {\n  display: flex;\n  align-items: center;\n}\n.reactodia-group-paginator__next::before {\n  background-image: url(${pe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-group-paginator__status {\n  flex: 60px 0 0;\n  text-align: center;\n  border-top: 1px solid #f1f1f3;\n  border-bottom: 1px solid #f1f1f3;\n}\n.reactodia-group-paginator__page-size {\n  margin-left: 4px;\n}\n\n.reactodia-standard-template {\n  min-width: 180px;\n  max-width: 400px;\n  float: left;\n}\n.reactodia-standard-template--group {\n  border-radius: 2px;\n  border: 1px solid;\n  border-color: var(--reactodia-standard-group-color);\n  background: #fafaf9;\n  padding: 4px;\n}\n.reactodia-standard-template__main {\n  border-radius: 2px;\n  border: 1px solid;\n  border-color: var(--reactodia-standard-entity-color);\n  background-color: var(--reactodia-standard-entity-color);\n}\n.reactodia-standard-template__body {\n  margin-left: 8px;\n  border-radius: 0 2px 2px 0;\n  border-left: 1px solid;\n  border-left-color: var(--reactodia-standard-entity-color);\n  padding: 3px 0;\n  background: #fafaf9;\n}\n.reactodia-standard-template--new .reactodia-standard-template__main {\n  background-color: white;\n}\n.reactodia-standard-template__body-horizontal {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  overflow: hidden;\n}\n.reactodia-standard-template__body-content {\n  flex-grow: 1;\n  min-width: 0;\n  margin-right: 12px;\n}\n.reactodia-standard-template__item {\n  display: flex;\n  border-radius: 2px;\n  border: 0px;\n}\n.reactodia-standard-template__item-filler {\n  font-size: 15px;\n  padding: 3px;\n}\n.reactodia-standard-template__item:not(:first-child), .reactodia-standard-template__item-filler:not(:first-child) {\n  margin-top: 4px;\n}\n.reactodia-standard-template__item-stripe {\n  width: 6px;\n  background: var(--reactodia-standard-entity-color);\n}\n.reactodia-standard-template--new .reactodia-standard-template__item-stripe {\n  background: white;\n  border: 1px solid var(--reactodia-standard-entity-color);\n}\n.reactodia-standard-template__item-body {\n  flex: auto;\n  display: flex;\n  padding: 3px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  background: #fafaf9;\n}\n.reactodia-standard-template__label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template--standalone .reactodia-standard-template__label {\n  font-size: 19px;\n}\n.reactodia-standard-template--group .reactodia-standard-template__label {\n  font-size: 15px;\n  flex: auto;\n}\n.reactodia-standard-template--group .reactodia-standard-template--changed .reactodia-standard-template__label {\n  font-style: italic;\n  color: rgb(0, 153, 255);\n}\n.reactodia-standard-template--group .reactodia-standard-template--deleted .reactodia-standard-template__label {\n  text-decoration: line-through;\n  color: rgb(255, 59, 59);\n}\n.reactodia-standard-template__thumbnail {\n  font-size: 26px;\n  margin: 5px 10px;\n  flex-shrink: 0;\n  width: 50px;\n  height: 50px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: var(--reactodia-standard-entity-color);\n}\n.reactodia-standard-template__thumbnail-image {\n  max-height: 100%;\n  max-width: 100%;\n}\n.reactodia-standard-template__thumbnail-icon {\n  width: 26px;\n  height: 26px;\n  object-fit: contain;\n}\n.reactodia-standard-template__photo {\n  border-bottom: 1px solid;\n  border-color: var(--reactodia-standard-entity-color);\n}\n.reactodia-standard-template__photo-image {\n  width: 100%;\n  border-radius: 2px 2px 0 0;\n}\n.reactodia-standard-template__type {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 11px;\n  font-style: italic;\n  color: #999;\n  display: flex;\n}\n.reactodia-standard-template__type-value {\n  width: 0;\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template__iri {\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n}\n.reactodia-standard-template__iri-key {\n  font-size: 12px;\n  margin-right: 4px;\n  color: #b6b6b6;\n}\n.reactodia-standard-template__iri-value {\n  font-size: 12px;\n  width: 100%;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n.reactodia-standard-template__iri-value a {\n  color: #b6b6b6;\n}\n.reactodia-standard-template__hr {\n  border: 0;\n  border-top: 1px solid #eee;\n  height: 0;\n  margin: 5px 0;\n}\n.reactodia-standard-template__properties {\n  font-size: 15px;\n  max-height: 200px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n.reactodia-standard-template__properties-row {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  white-space: nowrap;\n}\n.reactodia-standard-template__properties-key {\n  display: inline-block;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  vertical-align: top;\n}\n.reactodia-standard-template__properties-values {\n  display: inline-block;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.reactodia-standard-template__properties-value {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: initial;\n  padding-right: 10px;\n}\n.reactodia-standard-template__pinned-props {\n  border-top: 1px solid;\n  border-color: var(--reactodia-standard-entity-color);\n  margin: 0 5px;\n}\n.reactodia-standard-template__dropdown {\n  border: 1px solid;\n  border-color: var(--reactodia-standard-entity-color);\n  border-radius: 2px;\n  background-color: white;\n  margin-top: 5px;\n}\n.reactodia-standard-template__dropdown-content {\n  width: 100%;\n  padding: 9px;\n}\n.reactodia-standard-template__actions {\n  display: flex;\n  justify-content: space-between;\n}\n.reactodia-standard-template__delete-button, .reactodia-standard-template__edit-button {\n  display: flex;\n  align-items: center;\n  padding: 5px;\n  min-width: 60px;\n}\n.reactodia-standard-template__delete-button {\n  display: flex;\n  align-items: center;\n}\n.reactodia-standard-template__delete-button::before {\n  background-image: url(${ye});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-standard-template__edit-button {\n  display: flex;\n  align-items: center;\n}\n.reactodia-standard-template__edit-button::before {\n  background-image: url(${me});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-standard-template__ungroup-one-button {\n  display: flex;\n  align-items: center;\n  width: 18px;\n  height: 18px;\n  padding: 0px;\n  align-self: center;\n  margin-left: 2px;\n  display: block;\n  opacity: 0;\n  transition: opacity 200ms 0ms;\n}\n.reactodia-standard-template__ungroup-one-button::before {\n  background-image: url(${pe});\n  background-size: contain;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  content: "";\n  display: block;\n  height: 16px;\n  width: 16px;\n  margin-right: 3px;\n}\n.reactodia-standard-template:hover .reactodia-standard-template__ungroup-one-button, .reactodia-standard-template:focus .reactodia-standard-template__ungroup-one-button {\n  opacity: 1;\n}\n.reactodia-standard-template--group .reactodia-group-paginator {\n  margin-top: 4px;\n  opacity: 0.4;\n  transition: opacity 200ms 0ms;\n}\n.reactodia-standard-template--group .reactodia-group-paginator:hover {\n  opacity: 1;\n}`,""]);const Fe=K},e=>{e.exports=function(e){return e[1]}},e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC41NjggMS4wMzFBNi44IDYuOCAwIDAgMSAxMi43NiAzLjA1YTcuMDYgNy4wNiAwIDAgMSAuNDYgOS4zOSA2Ljg1IDYuODUgMCAwIDEtOC41OCAxLjc0IDcgNyAwIDAgMS0zLjEyLTMuNSA3LjEyIDcuMTIgMCAwIDEtLjIzLTQuNzEgNyA3IDAgMCAxIDIuNzctMy43OSA2LjggNi44IDAgMCAxIDQuNTA4LTEuMTQ5ek05LjA0IDEzLjg4YTUuODkgNS44OSAwIDAgMCAzLjQxLTIuMDcgNi4wNyA2LjA3IDAgMCAwLS40LTguMDYgNS44MiA1LjgyIDAgMCAwLTcuNDMtLjc0IDYuMDYgNi4wNiAwIDAgMCAuNSAxMC4yOSA1LjgxIDUuODEgMCAwIDAgMy45Mi41OHpNNy4zNzUgNmgxLjI1VjVoLTEuMjV2MXptMS4yNSAxdjRoLTEuMjVWN2gxLjI1eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy41NiAxaC44OGw2LjU0IDEyLjI2LS40NC43NEgxLjQ0TDEgMTMuMjYgNy41NiAxek04IDIuMjhMMi4yOCAxM0gxMy43TDggMi4yOHpNOC42MjUgMTJ2LTFoLTEuMjV2MWgxLjI1em0tMS4yNS0yVjZoMS4yNXY0aC0xLjI1eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNS4yNSAwYTguMjUgOC4yNSAwIDAgMC02LjE4IDEzLjcyTDEgMjIuODhsMS4xMiAxIDguMDUtOS4xMkE4LjI1MSA4LjI1MSAwIDEgMCAxNS4yNS4wMVYwem0wIDE1YTYuNzUgNi43NSAwIDEgMSAwLTEzLjUgNi43NSA2Ljc1IDAgMCAxIDAgMTMuNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNiA1SDBWNGgxNnYxem0wIDhIMHYtMWgxNnYxem0wLTQuMDA4SDBWOGgxNnYuOTkyeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOCA4LjcwN2wzLjY0NiAzLjY0Ny43MDgtLjcwN0w4LjcwNyA4bDMuNjQ3LTMuNjQ2LS43MDctLjcwOEw4IDcuMjkzIDQuMzU0IDMuNjQ2bC0uNzA3LjcwOEw3LjI5MyA4bC0zLjY0NiAzLjY0Ni43MDcuNzA4TDggOC43MDd6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy41MSA0bC01LTNoLTFsLTUgMy0uNDkuODZ2NmwuNDkuODUgNSAzaDFsNS0zIC40OS0uODV2LTZMMTMuNTEgNHptLTYgOS41NmwtNC41LTIuN1Y1LjdsNC41IDIuNDV2NS40MXpNMy4yNyA0LjdsNC43NC0yLjg0IDQuNzQgMi44NC00Ljc0IDIuNTlMMy4yNyA0Ljd6bTkuNzQgNi4xNmwtNC41IDIuN1Y4LjE1bDQuNS0yLjQ1djUuMTZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0yIDUuNTZMMi40MTMgNWgxMS4xOTRsLjM5My41NEw4LjM3MyAxMWgtLjgyN0wyIDUuNTZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik01LjU2IDE0TDUgMTMuNTg3VjIuMzkzTDUuNTQgMiAxMSA3LjYyN3YuODI3TDUuNTYgMTR6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xNCA3djFIOHY2SDdWOEgxVjdoNlYxaDF2Nmg2eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMjMgMTAuOTMzYy4zMjYuMTkyLjY5OS4yOSAxLjA3Ny4yODJhMi4xNTkgMi4xNTkgMCAwIDAgMS43NTQtLjg0MiAzLjI5MSAzLjI5MSAwIDAgMCAuNjU0LTIuMTEzIDIuODg2IDIuODg2IDAgMCAwLS41NzYtMS44NzcgMS45OSAxLjk5IDAgMCAwLTEuNjM0LS43MzMgMi4yOTQgMi4yOTQgMCAwIDAtMS41MjMuNTY3VjMuNDc1aC0uOTkxVjExLjFoLjk5NXYtLjM0NGMuMDc2LjA2Ni4xNTguMTI1LjI0NC4xNzd6TTcuODUgNi43Yy4xODYtLjA3OS4zODgtLjExMy41OS0uMWExLjA4IDEuMDggMCAwIDEgLjg5Ni40MjhjLjI1Ny4zNjMuMzgyLjgwMi4zNTcgMS4yNDVhMi40ODUgMi40ODUgMCAwIDEtLjQgMS40ODQgMS4xMzMgMS4xMzMgMCAwIDEtLjk2LjUwOCAxLjIyNCAxLjIyNCAwIDAgMS0uOTc2LS40MTdBMS41MjIgMS41MjIgMCAwIDEgNi45NzUgOC44di0uNmExLjcyMiAxLjcyMiAwIDAgMSAuMzkzLTEuMTQ1Yy4xMy0uMTU0LjI5Ni0uMjc2LjQ4Mi0uMzU1ek0zLjI4OSA1LjY3NWEzLjAzIDMuMDMgMCAwIDAtLjkzNy4xNjIgMi41OSAyLjU5IDAgMCAwLS44LjRsLS4xLjA3N3YxLjJsLjQyMy0uMzU5YTIuMSAyLjEgMCAwIDEgMS4zNjYtLjU3Mi43NTguNzU4IDAgMCAxIC42NjEuMjgyYy4xNS4yMzIuMjMuNTAzLjIzMS43NzlMMi45IDcuODI1YTIuNiAyLjYgMCAwIDAtMS4zNzguNTc1IDEuNjUgMS42NSAwIDAgMC0uMDIyIDIuMzM2IDEuNzM3IDEuNzM3IDAgMCAwIDEuMjUzLjQ1NCAxLjk2IDEuOTYgMCAwIDAgMS4xMDctLjMzMmMuMTAyLS4wNjguMTk3LS4xNDUuMjg2LS4yMjl2LjQ0NGguOTQxVjcuNzE1YTIuMTkzIDIuMTkzIDAgMCAwLS40NjktMS41IDEuNjg3IDEuNjg3IDAgMCAwLTEuMzI5LS41NHptLjg1NyAzLjA0MWMuMDIuNDE4LS4xMi44MjktLjM5MSAxLjE0OGExLjIyMSAxLjIyMSAwIDAgMS0uOTU1LjQyMi44MzIuODMyIDAgMCAxLS42MDgtLjIuODMzLjgzMyAwIDAgMSAwLTEuMDkxYy4yODEtLjE3NC42LS4yNzcuOTMtLjNsMS4wMi0uMTQ4LjAwNC4xNjl6bTguMzEzIDIuMzE3Yy4zMDcuMTMuNjQuMTkzLjk3My4xODIuNDk1LjAxMi45ODMtLjExNCAxLjQxLS4zNjVsLjEyMy0uMDc1LjAxMy0uMDA3VjkuNjE1bC0uNDQ2LjMyYy0uMzE2LjIyNC0uNjk2LjM0LTEuMDg0LjMyOUExLjMgMS4zIDAgMCAxIDEyLjQgOS44YTEuOTc1IDEuOTc1IDAgMCAxLS40LTEuMzEyIDIuMDEgMi4wMSAwIDAgMSAuNDUzLTEuMzgxQTEuNDMyIDEuNDMyIDAgMCAxIDEzLjYgNi42YTEuOCAxLjggMCAwIDEgLjk3MS4yNzlsLjQzLjI2NVY1Ljk3bC0uMTctLjA3M2EyLjkgMi45IDAgMCAwLTEuMTctLjI0NyAyLjUyIDIuNTIgMCAwIDAtMS45MjkuODE3IDIuOSAyLjkgMCAwIDAtLjc0NyAyLjA0OWMtLjAyOC43MDcuMjEgMS40LjY3IDEuOTM5LjIyMi4yNDkuNDk3LjQ0Ni44MDQuNTc4eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTEuNjcgOC42NThhMy42NjEgMy42NjEgMCAwIDAtLjc4MSAxLjExNCAzLjI4IDMuMjggMCAwIDAtLjI2OCAxLjMyOXYxLjZhMS4zMDQgMS4zMDQgMCAwIDEtLjc5NCAxLjE5NyAxLjI4MiAxLjI4MiAwIDAgMS0uNTA5LjEwMkg3LjcxMmExLjI4NSAxLjI4NSAwIDAgMS0uOTIyLS4zNzkgMS4zMDMgMS4zMDMgMCAwIDEtLjM4LS45MnYtMS42YzAtLjQ3OS0uMDkyLS45MjEtLjI3NC0xLjMyOWEzLjU1NiAzLjU1NiAwIDAgMC0uNzc2LTEuMTE0IDQuNjg5IDQuNjg5IDAgMCAxLTEuMDA2LTEuNDM3QTQuMTg3IDQuMTg3IDAgMCAxIDQgNS41YTQuNDMyIDQuNDMyIDAgMCAxIC42MTYtMi4yN2MuMTk3LS4zMzYuNDMyLS42NC43MDUtLjkxNGE0LjYgNC42IDAgMCAxIC45MTEtLjcwMmMuMzM4LS4xOTYuNy0uMzQ4IDEuMDg0LS40NTRhNC40NSA0LjQ1IDAgMCAxIDEuMi0uMTYgNC40NzYgNC40NzYgMCAwIDEgMi4yNzYuNjE0IDQuNDc1IDQuNDc1IDAgMCAxIDEuNjIyIDEuNjE2IDQuNDM4IDQuNDM4IDAgMCAxIC42MTYgMi4yN2MwIC42MTctLjExNyAxLjE5MS0uMzUzIDEuNzIxYTQuNjkgNC42OSAwIDAgMS0xLjAwNiAxLjQzN3pNOS42MjMgMTAuNUg3LjQwOXYyLjIwMWMwIC4wODEuMDI4LjE1LjA5LjIxMmEuMjkuMjkgMCAwIDAgLjIxMy4wOWgxLjYwNmEuMjg5LjI4OSAwIDAgMCAuMjEzLS4wOS4yODYuMjg2IDAgMCAwIC4wOS0uMjEyVjEwLjV6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSA1LjksNiBoIC0xIFYgMyBoIDEwIHYgMTAgaCAtMTAgdiAtMyBoIDEgdiAyIGggOCBWIDQgaCAtOCB6IiAvPg0KPHBhdGggZD0iTSAxLjUsNy41IEggNy43NzE5MTkgTCA2LjQ0Mjk4LDYgNy4xMDc0NSw1LjI1IDkuNCw3LjgzNzY0NjEgViA4LjE2MjM1MzkgTCA3LjEwNzQ1LDEwLjc1IDYuNDQyOTgsMTAgNy43NzE5MTksOC41IEggMS41IFoiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSAxMC41LDYgaCAxIFYgMyBoIC0xMCB2IDEwIGggMTAgdiAtMyBoIC0xIHYgMiBoIC04IFYgNCBoIDggeiIgLz4NCjxwYXRoIGQ9Im0gNyw3LjUgaCA2LjI3MTkxOSBMIDExLjk0Mjk4LDYgMTIuNjA3NDUsNS4yNSAxNC45LDcuODM3NjQ2MSBWIDguMTYyMzUzOSBMIDEyLjYwNzQ1LDEwLjc1IDExLjk0Mjk4LDEwIDEzLjI3MTkxOSw4LjUgSCA3IFoiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMDcyIDguMDI0TDUuNzE1IDMuNjY3bC42MTgtLjYyTDExIDcuNzE2di42MThMNi4zMzMgMTNsLS42MTgtLjYxOSA0LjM1Ny00LjM1N3oiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPg0KPHBhdGggZD0ibSAxNC41LDMuNSAtMSwtMSBtIDAsMCBIIDIuNSBWIDMuMDY1MjMyNCBMIDYuOTg2MTUyNiw4IDcuNSw4LjU2NTIzMjIgViAxMi41MTAzIGwgMSwtMC43MzMzMzMgViA4LjU0ODkxNzggbCA1LC01LjQ5OTk5OTggeiBtIDAsMC41NDg5MTggViA0LjYgbSAwLDAgLTQsNC40IHYgMy4zIGwgLTMsMi4yIFYgOSBsIC01LC01LjUgdiAtMiBoIDEzIHYgMiIgLz4NCjxwYXRoIGQ9Ik0gMy4wMTg3NDI0LDggSCA0IHYgMS41IGggMS41IHYgMSBMIDQsMTAuNDY3Mjg3IFYgMTIgSCAzIFYgMTAuNSBIIDEuNSB2IC0xIEggMyBaIiAvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNy45NzYgMTAuMDcybDQuMzU3LTQuMzU3LjYyLjYxOEw4LjI4NCAxMWgtLjYxOEwzIDYuMzMzbC42MTktLjYxOCA0LjM1NyA0LjM1N3oiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy4yMyAxaC0xLjQ2TDMuNTIgOS4yNWwtLjE2LjIyTDEgMTMuNTkgMi40MSAxNWw0LjEyLTIuMzYuMjItLjE2TDE1IDQuMjNWMi43N0wxMy4yMyAxek0yLjQxIDEzLjU5bDEuNTEtMyAxLjQ1IDEuNDUtMi45NiAxLjU1em0zLjgzLTIuMDZMNC40NyA5Ljc2bDgtOCAxLjc3IDEuNzctOCA4eiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAgM2gzdjFoLTF2OWwtMSAxSDRsLTEtMVY0SDJWM2gzVjJhMSAxIDAgMCAxIDEtMWgzYTEgMSAwIDAgMSAxIDF2MXpNOSAySDZ2MWgzVjJ6TTQgMTNoN1Y0SDR2OXptMi04SDV2N2gxVjV6bTEgMGgxdjdIN1Y1em0yIDBoMXY3SDlWNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xLjQ3OTc4IDEuNDc5N0MxLjMwMjI3IDEuNjU3MjEgMS4yODYxNCAxLjkzNDk4IDEuNDMxMzcgMi4xMzA3MkwxLjQ3OTc4IDIuMTg2OEw0LjE2OTUgNC44NzY1MkMyLjg4ODE3IDUuNzc2MTYgMS45MzA1MiA3LjExOTg1IDEuNTMyNTkgOC43MDk1MkMxLjQ2NTU0IDguOTc3MzggMS42MjgzNCA5LjI0ODkyIDEuODk2MjEgOS4zMTU5OEMyLjE2NDA5IDkuMzgyOTggMi40MzU2IDkuMjIwMjUgMi41MDI2NiA4Ljk1MjMyQzIuODU1NjQgNy41NDIyNSAzLjcyNzQyIDYuMzU5NTYgNC44ODk0NCA1LjU5NjI2TDYuMDk1ODYgNi44MDI3OEM1LjYyNDE5IDcuMjgzNzggNS4zMzMzNCA3Ljk0Mjc4IDUuMzMzMzQgOC42Njk2NUM1LjMzMzM0IDEwLjE0MjQgNi41MjcyNCAxMS4zMzYzIDggMTEuMzM2M0M4LjcyNjk0IDExLjMzNjMgOS4zODU4NyAxMS4wNDU0IDkuODY2OTQgMTAuNTczOEwxMy44MTMxIDE0LjUyMDFDMTQuMDA4NCAxNC43MTU0IDE0LjMyNDkgMTQuNzE1NCAxNC41MjAyIDE0LjUyMDFDMTQuNjk3NyAxNC4zNDI2IDE0LjcxMzkgMTQuMDY0OSAxNC41Njg2IDEzLjg2OTFMMTQuNTIwMiAxMy44MTNMMTAuNDQ0NSA5LjczNjkyTDEwLjQ0NTMgOS43MzU5Mkw5LjY0NTI3IDguOTM3MzJMNy43MzIgNy4wMjQ0NUw3LjczMzM0IDcuMDIzOTJMNS44MTI1MiA1LjEwNTEzTDUuODEzMzQgNS4xMDM5Mkw1LjA1NzgyIDQuMzUwMjRMMi4xODY4OSAxLjQ3OTdDMS45OTE2MyAxLjI4NDQ0IDEuNjc1MDQgMS4yODQ0NCAxLjQ3OTc4IDEuNDc5N1pNNi44MDI3NCA3LjUxMDI1TDkuMTU5NDcgOS44NjY5OEM4Ljg1OTQ3IDEwLjE1NzUgOC40NTA2IDEwLjMzNjMgOCAxMC4zMzYzQzcuMDc5NTQgMTAuMzM2MyA2LjMzMzM0IDkuNTkwMTIgNi4zMzMzNCA4LjY2OTY1QzYuMzMzMzQgOC4yMTkwNSA2LjUxMjE2IDcuODEwMTggNi44MDI3NCA3LjUxMDI1Wk04IDMuNjY2NThDNy4zMzMxNCAzLjY2NjU4IDYuNjg2MDcgMy43NjUzIDYuMDc0MDYgMy45NDk5Mkw2Ljg5ODc0IDQuNzc0MDRDNy4yNTU5NCA0LjcwMzQ2IDcuNjI0MjcgNC42NjY1OCA4IDQuNjY2NThDMTAuNjE1NCA0LjY2NjU4IDEyLjg3MzMgNi40NTM0MiAxMy40OTgxIDguOTU1MzhDMTMuNTY1IDkuMjIzMjUgMTMuODM2NCA5LjM4NjE4IDE0LjEwNDMgOS4zMTkzMkMxNC4zNzIzIDkuMjUyMzggMTQuNTM1MiA4Ljk4MDk4IDE0LjQ2ODMgOC43MTMwNUMxMy43MzI5IDUuNzY4NCAxMS4wNzcgMy42NjY1OCA4IDMuNjY2NThaTTguMTI5OCA2LjAwNjFMMTAuNjY0IDguNTM5OTJDMTAuNTk2MSA3LjE2ODY1IDkuNDk4MTQgNi4wNzE2OCA4LjEyOTggNi4wMDYxWiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMyA5bDIuMTQ2IDIuMTQ2LS43MDcuNzA4LTMtM3YtLjcwOGwzLTMgLjcwNy43MDhMMyA4aDEwbC0yLjE0Ni0yLjE0Ni43MDctLjcwOCAzIDN2LjcwOGwtMyAzLS43MDctLjcwN0wxMyA5SDN6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik03Ljk5OTkzIDYuMDAzMTZDOS40NzI2NiA2LjAwMzE2IDEwLjY2NjYgNy4xOTcwOCAxMC42NjY2IDguNjY5ODFDMTAuNjY2NiAxMC4xNDI2IDkuNDcyNjYgMTEuMzM2NSA3Ljk5OTkzIDExLjMzNjVDNi41MjcxNSAxMS4zMzY1IDUuMzMzMjQgMTAuMTQyNiA1LjMzMzI0IDguNjY5ODFDNS4zMzMyNCA3LjE5NzA4IDYuNTI3MTUgNi4wMDMxNiA3Ljk5OTkzIDYuMDAzMTZaTTcuOTk5OTMgNy4wMDMxNUM3LjA3OTQ2IDcuMDAzMTUgNi4zMzMyNCA3Ljc0OTM1IDYuMzMzMjQgOC42Njk4MUM2LjMzMzI0IDkuNTkwMjggNy4wNzk0NiAxMC4zMzY1IDcuOTk5OTMgMTAuMzM2NUM4LjkyMDQgMTAuMzM2NSA5LjY2NjYgOS41OTAyOCA5LjY2NjYgOC42Njk4MUM5LjY2NjYgNy43NDkzNSA4LjkyMDQgNy4wMDMxNSA3Ljk5OTkzIDcuMDAzMTVaTTcuOTk5OTMgMy42NjY3NUMxMS4wNzU2IDMuNjY2NzUgMTMuNzMwNyA1Ljc2Njc1IDE0LjQ2NzMgOC43MDk2OEMxNC41MzQ0IDguOTc3NTUgMTQuMzcxNiA5LjI0OTA4IDE0LjEwMzcgOS4zMTYxNUMxMy44MzU4IDkuMzgzMTUgMTMuNTY0MyA5LjIyMDQxIDEzLjQ5NzMgOC45NTI0OEMxMi44NzEzIDYuNDUyMDUgMTAuNjE0MSA0LjY2Njc1IDcuOTk5OTMgNC42NjY3NUM1LjM4NDU0IDQuNjY2NzUgMy4xMjY2NCA2LjQ1MzU5IDIuNTAxODIgOC45NTU1NUMyLjQzNDkxIDkuMjIzNDEgMi4xNjM0OCA5LjM4NjM1IDEuODk1NTcgOS4zMTk0OEMxLjYyNzY2IDkuMjUyNTUgMS40NjQ3MSA4Ljk4MTE1IDEuNTMxNjIgOC43MTMyMUMyLjI2NzAxIDUuNzY4NTYgNC45MjI5IDMuNjY2NzUgNy45OTk5MyAzLjY2Njc1WiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMCA3djFINVY3aDV6Ii8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xLjUgMWgxMmwuNS41djEybC0uNS41aC0xMmwtLjUtLjV2LTEybC41LS41ek0yIDEzaDExVjJIMnYxMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMS41IDFoMTJsLjUuNXYxMmwtLjUuNWgtMTJsLS41LS41di0xMmwuNS0uNXpNMiAxM2gxMVYySDJ2MTF6Ii8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04IDRIN3YzSDR2MWgzdjNoMVY4aDNWN0g4VjR6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnDQogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgdmlld0JveD0iMCAwIDExMCAxMTAiDQogICB2ZXJzaW9uPSIxLjEiDQogICB3aWR0aD0iNTAwIg0KICAgaGVpZ2h0PSI1MDAiPg0KICA8cGF0aA0KICAgICBkPSJNIDgyLjE4MjQyMiw4LjA1MjExMDcgQyA1Ni40NDc3NSwtNi45MDE4MTM3IDIzLjQ2MzE4NSwxLjgzNzcyNTggOC41MDkyNzA2LDI3LjU3MjM4IC02LjQ0NDY0MzQsNTMuMzA3MDM0IDIuMjk0ODM1Nyw4Ni4yOTE2MTYgMjguMDI5NTA4LDEwMS4yNDU1NCA1My43NjQxOCwxMTYuMTk5NDYgODYuNzQ4NzQ2LDEwNy40NTk5MyAxMDEuNzAyNjYsODEuNzI1MjcxIDExNi42NTY1Nyw1NS45OTA2MTYgMTA3LjkxNzA5LDIzLjAwNjAzNSA4Mi4xODI0MjIsOC4wNTIxMTA3IFogTSA3MS43NTYwMiwyOC41Nzg1NTMgODIuMjg2ODUsMzguODQ2OTg0IDY1LjQ1MzQ3OSw1Ni4zNzMyOTYgODMuMDY0NzM4LDczLjMxNDMwMSA3Mi43OTY5MzcsODMuODQ0NDg1IDU1LjE2OTczNiw2Ni42NTcwMzkgMzkuMDEwOTk4LDgzLjIyODcxMSAyOC40ODAxNjcsNzIuOTYwMjggNDQuNjM5Mzc4LDU2LjM4OTA2OSAyOC40MTUyMTEsNDAuNTY4NjMxIDM4LjY4MzAxMywzMC4wMzg0NDYgNTQuOTM4ODkzLDQ1Ljg1ODcxIFoiDQogICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuMDY4MTI3NjMiIC8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPgo8cGF0aCBkPSJNIDEuNSw2IFYgMS41IEggNiB2IDEgSCAyLjUgViA2IFoiIC8+CjxwYXRoIGQ9Im0gMTAsMi41IHYgLTEgaCA0LjUgViA2IGggLTEgViAyLjUgWiIgLz4KPHBhdGggZD0ibSAxLjUsMTAgdiA0LjUgSCA2IHYgLTEgSCAyLjUgViAxMCBaIiAvPgo8cGF0aCBkPSJtIDEwLDEzLjUgdiAxIGggNC41IFYgMTAgaCAtMSB2IDMuNSB6IiAvPgo8L3N2Zz4K"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMy41IDExaC0xLjcyOUw4LjQzOCA2SDkuNWwuNS0uNXYtNEw5LjUgMWgtNGwtLjUuNXY0bC41LjVoMS4wNjJsLTMuMzMzIDVIMS41bC0uNS41djNsLjUuNWgzbC41LS41di0zbC0uNS0uNWgtLjA2OEw3LjUgNi40bDMuMDY4IDQuNkgxMC41bC0uNS41djNsLjUuNWgzbC41LS41di0zbC0uNS0uNXpNNiA1VjJoM3YzSDZ6bS0yIDd2Mkgydi0yaDJ6bTkgMmgtMnYtMmgydjJ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC4wMjQgNS45MjhsLTQuMzU3IDQuMzU3LS42Mi0uNjE4TDcuNzE2IDVoLjYxOEwxMyA5LjY2N2wtLjYxOS42MTgtNC4zNTctNC4zNTd6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNC40IDNoMy4wODVhMy40IDMuNCAwIDAgMSAzLjQgMy40di4yMDVBMy40IDMuNCAwIDAgMSA3LjQ4NSAxMEg3VjloLjQ4NUEyLjQgMi40IDAgMCAwIDkuODggNi42MVY2LjRBMi40IDIuNCAwIDAgMCA3LjQ5IDRINC40QTIuNCAyLjQgMCAwIDAgMiA2LjR2LjIwNUEyLjM5NCAyLjM5NCAwIDAgMCA0IDguOTZ2MWEzLjQgMy40IDAgMCAxLTMtMy4zNVY2LjRBMy40MDUgMy40MDUgMCAwIDEgNC40IDN6TTEyIDcuMDR2LTFhMy40IDMuNCAwIDAgMSAzIDMuMzZ2LjIwNUEzLjQwNSAzLjQwNSAwIDAgMSAxMS42MDUgMTNoLTMuMDlBMy40IDMuNCAwIDAgMSA1LjEyIDkuNjFWOS40QTMuNCAzLjQgMCAwIDEgOC41MTUgNkg5djFoLS40ODVBMi40IDIuNCAwIDAgMCA2LjEyIDkuNHYuMjA1QTIuNCAyLjQgMCAwIDAgOC41MTUgMTJoMy4wOUEyLjQgMi40IDAgMCAwIDE0IDkuNjFWOS40YTIuMzk0IDIuMzk0IDAgMCAwLTItMi4zNnoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik05LjAwODg1IDYuOTkxMDNMMTEuMDMzMyAxMS4wMzMyTDYuOTkxMTQgOS4wMDg3NEw0Ljk2NjY2IDQuOTY2NTVMOS4wMDg4NSA2Ljk5MTAzWk05LjQzNTQxIDkuNDM1M0w4LjQ4MDcyIDcuNTE5MTZMNi41NjQ1OCA2LjU2NDQ3TDcuNTE5MjYgOC40ODA2Mkw5LjQzNTQxIDkuNDM1M1oiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEzLjk3OTUgOC41QzEzLjczOSAxMS40MTQ5IDExLjQxNDkgMTMuNzM5IDguNDk5OTkgMTMuOTc5NVYxM0g3LjQ5OTk5VjEzLjk3OTVDNC41NzIzMyAxMy43Mzc5IDIuMjQwNjcgMTEuMzk0NSAyLjAxNzUgOC40NjE2N0gzVjcuNDYxNjdIMi4wMjM4MkMyLjI4MTQxIDQuNTY0NzUgNC41OTc4OCAyLjI1OTk2IDcuNDk5OTkgMi4wMjA1NFYzSDguNDk5OTlWMi4wMjA1NEMxMS40MTQ5IDIuMjYxMDEgMTMuNzM5IDQuNTg1MSAxMy45Nzk1IDcuNUgxM1Y4LjVIMTMuOTc5NVpNOCAxNUMxMS44NjYgMTUgMTUgMTEuODY2IDE1IDhDMTUgNC4xMzQwMSAxMS44NjYgMSA4IDFDNC4xMzQwMSAxIDEgNC4xMzQwMSAxIDhDMSAxMS44NjYgNC4xMzQwMSAxNSA4IDE1WiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC42IDFjMS42LjEgMy4xLjkgNC4yIDIgMS4zIDEuNCAyIDMuMSAyIDUuMSAwIDEuNi0uNiAzLjEtMS42IDQuNC0xIDEuMi0yLjQgMi4xLTQgMi40LTEuNi4zLTMuMi4xLTQuNi0uNy0xLjQtLjgtMi41LTItMy4xLTMuNUMuOSA5LjIuOCA3LjUgMS4zIDZjLjUtMS42IDEuNC0yLjkgMi44LTMuOEM1LjQgMS4zIDcgLjkgOC42IDF6bS41IDEyLjljMS4zLS4zIDIuNS0xIDMuNC0yLjEuOC0xLjEgMS4zLTIuNCAxLjItMy44IDAtMS42LS42LTMuMi0xLjctNC4zLTEtMS0yLjItMS42LTMuNi0xLjctMS4zLS4xLTIuNy4yLTMuOCAxLTEuMS44LTEuOSAxLjktMi4zIDMuMy0uNCAxLjMtLjQgMi43LjIgNCAuNiAxLjMgMS41IDIuMyAyLjcgMyAxLjIuNyAyLjYuOSAzLjkuNnpNNy45IDcuNUwxMC4zIDVsLjcuNy0yLjQgMi41IDIuNCAyLjUtLjcuNy0yLjQtMi41LTIuNCAyLjUtLjctLjcgMi40LTIuNS0yLjQtMi41LjctLjcgMi40IDIuNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMS41IDFoMnYxSDJ2MTJoMS41djFoLTJsLS41LS41di0xM2wuNS0uNXptNiA2aC0yTDUgNi41di0ybC41LS41aDJsLjUuNXYybC0uNS41ek02IDZoMVY1SDZ2MXptNy41IDFoLTNsLS41LS41di0zbC41LS41aDNsLjUuNXYzbC0uNS41ek0xMSA2aDJWNGgtMnYyem0tMy41IDZoLTJsLS41LS41di0ybC41LS41aDJsLjUuNXYybC0uNS41ek02IDExaDF2LTFINnYxem03LjUgMmgtM2wtLjUtLjV2LTNsLjUtLjVoM2wuNS41djNsLS41LjV6TTExIDEyaDJ2LTJoLTJ2MnptLTEtMkg4djFoMnYtMXptMC01SDh2MWgyVjV6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMi45IDFMNSAzLjFsLS44LjdMMyAyLjZWN0gyVjIuNUwuOCAzLjhsLS43LS43TDIuMiAxaC43ek0zIDEzLjRWOUgydjQuNEwuOCAxMi4ybC0uNy43TDIuMiAxNWguN0w1IDEyLjlsLS43LS43TDMgMTMuNHpNOC41IDdoLTJMNiA2LjV2LTJsLjUtLjVoMmwuNS41djJsLS41LjV6TTcgNmgxVjVIN3Yxem03LjUgMWgtM2wtLjUtLjV2LTNsLjUtLjVoM2wuNS41djNsLS41LjV6TTEyIDZoMlY0aC0ydjJ6bS0zLjUgNmgtMmwtLjUtLjV2LTJsLjUtLjVoMmwuNS41djJsLS41LjV6TTcgMTFoMXYtMUg3djF6bTcuNSAyaC0zbC0uNS0uNXYtM2wuNS0uNWgzbC41LjV2M2wtLjUuNXpNMTIgMTJoMnYtMmgtMnYyem0tMS0ySDl2MWgydi0xem0wLTVIOXYxaDJWNXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNyAxSDZ2M0g0LjVsLS41LjVWOGE0IDQgMCAwIDAgMy41IDMuOTY5VjE1aDF2LTMuMDMxQTQgNCAwIDAgMCAxMiA4VjQuNWwtLjUtLjVIMTBWMUg5djNIN1Yxem0zLjEyMSA5LjEyMUEzIDMgMCAwIDEgNSA4VjVoNnYzYTMgMyAwIDAgMS0uODc5IDIuMTIxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xLjUgMTRoMTFsLjQ4LS4zNyAyLjYzLTctLjQ4LS42M0gxNFYzLjVsLS41LS41SDcuNzFsLS44Ni0uODVMNi41IDJoLTVsLS41LjV2MTFsLjUuNXpNMiAzaDQuMjlsLjg2Ljg1LjM1LjE1SDEzdjJIOC41bC0uMzUuMTUtLjg2Ljg1SDMuNWwtLjQ3LjM0LTEgMy4wOEwyIDN6bTEwLjEzIDEwSDIuMTlsMS42Ny01SDcuNWwuMzUtLjE1Ljg2LS44NWg1Ljc5bC0yLjM3IDZ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuMzUzIDEuMTQ2bDEuNSAxLjVMMTUgM3YxMS41bC0uNS41aC0xM2wtLjUtLjV2LTEzbC41LS41SDEzbC4zNTMuMTQ2ek0yIDJ2MTJoMTJWMy4yMDhMMTIuNzkzIDJIMTF2NEg0VjJIMnptNiAwdjNoMlYySDh6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMiAyaDZ2My41bC41LjVIMTJ2MWgxVjQuOGwtLjE1LS4zNi0zLjI4LTMuM0w5LjIyIDFIMS41bC0uNS41djEzbC41LjVINXYtMUgyVjJ6bTcgMGwzIDNIOVYyem01LjUgNmgtOGwtLjUuNXY2bC41LjVoOGwuNS0uNXYtNmwtLjUtLjV6TTE0IDl2NGwtMS42My0xLjZoLS43MWwtMS4xNiAxLjE3LTIuMTMtMi4xM2gtLjcxTDcgMTEuMVY5aDd6bS0yLjggNC4yN2wuODEtLjgxTDEzLjU1IDE0aC0xLjYybC0uNzMtLjczek03IDE0di0xLjQ5bDEtMUwxMC41MiAxNEg3em01LjUtMy41YS41LjUgMCAxIDAgMC0xIC41LjUgMCAwIDAgMCAxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuODUgNC40NGwtMy4yOC0zLjMtLjM1LS4xNEgyLjVsLS41LjVWN2gxVjJoNnYzLjVsLjUuNUgxM3YxaDFWNC44bC0uMTUtLjM2ek0xMCA1VjJsMyAzaC0zek0yLjUgOGwtLjUuNXY2bC41LjVoMTFsLjUtLjV2LTZsLS41LS41aC0xMXpNMTMgMTN2MUgzVjloMTB2NHptLTgtMWgtLjMydjFINHYtM2gxLjA2Yy43NSAwIDEuMTMuMzYgMS4xMyAxYS45NC45NCAwIDAgMS0uMzIuNzJBMS4zMyAxLjMzIDAgMCAxIDUgMTJ6bS0uMDYtMS40NWgtLjI2di45M2guMjZjLjM2IDAgLjU0LS4xNi41NC0uNDcgMC0uMzEtLjE4LS40Ni0uNTQtLjQ2ek05IDEyLjU4YTEuNDggMS40OCAwIDAgMCAuNDQtMS4xMmMwLTEtLjUzLTEuNDYtMS42LTEuNDZINi43OHYzaDEuMDZBMS42IDEuNiAwIDAgMCA5IDEyLjU4em0tMS41NS0uMTN2LTEuOWguMzNhLjk0Ljk0IDAgMCAxIC43LjI1LjkxLjkxIDAgMCAxIC4yNS42NyAxIDEgMCAwIDEtLjI1LjcyLjk0Ljk0IDAgMCAxLS42OS4yNmgtLjM0em00LjQ1LS42MWgtLjk3VjEzaC0uNjh2LTNoMS43NHYuNTVoLTEuMDZ2Ljc0aC45N3YuNTV6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMy41IDJ2My41TDQgNmgzLjVWNUg0Ljk3OWwuOTQxLS45NDFhMy41NTIgMy41NTIgMCAxIDEgNS4wMjMgNS4wMjNMNS43NDYgMTQuMjhsLjcyLjcyIDUuMTk4LTUuMTk4QTQuNTcgNC41NyAwIDAgMCA1LjIgMy4zMzlsLS43LjdWMmgtMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNSAydjMuNUwxMiA2SDguNVY1aDIuNTIxbC0uOTQxLS45NDFhMy41NTIgMy41NTIgMCAxIDAtNS4wMjMgNS4wMjNsNS4xOTcgNS4xOTgtLjcyLjcyLTUuMTk4LTUuMTk4QTQuNTcgNC41NyAwIDAgMSAxMC44IDMuMzM5bC43LjdWMmgxeiIvPjwvc3ZnPg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOC41IDFhNi41IDYuNSAwIDEgMSAwIDEzIDYuNSA2LjUgMCAwIDEgMC0xM3ptNC44OTQgNGE1LjUyNyA1LjUyNyAwIDAgMC0zLjA1My0yLjY3NmMuNDQ0Ljg0Ljc2NSAxLjc0Ljk1MyAyLjY3NmgyLjF6bS41ODIgMi45OTVBNS4xMSA1LjExIDAgMCAwIDE0IDcuNWE1LjQ2NCA1LjQ2NCAwIDAgMC0uMjEzLTEuNWgtMi4zNDJjLjAzMi4zMzEuMDU1LjY2NC4wNTUgMWExMC4xMTQgMTAuMTE0IDAgMCAxLS4yMDYgMmgyLjQ5M2MuMDk1LS4zMjkuMTU4LS42NjUuMTktMS4wMDV6bS0zLjUzNSAwbC4wMDYtLjA1MUE5LjA0IDkuMDQgMCAwIDAgMTAuNSA3YTguOTk0IDguOTk0IDAgMCAwLS4wNzYtMUg2LjU3NkE4LjgyIDguODIgMCAwIDAgNi41IDdhOC45OCA4Ljk4IDAgMCAwIC4yMzMgMmgzLjUzNGMuMDc3LS4zMzIuMTM1LS42NjcuMTc0LTEuMDA1ek0xMC4yNDkgNWE4Ljk3NCA4Ljk3NCAwIDAgMC0xLjI1NS0yLjk3QzguODMgMi4wMTYgOC42NjYgMiA4LjUgMmEzLjYyIDMuNjIgMCAwIDAtLjMxMi4wMTVsLS4xODIuMDE1TDggMi4wNEE4Ljk3IDguOTcgMCAwIDAgNi43NTEgNWgzLjQ5OHpNNS43MDYgNWE5Ljk1OSA5Ljk1OSAwIDAgMSAuOTY2LTIuNjgxQTUuNTI3IDUuNTI3IDAgMCAwIDMuNjA2IDVoMi4xek0zLjIxMyA2QTUuNDggNS40OCAwIDAgMCAzIDcuNSA1LjQ4IDUuNDggMCAwIDAgMy4yMTMgOWgyLjQ5M0ExMC4wMTYgMTAuMDE2IDAgMCAxIDUuNSA3YzAtLjMzNi4wMjMtLjY2OS4wNTUtMUgzLjIxM3ptMi43NTQgNGgtMi4zNmE1LjUxNSA1LjUxNSAwIDAgMCAzLjgxOSAyLjg5M0ExMC4wMjMgMTAuMDIzIDAgMCAxIDUuOTY3IDEwek04LjUgMTIuNjQ0QTguOTQyIDguOTQyIDAgMCAwIDkuOTc4IDEwSDcuMDIyQTguOTQzIDguOTQzIDAgMCAwIDguNSAxMi42NDR6TTExLjAzMyAxMGExMC4wMjQgMTAuMDI0IDAgMCAxLTEuNDU5IDIuODkzQTUuNTE3IDUuNTE3IDAgMCAwIDEzLjM5MyAxMGgtMi4zNnoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDI3IDYuMTQ5YTUuNTIgNS41MiAwIDAgMS0xLjI3IDMuOTA4bDQuMjYgNC4yNi0uNy43MS00LjI2LTQuMjdhNS41MiA1LjUyIDAgMSAxIDEuOTctNC42MDh6bS01LjQ1IDQuODg4YTQuNTEgNC41MSAwIDAgMCAzLjE4LTEuMzJsLS4wNC4wMmE0LjUxIDQuNTEgMCAwIDAgMS4zNi0zLjIgNC41IDQuNSAwIDEgMC00LjUgNC41em0yLjQ0LTR2LTFoLTJ2LTJoLTF2MmgtMnYxaDJ2Mmgxdi0yaDJ6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDI3IDYuMTQ5YTUuNTIgNS41MiAwIDAgMS0xLjI3IDMuOTA4bDQuMjYgNC4yNi0uNy43MS00LjI2LTQuMjdhNS41MiA1LjUyIDAgMSAxIDEuOTctNC42MDh6bS01LjQ1IDQuODg4YTQuNTEgNC41MSAwIDAgMCAzLjE4LTEuMzJsLS4wNC4wMmE0LjUxIDQuNTEgMCAwIDAgMS4zNi0zLjIgNC41IDQuNSAwIDEgMC00LjUgNC41em0tMi41NC00Ljk4aDV2MWgtNXYtMXoiLz48L3N2Zz4="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAzbDEtMWgxMmwxIDF2NmgtMVYzSDJ2OGg1djFIMmwtMS0xVjN6bTE0LjcwNyA5LjcwN0w5IDZ2OS40MTRsMi43MDctMi43MDdoNHpNMTAgMTNWOC40MTRsMy4yOTMgMy4yOTNoLTJMMTAgMTN6Ii8+PC9zdmc+"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNS45MjggNy45NzZsNC4zNTcgNC4zNTctLjYxOC42Mkw1IDguMjg0di0uNjE4TDkuNjY3IDNsLjYxOC42MTktNC4zNTcgNC4zNTd6Ii8+PC9zdmc+"},(e,t,n)=>{function i(e,t){return e.then((e=>t&&t.aborted?null:e),(e=>t&&t.aborted?null:Promise.reject(e)))}function r(e,t){if(!t)return e;let n;const i=new Promise(((e,i)=>{n=()=>{t.removeEventListener("abort",r),n=void 0};const r=()=>{n?.();try{t.throwIfAborted()}catch(e){i(e)}i(new Error("Failed to throw abort error"))};t.addEventListener("abort",r)}));return Promise.race([e,i]).then((e=>(n?.(),e)))}async function o(e,t,n){const{timeout:i,signal:r}=n,o=new s(r),{signal:l}=o;try{const n=new Map;let r;for(const o of e){l.throwIfAborted(),n.set(o,t(o,l).then((e=>({type:"resolve",result:e})),(()=>({type:"reject",variant:o}))));const e=a(i,{signal:l}).then((()=>({type:"timeout"})));e:for(;n.size>0;){const t=await Promise.race([...n.values(),e]);switch(t.type){case"resolve":return t.result;case"reject":if(n.delete(t.variant),t.variant===r)break e;break;case"timeout":break e}}r=o}}finally{o.abort()}throw new Error("No variants left to attempt")}n.r(t),n.d(t,{AbortScope:()=>s,AsyncLock:()=>l,delay:()=>a,mapAbortedToNull:()=>i,raceAbortSignal:()=>r,raceHappyEyes:()=>o});class s{controller;parentSignal;onAbort;constructor(e){this.controller=new AbortController,e&&(this.parentSignal=void 0,this.onAbort=()=>this.controller.abort(),e.addEventListener("abort",this.onAbort))}get signal(){return this.controller.signal}[Symbol.dispose](){this.controller.abort(),this.parentSignal&&this.onAbort&&this.parentSignal.removeEventListener("abort",this.onAbort)}abort(){this[Symbol.dispose]()}}function a(e,t){const n=t?.signal;return new Promise(((t,i)=>{let r;const o=setTimeout((()=>{n&&r&&n.removeEventListener("abort",r),t()}),e);if(n){if(n.aborted)try{n.throwIfAborted()}catch(s){i(s)}r=()=>{clearTimeout(o),n.removeEventListener("abort",r);try{n.throwIfAborted()}catch(s){i(s)}},n.addEventListener("abort",r)}}))}class l{active;acquire(){let e;const t=new Promise(((t,n)=>{e={resolve:t,reject:n,token:{release:()=>this.release(e)}}}));return this.active?this.active.next=e:(this.active=e,this.activate()),t}release(e){return this.active===e&&(this.active=this.active.next,this.activate()),Promise.resolve()}activate(){this.active&&this.active.resolve(this.active.token)}dispose(){let e=this.active;for(;e;)e.reject(new Error("AsyncLock is disposed")),e=e.next}}},(e,t,n)=>{function i(e,t,n){let i=e.get(t);i||(i=[],e.set(t,i)),i.push(n)}function r(e,t,n){let i=e.get(t);i||(i=new Set,e.set(t,i)),i.add(n)}function o(e,t,n){const i=e.get(t);i&&(i.delete(n),0===i.size&&e.delete(t))}function s(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.r(t),n.d(t,{OrderedMap:()=>a,moveComparator:()=>l,multimapAdd:()=>r,multimapArrayAdd:()=>i,multimapDelete:()=>o,shallowArrayEqual:()=>s});class a{mapping=new Map;ordered=[];reorder(e){this.ordered.sort(e)}get items(){return this.ordered}get(e){return this.mapping.get(e)}push(e,t){if(this.mapping.has(e)){const n=this.mapping.get(e);if(n===t)return;const i=this.ordered.indexOf(n);this.ordered.splice(i,1)}this.mapping.set(e,t),this.ordered.push(t)}delete(e){if(!this.mapping.has(e))return;const t=this.mapping.get(e),n=this.ordered.indexOf(t);return this.ordered.splice(n,1),this.mapping.delete(e),t}}function l(e,t,n){const i=new Map,r=("start"===n?-1:1)*e.length;e.forEach(((e,t)=>{i.set(e,t)}));for(const o of t)i.set(o,r+i.get(o));return(e,t)=>{const n=i.get(e),r=i.get(t);return n>r?1:n<r?-1:0}}},(e,t,n)=>{n.r(t),n.d(t,{EventObserver:()=>r,EventSource:()=>i});class i{listeners=new Map;anyListeners;on(e,t){let n=this.listeners.get(e);n||(n=new Set,this.listeners.set(e,n)),n.add(t)}onAny(e){let t=this.anyListeners;t||(t=new Set,this.anyListeners=t),t.add(e)}off(e,t){const n=this.listeners.get(e);n&&n.delete(t)}offAny(e){const t=this.anyListeners;t&&t.delete(e)}trigger(e,t){const n=this.listeners.get(e);if(n)for(const i of n)i(t);if(this.anyListeners)for(const i of this.anyListeners)i({[e]:t})}}class r{onDispose=new Set;listen(e,t,n){e.on(t,n),this.onDispose.add((()=>e.off(t,n)))}listenAny(e,t){e.onAny(t),this.onDispose.add((()=>e.offAny(t)))}listenOnce(e,t,n){let i;const r=o=>{e.off(t,r),this.onDispose.delete(i),n(o)};i=()=>{e.off(t,r),this.onDispose.delete(i)},e.on(t,r),this.onDispose.add(i)}stopListening(){for(const e of this.onDispose)e();this.onDispose.clear()}}},(e,t,n)=>{n.r(t),n.d(t,{HashMap:()=>i,HashSet:()=>r});class i{hashKey;equalKeys;map=new Map;_size=0;constructor(e,t){this.hashKey=e,this.equalKeys=t}get size(){return this._size}has(e){const t=this.map.get(this.hashKey(e));if(!t)return!1;if(!Array.isArray(t))return this.equalKeys(t.k,e);for(const n of t)if(this.equalKeys(n.k,e))return!0;return!1}get(e){const t=this.map.get(this.hashKey(e));if(t)if(Array.isArray(t)){for(const n of t)if(this.equalKeys(n.k,e))return n.v}else if(this.equalKeys(t.k,e))return t.v}set(e,t){const n=this.hashKey(e);let i=this.map.get(n);if(i)if(Array.isArray(i)){let n=-1;for(let t=0;t<i.length;t++)if(this.equalKeys(i[t].k,e)){n=t;break}n>=0?i.splice(n,1):this._size++,i.push({k:e,v:t})}else if(this.equalKeys(i.k,e))this.map.set(n,{k:e,v:t});else{i=[i,{k:e,v:t}],this.map.set(n,i),this._size++}else i={k:e,v:t},this.map.set(n,i),this._size++;return this}delete(e){const t=this.hashKey(e),n=this.map.get(t);if(!n)return!1;if(Array.isArray(n)){for(let i=0;i<n.length;i++)if(this.equalKeys(n[i].k,e))return n.splice(i,1),this._size--,0===n.length&&this.map.delete(t),!0}else if(this.equalKeys(n.k,e))return this.map.delete(t),this._size--,!0;return!1}clear(){this.map.clear(),this._size=0}clone(){const e=new i(this.hashKey,this.equalKeys);e._size=this.size;for(const[t,n]of this.map)e.map.set(t,Array.isArray(n)?[...n]:n);return e}forEach(e){for(const[t,n]of this)e(n,t,this)}*keys(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield t.k;else yield e.k}*values(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield t.v;else yield e.v}*entries(){for(const e of this.map.values())if(Array.isArray(e))for(const t of e)yield[t.k,t.v];else yield[e.k,e.v]}[Symbol.iterator](){return this.entries()}}class r{hashCode;equals;map;constructor(e,t){this.hashCode=e,this.equals=t,this.map=new i(e,t)}get size(){return this.map.size}has(e){return this.map.has(e)}add(e){return this.map.set(e,e),this}delete(e){return this.map.delete(e)}clear(){this.map.clear()}clone(){const e=new r(this.hashCode,this.equals);return this.forEach((t=>e.add(t))),e}forEach(e){this.map.forEach(((t,n)=>e(t,n,this)))}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map.keys()}}},(e,t,n)=>{n.r(t),n.d(t,{neverSyncStore:()=>l,useEventStore:()=>c,useFrameDebouncedStore:()=>d,useObservedProperty:()=>o,useSyncStore:()=>u,useSyncStoreWithComparator:()=>h});var i=n(61),r=n(62);function o(e,t,n){return u(c(e,t),n)}const s=()=>{},a=()=>s;function l(){return a}function c(e,t){return i.useCallback((n=>e?(e.on(t,n),()=>e.off(t,n)):s),[e,t])}function d(e){return i.useCallback((t=>{let n;const i=()=>{n=void 0,t()},r=e((()=>{void 0===n&&(n=requestAnimationFrame(i))}));return()=>{void 0!==n&&cancelAnimationFrame(n),r()}}),[e])}function u(e,t){return(0,r.useSyncExternalStore)(e,t)}function h(e,t,n){const o=i.useRef();return(0,r.useSyncExternalStore)(e,(()=>{const e=t();if(o.current){const[t]=o.current;if(n(t,e))return t}return o.current=[e],e}))}},e=>{e.exports=ve},(e,t,n)=>{e.exports=n(63)},(e,t,n)=>{var i=n(61);var r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=i.useState,s=i.useEffect,a=i.useLayoutEffect,l=i.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(i){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=o({inst:{value:n,getSnapshot:t}}),r=i[0].inst,d=i[1];return a((function(){r.value=n,r.getSnapshot=t,c(r)&&d({inst:r})}),[e,n,t]),s((function(){return c(r)&&d({inst:r}),e((function(){c(r)&&d({inst:r})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:d},(e,t,n)=>{0},(e,t,n)=>{n.r(t),n.d(t,{KeyedObserver:()=>r,useKeyedSyncStore:()=>o});var i=n(61);class r{subscribe;observedKeys=new Map;constructor(e){this.subscribe=e}setSubscribe(e){this.subscribe=e}observe(e){if(0===e.length&&0===this.observedKeys.size)return;const t=new Map;for(const n of e){if(t.has(n))continue;let e=this.observedKeys.get(n);e||(e=this.subscribe(n)),e&&t.set(n,e)}this.observedKeys.forEach(((e,n)=>{t.has(n)||e()})),this.observedKeys=t}stopListening(){this.observe([])}}function o(e,t,n){const[,o]=i.useState(0),s=i.useRef();let a=s.current;if(!a){const t=()=>o((e=>e+1));a={observer:new r((i=>e(i,n,t))),forceUpdate:t,lastStore:e},s.current=a}if(a.lastStore!==e){const{observer:t,forceUpdate:i}=a;t.setSubscribe((t=>e(t,n,i))),a.lastStore=e}a.observer.observe(t),i.useEffect((()=>()=>s.current?.observer.stopListening()),[])}},(e,t,n)=>{n.r(t),n.d(t,{defineWorker:()=>r,useWorker:()=>a});var i=n(61);function r(e,t){return{[o]:()=>({instance:new l(e,t),refCount:0}),[s]:void 0}}const o=Symbol("WorkerDefinition.construct"),s=Symbol("WorkerDefinition.state");function a(e){i.useEffect((()=>{let t=e[s];return t||(t=e[o](),e[s]=t),t.refCount++,()=>{const t=e[s];t&&(t.refCount--,t.refCount<=0&&t.instance.disconnect())}}),[e]);let t=e[s];return t||(t=e[o](),e[s]=t),t.instance.proxy}class l{workerFactory;constructorArgs;static PROXY_OWNER=Symbol("LazyWorkerProxy.owner");connectionState;methods=new Map;proxy;constructor(e,t){this.workerFactory=e,this.constructorArgs=t,this.connectionState={type:"initial"};const n={[l.PROXY_OWNER]:this};this.proxy=new Proxy(n,{get:(e,t)=>{if("string"!=typeof t)return;return e[l.PROXY_OWNER].getMethod(t)}})}getMethod(e){let t=this.methods.get(e);return t||(t=async(...t)=>{const[n,i]=await this.ensureConnection();return n.call(e,t,{signal:i})}),t}async ensureConnection(){switch(this.connectionState.type){case"initial":{const e=this.connectionState,t=new AbortController,n=this.connect(e,t.signal).then((e=>{const[n,i]=e;return i.aborted&&n.dispose(),i.throwIfAborted(),this.connectionState={type:"connected",connection:n,controller:t},e}));return this.connectionState={type:"connecting",request:n,controller:t},n}case"connecting":{const{request:e}=this.connectionState;return e}case"connected":{const{connection:e,controller:t}=this.connectionState;return Promise.resolve([e,t.signal])}}}async connect(e,t){t.throwIfAborted();const{workerFactory:n,constructorArgs:i}=this,r=new c(n());return await r.call("constructor",i,{signal:t}),[r,t]}disconnect(){switch(this.connectionState.type){case"connecting":{const{controller:e}=this.connectionState;e.abort();break}case"connected":{const{connection:e,controller:t}=this.connectionState;t.abort(),e.dispose();break}}this.connectionState={type:"initial"}}}class c{worker;requests=new Map;nextCallId=1;constructor(e){this.worker=e,this.worker.addEventListener("message",this.onMessage),this.worker.addEventListener("error",this.onError)}call(e,t,n){const i=this.nextCallId++,r=new Promise(((e,t)=>{this.requests.set(i,{resolve:e,reject:t})})),o={type:"call",id:i,method:e,args:t};return this.worker.postMessage(o),r}onMessage=e=>{const t=e.data,n=this.requests.get(t.id);if(n)switch(this.requests.delete(t.id),t.type){case"success":n.resolve(t.result);break;case"error":n.reject(t.error);break;default:console.warn(`Unexpected worker response type: ${t.type}`)}};onError=e=>{const t=Array.from(this.requests.values());this.requests.clear();for(const n of t)n.reject(e)};dispose(){this.worker.removeEventListener("message",this.onMessage),this.worker.removeEventListener("error",this.onError),this.worker.terminate()}[Symbol.dispose](){this.dispose()}}},(e,t,n)=>{n.r(t),n.d(t,{BufferingQueue:()=>r,Debouncer:()=>i,animateInterval:()=>o,easeInOutBezier:()=>s});class i{scheduled;_timeout;callback;constructor(e="frame"){this._timeout=e,this.runSynchronously=this.runSynchronously.bind(this)}get timeout(){return this._timeout}setTimeout(e){this._timeout=e}call(e){this.callback=e,this.schedule()}schedule(){void 0===this.scheduled&&("frame"===this.timeout?this.scheduled=requestAnimationFrame(this.runSynchronously):this.scheduled=setTimeout(this.runSynchronously,this.timeout))}run(){const e=this.callback;e?.()}runSynchronously(){this.cancelScheduledTimeout()&&this.run()}dispose(){this.cancelScheduledTimeout()}cancelScheduledTimeout(){return void 0!==this.scheduled&&("frame"===this.timeout?cancelAnimationFrame(this.scheduled):clearTimeout(this.scheduled),this.scheduled=void 0,!0)}}class r{onFetch;debouncer;queuedItems=new Set;constructor(e,t=200){this.onFetch=e,this.debouncer=new i(t)}has(e){return this.queuedItems.has(e)}push(e){this.queuedItems.add(e),this.debouncer.call(this.run)}clear(){this.queuedItems.clear()}run=()=>{const{queuedItems:e,onFetch:t}=this,n=Array.from(e);e.clear(),t(n)}}function o(e,t,n){return new Promise((i=>{let r,o,s;const a=l=>{if(n&&n.aborted)return;o=o||l;let c=l-o;c>e&&(c=e),t(c/e),c<e?r=requestAnimationFrame(a):(s?.(),i())};if(n){const e=()=>{cancelAnimationFrame(r),s?.(),i()};s=()=>{n.removeEventListener("abort",e)},n.addEventListener("abort",e)}r=requestAnimationFrame(a)}))}function s(e){return e<0?0:e>1?1:e*e*(3-2*e)}},(e,t,n)=>{n.r(t),n.d(t,{equalElements:()=>u,equalLinks:()=>c,equalProperties:()=>p,equalSubtypeEdges:()=>l,hashLink:()=>d,hashSubtypeEdge:()=>a,isEncodedBlank:()=>s});var i=n(57),r=n(69),o=n(70);function s(e){return e.startsWith("urn:reactodia:blank:")}function a(e){const[t,n]=e;let i=o.hashString(t);return i=o.chainHash(i,o.hashString(n)),o.dropHighestNonSignBit(i)}function l(e,t){const[n,i]=e,[r,o]=t;return n===r&&i===o}function c(e,t){return e.linkTypeId===t.linkTypeId&&e.sourceId===t.sourceId&&e.targetId===t.targetId}function d(e){const{linkTypeId:t,sourceId:n,targetId:i}=e;let o=(0,r.hashFnv32a)(t);return o=31*o+(0,r.hashFnv32a)(n),o=31*o+(0,r.hashFnv32a)(i),o}function u(e,t){return e.id===t.id&&(0,i.shallowArrayEqual)(e.types,t.types)&&h(e.label,t.label)&&e.image===t.image&&p(e.properties,t.properties)}function h(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!o.equalTerms(e[n],t[n]))return!1;return!0}function p(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(!Object.prototype.hasOwnProperty.call(t,n))return!1;if(!h(e[n],t[n]))return!1}for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}},(e,t,n)=>{function i(){function e(){return Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function r(e,t=2166136261){let n,i,r=2147483647&t;for(n=0,i=e.length;n<i;n++)r^=e.charCodeAt(n),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24);return r>>>0}n.r(t),n.d(t,{generate128BitID:()=>i,hashFnv32a:()=>r})},(e,t,n)=>{n.r(t),n.d(t,{DefaultDataFactory:()=>s,chainHash:()=>u,dropHighestNonSignBit:()=>h,equalQuads:()=>f,equalTerms:()=>p,getLocalName:()=>m,hashQuad:()=>g,hashString:()=>d,hashTerm:()=>c,looksLikeTerm:()=>a,termToString:()=>l});var i=n(71),r=n(69),o=n(72);const s=i.DataFactory;function a(e){if(!("object"==typeof e&&e&&"termType"in e&&"equals"in e&&"function"==typeof e.equals))return!1;const{termType:t}=e;switch(t){case"NamedNode":case"Literal":case"BlankNode":case"DefaultGraph":case"Variable":case"Quad":return!0;default:return!1}}function l(e){switch(e.termType){case"NamedNode":return`<${(0,o.escapeRdfValue)(e.value)}>`;case"BlankNode":return`_:${e.value}`;case"Literal":{const{value:t,language:n,datatype:i}=e,r=`"${(0,o.escapeRdfValue)(t)}"`;return n?r+`@${n}`:i?r+"^^"+l(i):r}case"DefaultGraph":return"(default graph)";case"Variable":return`?${e.value}`;case"Quad":{let t="<< ";return t+=l(e.subject)+" ",t+=l(e.predicate)+" ",t+=l(e.object)+" ","DefaultGraph"!==e.graph.termType&&(t+=l(e.graph)+" "),t+=">>",t}}}function c(e){let t=0;switch(e.termType){case"NamedNode":case"BlankNode":case"Variable":t=(0,r.hashFnv32a)(e.value);break;case"Literal":t=(0,r.hashFnv32a)(e.value),e.datatype&&(t=Math.imul(t,31)+(0,r.hashFnv32a)(e.datatype.value)|0),e.language&&(t=Math.imul(t,31)+(0,r.hashFnv32a)(e.language)|0);break;case"Quad":t=Math.imul(t,31)+c(e.subject)|0,t=Math.imul(t,31)+c(e.predicate)|0,t=Math.imul(t,31)+c(e.object)|0,t=Math.imul(t,31)+c(e.graph)|0}return h(t)}function d(e){return(0,r.hashFnv32a)(e)}function u(e,t){return Math.imul(e,31)+t|0}function h(e){return e>>>1&1073741824|3221225471&e}function p(e,t){if(e.termType!==t.termType)return!1;switch(e.termType){case"NamedNode":case"BlankNode":case"Variable":case"DefaultGraph":{const{value:n}=t;return e.value===n}case"Literal":{const{value:n,language:i,datatype:r}=t;return e.value===n&&e.datatype.value===r.value&&e.language===i}case"Quad":{const{subject:n,predicate:i,object:r,graph:o}=t;return p(e.subject,n)&&p(e.predicate,i)&&p(e.object,r)&&p(e.graph,o)}}}function g(e){return c(e)}function f(e,t){return p(e,t)}function m(e){let t=e.indexOf("#");if(t<0&&(t=e.lastIndexOf("/")),t<0&&(t=e.lastIndexOf(":")),!(t<0))return e.substring(t+1)}},e=>{e.exports=xe},(e,t,n)=>{function i(e){return r.test(e)?e.replace(o,a):e}n.r(t),n.d(t,{escapeRdfValue:()=>i});const r=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,o=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,s={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e){let t=s[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t),n.d(t,{DIAGRAM_CONTEXT_URL_V1:()=>i,PLACEHOLDER_ELEMENT_TYPE:()=>r,PLACEHOLDER_LINK_TYPE:()=>o,TemplateProperties:()=>s});const i="https://ontodia.org/context/v1.json",r="urn:reactodia:newElement",o="urn:reactodia:newLink";var s;!function(e){e.PinnedProperties="urn:reactodia:pinnedProperties",e.CustomLabel="urn:reactodia:customLabel",e.LayoutOnly="urn:reactodia:layoutOnly",e.GroupPageIndex="urn:reactodia:groupPageIndex",e.GroupPageSize="urn:reactodia:groupPageSize"}(s||(s={}))},(e,t,n)=>{n.r(t),n.d(t,{CompositeDataProvider:()=>o});var i=n(70),r=n(76);class o{providers;constructor(e){const{providers:t}=e;this.providers=t}get factory(){return this.providers.length>0?this.providers[0].provider.factory:i.DefaultDataFactory}async requestWithMerge(e,t){return t(await Promise.all(this.providers.map((t=>e(t.provider).then((e=>[e,t]))))))}knownElementTypes(e){return this.requestWithMerge((t=>t.knownElementTypes(e)),r.mergeKnownElementTypes)}knownLinkTypes(e){return this.requestWithMerge((t=>t.knownLinkTypes(e)),r.mergeKnownLinkTypes)}elementTypes(e){return this.requestWithMerge((t=>t.elementTypes(e)),r.mergeElementTypes)}propertyTypes(e){return this.requestWithMerge((t=>t.propertyTypes(e)),r.mergePropertyTypes)}linkTypes(e){return this.requestWithMerge((t=>t.linkTypes(e)),r.mergeLinkTypes)}elements(e){return this.requestWithMerge((t=>t.elements(e)),r.mergeElementInfo)}links(e){return this.requestWithMerge((t=>t.links(e)),r.mergeLinksInfo)}connectedLinkStats(e){return this.requestWithMerge((t=>t.connectedLinkStats(e)),r.mergeConnectedLinkStats)}lookup(e){return this.requestWithMerge((t=>t.lookup(e)),r.mergeLookup)}}},(e,t,n)=>{n.r(t),n.d(t,{mergeConnectedLinkStats:()=>w,mergeElementInfo:()=>f,mergeElementTypes:()=>u,mergeKnownElementTypes:()=>a,mergeKnownLinkTypes:()=>l,mergeLinkTypes:()=>h,mergeLinksInfo:()=>x,mergeLookup:()=>v,mergePropertyTypes:()=>c});var i=n(59),r=n(70),o=n(68);const s="urn:reactodia:sourceProvider";function a(e){const t=new Map,n=new i.HashSet(o.hashSubtypeEdge,o.equalSubtypeEdges);for(const[i]of e){for(const e of i.elementTypes){const n=t.get(e.id);t.set(e.id,n?L(n,e):e)}for(const e of i.subtypeOf)n.add(e)}return{elementTypes:Array.from(t.values()),subtypeOf:Array.from(n.values())}}function l(e){const t=new Map;for(const[n]of e)for(const e of n){const n=t.get(e.id);t.set(e.id,n?p(n,e):e)}return Array.from(t.values())}function c(e){return g(e,d)}function d(e,t){return{...e,...t,label:k(e.label,t.label)}}function u(e){return g(e,L)}function h(e){return g(e,p)}function p(e,t){return{...e,...t,label:k(e.label,t.label),count:e.count||t.count?(e.count??0)+(t.count??0):void 0}}function g(e,t){const n=new Map;for(const[i]of e)for(const[e,r]of i){const i=n.get(e);n.set(e,i?t(i,r):r)}return n}function f(e){const t=new Map;for(const[n,i]of e)for(const[e,r]of n){const n={...r,properties:m(r.properties,i)},o=t.get(e);t.set(e,o?y(o,n):n)}return t}function m(e,t){return{...e,[s]:[t.provider.factory.literal(t.name)]}}function y(e,t){const n=new Set(e.types);for(const i of t.types)n.add(i);return{...e,...t,label:k(e.label,t.label),types:Array.from(n).sort(),image:e.image||t.image,properties:b(e.properties,t.properties)}}function b(e,t){const n=new i.HashSet(r.hashTerm,r.equalTerms),o={};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(Object.prototype.hasOwnProperty.call(t,i)){const r=[];S(e[i],r,n),S(t[i],r,n),o[i]=r,n.clear()}else o[i]=e[i];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(o,i)||(o[i]=t[i]));return o}function x(e){const t=new i.HashSet(o.hashLink,o.equalLinks),n=[];for(const[i]of e)for(const e of i)t.has(e)||(t.add(e),n.push(e));return n}function w(e){const t=new Map;for(const[r]of e)for(const e of r){const r=t.get(e.id);t.set(e.id,r?(n=r,i=e,{...n,...i,inCount:n.inCount+i.inCount,outCount:n.outCount+i.outCount,inexact:Boolean(n.inexact||i.inexact)}):e)}var n,i;return Array.from(t.values())}function v(e){const t=new Map;for(const[n,i]of e)for(const{element:e,inLinks:r,outLinks:o}of n){const n={...e,properties:m(e.properties,i)},s=t.get(n.id);if(s){s.element=y(s.element,n);for(const e of r)s.inLinks.add(e);for(const e of o)s.outLinks.add(e)}else t.set(e.id,{element:n,inLinks:new Set(r),outLinks:new Set(o)})}return Array.from(t.values())}function k(e,t){const n=[],o=new i.HashSet(r.hashTerm,r.equalTerms);return S(e,n,o),S(t,n,o),n}function S(e,t,n){for(const i of e)n.has(i)||(n.add(i),t.push(i))}function L(e,t){return{...e,...t,label:k(e.label,t.label),count:_(e.count,t.count)}}function _(e,t){if(void 0!==e||void 0!==t)return(e??0)+(t??0)}},(e,t,n)=>{n.r(t),n.d(t,{DecoratedDataProvider:()=>r,delayProviderDecorator:()=>o});var i=n(56);class r{baseProvider;decorator;constructor(e){this.baseProvider=e.baseProvider,this.decorator=e.decorator}get factory(){return this.baseProvider.factory}decorate(e,t){const n=this.baseProvider[e].bind(this.baseProvider),{decorator:i}=this;return i(e,t[0],n)}knownElementTypes(e){return this.decorate("knownElementTypes",[e])}knownLinkTypes(e){return this.decorate("knownLinkTypes",[e])}elementTypes(e){return this.decorate("elementTypes",[e])}propertyTypes(e){return this.decorate("propertyTypes",[e])}linkTypes(e){return this.decorate("linkTypes",[e])}elements(e){return this.decorate("elements",[e])}links(e){return this.decorate("links",[e])}connectedLinkStats(e){return this.decorate("connectedLinkStats",[e])}lookup(e){return this.decorate("lookup",[e])}}function o(e,t){return(n,r,o)=>{const s="linear"===t?Math.random()*e*2:"exponential"===t?-Math.log(Math.random())*e:e;return(0,i.delay)(s,{signal:r.signal}).then((()=>o(r)))}}},(e,t,n)=>{n.r(t),n.d(t,{EmptyDataProvider:()=>r});var i=n(70);class r{get factory(){return i.DefaultDataFactory}knownElementTypes(e){return Promise.resolve({elementTypes:[],subtypeOf:[]})}knownLinkTypes(e){return Promise.resolve([])}elementTypes(e){return Promise.resolve(new Map)}propertyTypes(e){return Promise.resolve(new Map)}linkTypes(e){return Promise.resolve(new Map)}elements(e){return Promise.resolve(new Map)}links(e){return Promise.resolve([])}connectedLinkStats(e){return Promise.resolve([])}lookup(e){return Promise.resolve([])}}},(e,t,n)=>{n.r(t),n.d(t,{IndexedDbCachedProvider:()=>c});var i=n(56),r=n(57),o=n(80),s=n(81);const a="__missing",l=["elementType","element","link","direction","text","limit"];class c{static DB_VERSION=3;hasher=new s.Sha256;baseProvider;dbName;cacheMissing;cacheLinks;cacheTextLookups;linkLock=new i.AsyncLock;closeSignal;openedDb;deleteRequest;constructor(e){this.baseProvider=e.baseProvider,this.dbName=e.dbName,this.cacheMissing=e.cacheMissing??!0,this.cacheLinks=e.cacheLinks??!0,this.cacheTextLookups=e.cacheTextLookups??!1,this.closeSignal=e.closeSignal,this.closeSignal.addEventListener("abort",this.onClose)}get factory(){return this.baseProvider.factory}clearCache(){return this.deleteRequest=this.deleteDatabase(),this.deleteRequest}async deleteDatabase(){await this.closeDatabase(),await h(indexedDB.deleteDatabase(this.dbName))}async openDb(){return this.deleteRequest&&await this.deleteRequest.catch((()=>{})),this.openedDb||(this.openedDb=new Promise(((e,t)=>{const n=indexedDB.open(this.dbName,c.DB_VERSION);n.onupgradeneeded=e=>{const t=n.result;if(e.newVersion!==e.oldVersion)for(const n of t.objectStoreNames)t.deleteObjectStore(n);if(t.objectStoreNames.contains("knownElementTypes")||t.createObjectStore("knownElementTypes",{keyPath:"id"}),t.objectStoreNames.contains("knownLinkTypes")||t.createObjectStore("knownLinkTypes",{keyPath:"id"}),!t.objectStoreNames.contains("elementTypes")){const e="id";t.createObjectStore("elementTypes",{keyPath:e})}if(!t.objectStoreNames.contains("linkTypes")){const e="id";t.createObjectStore("linkTypes",{keyPath:e})}if(!t.objectStoreNames.contains("propertyTypes")){const e="id";t.createObjectStore("propertyTypes",{keyPath:e})}if(!t.objectStoreNames.contains("elements")){const e="id";t.createObjectStore("elements",{keyPath:e})}if(!t.objectStoreNames.contains("links")){const e="__id",n=["sourceId","targetId"];t.createObjectStore("links",{keyPath:e,autoIncrement:!0}).createIndex("bySourceTarget",n)}if(!t.objectStoreNames.contains("linkBlocks")){const e="endpoint",n="connectedRange";t.createObjectStore("linkBlocks",{keyPath:e}).createIndex("byRangeKey",n)}if(t.objectStoreNames.contains("linkRanges")||t.createObjectStore("linkRanges"),!t.objectStoreNames.contains("connectedLinkStats")){const e=["elementId","inexactCount"];t.createObjectStore("connectedLinkStats",{keyPath:e})}t.objectStoreNames.contains("lookup")||t.createObjectStore("lookup",{keyPath:l})},n.onblocked=e=>{t(new Error("IndexedDB is blocked from upgrade due to being opened at another browser tab"))},n.onsuccess=t=>{const i=n.result;e(i)},n.onerror=e=>{t(n.error)}}))),this.openedDb}onClose=async()=>{this.closeSignal.removeEventListener("abort",this.onClose),this.closeDatabase()};async closeDatabase(){if(this.openedDb){(await this.openedDb).close(),this.openedDb=void 0}}async knownElementTypes(e){const t=await this.openDb(),n=await d(t,"knownElementTypes","knownElementTypes",(async t=>({id:t,value:await this.baseProvider.knownElementTypes(e)})));return y(n.value.elementTypes.values(),this.factory),n.value}async knownLinkTypes(e){const t=await this.openDb(),n=await d(t,"knownLinkTypes","knownLinkTypes",(async t=>({id:t,value:await this.baseProvider.knownLinkTypes(e)})));return y(n.value.values(),this.factory),n.value}async elementTypes(e){const{classIds:t,signal:n}=e,i=await this.openDb(),r=await u(i,"elementTypes",t,this.cacheMissing,(async e=>await this.baseProvider.elementTypes({classIds:e,signal:n})));return y(r.values(),this.factory),r}async propertyTypes(e){const{propertyIds:t,signal:n}=e,i=await this.openDb(),r=await u(i,"propertyTypes",t,this.cacheMissing,(async e=>await this.baseProvider.propertyTypes({propertyIds:e,signal:n})));return y(r.values(),this.factory),r}async linkTypes(e){const{linkTypeIds:t,signal:n}=e,i=await this.openDb(),r=await u(i,"linkTypes",t,this.cacheMissing,(async e=>await this.baseProvider.linkTypes({linkTypeIds:e,signal:n})));return y(r.values(),this.factory),r}async elements(e){const{elementIds:t,signal:n}=e,i=await this.openDb(),r=await u(i,"elements",t,this.cacheMissing,(async e=>await this.baseProvider.elements({elementIds:e,signal:n})));return y(r.values(),this.factory),b(r.values(),this.factory),r}async links(e){if(!this.cacheLinks)return this.baseProvider.links(e);if(0===e.primary.length||0===e.secondary.length)return[];const t=await this.openDb(),n=[...e.primary].sort(),i=[...e.secondary].sort(),r={sources:new Set(n),targets:new Set(i)},o=await this.linkLock.acquire();try{const n=await this.readLinkRanges(t,r),i=await this.selectMissingLinkBlocks(r,n);i.length>0&&(await this.fetchAndCacheLinks(t,i,e.signal),await this.updateLinkRanges(t,n,r))}finally{await o.release()}const s=[],a=e.linkTypeIds?new Set(e.linkTypeIds):void 0;await this.readLinksFromCache(t,n,i,(e=>{a&&!a.has(e.linkTypeId)||s.push(e)}));const l=n.filter((e=>!r.targets.has(e)));return await this.readLinksFromCache(t,i,l,(e=>{a&&!a.has(e.linkTypeId)||s.push(e)})),b(s,this.factory),s}async readLinkRanges(e,t){const n=e.transaction(["linkBlocks","linkRanges"],"readonly");try{const e=n.objectStore("linkBlocks"),i=n.objectStore("linkRanges"),r=new Set(t.sources);for(const n of t.targets)r.add(n);const o=new Map;await p(e,Array.from(r),(e=>{const t=e;t&&o.set(t.endpoint,t.connectedRange)}));const s=new Set(o.values()),a=new Map;return await p(i,Array.from(s),((e,t)=>{const n=e;n&&a.set(t,n)})),n.commit(),{endpoints:r,rangeByEndpoint:o,rangeByKey:a}}catch(i){throw f(n),new Error("Failed to read link ranges for an update",{cause:i})}}selectMissingLinkBlocks(e,t){const n=new Map;for(const o of e.sources){const e=t.rangeByEndpoint.get(o);e&&(0,r.multimapAdd)(n,e,o)}const i=Array.from(n.keys()).sort(),s=[];for(const r of i){const e=n.get(r),i=t.rangeByKey.get(r);e&&i&&s.push({sources:e,targets:i})}return(0,o.subtractAdjacencyBlocks)(e,s)}async fetchAndCacheLinks(e,t,n){const i=[];await Promise.all(t.map((async e=>{const t=await this.baseProvider.links({primary:Array.from(e.sources),secondary:Array.from(e.targets),signal:n});for(const n of t)i.push(m(n))}))),n?.throwIfAborted();const r=e.transaction("links","readwrite");try{const e=r.objectStore("links");await g(e,i),r.commit()}catch(o){throw f(r),new Error("Failed to fetch and cache missing links from base provider",{cause:o})}}async updateLinkRanges(e,t,n){const i={items:t.endpoints},r={items:n.sources},s={items:n.targets},a=new Map,l=new Map,c=new Map;for(const[o,p]of t.rangeByEndpoint)if(n.sources.has(o)&&n.targets.has(o)){if(!a.has(p)){const e=t.rangeByKey.get(p),i=new Set(e);for(const t of n.sources)i.add(t);for(const t of n.targets)i.add(t);a.set(p,{before:e,items:i})}}else if(n.sources.has(o)){if(!l.has(p)){const e=t.rangeByKey.get(p),i=new Set(e);for(const t of n.targets)i.add(t);l.set(p,{before:e,items:i})}}else if(n.targets.has(o)&&!c.has(p)){const e=t.rangeByKey.get(p),i=new Set(e);for(const t of n.sources)i.add(t);c.set(p,{before:e,items:i})}const d=[i,r,s];for(const o of[a,l,c])for(const e of o.values())e.items.size>(e.before?.size??0)&&d.push(e);for(const p of d)p.computedHash=(0,o.hashAdjacencyRange)(p.items,this.hasher);const u=e.transaction(["linkBlocks","linkRanges"],"readwrite");try{const e=u.objectStore("linkBlocks"),o=u.objectStore("linkRanges"),d=[],h=new Map;for(const u of t.endpoints){const e=t.rangeByEndpoint.get(u);let o;n.sources.has(u)&&n.targets.has(u)?o=e?a.get(e):i:n.sources.has(u)?o=e?l.get(e):s:n.targets.has(u)&&(o=e?c.get(e):r),o?.computedHash&&(d.push({endpoint:u,connectedRange:o.computedHash}),t.rangeByKey.has(o.computedHash)||h.set(o.computedHash,o))}await g(o,Array.from(h.values()),(e=>[e.computedHash,e.items])),await g(e,d);const f=new Set;for(const n of d){const e=t.rangeByEndpoint.get(n.endpoint);e&&f.add(e)}const m=e.index("byRangeKey"),y=Array.from(f),b=new Set;await p(m,y,((e,t)=>{e&&b.add(t)})),await function(e,t){if(0===t.length)return Promise.resolve();return new Promise(((n,i)=>{let r=0,o=!1;for(const s of t){const a=e.delete(s);a.onsuccess=()=>{o||(r++,r===t.length&&n())},a.onerror=()=>{o=!0,i(a.error)}}}))}(o,y.filter((e=>!b.has(e)))),u.commit()}catch(h){throw f(u),new Error("Failed to update cached link blocks",{cause:h})}}async readLinksFromCache(e,t,n,i){const r=e.transaction("links","readonly");try{const e=r.objectStore("links").index("bySourceTarget");await function(e,t,n,i){if(0===t.length||0===n.length)return Promise.resolve();const r=IDBKeyRange.bound([t[0],n[0]],[t[t.length-1],n[n.length-1]]);let o=0,s=0;return function(e,t,n){return new Promise(((i,r)=>{const o=e.openCursor(t);o.onsuccess=e=>{const t=o.result;t?n(t):i()},o.onerror=()=>{r(o.error)}}))}(e,r,(e=>{const[r,a]=e.key;for(;;){for(;o<t.length&&indexedDB.cmp(t[o],r)<0;)o++,s=0;if(o>=t.length)return;if(indexedDB.cmp(t[o],r)>0)return void e.continue([t[o],n[0]]);for(;s<n.length&&indexedDB.cmp(n[s],a)<0;)s++;if(!(s>=n.length))return indexedDB.cmp(n[s],a)>0?void e.continue([t[o],n[s]]):(i(e),void e.continue());s=0,o++}}))}(e,t,n,(e=>{const{__id:t,...n}=e.value;i(n)})),r.commit()}catch(o){throw f(r),new Error("Failed to read links from cache",{cause:o})}}async connectedLinkStats(e){const{signal:t}=e,n=await this.openDb(),i=[e.elementId,e.inexactCount?1:0];return(await d(n,"connectedLinkStats",i,(async([e,n])=>({elementId:e,inexactCount:n,stats:await this.baseProvider.connectedLinkStats({elementId:e,inexactCount:Boolean(n),signal:t})})))).stats}async lookup(e){if(!this.cacheTextLookups&&void 0!==e.text)return this.baseProvider.lookup(e);const t=[e.elementTypeId??"",e.refElementId??"",e.refElementLinkId??"",e.linkDirection??"",e.text??"",void 0===e.limit?"":null===e.limit?"null":String(e.limit)],n=await this.openDb(),i=await d(n,"lookup",t,(async([t,n,i,r,o,s])=>({elementType:t,element:n,link:i,direction:r,text:o,limit:s,result:await this.baseProvider.lookup(e)}))),r=i.result.map((e=>e.element));return y(r,this.factory),b(r,this.factory),i.result}}async function d(e,t,n,i){{const i=e.transaction(t,"readonly"),r=i.objectStore(t),o=await h(r.get(n));if(i.commit(),o)return o}const r=m(await i(n)),o=e.transaction(t,"readwrite"),s=o.objectStore(t);return await h(s.put(r)),o.commit(),r}async function u(e,t,n,i,r){const o=new Map,s=[];if(n.length>0){const r=e.transaction(t,"readonly"),l=r.objectStore(t);await p(l,n,((e,t)=>{const n=e;n?!function(e){return"object"==typeof e&&e&&Object.prototype.hasOwnProperty.call(e,a)&&Boolean(e[a])}(n)?o.set(t,n):i||s.push(t):s.push(t)})),r.commit()}if(s.length>0){const n=await r(s),i=[];for(const e of s)if(n.has(e)){const t=m(n.get(e));o.set(e,t),i.push(t)}else i.push({id:e,[a]:!0});const l=e.transaction(t,"readwrite"),c=l.objectStore(t);await g(c,i),l.commit()}return o}function h(e){return new Promise(((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)}))}function p(e,t,n){return 0===t.length?Promise.resolve():new Promise(((i,r)=>{let o=0,s=!1;for(const a of t){const l=e.get(a);l.onsuccess=()=>{if(!s){o++;try{n(l.result,a)}catch(e){s=!0,r(e)}o===t.length&&i()}},l.onerror=()=>{s=!0,r(l.error)}}}))}function g(e,t,n){return 0===t.length?Promise.resolve([]):new Promise(((i,r)=>{const o=[];let s=!1;for(const a of t){let l;if(n){const[t,i]=n(a);l=e.put(i,t)}else l=e.put(a);l.onsuccess=()=>{s||(o.push(l.result),o.length===t.length&&i(o))},l.onerror=()=>{s=!0,r(l.error)}}}))}function f(e){try{e.abort()}catch(t){}}function m(e){return JSON.parse(JSON.stringify(e))}function y(e,t){for(const n of e)n.label=n.label.map((e=>x(e,t)))}function b(e,t){for(const n of e)for(const e in n.properties)if(Object.prototype.hasOwnProperty.call(n.properties,e)){const i=n.properties[e];i&&(n.properties[e]=i.map((e=>x(e,t))))}}function x(e,t){switch(e.termType){case"NamedNode":return t.namedNode(e.value);case"Literal":return t.literal(e.value,e.language?e.language:t.namedNode(e.datatype.value));default:return e}}},(e,t,n)=>{n.r(t),n.d(t,{hashAdjacencyRange:()=>l,subtractAdjacencyBlocks:()=>o});var i=n(59),r=n(69);function o(e,t){const n=new Set(e.sources),r=new i.HashMap(s,a),o=[],l=(e,t)=>{let n=r.get(t);if(n)for(const i of e)n.sources.add(i);else n={targets:t,sources:new Set(e)},r.set(t,n),o.push(n)};for(const i of t){for(const e of i.sources)n.delete(e);const t=new Set(e.targets);for(const e of i.targets)t.delete(e);t.size>0&&l(i.sources,t)}return n.size>0&&l(n,e.targets),o}function s(e){let t=0;for(const n of e)t=(0|t)+(0|(0,r.hashFnv32a)(String(n)));return 0|t}function a(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function l(e,t){const n=Array.from(e).sort(),i=new TextEncoder,r=t.create(),o=t.create();for(const a of n){const e=i.encode(a);o.start(),o.update(e),r.update(o.digest())}const s=r.digest();return Array.from(s,(e=>e.toString(16).padStart(2,"0"))).join("")}},(e,t,n)=>{n.r(t),n.d(t,{Sha256:()=>r});var i=n(82);class r{initialized=!1;_padding;_k;initialize(){this.initialized||(this._padding=new Uint8Array(64),this._padding[0]=128,this._k=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),this.initialized=!0)}create(){return this.initialize(),new o(this._padding,this._k)}}class o{_padding;_k;blockLength=64;digestLength=32;messageLength=0;messageLength64=[0,0];_state;_input;_w=Array.from({length:64},(()=>0));constructor(e,t){this._padding=e,this._k=t,this.start()}start(){this.messageLength=0,this.messageLength64=[0,0],this._input=new i.CircularBuffer,this._state={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225}}update(e){this.messageLength+=e.length,this.messageLength64[0]+=e.length/4294967296>>>0,this.messageLength64[1]+=e.length>>>0,this._input.writeBytes(e),s(this._state,this._w,this._input,this._k)}digest(){const e=new i.CircularBuffer;e.ensureFreeCapacity(this._input.length);for(const i of this._input.peekBytes())e.writeBytes(i);e.writeBytes(this._padding,64-(this.messageLength64[1]+8&63)),e.writeInt32(this.messageLength64[0]<<3|this.messageLength64[0]>>>28),e.writeInt32(this.messageLength64[1]<<3);const t={...this._state};s(t,this._w,e,this._k);const n=new i.CircularBuffer(this.digestLength);return n.writeInt32(t.h0),n.writeInt32(t.h1),n.writeInt32(t.h2),n.writeInt32(t.h3),n.writeInt32(t.h4),n.writeInt32(t.h5),n.writeInt32(t.h6),n.writeInt32(t.h7),n.readBytes(n.length)}}function s(e,t,n,i){let r,o,s,a,l,c,d,u,h,p,g,f,m,y,b,x=n.length;for(;x>=64;){for(d=0;d<16;++d)t[d]=n.readInt32();for(;d<64;++d)r=t[d-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,o=t[d-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,t[d]=r+t[d-7]+o+t[d-16]|0;for(u=e.h0,h=e.h1,p=e.h2,g=e.h3,f=e.h4,m=e.h5,y=e.h6,b=e.h7,d=0;d<64;++d)a=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),l=y^f&(m^y),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|p&(u^h),r=b+a+l+i[d]+t[d],o=s+c,b=y,y=m,m=f,f=g+r|0,g=p,p=h,h=u,u=r+o|0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+p|0,e.h3=e.h3+g|0,e.h4=e.h4+f|0,e.h5=e.h5+m|0,e.h6=e.h6+y|0,e.h7=e.h7+b|0,x-=64}}},(e,t,n)=>{n.r(t),n.d(t,{CircularBuffer:()=>i});class i{buffer;_length=0;start=0;end=0;constructor(e=16){this.buffer=new Uint8Array(e??16)}get length(){return this._length}ensureFreeCapacity(e){const t=this.length+e,n=this.buffer.length;if(t>n){const e=Math.ceil(Math.log2(t)),i=Math.max(Math.pow(2,e),16),r=new Uint8Array(i);if(r.set(this.buffer),this.buffer=r,this.length>0&&this.end<=this.start){const e=this.start+(i-n);this.buffer.copyWithin(e,this.start,n-this.start),this.start=e}}}advanceStart(e){const t=r(this.start,this.end,this.buffer.length),n=Math.min(t,e);return this.start+=n,this._length-=n,this.start===this.buffer.length&&(this.start=0),n}advanceEnd(e){const t=r(this.end,this.start,this.buffer.length),n=Math.min(t,e);return this.end+=n,this._length+=n,this.end===this.buffer.length&&(this.end=0),n}*peekBytes(e=this.length){if(e<0||e>this.length)throw new Error("CircularBuffer: invalid byte count to peek");let t=e,n=this.start;for(;t>0;){const e=r(n,this.end,this.buffer.length),i=Math.min(e,t);yield this.buffer.subarray(n,n+i),t-=i,n+=i,n>=this.buffer.length&&(n=0)}}readBytes(e){if(e<0||e>this.length)throw new Error("CircularBuffer: invalid byte count to read");const t=new Uint8Array(e);let n=0,i=e;for(;i>0;){const e=this.start,r=this.advanceStart(i);t.set(this.buffer.subarray(e,e+r),n),n+=r,i-=r}return t}writeBytes(e,t=e.length){if(t<0||t>e.length)throw new Error("CircularBuffer: invalid offset and/or count to write bytes");this.ensureFreeCapacity(t);let n=t;for(;n>0;){const t=this.end,i=this.advanceEnd(n);this.buffer.set(e.subarray(0,i),t),n-=i}}readInt32(){if(this._length<4)throw new Error("CircularBuffer: not enough length to read Int32");const e=this.buffer[this.start]<<24;this.advanceStart(1);const t=this.buffer[this.start]<<16;this.advanceStart(1);const n=this.buffer[this.start]<<8;this.advanceStart(1);const i=this.buffer[this.start];return this.advanceStart(1),e|t|n|i}writeInt32(e){this.ensureFreeCapacity(4),this.buffer[this.end]=e>>24&255,this.advanceEnd(1),this.buffer[this.end]=e>>16&255,this.advanceEnd(1),this.buffer[this.end]=e>>8&255,this.advanceEnd(1),this.buffer[this.end]=255&e,this.advanceEnd(1)}}function r(e,t,n){return e<t?t-e:n-e}},(e,t,n)=>{n.r(t),n.d(t,{IndexQuadBy:()=>i,indexedDataset:()=>a});var i,r,o=n(59),s=n(70);function a(e){return new l(e)}!function(e){e[e.OnlyQuad=0]="OnlyQuad",e[e.S=1]="S",e[e.P=2]="P",e[e.O=4]="O",e[e.SP=8]="SP",e[e.OP=16]="OP"}(i||(i={}));class l{_size=0;byQuad;bySubject;byPredicate;byObject;bySubjectPredicate;byObjectPredicate;constructor(e){this.byQuad=new o.HashMap(s.hashQuad,s.equalQuads),e&i.S&&(this.bySubject=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.P&&(this.byPredicate=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.O&&(this.byObject=new o.HashMap(s.hashTerm,s.equalTerms)),e&i.SP&&(this.bySubjectPredicate=new o.HashMap(r.hashCode,r.equals)),e&i.OP&&(this.byObjectPredicate=new o.HashMap(r.hashCode,r.equals))}get size(){return this._size}add(e){return this.byQuad.has(e)||(this.byQuad.set(e,e),this.bySubject&&d(this.bySubject,e.subject,e),this.byPredicate&&d(this.byPredicate,e.predicate,e),this.byObject&&d(this.byObject,e.object,e),this.bySubjectPredicate&&d(this.bySubjectPredicate,{source:e.subject,predicate:e.predicate},e),this.byObjectPredicate&&d(this.byObjectPredicate,{source:e.object,predicate:e.predicate},e),this._size++),this}addAll(e){for(const t of e)this.add(t);return this}delete(e){const t=this.byQuad.get(e);return t&&(this.byQuad.delete(t),this.bySubject&&u(this.bySubject,t.subject,t),this.byPredicate&&u(this.byPredicate,t.predicate,t),this.byObject&&u(this.byObject,t.object,t),this.bySubjectPredicate&&u(this.bySubjectPredicate,{source:e.subject,predicate:e.predicate},t),this.byObjectPredicate&&u(this.byObjectPredicate,{source:e.object,predicate:e.predicate},t),this._size--),this}clear(){this._size=0,this.byQuad.clear(),this.bySubject&&this.bySubject.clear(),this.byPredicate&&this.byPredicate.clear(),this.byObject&&this.byObject.clear(),this.bySubjectPredicate&&this.bySubjectPredicate.clear(),this.byObjectPredicate&&this.byObjectPredicate.clear()}has(e){return this.byQuad.has(e)}hasMatches(e,t,n,i){for(const r of this.iterateMatches(e,t,n,i))return!0;return!1}iterateMatches(e,t,n,i){let r;if(e&&t&&n&&i){const o=this.byQuad.get(s.DefaultDataFactory.quad(e,t,n,i));r=o?[o]:[]}else if(this.bySubjectPredicate&&e&&t){r=h(c(this.bySubjectPredicate.get({source:e,predicate:t})),null,null,n)}else if(this.byObjectPredicate&&t&&n){r=h(c(this.byObjectPredicate.get({source:n,predicate:t})),e,null,null)}else if(this.bySubject&&e){r=h(c(this.bySubject.get(e)),null,t,n)}else if(this.byPredicate&&t){r=h(c(this.byPredicate.get(t)),e,null,n)}else if(this.byObject&&n){r=h(c(this.byObject.get(n)),e,t,null)}else r=h(this.byQuad.values(),e,t,n);return i?function*(e,t){for(const n of e)(0,s.equalTerms)(n.graph,t)&&(yield n)}(r,i):r}[Symbol.iterator](){return this.byQuad.values()}forEach(e){this.byQuad.forEach(e)}}function c(e){return e instanceof Set?e:e?[e]:[]}function d(e,t,n){let i=e.get(t);if(i)if(i instanceof Set)i.add(n);else{const r=i;i=new Set,i.add(r),i.add(n),e.set(t,i)}else i=n,e.set(t,i)}function u(e,t,n){const i=e.get(t);i&&(i instanceof Set?i.delete(n):e.delete(t))}function*h(e,t,n,i){for(const r of e)t&&!(0,s.equalTerms)(t,r.subject)||n&&!(0,s.equalTerms)(n,r.predicate)||i&&!(0,s.equalTerms)(i,r.object)||(yield r)}!function(e){e.hashCode=function(e){return(0,s.dropHighestNonSignBit)(Math.imul((0,s.hashTerm)(e.source),31)+(0,s.hashTerm)(e.predicate)|0)},e.equals=function(e,t){return(0,s.equalTerms)(e.source,t.source)&&(0,s.equalTerms)(e.predicate,t.predicate)}}(r||(r={}))},(e,t,n)=>{n.r(t),n.d(t,{RdfDataProvider:()=>l});var i=n(59),r=n(68),o=n(83),s=n(70);const a="urn:reactodia:blank:rdf:";class l{factory;dataset;acceptBlankNodes;typePredicate;labelPredicate;imagePredicate;elementTypeBaseTypes;elementSubtypePredicate;linkTypeBaseTypes;EMPTY_LINKS=new Set;constructor(e={}){this.factory=e.factory??s.DefaultDataFactory,this.dataset=(0,o.indexedDataset)(o.IndexQuadBy.S|o.IndexQuadBy.SP|o.IndexQuadBy.O|o.IndexQuadBy.OP),this.acceptBlankNodes=e.acceptBlankNodes??!0,this.typePredicate=this.factory.namedNode(e.typePredicate??"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.labelPredicate=null===e.labelPredicate?null:this.factory.namedNode(e.labelPredicate??"http://www.w3.org/2000/01/rdf-schema#label"),this.imagePredicate=null===e.imagePredicate?null:this.factory.namedNode(e.imagePredicate??"https://schema.org/thumbnailUrl"),this.elementTypeBaseTypes=(e.elementTypeBaseTypes??["http://www.w3.org/2002/07/owl#Class","http://www.w3.org/2000/01/rdf-schema#Class"]).map((e=>this.factory.namedNode(e))),this.elementSubtypePredicate=null===e.elementSubtypePredicate?null:this.factory.namedNode(e.elementSubtypePredicate??"http://www.w3.org/2000/01/rdf-schema#subClassOf"),this.linkTypeBaseTypes=(e.linkTypeBaseTypes??["http://www.w3.org/2002/07/owl#ObjectProperty","http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"]).map((e=>this.factory.namedNode(e)))}addGraph(e){if(this.acceptBlankNodes)this.dataset.addAll(e);else for(const t of e)"BlankNode"!==t.subject.termType&&"BlankNode"!==t.object.termType&&"BlankNode"!==t.graph.termType&&this.dataset.add(t)}encodeTerm(e){return g(e)}decodeTerm(e){return function(e,t){return e.startsWith(a)?t.blankNode(e.substring(a.length)):t.namedNode(e)}(e,this.factory)}knownElementTypes(e){const t=this.computeTypeCounts();for(const i of this.elementTypeBaseTypes)for(const e of this.dataset.iterateMatches(null,this.typePredicate,i))if(c(e.subject)){const n=this.encodeTerm(e.subject);t.has(n)||t.set(n,0)}const n=new i.HashSet(r.hashSubtypeEdge,r.equalSubtypeEdges);if(this.elementSubtypePredicate)for(const i of this.dataset.iterateMatches(null,this.elementSubtypePredicate,null))if(c(i.subject)&&c(i.object)){const e=this.encodeTerm(i.subject);t.has(e)||t.set(e,0);const r=this.encodeTerm(i.object);t.has(r)||t.set(r,0),n.add([this.encodeTerm(i.subject),this.encodeTerm(i.object)])}const o=[],s=new Set;for(const[i,r]of t){const e=this.decodeTerm(i),t=this.labelPredicate?h(this.dataset,e,this.labelPredicate):[];"BlankNode"===e.termType&&0===t.length?s.add(i):o.push({id:i,label:t,count:r})}const a=[];for(const i of n.values()){const[e,t]=i;s.has(e)||s.has(t)||a.push(i)}const l={elementTypes:o,subtypeOf:a};return Promise.resolve(l)}knownLinkTypes(e){const t=this.computeLinkCounts();for(const i of this.linkTypeBaseTypes)for(const e of this.dataset.iterateMatches(null,this.typePredicate,i))if(c(e.subject)){const n=this.encodeTerm(e.subject);t.has(n)||t.set(n,0)}const n=new Map;for(const[i,r]of t){const e=this.decodeTerm(i),t=this.labelPredicate?h(this.dataset,e,this.labelPredicate):[];"BlankNode"===e.termType&&0===t.length||n.set(i,{id:i,label:t,count:r})}return Promise.resolve(Array.from(n.values()))}elementTypes(e){const{classIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i);let t=0;for(const n of this.dataset.iterateMatches(null,this.typePredicate,e))t++;const r={id:i,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],count:t};n.set(i,r)}return Promise.resolve(n)}propertyTypes(e){const{propertyIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i),t={id:i,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[]};n.set(i,t)}return Promise.resolve(n)}linkTypes(e){const{linkTypeIds:t}=e,n=this.computeLinkCounts(t),i=new Map;for(const r of t){const e=this.decodeTerm(r),t={id:r,label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],count:n.get(r)??0};i.set(r,t)}return Promise.resolve(i)}elements(e){const{elementIds:t}=e,n=new Map;for(const i of t){const e=this.decodeTerm(i);if(this.dataset.hasMatches(e,null,null)){const t=this.imagePredicate?d(this.dataset,e,this.imagePredicate):void 0,r={id:i,types:u(this.dataset,e,this.typePredicate),label:this.labelPredicate?h(this.dataset,e,this.labelPredicate):[],image:t?t.value:void 0,properties:p(this.dataset,e)};n.set(i,r)}}return Promise.resolve(n)}links(e){const{primary:t,secondary:n,linkTypeIds:r}=e,o=new i.HashSet(s.hashTerm,s.equalTerms);for(const i of t)o.add(this.decodeTerm(i));const a=new i.HashSet(s.hashTerm,s.equalTerms);for(const i of n)a.add(this.decodeTerm(i));const l=r?new Set(r):void 0,d=[];for(const i of this.dataset)if(c(i.subject)&&"NamedNode"===i.predicate.termType&&c(i.object)&&(o.has(i.subject)&&a.has(i.object)||a.has(i.subject)&&o.has(i.object))&&(!l||!l.has(i.predicate.value))){const e=p(this.dataset,i);d.push({sourceId:this.encodeTerm(i.subject),targetId:this.encodeTerm(i.object),linkTypeId:this.encodeTerm(i.predicate),properties:e})}return Promise.resolve(d)}connectedLinkStats(e){const{elementId:t}=e,n=this.decodeTerm(t),i=new Map;for(const s of this.dataset.iterateMatches(n,null,null))if("NamedNode"===s.predicate.termType&&c(s.object)){const e=this.encodeTerm(s.predicate);i.set(e,(i.get(e)??0)+1)}const r=new Map;for(const s of this.dataset.iterateMatches(null,null,n))if("NamedNode"===s.predicate.termType&&c(s.subject)){const e=this.encodeTerm(s.predicate);r.set(e,(r.get(e)??0)+1)}const o=[];for(const[s,a]of i)o.push({id:s,inCount:r.get(s)??0,outCount:a});for(const[s,a]of r)i.has(s)||o.push({id:s,inCount:a,outCount:0});return Promise.resolve(o)}lookup(e){const t=new i.HashMap(s.hashTerm,s.equalTerms);let n=e.text?new RegExp(e.text.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),"i"):void 0;if(e.refElementId){const n=this.decodeTerm(e.refElementId),i=e.refElementLinkId?this.decodeTerm(e.refElementLinkId):null;if(!e.linkDirection||"out"===e.linkDirection)for(const e of this.dataset.iterateMatches(n,i,null))if("NamedNode"===e.predicate.termType&&c(e.object)){const n=e.object;let i=t.get(n);i||(i={term:n},t.set(n,i));const r=this.encodeTerm(e.predicate);i.outLinks||(i.outLinks=new Set),i.outLinks.add(r)}if(!e.linkDirection||"in"===e.linkDirection)for(const e of this.dataset.iterateMatches(null,i,n))if("NamedNode"===e.predicate.termType&&c(e.subject)){const n=e.subject;let i=t.get(n);i||(i={term:n},t.set(n,i));const r=this.encodeTerm(e.predicate);i.inLinks||(i.inLinks=new Set),i.inLinks.add(r)}if(e.elementTypeId){const n=this.decodeTerm(e.elementTypeId);for(const e of Array.from(t.values()))this.dataset.hasMatches(e.term,this.typePredicate,n)||t.delete(e.term)}}else if(e.elementTypeId){const n=this.decodeTerm(e.elementTypeId);for(const e of this.dataset.iterateMatches(null,this.typePredicate,n))c(e.subject)&&!t.has(e.subject)&&t.set(e.subject,{term:e.subject})}else if(n&&this.labelPredicate){for(const e of this.dataset.iterateMatches(null,this.labelPredicate,null))c(e.subject)&&"Literal"===e.object.termType&&n.test(e.object.value)&&!t.has(e.subject)&&t.set(e.subject,{term:e.subject});n=void 0}const r=[],o="number"==typeof e.limit?e.limit:Number.POSITIVE_INFINITY;for(const i of t.values()){if(r.length>=o)break;let e;if(this.labelPredicate){if(e=h(this.dataset,i.term,this.labelPredicate),n){let t=!1;for(const i of e)if(n.test(i.value)){t=!0;break}if(!t)continue}}else e=[];const t=this.imagePredicate?d(this.dataset,i.term,this.imagePredicate):void 0,s={id:this.encodeTerm(i.term),types:u(this.dataset,i.term,this.typePredicate),label:e,image:t?t.value:void 0,properties:{}};r.push({element:s,inLinks:i.inLinks??this.EMPTY_LINKS,outLinks:i.outLinks??this.EMPTY_LINKS})}return Promise.resolve(r)}computeTypeCounts(){const e=new Map;for(const t of this.dataset.iterateMatches(null,this.typePredicate,null))if(c(t.object)){const n=this.encodeTerm(t.object);e.set(n,(e.get(n)??0)+1)}return e}computeLinkCounts(e){const t=e?new Set(e):void 0,n=new Map;for(const i of this.dataset)if("NamedNode"===i.predicate.termType){const e=this.encodeTerm(i.predicate);t&&!t.has(e)||n.set(e,(n.get(e)??0)+1)}return n}}function c(e){switch(e.termType){case"NamedNode":case"BlankNode":return!0;default:return!1}}function d(e,t,n){for(const i of e.iterateMatches(t,n,null))if(s.equalTerms(i.predicate,n)&&("NamedNode"===i.object.termType||"Literal"===i.object.termType))return i.object}function u(e,t,n){const i=new Set;for(const r of e.iterateMatches(t,n,null))if(c(r.object)){const e=g(r.object);i.add(e)}return Array.from(i).sort()}function h(e,t,n){const i=[];for(const r of e.iterateMatches(t,n,null))s.equalTerms(r.predicate,n)&&"Literal"===r.object.termType&&i.push(r.object);return i}function p(e,t){const n={};for(const i of e.iterateMatches(t,null,null))if("NamedNode"===i.predicate.termType&&"Literal"===i.object.termType){const e=g(i.predicate);let t;Object.prototype.hasOwnProperty.call(n,e)?t=n[e]:(t=[],n[e]=t),t.push(i.object)}return n}function g(e){switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return a+e.value;default:throw new Error(`Unexpected term type to encode: ${e.termType}`)}}},(e,t,n)=>{n.r(t),n.d(t,{SparqlDataProvider:()=>d});var i=n(71),r=n(57),o=n(70),s=n(86),a=n(87),l=n(88),c=n(89);class d{factory;options;settings;queryFunction;acceptBlankNodes=!1;chunkMeasure;linkByPredicate=new Map;linkById=new Map;openWorldLinks;propertyByPredicate=new Map;openWorldProperties;constructor(e,t=c.OwlStatsSettings){const{factory:n=o.DefaultDataFactory,queryFunction:i=f}=e;this.factory=n,this.options=e,this.settings=t,this.queryFunction=i;const{chunk:s,queryMethod:l="GET"}=this.options;if(s&&!Number.isSafeInteger(s.maxSize))throw new Error("SparqlDataProviderOptions.chunk.maxSize should be a non-negative number");this.chunkMeasure=s?{maxSize:s.maxSize,measure:u(s.unit)}:void 0===s&&"GET"===l?{maxSize:2500,measure:u("totalLength")}:{maxSize:1/0,measure:u("itemCount")};for(const o of t.linkConfigurations){this.linkById.set(o.id,o);const e=(0,a.isDirectLink)(o)?o.path:o.id;(0,r.multimapArrayAdd)(this.linkByPredicate,e,o)}this.openWorldLinks=0===t.linkConfigurations.length||Boolean(t.openWorldLinks);for(const o of t.propertyConfigurations){const e=(0,a.isDirectProperty)(o)?o.path:o.id;(0,r.multimapArrayAdd)(this.propertyByPredicate,e,o)}this.openWorldProperties=0===t.propertyConfigurations.length||Boolean(t.openWorldProperties)}async queryChunked(e,t){const{maxSize:n,measure:i}=this.chunkMeasure,r=[];for(const o of(0,s.chunkArray)(e,i,n))r.push(t(o));await Promise.all(r)}async knownElementTypes(e){const{signal:t}=e,{defaultPrefix:n,schemaLabelProperty:i,filterOnlyLanguages:r,classTreeQuery:o}=this.settings;if(!o)return{elementTypes:[],subtypeOf:[]};const s=n+p(o,{schemaLabelProperty:i,labelLanguageFilter:m("?label",r)}),l=await this.executeSparqlSelect(s,{signal:t}),c=(0,a.getClassTree)(l);return this.options.prepareLabels&&await h(c.elementTypes,this.options.prepareLabels,t),c}async propertyTypes(e){const{propertyIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,filterOnlyLanguages:o,propertyInfoQuery:s}=this.settings,l=new Map;if(s)await this.queryChunked(t,(async e=>{const t=e.map(b).map((e=>` ( ${e} )`)).join(" "),c=i+p(s,{ids:t,schemaLabelProperty:r,labelLanguageFilter:m("?label",o)}),d=await this.executeSparqlSelect(c,{signal:n});(0,a.collectPropertyInfo)(d,l)}));else for(const a of t)l.set(a,{id:a,label:[]});return this.options.prepareLabels&&await h(l.values(),this.options.prepareLabels,n),l}async elementTypes(e){const{classIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,filterOnlyLanguages:o,classInfoQuery:s}=this.settings,l=new Map;if(s)await this.queryChunked(t,(async e=>{const t=e.map(b).map((e=>` ( ${e} )`)).join(" "),c=i+p(s,{ids:t,schemaLabelProperty:r,labelLanguageFilter:m("?label",o)}),d=await this.executeSparqlSelect(c,{signal:n});(0,a.collectClassInfo)(d,l)}));else for(const a of t)l.set(a,{id:a,label:[]});return this.options.prepareLabels&&await h(l.values(),this.options.prepareLabels,n),l}async linkTypes(e){const{linkTypeIds:t,signal:n}=e,{defaultPrefix:i,schemaLabelProperty:r,filterOnlyLanguages:o,linkTypesInfoQuery:s}=this.settings,l=new Map;if(s)await this.queryChunked(t,(async e=>{const t=e.map(b).map((e=>` ( ${e} )`)).join(" "),c=i+p(s,{ids:t,schemaLabelProperty:r,labelLanguageFilter:m("?label",o)}),d=await this.executeSparqlSelect(c,{signal:n});(0,a.collectLinkTypes)(d,l)}));else for(const a of t)l.set(a,{id:a,label:[]});return this.options.prepareLabels&&await h(l.values(),this.options.prepareLabels,n),l}async knownLinkTypes(e){const{signal:t}=e,{defaultPrefix:n,schemaLabelProperty:i,filterOnlyLanguages:r,linkTypesQuery:o,linkTypesPattern:s}=this.settings;if(!o)return[];const l=n+p(o,{linkTypesPattern:s,schemaLabelProperty:i,labelLanguageFilter:m("?label",r)}),c=await this.executeSparqlSelect(l,{signal:t}),d=(0,a.getLinkTypes)(c);return this.options.prepareLabels&&await h(d.values(),this.options.prepareLabels,t),Array.from(d.values())}async elements(e){const{elementIds:t,signal:n}=e,i=[];t.length>0&&await this.queryChunked(t,(async e=>{const t=e.map(b).map((e=>` (${e})`)).join(" "),{defaultPrefix:n,dataLabelProperty:r,filterOnlyLanguages:o,elementInfoQuery:s}=this.settings,a=n+p(s,{ids:t,dataLabelProperty:r,labelLanguageFilter:m("?label",o),valueLanguageFilter:m("?propValue",o),propertyConfigurations:this.formatPropertyInfo()}),l=await this.executeSparqlConstruct(a);for(const c of l)i.push(c)}));const r=this.queryManyElementTypes(this.settings.propertyConfigurations.length>0?t:[],n),o=(0,a.triplesToElementBinding)(i),s=(0,a.getElementsInfo)(o,await r,this.propertyByPredicate,this.openWorldProperties);return this.options.prepareLabels&&await h(s.values(),this.options.prepareLabels,n),this.options.prepareImages?await function(e,t,n){return t(e.values(),n).then((t=>{for(const[n,i]of t){const t=e.get(n);t&&(t.image=i)}}))}(s,this.options.prepareImages,n):this.options.imagePropertyUris&&this.options.imagePropertyUris.length&&await this.attachImages(s,this.options.imagePropertyUris,n),s}async attachImages(e,t,n){const i=t.map(b).map((e=>` ( ${e} )`)).join(" ");await this.queryChunked(Array.from(e.keys()),(async t=>{const r=t.map((e=>` ( ${b(e)} )`)).join(" "),o=this.settings.defaultPrefix+`\n                SELECT ?inst ?linkType ?image\n                WHERE {\n                    VALUES (?inst) {${r}}\n                    VALUES (?linkType) {${i}}\n                    ${this.settings.imageQueryPattern}\n                }\n            `;try{const t=await this.executeSparqlSelect(o,{signal:n});(0,a.enrichElementsWithImages)(t,e)}catch(s){console.warn("Failed to load entity image URLs",s)}}))}async links(e){const{primary:t,secondary:n,linkTypeIds:i,signal:r}=e,{filterOnlyLanguages:o,linksInfoQuery:s}=this.settings,l=m("?propValue",o),c=this.formatLinkLinks();let d,u;if(d=t.length>0&&n.length>0?s.includes("${ids}")?this.queryUndirectedLinks(t,n,{propLanguageFilter:l,linkConfigurations:c},r):this.queryDirectedLinks(t,n,{propLanguageFilter:l,linkConfigurations:c},r):Promise.resolve([]),this.linkByPredicate.size>0){u=new Set(t);for(const e of n)u.add(e)}const h=this.queryManyElementTypes(u?Array.from(u):[],r);let p=(0,a.getLinksInfo)(await d,await h,this.linkByPredicate,this.openWorldLinks);if(i){const e=new Set(i);p=p.filter((t=>e.has(t.linkTypeId)))}return p}async queryUndirectedLinks(e,t,n,i){const{propLanguageFilter:r,linkConfigurations:o}=n,{defaultPrefix:s,linksInfoQuery:a}=this.settings,l=new Set(e);for(const d of t)l.add(d);const c=s+p(a,{ids:y(l),propLanguageFilter:r,linkConfigurations:o});return(await this.executeSparqlSelect(c,{signal:i})).results.bindings}async queryDirectedLinks(e,t,n,i){const{propLanguageFilter:r,linkConfigurations:o}=n,{defaultPrefix:a,linksInfoQuery:l}=this.settings,{maxSize:c,measure:d}=this.chunkMeasure,u=[],h=Array.from((0,s.chunkUndirectedCrossProduct)(e,t,d,c),(async e=>{const t=a+p(l,{sourceIris:y(e.sources),targetIris:y(e.targets),propLanguageFilter:r,linkConfigurations:o}),n=await this.executeSparqlSelect(t,{signal:i});for(const i of n.results.bindings)u.push(i)}));return await Promise.all(h),u}async connectedLinkStats(e){const{elementId:t,inexactCount:n,signal:i}=e,{defaultPrefix:r,linkTypesOfQuery:o,linkTypesStatisticsQuery:s,filterTypePattern:l}=this.settings,c=/\?direction\b/.test(o),d=b(t),u=this.formatLinkUnion(t,void 0,void 0,"?outObject","?inObject",c);u.usePredicatePart&&(u.unionParts.push(`{ ${d} ?link ?outObject ${c?'BIND("out" AS ?direction)':""} }`),u.unionParts.push(`{ ?inObject ?link ${d} ${c?'BIND("in" AS ?direction)':""} }`));const h=r+p(o,{elementIri:d,linkConfigurations:u.unionParts.join("\nUNION\n")}),g=await this.executeSparqlSelect(h,{signal:i}),f=g.head.vars.includes("direction"),m=(0,a.getConnectedLinkTypes)(g,this.linkByPredicate,this.openWorldLinks),y=this.acceptBlankNodes?"FILTER (IsIri(?outObject) || IsBlank(?outObject))":"FILTER IsIri(?outObject)",x=this.acceptBlankNodes?"FILTER (IsIri(?inObject) || IsBlank(?inObject))":"FILTER IsIri(?inObject)",w=[];return await Promise.all(m.map((async({linkType:e,hasInLink:t,hasOutLink:o})=>{const c=this.linkById.get(e);let u,h;if(!c||(0,a.isDirectLink)(c)){const t=b(c&&(0,a.isDirectLink)(c)?c.path:e);u=`${d} ${t} ?outObject`,h=`?inObject ${t} ${d}`}else u=this.formatLinkPath(c.path,d,"?outObject"),h=this.formatLinkPath(c.path,"?inObject",d);if(c&&c.domain&&c.domain.length>0){const e=c.domain.map(b).join(", ");u+=` { ${l.replace(/[?$]inst\b/g,d)} FILTER(?class IN (${e})) }`,h+=` { ${l.replace(/[?$]inst\b/g,"?inObject")} FILTER(?class IN (${e})) }`}if(!s||n&&f)w.push({id:e,inCount:t?1:0,outCount:o?1:0,inexact:!0});else{const t=r+p(s,{linkId:b(e),elementIri:d,linkConfigurationOut:u,linkConfigurationIn:h,navigateElementFilterOut:y,navigateElementFilterIn:x}),n=await this.executeSparqlSelect(t,{signal:i}),o=(0,a.getLinkStatistics)(n);o&&w.push(o)}}))),w}async lookup(e){const{signal:t}=e,n={...e,limit:void 0===e.limit?100:e.limit},i=this.querySingleElementTypes(n.refElementId&&this.settings.linkConfigurations.length>0?n.refElementId:void 0,t),r=this.createFilterQuery(n),o=await this.executeSparqlSelect(r,{signal:t}),s=(0,a.getFilteredData)(o,await i,this.linkByPredicate,this.openWorldLinks);if(this.options.prepareLabels){const e=s.map((e=>e.element));await h(e,this.options.prepareLabels,t)}return s}createFilterQuery(e){if(!e.refElementId&&e.refElementLinkId)throw new Error("Cannot execute refElementLink filter without refElement");let t="?inst ?class ?label",n="?inst",i="",r="";e.refElementId&&(t+=" ?link ?direction",n+=" ?link ?direction",i=this.createRefQueryPart({elementId:e.refElementId,linkId:e.refElementLinkId,direction:e.linkDirection}),this.settings.linkConfigurations.length>0&&(t+=" ?classAll",r=this.settings.filterTypePattern.replace(/[?$]class\b/g,"?classAll")));let o="";if(e.elementTypeId){const t=b(e.elementTypeId);o=this.settings.filterTypePattern.replace(/[?$]class\b/g,t)}const{defaultPrefix:s,dataLabelProperty:a,filterOnlyLanguages:l,filterElementInfoPattern:c,fullTextSearch:d}=this.settings,u=p(c,{dataLabelProperty:a,labelLanguageFilter:m("?label",l)});let h="";e.text&&(n+=" ?score",this.settings.fullTextSearch.extractLabel&&(h+=`\n        BIND ( str( ${"?inst"} ) as ?uriStr)\n        BIND ( strafter(?uriStr, "#") as ?label3)\n        BIND ( strafter(strafter(?uriStr, "//"), "/") as ?label6)\n        BIND ( strafter(?label6, "/") as ?label5)\n        BIND ( strafter(?label5, "/") as ?label4)\n        BIND (if (?label3 != "", ?label3,\n            if (?label4 != "", ?label4,\n            if (?label5 != "", ?label5, ?label6))) as ${"?extractedLabel"})\n    `),h=p(d.queryPattern,{text:e.text,dataLabelProperty:a}));let g="";return"number"==typeof e.limit&&(g=`LIMIT ${e.limit}`),`${s}\n            ${d.prefix}\n\n        SELECT ${t}\n        WHERE {\n            {\n                SELECT DISTINCT ${n} WHERE {\n                    ${o}\n                    ${i}\n                    ${h}\n                    ${this.settings.filterAdditionalRestriction}\n                }\n                ${h?"ORDER BY DESC(?score)":""}\n                ${g}\n            }\n            ${r}\n            ${u}\n        } ${h?"ORDER BY DESC(?score)":""}\n        `}executeSparqlSelect(e,t){const n=this.options.queryMethod??"GET",{signal:i}=t??{};return async function(e,t,n,i,r,o){let s;s=i("GET"===n?{url:g(e,{query:t}),headers:{Accept:"application/sparql-results+json"},method:"GET",signal:o}:{url:e,body:t,headers:{Accept:"application/sparql-results+json","Content-Type":"application/sparql-query; charset=UTF-8"},method:"POST",signal:o});const a=await s;if(a.ok){const e=await a.json();return(0,l.mapSparqlResponseIntoRdfJs)(e,r)}{const e=new Error(a.statusText);throw e.response=a,e}}(this.options.endpointUrl,e,n,this.queryFunction,this.factory,i)}executeSparqlConstruct(e,t){const n=this.options.queryMethod??"GET",{signal:r}=t??{};return async function(e,t,n,r,o){let s;s=r("GET"===n?{url:g(e,{query:t}),headers:{Accept:"text/turtle"},method:"GET",signal:o}:{url:e,body:t,headers:{Accept:"text/turtle","Content-Type":"application/sparql-query; charset=UTF-8"},method:"POST",signal:o});const a=await s;if(a.ok){const e=await a.text();return(new i.Parser).parse(e)}{const e=new Error(a.statusText);throw e.response=a,e}}(this.options.endpointUrl,e,n,this.queryFunction,r)}createRefQueryPart(e){const{elementId:t,linkId:n,direction:i}=e,{unionParts:r,usePredicatePart:o}=this.formatLinkUnion(t,n,i,"?inst","?inst",!0);if(o){const t=b(e.elementId);let o;if(n){const e=this.linkById.get(n);o=e&&(0,a.isDirectLink)(e)?b(e.path):b(n)}const s=o||"?link",l=o?`BIND(${o} as ?link)`:"",c=this.acceptBlankNodes?"FILTER(isIri(?inst) || isBlank(?inst))":"FILTER(isIri(?inst))";i&&"out"!==i||r.push(`{ ${t} ${s} ?inst BIND("out" as ?direction) ${l} ${c} }`),i&&"in"!==i||r.push(`{ ?inst ${s} ${t} BIND("in" as ?direction) ${l} ${c} }`)}let s=0===r.length?"FILTER(false)":r.join("\nUNION\n");return!n&&this.settings.filterRefElementLinkPattern.length>0&&(s+=`\n${this.settings.filterRefElementLinkPattern}`),s}formatLinkUnion(e,t,n,i,r,o){const{linkConfigurations:s}=this.settings,l=b(e),c=[];let d=!1;for(const u of s)if(!t||u.id===t)if((0,a.isDirectLink)(u))d=!0;else{const e=b(u.id);if(!n||"out"===n){const t=this.formatLinkPath(u.path,l,i),n=o?'BIND("out" as ?direction) ':"";c.push(`{ ${t} BIND(${e} as ?link) ${n}}`)}if(!n||"in"===n){const t=this.formatLinkPath(u.path,r,l),n=o?'BIND("in" as ?direction) ':"";c.push(`{ ${t} BIND(${e} as ?link) ${n}}`)}}return{unionParts:c,usePredicatePart:this.openWorldLinks||d}}formatLinkLinks(){const e=[];let t=!1;for(const n of this.settings.linkConfigurations)if((0,a.isDirectLink)(n))t=!0;else{const t=b(n.id);e.push(`${this.formatLinkPath(n.path,"?source","?target")} BIND(${t} as ?type)`)}return(this.openWorldLinks||t)&&e.push("?source ?type ?target"),0===e.length?"":1===e.length?e[0]:"{ "+e.join(" }\nUNION\n{ ")+" }"}formatLinkPath(e,t,n){return e.replace(/[?$]source\b/g,t).replace(/[?$]target\b/g,n)}formatPropertyInfo(){const e=[];let t=!1;for(const n of this.settings.propertyConfigurations)if((0,a.isDirectProperty)(n))t=!0;else{const t=b(n.id),i=this.formatPropertyPath(n.path,"?inst","?propValue");e.push(`{ ${i} BIND(${t} as ?propType) }`)}return(this.openWorldProperties||t)&&e.push("{ ?inst ?propType ?propValue }"),e.join("\nUNION\n")}formatPropertyPath(e,t,n){return e.replace(/[?$]inst\b/g,t).replace(/[?$]value\b/g,n)}async querySingleElementTypes(e,t){if(!e)return;return(await this.queryManyElementTypes([e],t)).get(e)}async queryManyElementTypes(e,t){if(0===e.length)return new Map;const{filterTypePattern:n}=this.settings,i=new Map;return await this.queryChunked(e,(async e=>{const r=p("SELECT ?inst ?class { VALUES(?inst) { ${ids} } ${filterTypePattern} }",{ids:e.map((e=>`(${b(e)})`)).join(" "),filterTypePattern:n}),o=await this.executeSparqlSelect(r,{signal:t});(0,a.collectElementTypes)(o,i)})),i}}function u(e){return"totalLength"===e?e=>b(e).length+3:()=>1}async function h(e,t,n){const i=new Set;for(const o of e)i.add(o.id);const r=await t(i,n);for(const o of e){const e=r.get(o.id);e&&(o.label=e)}}function p(e,t){let n=e;for(const i in t){if(!Object.prototype.hasOwnProperty.call(t,i))continue;const e=t[i]||"";n=n.replace(new RegExp("\\${"+i+"}","g"),e)}return n}function g(e,t={}){const n=e.indexOf("?")<0?"?":"&";return e+(n+Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&"))}function f(e){return fetch(e.url,{method:e.method,body:e.body,credentials:"same-origin",mode:"cors",cache:"default",headers:e.headers,signal:e.signal})}function m(e,t){if(!t)return"";const n=[`FILTER(!isLiteral(${e}) || lang(${e}) = ""`];for(const i of t)n.push(` || lang(${e}) = "${i}"`);return n.push(")"),n.join("")}function y(e){return Array.from(e,(e=>`(${b(e)})`)).join(" ")}function b(e){if("string"!=typeof e)throw new Error(`Cannot escape IRI of type "${typeof e}"`);return`<${e}>`}},(e,t,n)=>{function*i(e,t,n){if(!Number.isFinite(n))return void(yield e);const i=[];let r=0;for(const o of e){const e=t(o);r>0&&r+e>n&&(yield[...i],i.length=0,r=0),i.push(o),r+=e}r>0&&(yield i)}function*r(e,t,n,i){e.length<t.length&&([e,t]=[t,e]);const r=new Set(t),s=new Set;for(const o of e)r.has(o)&&s.add(o);yield*o(e,t,n,i),yield*o(t,e,n,i,r.size===s.size?s:void 0)}function*o(e,t,n,i,r){const o=Math.ceil(i/2),s=new Set,a=[];let l=0,c=0;function d(){const e={sources:[...s],targets:[...a]};return a.length=0,c=0,e}for(let u=0;u<e.length;u++){const h=e[u];if(s.add(h),l+=n(h),l>=o||u===e.length-1){for(const e of t){if(r&&r.has(e))continue;const t=n(e);c>0&&l+c+t>i&&(yield d()),a.push(e),c+=t}c>0&&(yield d()),s.clear(),l=0}}}n.r(t),n.d(t,{chunkArray:()=>i,chunkUndirectedCrossProduct:()=>r})},(e,t,n)=>{n.r(t),n.d(t,{collectClassInfo:()=>p,collectElementTypes:()=>v,collectLinkTypes:()=>f,collectPropertyInfo:()=>g,enrichElement:()=>N,enrichElementsWithImages:()=>w,getClassTree:()=>h,getConnectedLinkTypes:()=>S,getElementsInfo:()=>b,getFilteredData:()=>_,getLinkStatistics:()=>L,getLinkTypes:()=>m,getLinksInfo:()=>k,isDirectLink:()=>T,isDirectProperty:()=>E,triplesToElementBinding:()=>y});var i=n(57),r=n(59),o=n(70),s=n(68),a=n(88);const l="urn:reactodia:sparql:type",c="urn:reactodia:sparql:label",d=new Map,u=new Set;function h(e){const t=new Map,n=new r.HashSet(s.hashSubtypeEdge,s.equalSubtypeEdges);for(const r of e.results.bindings){if(!(0,a.isRdfIri)(r.class))continue;const e=r.class.value;let o=t.get(e);if(o||(o=i(e),t.set(e,o)),C(o.label,r.label),r.parent){const t=r.parent.value;n.add([e,t])}r.instcount&&(o.count=D(r.instcount))}for(const r of e.results.bindings)if(r.parent){const e=r.parent.value;t.has(e)||t.set(e,i(e))}function i(e){return{id:e,label:[],count:void 0}}return{elementTypes:Array.from(t.values()),subtypeOf:Array.from(n.values())}}function p(e,t){for(const n of e.results.bindings){if(!n.class)continue;const e=n.class.value,i=t.get(e);if(i){if(C(i.label,n.label),n.instcount){const e=D(n.instcount);void 0!==e&&(i.count=void 0===i.count?e:Math.max(i.count,e))}}else t.set(e,{id:e,label:n.label?[n.label]:[],count:n.instcount?D(n.instcount):void 0})}}function g(e,t){for(const n of e.results.bindings){const e=n.property.value,i=t.get(e);i?C(i.label,n.label):t.set(e,{id:n.property.value,label:n.label?[n.label]:[]})}}function f(e,t){for(const n of e.results.bindings){const e=n.link.value,i=t.get(e);i?C(i.label,n.label):t.set(e,O(n))}}function m(e){const t=new Map;return f(e,t),t}function y(e){const t=new Map,n={head:{vars:["inst","class","label","blankType","propType","propValue"]},results:{bindings:[]}};for(const r of e){if(!(0,a.isRdfIri)(r.subject))continue;const e=r.subject.value;t.has(e)||t.set(e,i(r)),r.predicate.value===c&&(0,a.isRdfLiteral)(r.object)?(t.get(e).label&&t.set(e,i(r)),t.get(e).label=r.object):r.predicate.value===l&&(0,a.isRdfIri)(r.object)&&(0,a.isRdfIri)(r.predicate)?(t.get(e).class&&t.set(e,i(r)),t.get(e).class=r.object):((0,a.isRdfIri)(r.object)||(0,a.isRdfLiteral)(r.object))&&(0,a.isRdfIri)(r.predicate)&&(t.get(e).propType&&t.set(e,i(r)),t.get(e).propType=r.predicate,t.get(e).propValue=r.object)}function i(e){const t={inst:e.subject};return n.results.bindings.push(t),t}return n}function b(e,t=d,n=d,i=!0){const r=new Map;for(const o of e.results.bindings){if(!(0,a.isRdfIri)(o.inst))continue;const e=o.inst.value;let t=r.get(e);t||(t=P(e),r.set(e,t)),N(t,o)}if(!i||n.size>0)for(const o of r.values()){const e=t.get(o.id);o.properties=x(o,e,n,i)}return r}function x(e,t,n,i){const r={};for(const o in e.properties){if(!Object.hasOwnProperty.call(e.properties,o))continue;const s=n.get(o);if(s&&s.length>0)for(const n of s)j(n,t)&&(r[n.id]=e.properties[o]);else i&&(r[o]=e.properties[o])}return r}function w(e,t){for(const n of e.results.bindings){if(!(0,a.isRdfIri)(n.inst))continue;const e=t.get(n.inst.value);e&&(e.image=n.image.value)}}function v(e,t){for(const n of e.results.bindings)if((0,a.isRdfIri)(n.inst)&&(0,a.isRdfIri)(n.class)){const e=n.inst.value,r=n.class.value;(0,i.multimapAdd)(t,e,r)}}function k(e,t=d,n=d,i=!0){const o=new r.HashMap(s.hashLink,s.equalLinks);for(const r of e){const e={sourceId:r.source.value,linkTypeId:r.type.value,targetId:r.target.value,properties:{}},s=o.get(e);if(s)r.propType&&r.propValue&&A(s.properties,r.propType,r.propValue);else{r.propType&&r.propValue&&A(e.properties,r.propType,r.propValue);const s=n.get(e.linkTypeId);if(s&&s.length>0){for(const n of s)if(j(n,t.get(e.sourceId))){const t=T(n)?{...e,linkTypeId:n.id}:e;o.set(t,t)}}else i&&o.set(e,e)}}return Array.from(o.values())}function S(e,t=d,n=!0){const i=new Map,r=(e,t)=>{let n=i.get(e);n||(n={linkType:e},i.set(e,n)),(0,a.isRdfLiteral)(t)&&("in"===t.value?n.hasInLink=!0:"out"===t.value&&(n.hasOutLink=!0))};for(const o of e.results.bindings){if(!(0,a.isRdfIri)(o.link))continue;const e=t.get(o.link.value);if(e&&e.length>0)for(const t of e){r(T(t)?t.id:o.link.value,o.direction)}else n&&r(o.link.value,o.direction)}return Array.from(i.values())}function L(e){for(const n of e.results.bindings)if((0,a.isRdfIri)(n.link))return{id:(t=n).link.value,inCount:D(t.inCount),outCount:D(t.outCount)};var t}function _(e,t,n,r){const o=n??d,s=new Map,l=new Map,c=new Map,h=new Map;for(const d of e.results.bindings){if(!(0,a.isRdfIri)(d.inst)&&!(0,a.isRdfBlank)(d.inst))continue;const e=d.inst.value;let t=s.get(e);if(t||(t=P(e),s.set(e,t)),N(t,d),(0,a.isRdfIri)(d.classAll)&&(0,i.multimapAdd)(l,e,d.classAll.value),!r&&d.link&&d.direction){const e="in"===d.direction.value?h:"out"===d.direction.value?c:void 0;e&&(0,i.multimapAdd)(e,t.id,d.link.value)}}const p=[];for(const i of s.values()){const e=l.get(i.id);if(r||M(t,c.get(i.id),o)&&M(e,h.get(i.id),o)){i.types.sort();const n=new Set(I(t,c.get(i.id)??u,o,r)),s=new Set(I(e,h.get(i.id)??u,o,r));p.push({element:i,outLinks:n,inLinks:s})}}return p}function M(e,t,n){if(!t)return!0;const i=I(e,t,n,!1);for(const r of i)return!0;return!1}function*I(e,t,n,i){for(const r of t){const t=n.get(r);if(t)for(const n of t)j(n,e)&&(yield n.id);else i&&(yield r)}}function T(e){return!/[?$][a-zA-Z]+\b/.test(e.path)}function E(e){return!/[?$][a-zA-Z]+\b/.test(e.path)}function j(e,t){if(e.domain&&0!==e.domain.length){if(t){for(const n of e.domain)if(t.has(n))return!0;return!1}return!1}return!0}function N(e,t){e&&(C(e.label,t.label),t.class&&e.types.indexOf(t.class.value)<0&&e.types.push(t.class.value),t.propType&&t.propValue&&t.propType.value!==c&&A(e.properties,t.propType,t.propValue))}function C(e,t){if(t){for(const n of e)if(o.equalTerms(n,t))return;e.push(t)}}function A(e,t,n){let i=Object.prototype.hasOwnProperty.call(e,t.value)?e[t.value]:void 0;if(i){for(const r of i)if(o.equalTerms(r,n))return}else i=[],e[t.value]=i;i.push(n)}function D(e){const t=+e.value;return Number.isFinite(t)?t:0}function P(e){return{id:e,label:[],types:[],properties:{}}}function O(e){return{id:e.link.value,label:e.label?[e.label]:[],count:e.instcount?D(e.instcount):void 0}}},(e,t,n)=>{function i(e,t){return{...e,results:{...e.results,bindings:e.results.bindings.map((function(e){const n={};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const r=e[i];switch(r.type){case"uri":n[i]=t.namedNode(r.value);break;case"bnode":n[i]=t.blankNode(r.value);break;case"literal":case"typed-literal":n[i]=t.literal(r.value,r["xml:lang"]?r["xml:lang"]:r.datatype?t.namedNode(r.datatype):void 0);break;default:throw new Error(`Unexpected SPARQL term type: "${r.type}"`)}}return n}))}}}function r(e){return Boolean(e&&"NamedNode"===e.termType)}function o(e){return Boolean(e&&"BlankNode"===e.termType)}function s(e){return Boolean(e&&"Literal"===e.termType)}n.r(t),n.d(t,{isRdfBlank:()=>o,isRdfIri:()=>r,isRdfLiteral:()=>s,mapSparqlResponseIntoRdfJs:()=>i})},(e,t,n)=>{n.r(t),n.d(t,{DBPediaSettings:()=>u,OwlRdfsSettings:()=>a,OwlStatsSettings:()=>c,RdfSettings:()=>i,WikidataSettings:()=>o});const i={linkConfigurations:[],openWorldLinks:!1,propertyConfigurations:[],openWorldProperties:!1,linksInfoQuery:"SELECT ?source ?type ?target\n            WHERE {\n                ${linkConfigurations}\n                VALUES (?source) {${sourceIris}}\n                VALUES (?target) {${targetIris}}\n            }",defaultPrefix:"",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",fullTextSearch:{prefix:"",queryPattern:""},classTreeQuery:"",classInfoQuery:'SELECT ?class ?label ?instcount WHERE {\n    VALUES(?class) {${ids}}\n    OPTIONAL {\n        ?class ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n    BIND("" as ?instcount)\n}',linkTypesQuery:"SELECT DISTINCT ?link ?instcount ?label WHERE {\n    ${linkTypesPattern}\n    OPTIONAL {\n        ?link ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n}",linkTypesPattern:"",linkTypesInfoQuery:"SELECT ?link ?label WHERE {\n    VALUES(?link) {${ids}}\n    OPTIONAL {\n        ?link ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n}",propertyInfoQuery:"SELECT ?property ?label WHERE {\n    VALUES(?property) {${ids}}\n    OPTIONAL {\n        ?property ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n}",elementInfoQuery:"",imageQueryPattern:"",linkTypesOfQuery:"",linkTypesStatisticsQuery:"",filterRefElementLinkPattern:"",filterTypePattern:"",filterAdditionalRestriction:"",filterElementInfoPattern:""},r={defaultPrefix:"PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n PREFIX wdt: <http://www.wikidata.org/prop/direct/>\n PREFIX wd: <http://www.wikidata.org/entity/>\n PREFIX owl:  <http://www.w3.org/2002/07/owl#>\n",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",classTreeQuery:"\n        SELECT distinct ?class ?label ?parent WHERE {\n            ?class rdfs:label ?label.\n            ${labelLanguageFilter}\n            { ?class wdt:P279 wd:Q35120. }\n            UNION\n            { ?parent wdt:P279 wd:Q35120.\n            ?class wdt:P279 ?parent. }\n            UNION\n            { ?parent wdt:P279/wdt:P279 wd:Q35120.\n            ?class wdt:P279 ?parent. }\n        }\n    ",linkTypesQuery:"",linkTypesPattern:"\n        ?link wdt:P279* wd:Q18616576.\n        BIND(0 as ?instcount)\n    ",linkTypesInfoQuery:"SELECT ?link ?label WHERE {\n    VALUES (?link) {${ids}}\n    OPTIONAL {\n        ?claim <http://wikiba.se/ontology#directClaim> ?link .\n        ?claim ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n}",propertyInfoQuery:"SELECT ?property ?label WHERE {\n    VALUES (?property) {${ids}}\n    OPTIONAL {\n        ?claim <http://wikiba.se/ontology#directClaim> ?property .\n        ?claim ${schemaLabelProperty} ?label\n        ${labelLanguageFilter}\n    }\n}",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            OPTIONAL {\n                ?inst wdt:P31 ?class\n            }\n            OPTIONAL {\n                ?inst rdfs:label ?label\n                ${labelLanguageFilter}\n            }\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n                ${valueLanguageFilter}\n            }\n        }\n    ",imageQueryPattern:' { ?inst ?linkType ?fullImage } union { ?inst wdt:P163/wdt:P18 ?fullImage }\n                BIND(CONCAT("https://commons.wikimedia.org/w/thumb.php?f=",\n                    STRAFTER(STR(?fullImage), "Special:FilePath/"), "&w=200") AS ?image)',linkTypesOfQuery:"\n        SELECT DISTINCT ?link ?direction\n        WHERE {\n            ${linkConfigurations}\n            ?claim <http://wikiba.se/ontology#directClaim> ?link .\n        }\n    ",linkTypesStatisticsQuery:"\n        SELECT (${linkId} as ?link) (COUNT(?outObject) AS ?outCount) (COUNT(?inObject) AS ?inCount)\n        WHERE {\n            {\n                {\n                    SELECT DISTINCT ?outObject WHERE {\n                        ${linkConfigurationOut}\n                        FILTER(ISIRI(?outObject))\n                        ?outObject ?someprop ?someobj.\n                    }\n                    LIMIT 101\n                }\n            } UNION {\n                {\n                    SELECT DISTINCT ?inObject WHERE {\n                        ${linkConfigurationIn}\n                        FILTER(ISIRI(?inObject))\n                        ?inObject ?someprop ?someobj.\n                    }\n                    LIMIT 101\n                }\n            }\n        }\n    ",filterRefElementLinkPattern:"?claim <http://wikiba.se/ontology#directClaim> ?link .",filterTypePattern:"?inst wdt:P31 ?instType. ?instType wdt:P279* ?class",filterAdditionalRestriction:"FILTER ISIRI(?inst)\n                        BIND(STR(?inst) as ?strInst)\n                        FILTER exists {?inst ?someprop ?someobj}\n",filterElementInfoPattern:"\n        OPTIONAL {?inst wdt:P31 ?foundClass}\n        BIND (coalesce(?foundClass, owl:Thing) as ?class)\n        OPTIONAL {\n            ?inst rdfs:label ?label\n            ${labelLanguageFilter}\n        }\n    ",fullTextSearch:{prefix:"PREFIX bds: <http://www.bigdata.com/rdf/search#>\n",queryPattern:'\n            SERVICE wikibase:mwapi {\n                bd:serviceParam wikibase:endpoint "www.wikidata.org";\n                    wikibase:api "EntitySearch";\n                    mwapi:search "${text}";\n                    mwapi:language "en".\n                ?inst wikibase:apiOutputItem mwapi:item.\n                ?num wikibase:apiOrdinal true.\n            }\n            BIND(IF(\n                STRLEN(STR(?inst)) > 33,\n                0-<http://www.w3.org/2001/XMLSchema#integer>(SUBSTR(STR(?inst), 33)),\n                -10000\n            ) as ?score)\n        '}},o={...i,...r},s={defaultPrefix:"PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n PREFIX owl:  <http://www.w3.org/2002/07/owl#>\n",schemaLabelProperty:"rdfs:label",dataLabelProperty:"rdfs:label",fullTextSearch:{prefix:"",queryPattern:'?inst ${dataLabelProperty} ?search1\n        FILTER regex(COALESCE(str(?search1)), "${text}", "i")\n        BIND(0 as ?score)\n',extractLabel:!0},classTreeQuery:"\n        SELECT ?class ?label ?parent\n        WHERE {\n            {\n                ?class a rdfs:Class\n            } UNION {\n                ?class a owl:Class\n            }\n            FILTER ISIRI(?class)\n            OPTIONAL {\n                ?class rdfs:label ?label\n                ${labelLanguageFilter}\n            }\n            OPTIONAL {?class rdfs:subClassOf ?parent. FILTER ISIRI(?parent)}\n        }\n    ",linkTypesPattern:"\n        { ?link a rdf:Property }\n        UNION\n        { ?link a owl:ObjectProperty }\n        BIND('' as ?instcount)\n    ",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            OPTIONAL { ?inst a ?class }\n            OPTIONAL {\n                ?inst ${dataLabelProperty} ?label\n                ${labelLanguageFilter}\n            }\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n                ${valueLanguageFilter}\n            }\n        }\n    ",imageQueryPattern:"{ ?inst ?linkType ?image } UNION { [] ?linkType ?inst. BIND(?inst as ?image) }",linkTypesOfQuery:"\n        SELECT DISTINCT ?link ?direction\n        WHERE {\n            ${linkConfigurations}\n        }\n    ",linkTypesStatisticsQuery:"\n        SELECT ?link ?outCount ?inCount\n        WHERE {\n            {\n                SELECT (${linkId} as ?link) (count(?outObject) as ?outCount) WHERE {\n                    ${linkConfigurationOut}\n                    ${navigateElementFilterOut}\n                } LIMIT 101\n            } {\n                SELECT (${linkId} as ?link) (count(?inObject) as ?inCount) WHERE {\n                    ${linkConfigurationIn}\n                    ${navigateElementFilterIn}\n                } LIMIT 101\n            }\n        }\n    ",filterRefElementLinkPattern:"",filterTypePattern:"?inst a ?instType. ?instType rdfs:subClassOf* ?class",filterElementInfoPattern:"\n        OPTIONAL {?inst rdf:type ?foundClass}\n        BIND (coalesce(?foundClass, owl:Thing) as ?class)\n        OPTIONAL {\n            ?inst ${dataLabelProperty} ?label\n            ${labelLanguageFilter}\n        }\n    ",filterAdditionalRestriction:""},a={...i,...s},l={classTreeQuery:"\n        SELECT ?class ?instcount ?label ?parent\n        WHERE {\n            {SELECT ?class (count(?inst) as ?instcount)\n                WHERE {\n                    ?inst rdf:type ?class.\n                    FILTER ISIRI(?class)\n                } GROUP BY ?class } UNION\n            {\n                ?class rdf:type rdfs:Class\n            } UNION {\n                ?class rdf:type owl:Class\n            }\n            OPTIONAL {\n                ?class rdfs:label ?label\n                ${labelLanguageFilter}\n            }\n            OPTIONAL {?class rdfs:subClassOf ?parent. FILTER ISIRI(?parent)}\n        }\n    "},c={...a,...l},d={fullTextSearch:{prefix:"PREFIX dbo: <http://dbpedia.org/ontology/>\n",queryPattern:'\n              ?inst rdfs:label ?searchLabel.\n              ?searchLabel bif:contains "${text}".\n              ?inst dbo:wikiPageID ?origScore .\n              BIND(0-?origScore as ?score)\n        '},classTreeQuery:"\n        SELECT distinct ?class ?label ?parent WHERE {\n            ?class rdfs:label ?label.\n            OPTIONAL {?class rdfs:subClassOf ?parent}\n            ?root rdfs:subClassOf owl:Thing.\n            ?class rdfs:subClassOf? | rdfs:subClassOf/rdfs:subClassOf ?root\n        }\n    ",elementInfoQuery:"\n        CONSTRUCT {\n            ?inst <urn:reactodia:sparql:type> ?class .\n            ?inst <urn:reactodia:sparql:label> ?label .\n            ?inst ?propType ?propValue.\n        } WHERE {\n            VALUES (?inst) {${ids}}\n            ?inst a ?class .\n            ?inst rdfs:label ?label .\n            FILTER (!contains(str(?class), 'http://dbpedia.org/class/yago'))\n            OPTIONAL {\n                ${propertyConfigurations}\n                FILTER (isLiteral(?propValue))\n            }\n        }\n    ",filterTypePattern:"?inst a ?instType. ?instType rdfs:subClassOf* ?class",filterElementInfoPattern:"\n        OPTIONAL {?inst rdf:type ?foundClass. FILTER (!contains(str(?foundClass), 'http://dbpedia.org/class/yago'))}\n        BIND (coalesce(?foundClass, owl:Thing) as ?class)\n        OPTIONAL {?inst ${dataLabelProperty} ?label}",imageQueryPattern:' { ?inst ?linkType ?fullImage } UNION { [] ?linkType ?inst. BIND(?inst as ?fullImage) }\n            BIND(CONCAT("https://commons.wikimedia.org/w/thumb.php?f=",\n            STRAFTER(STR(?fullImage), "Special:FilePath/"), "&w=200") AS ?image)\n    '},u={...a,...d}},(e,t,n)=>{n.r(t),n.d(t,{CanvasContext:()=>r,useCanvas:()=>o});var i=n(61);const r=i.createContext(null);function o(){const e=i.useContext(r);if(!e)throw new Error("Missing Reactodia canvas context");return e}},(e,t,n)=>{n.r(t),n.d(t,{defineCanvasWidget:()=>r,extractCanvasWidget:()=>o});const i=Symbol("getWidgetMetadata");function r(e,t){e[i]=t}function o(e){const t=e.type[i];if(t)return t(e)}},(e,t,n)=>{n.r(t),n.d(t,{RestoreGeometry:()=>o,changeLinkTypeVisibility:()=>d,placeElementsAroundTarget:()=>h,restoreCapturedLinkGeometry:()=>s,restoreViewport:()=>u,setElementExpanded:()=>l,setElementState:()=>a,setLinkState:()=>c});var i=n(93),r=n(94);class o{elementState;linkState;title="Move elements and links";constructor(e,t){this.elementState=e,this.linkState=t}static capture(e){return o.capturePartial(e.elements,e.links)}static capturePartial(e,t){return new o(e.map((e=>({element:e,position:e.position}))),t.map((e=>({link:e,vertices:e.vertices}))))}hasChanges(){return this.elementState.length>0||this.linkState.length>0}filterOutUnchanged(){return new o(this.elementState.filter((({element:e,position:t})=>!i.Vector.equals(e.position,t))),this.linkState.filter((({link:e,vertices:t})=>!(0,i.isPolylineEqual)(e.vertices,t))))}invoke(){const e=o.capturePartial(this.elementState.map((e=>e.element)),this.linkState.map((e=>e.link)));for(const{element:t,position:n}of[...this.elementState].reverse())t.setPosition(n);for(const{link:t,vertices:n}of this.linkState)t.setVertices(n);return e}}function s(e){const t=e.vertices;return r.Command.create("Change link vertices",(()=>{const n=s(e);return e.setVertices(t),n}))}function a(e,t){return r.Command.create("Change element state",(()=>{const n=e.elementState;return e.setElementState(t),a(e,n)}))}function l(e,t){const n=t?"Expand element":"Collapse element";return r.Command.create(n,(()=>(e.setExpanded(t),l(e,!t))))}function c(e,t){return r.Command.create("Change link state",(()=>{const n=e.linkState;return e.setLinkState(t),c(e,n)}))}function d(e,t,n){return r.Command.create("Change link type visibility",(()=>{const i=e.getLinkVisibility(t);return e.setLinkVisibility(t,n),d(e,t,i)}))}function u(e){function t(){const{metrics:t}=e,{clientWidth:n,clientHeight:i}=e.metrics.area,r=t.clientToPaperCoords(n/2,i/2),{scale:o}=t.getTransform();return{center:r,scale:o}}function n({center:t,scale:n}){e.centerTo(t,{scale:n})}const i=t(),o=r.Command.create("Restore viewport",(()=>{const e=t();return n(i),r.Command.create("Revert viewport",(()=>(n(e),o)))}));return o}function h(e){const{elements:t,target:n,graph:s,sizeProvider:a,distance:l=300}=e;return r.Command.create("Place elements",(()=>{const e=o.capture(s),r=(0,i.boundsOf)(n,a),c=r.x+r.width/2,d=r.y+r.height/2;let u=0;const h=s.getElementLinks(n);if(h.length>0){const e=(0,i.calculateAveragePosition)(h.map((e=>{const t=s.sourceOf(e);return t!==n?t:s.targetOf(e)})),a),t={x:c-e.x,y:d-e.y};0===t.x&&0===t.y||(u=Math.atan2(t.y,t.x))}const p=Math.min(Math.PI/t.length,Math.PI/6),g=[...t],f=(e,t)=>{if(t){const{width:n,height:r}=(0,i.boundsOf)(t,a);t.setPosition({x:c+l*Math.cos(e)-n/2,y:d+l*Math.sin(e)-r/2})}};if(g.length%2==0)for(let t=p/2;g.length>0;t+=p)f(u-t,g.pop()),f(u+t,g.pop());else{f(u,g.pop());for(let e=p;g.length>0;e+=p)f(u-e,g.pop()),f(u+e,g.pop())}return e.filterOutUnchanged()}))}},(e,t,n)=>{var i,r;function o(e,t){const{x:n,y:i}=e.position,r=t.getElementSize(e);return{x:n,y:i,width:r?r.width:0,height:r?r.height:0}}function s(e,t){const n=0===e.width||0===e.height||t.x>e.x&&t.x<e.x+e.width&&t.y>e.y&&t.y<e.y+e.height,r=e.width/2,o=e.height/2,s={x:e.x+r,y:e.y+o};if(n)return s;const a=i.normalize({x:t.x-s.x,y:t.y-s.y}),l={x:Math.abs(a.x),y:a.y};return i.cross2D({x:r,y:-o},l)>0&&i.cross2D({x:r,y:o},l)<0?{x:s.x+r*Math.sign(a.x),y:s.y+r*a.y/Math.abs(a.x)}:{x:s.x+o*a.x/Math.abs(a.y),y:s.y+o*Math.sign(a.y)}}function a(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const i=e[n],r=t[n];if(i.x!==r.x||i.y!==r.y)return!1}return!0}function l(e,t,n){const i=s(e,n.length>0?n[0]:r.center(t)),o=s(t,n.length>0?n[n.length-1]:r.center(e));return[i,...n,o]}function c(e){let t;return e.reduce(((e,n)=>{const r=t?i.length({x:n.x-t.x,y:n.y-t.y}):0;return t=n,e+r}),0)}function d(e,t){if(0===e.length)throw new Error("Cannot compute a point for an empty polyline");if(t<0)return e[0];let n=0;for(let r=1;r<e.length;r++){const o=e[r-1],s=e[r],a={x:s.x-o.x,y:s.y-o.y},l=i.length(a),c=n+l;if(t<c){const e=(t-n)/l;return{x:o.x+e*a.x,y:o.y+e*a.y}}n=c}return e[e.length-1]}function u(e,t){let n=1/0,r=0;for(let o=0;o<e.length-1;o++){const s=e[o],a=e[o+1],l={x:t.x-s.x,y:t.y-s.y},c={x:a.x-s.x,y:a.y-s.y},d=i.length(c),u=i.dot(l,c)/d;if(u<0||u>d)continue;const h=Math.abs(i.cross2D(l,c))/d;h<n&&(n=h,r=o)}return r}function h(e){return"M"+e.map((({x:e,y:t})=>`${e},${t}`)).join(" L")}function p(e,t,n){for(let i=e.length-1;i>=0;i--){const r=e[i],{x:s,y:a,width:l,height:c}=o(r,n);if((0!==l||0!==c)&&(t.x>=s&&t.x<=s+l&&t.y>=a&&t.y<=a+c))return r}}function g(e,t,n){let i=1/0,r=1/0,o=-1/0,s=-1/0;for(const a of e){const{x:e,y:t}=a.position,l=n.getElementSize(a);i=Math.min(i,e),r=Math.min(r,t),o=Math.max(o,e+(l?l.width:0)),s=Math.max(s,t+(l?l.height:0))}for(const a of t){const e=a.vertices||[];for(const{x:t,y:n}of e)i=Math.min(i,t),r=Math.min(r,n),o=Math.max(o,t),s=Math.max(s,n)}return{x:Number.isFinite(i)?i:0,y:Number.isFinite(r)?r:0,width:Number.isFinite(i)&&Number.isFinite(o)?o-i:0,height:Number.isFinite(r)&&Number.isFinite(s)?s-r:0}}function f(e,t){let n=0,i=0;for(const r of e){const{x:e,y:s,width:a,height:l}=o(r,t);n+=e+a/2,i+=s+l/2}return{x:n/e.length,y:i/e.length}}n.r(t),n.d(t,{Rect:()=>r,Vector:()=>i,boundsOf:()=>o,calculateAveragePosition:()=>f,computePolyline:()=>l,computePolylineLength:()=>c,findElementAtPoint:()=>p,findNearestSegmentIndex:()=>u,getContentFittingBox:()=>g,getPointAlongPolyline:()=>d,isPolylineEqual:()=>a,pathFromPolyline:()=>h}),function(e){e.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},e.subtract=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},e.scale=function(e,t){return{x:e.x*t,y:e.y*t}},e.equals=function(e,t){return e.x===t.x&&e.y===t.y},e.length=function({x:e,y:t}){return Math.sqrt(e*e+t*t)},e.normalize=function({x:e,y:t}){if(0===e&&0===t)return{x:e,y:t};const n=1/Math.sqrt(e*e+t*t);return{x:e*n,y:t*n}},e.dot=function({x:e,y:t},{x:n,y:i}){return e*n+t*i},e.cross2D=function({x:e,y:t},{x:n,y:i}){return e*i-t*n}}(i||(i={})),function(e){e.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},e.center=function({x:e,y:t,width:n,height:i}){return{x:e+n/2,y:t+i/2}},e.intersects=function(e,t){return e.x<=t.x+t.width&&e.y<=t.y+t.height&&t.x<=e.x+e.width&&t.y<=e.y+e.height}}(r||(r={}))},(e,t,n)=>{n.r(t),n.d(t,{Command:()=>i,InMemoryHistory:()=>l});var i,r=n(58);!function(e){e.create=function(e,t){return new o(e,t)},e.effect=function(e,t){return new s(e,t)},e.compound=function(e,t){return new a(e,t)}}(i||(i={}));class o{title;invoke;constructor(e,t){this.title=e,this.invoke=t}}class s{title;body;skip;constructor(e,t){this.title=e,this.body=t,this.skip={title:"Skipped effect: "+e,invoke:()=>this}}invoke(){const{body:e}=this;return e(),this.skip}}class a{title;commands;constructor(e,t){this.title=e,this.commands=t}invoke(){const e=[];for(const t of this.commands)e.push(t.invoke());return e.reverse(),new a(this.title,e)}}class l{source=new r.EventSource;events=this.source;_undoStack=[];_redoStack=[];batches=[];get undoStack(){return this._undoStack}get redoStack(){return this._redoStack}hasChanges(){return this._undoStack.length>0}reset(){this._undoStack.length=0,this._redoStack.length=0,this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}undo(){const e=this._undoStack.pop();if(e){const t=e.invoke();this._redoStack.push(t),this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}}redo(){const e=this._redoStack.pop();if(e){const t=e.invoke();this._undoStack.push(t),this.source.trigger("historyChanged",{hasChanges:this.hasChanges()})}}execute(e){const t=e.invoke();this.registerToUndo(t)}registerToUndo(e){const t=this.topBatch();t?t._inverses.push(e):(this._undoStack.push(e),this._redoStack.length=0,this.source.trigger("historyChanged",{hasChanges:this.hasChanges()}))}topBatch(){return 0===this.batches.length?void 0:this.batches[this.batches.length-1]}startBatch(e){const t={_title:e,_inverses:[],history:this,store:()=>{if(this.batches.includes(t))for(;this.batches.length>0;){const e=this.batches.pop();if(e!==t&&console.warn("Storing other unclosed batch on top",e),e._inverses.length>0){const n=[...e._inverses].reverse();this.registerToUndo(i.compound(t._title,n))}if(e===t)break}else console.warn("Failed to find batch to store (already stored or discarded?)",t)},discard:()=>{if(this.batches.includes(t))for(;this.batches.length>0;){const e=this.batches.pop();if(e!==t&&console.warn("Discarding other unclosed batch on top",e),e===t)break}else console.warn("Failed to find batch to store (already stored or discarded?)")}};return this.batches.push(t),t}}},(e,t,n)=>{n.r(t)},(e,t,n)=>{n.r(t),n.d(t,{Element:()=>s,Link:()=>l,LinkVertex:()=>c,VoidElement:()=>a});var i=n(58),r=n(69),o=n(93);class s{source=new i.EventSource;events=this.source;id;_position;_expanded;_elementState;constructor(e){const{id:t=s.generateId(),position:n={x:0,y:0},expanded:i=!1,elementState:r}=e;this.id=t,this._position=n,this._expanded=i,this._elementState=r}static generateId(){return`urn:reactodia:e:${(0,r.generate128BitID)()}`}get position(){return this._position}setPosition(e){const t=this._position;t.x===e.x&&t.y===e.y||(this._position=e,this.source.trigger("changePosition",{source:this,previous:t}))}get isExpanded(){return this._expanded}setExpanded(e){const t=this._expanded;t!==e&&(this._expanded=e,this.source.trigger("changeExpanded",{source:this,previous:t}))}get elementState(){return this._elementState}setElementState(e){const t=this._elementState;t!==e&&(this._elementState=e,this.source.trigger("changeElementState",{source:this,previous:t}))}focus(){this.source.trigger("requestedFocus",{source:this})}redraw(e){this.source.trigger("requestedRedraw",{source:this,level:e})}}class a extends s{constructor(e){super(e)}}class l{source=new i.EventSource;events=this.source;id;_sourceId;_targetId;_vertices;_linkState;constructor(e){const{id:t=l.generateId(),sourceId:n,targetId:i,vertices:r=[],linkState:o}=e;this.id=t,this._sourceId=n,this._targetId=i,this._vertices=r,this._linkState=o}static generateId(){return`urn:reactodia:l:${(0,r.generate128BitID)()}`}get sourceId(){return this._sourceId}get targetId(){return this._targetId}get typeId(){return this.getTypeId()}get vertices(){return this._vertices}setVertices(e){const t=this._vertices;(0,o.isPolylineEqual)(this._vertices,e)||(this._vertices=e,this.source.trigger("changeVertices",{source:this,previous:t}))}get linkState(){return this._linkState}setLinkState(e){const t=this._linkState;t!==e&&(this._linkState=e,this.source.trigger("changeLinkState",{source:this,previous:t}))}redraw(){this.source.trigger("requestedRedraw",{source:this})}}class c{link;vertexIndex;constructor(e,t){this.link=e,this.vertexIndex=t}createAt(e){const t=[...this.link.vertices];t.splice(this.vertexIndex,0,e),this.link.setVertices(t)}moveTo(e){const t=[...this.link.vertices];t.splice(this.vertexIndex,1,e),this.link.setVertices(t)}remove(){const e=[...this.link.vertices],[t]=e.splice(this.vertexIndex,1);this.link.setVertices(e)}}},(e,t,n)=>{n.r(t),n.d(t,{applyLayout:()=>o,calculateLayout:()=>r,translateToPositiveQuadrant:()=>a,uniformGrid:()=>l});var i=n(93);async function r(e){const{layoutFunction:t,model:n,sizeProvider:r,typeProvider:o,fixedElements:s,selectedElements:a}=e;if(a&&a.size<=1)return{positions:new Map,sizes:new Map,nestedLayouts:[]};let l=n.elements;a&&(l=l.filter((e=>a.has(e))));const c=Object.create(null),d=Object.create(null);for(const f of l)c[f.id]={types:o?.getElementTypes?.(f)??[],fixed:s?.has(f)},d[f.id]=(0,i.boundsOf)(f,r);const u=[];for(const i of n.links)Object.hasOwn(c,i.sourceId)&&Object.hasOwn(c,i.targetId)&&"hidden"!==n.getLinkVisibility(i.typeId)&&u.push({type:o?.getLinkType?.(i)??i.typeId,source:i.sourceId,target:i.targetId});const h=await t({nodes:c,links:u},{bounds:d}),p=new Map,g=new Map;for(const[i,{x:f,y:m,width:y,height:b}]of Object.entries(h.bounds))p.set(i,{x:f,y:m}),g.set(i,{width:y,height:b});return{positions:p,sizes:g,nestedLayouts:[]}}function o(e,t){const{positions:n,sizes:r,nestedLayouts:a}=e,l=new s(r),c=t.elements.filter((({id:e})=>n.has(e)));for(const i of a)o(i,t);const d=(0,i.calculateAveragePosition)(c,l);for(const i of c){const e=n.get(i.id);e&&i.setPosition(e)}const u=(0,i.calculateAveragePosition)(c,l),h=d.x-u.x,p=d.y-u.y;for(const[i,o]of n){t.getElement(i).setPosition({x:o.x+h,y:o.y+p})}}class s{sizes;constructor(e){this.sizes=e}getElementSize(e){return this.sizes.get(e.id)}}function a(e,t){let n=1/0,i=1/0;e.forEach((e=>{n=Math.min(n,e.x),i=Math.min(i,e.y)}));const{x:r,y:o}=t;e.forEach(((t,s)=>{e.set(s,{x:t.x-n+r,y:t.y-i+o})}))}function l(e){return t=>{const n=Math.floor(t/e.rows);return{x:(t-n*e.rows)*e.cellSize.x,y:n*e.cellSize.y,width:e.cellSize.x,height:e.cellSize.y}}}},(e,t,n)=>{n.r(t),n.d(t,{defineLayoutWorker:()=>r});var i=n(66);function r(e){return(0,i.defineWorker)(e,[])}},(e,t,n)=>{n.r(t),n.d(t,{blockingDefaultLayout:()=>d,colaFlowLayout:()=>s,colaForceLayout:()=>o,colaRemoveOverlaps:()=>a,evaluateColaLayout:()=>r,getContentFittingBoxForLayout:()=>u,layoutPadded:()=>l,layoutPaddedBiasFree:()=>c});var i=n(100);function r(e,t,n){const i=new Map,r=[];for(const[s,a]of Object.entries(e.nodes)){const e=Object.hasOwn(t.bounds,s)?t.bounds[s]:void 0;i.set(s,{x:e?e.x:0,y:e?e.y:0,width:e?e.width:void 0,height:e?e.height:void 0,fixed:a.fixed?1:0})}for(const s of e.links){const e=i.get(s.source),t=i.get(s.target);e&&t&&r.push({source:e,target:t})}n(i,r);const o=Object.create(null);for(const[s,a]of i)o[s]={x:a.x,y:a.y,width:a.width??0,height:a.height??0};return{bounds:o}}function o(e,t,n){const{preferredLinkLength:o=200,avoidOverlaps:s=!0}=n??{};return r(e,t,((e,t)=>{(new i.Layout).nodes(Array.from(e.values())).links(t).avoidOverlaps(s).convergenceThreshold(1e-9).jaccardLinkLengths(o).handleDisconnected(!0).start(30,0,10,void 0,!1)}))}function s(e,t,n){const{axis:o="y",minSeparation:s=200,preferredLinkLength:a=50,avoidOverlaps:l=!0}=n??{};return r(e,t,((e,t)=>{(new i.Layout).nodes(Array.from(e.values())).links(t).avoidOverlaps(l).flowLayout(o,s).symmetricDiffLinkLengths(a).start(10,20,20,void 0,!1)}))}function a(e){const t=new Map;for(const[r,{x:o,y:s,width:a,height:l}]of Object.entries(e.bounds))t.set(r,new i.Rectangle(o,o+a,s,s+l));i.removeOverlaps(Array.from(t.values()));const n=Object.create(null);for(const[i,{x:r,y:o}]of t){const t=Object.hasOwn(e.bounds,i)?e.bounds[i]:void 0;n[i]={x:r,y:o,width:t?t.width:0,height:t?t.height:0}}return{bounds:n}}function l(e,t){if(!t)return{state:e,unwrap:e=>e};const n=Object.create(null);for(const[i,{x:r,y:o,width:s,height:a}]of Object.entries(e.bounds))n[i]={x:r-t.x,y:o-t.y,width:s+2*t.x,height:a+2*t.y};return{state:{bounds:n},unwrap:e=>{const n=Object.create(null);for(const[i,{x:r,y:o,width:s,height:a}]of Object.entries(e.bounds))n[i]={x:r+t.x,y:o+t.y,width:s-2*t.x,height:a-2*t.y};return{bounds:n}}}}function c(e,t){const n=Object.create(null);let i=1/0,r=1/0;for(const[s,{x:a,y:l,width:c,height:d}]of Object.entries(e.bounds)){const e=Math.max(c,d);i=Math.min(c?e/c:1,i),r=Math.min(d?e/d:1,r),n[s]={x:a,y:l,width:e,height:e}}const o=l({bounds:n},t);return{state:o.state,unwrap:t=>{const n=o.unwrap(t),s=u(n),a=Object.create(null);for(const[o,l]of Object.entries(n.bounds)){const t=Object.hasOwn(e.bounds,o)?e.bounds[o]:void 0;a[o]={x:(l.x-s.x)/i+s.x,y:(l.y-s.y)/r+s.y,width:t?t.width:l.width,height:t?t.height:l.height}}return{bounds:a}}}}function d(e,t,n){const{preferredLinkLength:i=200,padding:r={x:50,y:50}}=n??{},s=c(o(e,t,{preferredLinkLength:i,avoidOverlaps:!1}),r),l=a(s.state),d=s.unwrap(l);return Promise.resolve(d)}function u(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,{x:s,y:a,width:l,height:c}]of Object.entries(e.bounds))t=Math.min(t,s),n=Math.min(n,a),i=Math.max(i,s+l),r=Math.max(r,a+c);return{x:Number.isFinite(t)?t:0,y:Number.isFinite(n)?n:0,width:Number.isFinite(t)&&Number.isFinite(i)?i-t:0,height:Number.isFinite(n)&&Number.isFinite(r)?r-n:0}}},e=>{e.exports=Le},(e,t,n)=>{n.r(t),n.d(t,{LinkLabel:()=>S,LinkLayer:()=>f,LinkMarkers:()=>I,LinkPath:()=>w,LinkVertices:()=>_});var i,r=n(102),o=n(61),s=n(106),a=n.n(s),l=n(58),c=n(67),d=n(92),u=n(96),h=n(93),p=n(107),g=n(90);!function(e){e[e.Partial=1]="Partial",e[e.All=2]="All"}(i||(i={}));class f extends o.Component{listener=new l.EventObserver;delayedUpdate=new c.Debouncer;providedContext;updateState=i.Partial;scheduledToUpdate=new Set;labelMeasureRequests=new Set;delayedMeasureLabels=new c.Debouncer;memoizedLinks=new WeakMap;constructor(e){super(e),this.providedContext={scheduleLabelMeasure:this.scheduleLabelMeasure}}componentDidMount(){const{model:e,renderingState:t}=this.props,n=t=>{for(const n of e.getElementLinks(t))this.scheduleUpdateLink(n.id)};this.listener.listen(e.events,"changeLanguage",this.scheduleUpdateAll),this.listener.listen(e.events,"changeCells",(e=>{if(e.updateAll)this.scheduleUpdateAll();else if(e.changedElement&&n(e.changedElement),e.changedLinks)for(const t of e.changedLinks)this.scheduleUpdateLink(t.id)})),this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&n(e.changePosition.source)})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{const t=e.changeVertices||e.changeLinkState||e.requestedRedraw;t&&this.scheduleUpdateLink(t.source.id)})),this.listener.listen(e.events,"changeLinkVisibility",(t=>{for(const n of e.links.filter((e=>e.typeId===t.source)))this.scheduleUpdateLink(n.id)})),this.listener.listen(t.shared.events,"changeHighlight",this.scheduleUpdateAll),this.listener.listen(t.events,"changeElementSize",(e=>{n(e.source)}));const i=(e,t)=>{e.forEach(((e,n)=>{t.get(n)!==e&&this.scheduleUpdateLink(n)}))};this.listener.listen(t.events,"changeRoutings",(({previous:e})=>{const n=t.getRoutings();i(n,e),i(e,n)})),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{switch(e){case p.RenderingLayer.Link:this.delayedUpdate.runSynchronously();break;case p.RenderingLayer.LinkLabel:this.delayedMeasureLabels.runSynchronously()}}))}shouldComponentUpdate(){return!1}componentWillUnmount(){this.listener.stopListening(),this.delayedUpdate.dispose(),this.delayedMeasureLabels.dispose()}scheduleUpdateAll=()=>{this.updateState!==i.All&&(this.updateState=i.All,this.scheduledToUpdate=new Set),this.delayedUpdate.call(this.performUpdate)};scheduleUpdateLink(e){this.updateState===i.Partial&&this.scheduledToUpdate.add(e),this.delayedUpdate.call(this.performUpdate)}popShouldUpdatePredicate(){const{updateState:e,scheduledToUpdate:t}=this;return this.scheduledToUpdate=new Set,this.updateState=i.Partial,e===i.All?()=>!0:e=>t.has(e.id)}scheduleLabelMeasure=(e,t)=>{if(e.owner&&t){const{renderingState:t}=this.props;this.labelMeasureRequests.delete(e),t.setLinkLabelBounds(e.owner,void 0)}else this.labelMeasureRequests.add(e),this.delayedMeasureLabels.call(this.measureLabels)};measureLabels=()=>{const{renderingState:e}=this.props,t=Array.from(this.labelMeasureRequests);this.labelMeasureRequests.clear();const n=[];for(const i of t)n.push(i.measureSize());for(let i=0;i<t.length;i++){const r=t[i],o=n[i];if(r.owner&&o){const t=r.computeBounds(o);e.setLinkLabelBounds(r.owner,t)}}this.setState((()=>{for(let e=0;e<t.length;e++){const i=t[e],r=n[e];r&&i.applySize(r)}return null}))};performUpdate=()=>{this.forceUpdate()};render(){const{model:e,links:t,renderingState:n}=this.props,{memoizedLinks:i}=this,o=this.popShouldUpdatePredicate();for(const r of t)o(r)&&i.delete(r);return(0,r.jsx)(m.Provider,{value:this.providedContext,children:(0,r.jsx)("g",{className:"reactodia-link-layer",children:t.map((t=>{let o=i.get(t);return o||(o=(0,r.jsx)(b,{link:t,model:e,renderingState:n},t.id),i.set(t,o)),o}))})})}}const m=o.createContext(null),y="reactodia-link";function b(e){const{link:t,model:n,renderingState:i}=e,s=o.useMemo((()=>i.createLinkTemplate(t.typeId)),[t.typeId]),l=n.getElement(t.sourceId),c=n.getElement(t.targetId),d=n.getLinkVisibility(t.typeId);if(!l||!c||"hidden"===d)return null;const u=i.getRouting(t.id),p=t.vertices,g=u?u.vertices:p,f=(0,h.computePolyline)((0,h.boundsOf)(l,i),(0,h.boundsOf)(c,i),g),m=(0,h.pathFromPolyline)(f),b=(0,h.computePolylineLength)(f),x=i.ensureLinkTypeIndex(t.typeId),{highlighter:w}=i.shared,v=w&&!w(t),k=s.renderLink({link:t,markerSource:`url(#${E(x,!0)})`,markerTarget:`url(#${E(x,!1)})`,path:m,getPathPosition:e=>(0,h.getPointAlongPolyline)(f,b*e),route:u});return(0,r.jsx)("g",{"data-link-id":t.id,"data-source-id":t.sourceId,"data-target-id":t.targetId,className:a()(y,v?`${y}--blurred`:void 0),children:k})}const x="reactodia-link-path";function w(e){const{path:t,pathProps:n,markerSource:i,markerTarget:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{...n,className:a()(x,n?.className),d:t,markerStart:i,markerEnd:o}),(0,r.jsx)("path",{className:`${x}__wrap`,d:t})]})}const v="reactodia-link-label",k="middle";class S extends o.Component{static contextType=m;text;shouldUpdateBounds=!0;constructor(e){super(e),this.state={width:0,height:0}}get owner(){const{link:e,primary:t}=this.props;return t?e:void 0}render(){const{primary:e,position:{x:t,y:n},line:i=0,className:o,textAnchor:s=k,rectClass:l,rectStyle:c,textClass:d,textStyle:u,title:h,content:p,children:g}=this.props,{width:f,height:m}=this.state,{x:y,y:b}=this.computeBounds({width:f,height:m}),x=0===i?void 0:`translate(0, ${i*(m+2)}px)`;return(0,r.jsxs)("g",{style:x?{transform:x}:void 0,className:a()(v,e?`${v}--primary`:void 0,o),children:[h?(0,r.jsx)("title",{children:h}):void 0,(0,r.jsx)("rect",{x:y,y:b,width:f,height:m,className:l,style:c}),(0,r.jsx)("text",{ref:this.onTextMount,x:t,y:n,dy:"0.6ex",textAnchor:s,className:d,style:u,children:p}),g]})}measureSize(){if(!this.text)return;const{width:e,height:t}=this.text.getBBox();return{width:e,height:t}}applySize({width:e,height:t}){e===this.state.width&&t===this.state.height||this.setState({width:e,height:t})}computeBounds({width:e,height:t}){const{position:{x:n,y:i},textAnchor:r=k}=this.props;let o=0;return"middle"===r?o=-e/2:"end"===r&&(o=-e),{x:n+o,y:i-t/2,width:e,height:t}}onTextMount=e=>{this.text=e};componentDidMount(){this.tryRecomputeBounds(this.props)}componentWillUnmount(){const{scheduleLabelMeasure:e}=this.context;e(this,!0)}UNSAFE_componentWillReceiveProps(e){this.shouldUpdateBounds=!0}componentDidUpdate(e){this.tryRecomputeBounds(this.props)}tryRecomputeBounds(e){if(this.text&&this.shouldUpdateBounds){this.shouldUpdateBounds=!1;const{scheduleLabelMeasure:e}=this.context;e(this,!1)}}}const L="reactodia-link-vertices";function _(e){const{linkId:t,vertices:n,className:i,vertexRadius:o=10,fill:s}=e,{model:l}=(0,g.useCanvas)();if(0===n.length)return null;const c=a()(`${L}__vertex`,i),h=e=>{const n=l.getLink(t);if(!n)return;const i=new u.LinkVertex(n,e);l.history.registerToUndo((0,d.restoreCapturedLinkGeometry)(i.link)),i.remove()},p=[];for(let a=0;a<n.length;a++){const{x:e,y:t}=n[a],i=p.length;p.push((0,r.jsx)("circle",{"data-vertex":a,className:c,cx:e,cy:t,r:o,fill:s},i)),p.push((0,r.jsx)(M,{vertexIndex:a,vertexRadius:o,x:e,y:t,onRemove:h},i+1))}return(0,r.jsx)("g",{className:L,children:p})}class M extends o.Component{render(){const{vertexRadius:e,x:t,y:n}=this.props,i=`translate(${t+2*e},${n-2*e})scale(${e})`;return(0,r.jsxs)("g",{className:`${L}__handle`,"data-reactodia-no-export":"true",transform:i,onPointerDown:this.onRemoveVertex,children:[(0,r.jsx)("title",{children:"Remove vertex"}),(0,r.jsx)("circle",{r:1}),(0,r.jsx)("path",{d:"M-0.5,-0.5 L0.5,0.5 M0.5,-0.5 L-0.5,0.5",strokeWidth:2/e})]})}onRemoveVertex=e=>{if(0!==e.button)return;e.preventDefault(),e.stopPropagation();const{onRemove:t,vertexIndex:n}=this.props;t(n)}}class I extends o.Component{listener=new l.EventObserver;delayedUpdate=new c.Debouncer;render(){const{renderingState:e}=this.props,t=e.shared.defaultLinkTemplate,n=[];for(const[i,o]of e.getLinkTemplates()){const s=e.ensureLinkTypeIndex(i);o.markerSource&&n.push((0,r.jsx)(T,{linkTypeIndex:s,isStartMarker:!0,style:o.markerSource,defaultStyle:t.markerSource},2*s)),o.markerTarget&&n.push((0,r.jsx)(T,{linkTypeIndex:s,isStartMarker:!1,style:o.markerTarget,defaultStyle:t.markerTarget},2*s+1))}return(0,r.jsx)("defs",{children:n})}componentDidMount(){const{renderingState:e}=this.props;this.listener.listen(e.events,"syncUpdate",(({layer:e})=>{e===p.RenderingLayer.Link&&this.delayedUpdate.runSynchronously()})),this.listener.listen(e.events,"changeLinkTemplates",(()=>{this.delayedUpdate.call((()=>this.forceUpdate()))}))}shouldComponentUpdate(){return!1}componentWillUnmount(){this.listener.stopListening(),this.delayedUpdate.dispose()}}class T extends o.Component{render(){return(0,r.jsx)("marker",{ref:this.onMarkerMount})}shouldComponentUpdate(){return!1}onMarkerMount=e=>{if(!e)return;const{linkTypeIndex:t,isStartMarker:n,style:i,defaultStyle:r}=this.props,{d:o=r?.d,width:s=r?.width,height:a=r?.height}=i;if(void 0===o||void 0===s||void 0===a)return;e.setAttribute("id",E(t,n)),e.setAttribute("markerWidth",String(s)),e.setAttribute("markerHeight",String(a)),e.setAttribute("orient","auto");const l=n?0:s-1;e.setAttribute("refX",String(l)),e.setAttribute("refY",String(a/2)),e.setAttribute("markerUnits","userSpaceOnUse");const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",o),void 0!==i.fill&&c.setAttribute("fill",i.fill),void 0!==i.stroke&&c.setAttribute("stroke",i.stroke),void 0!==i.strokeWidth&&c.setAttribute("stroke-width",String(i.strokeWidth)),e.appendChild(c)}}function E(e,t){return`reactodia-marker-${t?"start":"end"}-${e}`}},(e,t,n)=>{e.exports=n(103)},(e,t,n)=>{n(104);var i=n(61),r=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),t.Fragment=o("react.fragment")}var s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,o={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:d,props:o,_owner:s.current}}t.jsx=c,t.jsxs=c},e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(e,r){for(var o,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(a[c]=o[c]);if(t){s=t(o);for(var d=0;d<s.length;d++)i.call(o,s[d])&&(a[s[d]]=o[s[d]])}}return a}},(e,t,n)=>{0},(e,t)=>{var n;!function(){var i={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)i.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},(e,t,n)=>{n.r(t),n.d(t,{MutableRenderingState:()=>h,RenderingLayer:()=>i});var i,r=n(58),o=n(67),s=n(93),a=n(108);!function(e){e[e.Element=1]="Element",e[e.ElementSize=2]="ElementSize",e[e.PaperArea=3]="PaperArea",e[e.LinkRoutes=4]="LinkRoutes",e[e.Link=5]="Link",e[e.LinkLabel=6]="LinkLabel",e[e.Overlay=7]="Overlay"}(i||(i={}));const l=i.Element,c=i.Overlay,d=e=>{},u=e=>{};class h{listener=new r.EventObserver;source=new r.EventSource;events=this.source;model;resolveElementTemplate;resolveLinkTemplate;linkRouter;elementSizes=new WeakMap;linkLabelBounds=new WeakMap;linkTypeIndex=new Map;static nextLinkTypeIndex=0;linkTemplates=new Map;delayedUpdateRoutings=new o.Debouncer;routings=new Map;shared;constructor(e){this.model=e.model,this.shared=e.shared,this.resolveElementTemplate=e.elementTemplateResolver??d,this.resolveLinkTemplate=e.linkTemplateResolver??u,this.linkRouter=e.linkRouter??new a.DefaultLinkRouter,this.listener.listen(this.model.events,"changeCells",(()=>this.scheduleUpdateRoutings())),this.listener.listen(this.model.events,"linkEvent",(({data:e})=>{e.changeVertices&&this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"elementEvent",(({data:e})=>{e.changePosition&&this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"changeLinkVisibility",(e=>{this.scheduleUpdateRoutings()})),this.listener.listen(this.model.events,"discardGraph",(()=>{this.linkTemplates.clear();const e=this.routings;this.routings=new Map,this.delayedUpdateRoutings.dispose(),this.source.trigger("changeLinkTemplates",{source:this}),this.source.trigger("changeRoutings",{source:this,previous:e})})),this.listener.listen(this.events,"changeElementSize",(()=>{this.scheduleUpdateRoutings()})),this.listener.listen(this.events,"syncUpdate",(({layer:e})=>{e===i.LinkRoutes&&this.delayedUpdateRoutings.runSynchronously()})),this.updateRoutings()}dispose(){this.listener.stopListening(),this.delayedUpdateRoutings.dispose()}syncUpdate(){for(let e=l;e<=c;e++)this.source.trigger("syncUpdate",{layer:e})}getElementSize(e){return this.elementSizes.get(e)}setElementSize(e,t){const n=this.elementSizes.get(e);n&&n.width===t.width&&n.height===t.height||(this.elementSizes.set(e,t),this.source.trigger("changeElementSize",{source:e,previous:n}))}getLinkLabelBounds(e){return this.linkLabelBounds.get(e)}setLinkLabelBounds(e,t){const n=this.linkLabelBounds.get(e);!n&&!t||n&&t&&n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height||(t?this.linkLabelBounds.set(e,t):this.linkLabelBounds.delete(e),this.source.trigger("changeLinkLabelBounds",{source:e,previous:n}))}getElementTemplate(e){return this.resolveElementTemplate(e)??this.shared.defaultElementTemplate}ensureLinkTypeIndex(e){let t=this.linkTypeIndex.get(e);return void 0===t&&(t=h.nextLinkTypeIndex++,this.linkTypeIndex.set(e,t)),t}getLinkTemplates(){return this.linkTemplates}createLinkTemplate(e){const t=this.linkTemplates.get(e);if(t)return t;const n=this.resolveLinkTemplate(e)??this.shared.defaultLinkTemplate;return this.linkTemplates.set(e,n),this.source.trigger("changeLinkTemplates",{source:this}),n}getRoutings(){return this.routings}getRouting(e){return this.routings.get(e)}scheduleUpdateRoutings(){this.delayedUpdateRoutings.call(this.updateRoutings)}updateRoutings=()=>{const e=this.routings,t=this.linkRouter.route(this.model,this);e.forEach(((e,n)=>{const i=t.get(n);var r,o;i&&(o=i,(r=e).linkId===o.linkId&&r.labelTextAnchor===o.labelTextAnchor&&(0,s.isPolylineEqual)(r.vertices,o.vertices))&&t.set(n,e)})),this.routings=t,this.source.trigger("changeRoutings",{source:this,previous:e})}}},(e,t,n)=>{n.r(t),n.d(t,{DefaultLinkRouter:()=>r});var i=n(93);class r{gap;constructor(e={}){const{gap:t=20}=e;this.gap=t}route(e,t){const n=new Map;for(const i of e.links){if(n.has(i.id))continue;const{sourceId:r,targetId:o}=i;r&&o&&(r===o?this.routeFeedbackSiblingLinks(r,e,t,n):this.routeNormalSiblingLinks(r,o,e,t,n))}return n}routeFeedbackSiblingLinks(e,t,n,r){const s=t.getElement(e),{x:a,y:l,width:c,height:d}=(0,i.boundsOf)(s,n);let u=0;for(const i of t.getElementLinks(s)){if(r.has(i.id)||"hidden"===t.getLinkVisibility(i.typeId)||o(i))continue;const{sourceId:e,targetId:n}=i;if(e===n){const e=this.gap*(u+1),t=[{x:a-e,y:l+d/2},{x:a-e,y:l-e},{x:a+c/2,y:l-e}];r.set(i.id,{linkId:i.id,vertices:t}),u++}}}routeNormalSiblingLinks(e,t,n,r,s){const a=n.getElement(e),l=n.getElement(t),c=i.Rect.center((0,i.boundsOf)(a,r)),d=i.Rect.center((0,i.boundsOf)(l,r)),u=(c.x+d.x)/2,h=(c.y+d.y)/2,p=i.Vector.normalize({x:d.x-c.x,y:d.y-c.y}),g=n.getElementLinks(a).filter((e=>!(e.sourceId!==t&&e.targetId!==t||s.has(e.id)||o(e)||"hidden"===n.getLinkVisibility(e.typeId))));if(g.length<=1)return;const f=g.length%2?0:1;g.forEach(((e,t)=>{const n=t+f,i=this.gap*Math.ceil(n/2)-(f?this.gap/2:0),r=n%2?{x:-p.y,y:p.x}:{x:p.y,y:-p.x},o={x:u+r.x*i,y:h+r.y*i};s.set(e.id,{linkId:e.id,vertices:[o],labelTextAnchor:this.getLabelAlignment(p,t,g.length)})}))}getLabelAlignment(e,t,n){const i=Math.atan2(e.y,e.x),r=Math.abs(i),o=i<0,s=i>0,a=n-2,l=n-1;if(!(r<1*Math.PI/8||r>7*Math.PI/8)){if(o&&t===l||s&&t===a)return"end";if(o&&t===a||s&&t===l)return"start"}return"middle"}}function o(e){return e.vertices.length>0}},(e,t,n)=>{n.r(t),n.d(t,{Paper:()=>c,TransformedSvgCanvas:()=>h,paneFromPaperCoords:()=>f,paneTopLeft:()=>g,paperFromPaneCoords:()=>m,totalPaneSize:()=>p});var i=n(102),r=n(61),o=n(96),s=n(110),a=n(101);const l="reactodia-paper";class c extends r.Component{render(){const{model:e,renderingState:t,paperTransform:n,svgCanvasRef:r,linkLayerWidgets:o,elementLayerWidgets:c}=this.props,{width:d,height:u,originX:p,originY:g,scale:f,paddingX:m,paddingY:y}=n,b={width:d*f+m,height:u*f+y,marginLeft:m,marginTop:y,paddingRight:m,paddingBottom:y},x={position:"absolute",left:0,top:0,transform:`scale(${f},${f})translate(${p}px,${g}px)`};return(0,i.jsxs)("div",{className:l,style:b,onPointerDown:this.onPointerDown,onContextMenu:this.onContextMenu,onScrollCapture:this.onScrollCapture,children:[(0,i.jsxs)(h,{svgCanvasRef:r,className:`${l}__canvas`,style:{overflow:"visible"},paperTransform:n,children:[(0,i.jsx)(a.LinkMarkers,{renderingState:t}),(0,i.jsx)(a.LinkLayer,{model:e,renderingState:t,links:e.links})]}),o,(0,i.jsx)(s.ElementLayer,{model:e,renderingState:t,style:x}),c]})}onPointerDown=e=>{const{model:t,onPointerDown:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}};onContextMenu=e=>{const{model:t,onContextMenu:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}};onScrollCapture=e=>{const{model:t,onScrollCapture:n}=this.props;if(n){n(e,e.target instanceof Element?d(e.target,e.currentTarget,t):void 0)}}}function d(e,t,n){let i,r=e;for(;;){if(r instanceof Element){if(r.hasAttribute("data-element-id"))return n.getElement(r.getAttribute("data-element-id"));if(r.hasAttribute("data-link-id")){const e=n.getLink(r.getAttribute("data-link-id"));if(!e)return;return"number"==typeof i?new o.LinkVertex(e,i):e}r.hasAttribute("data-vertex")&&(i=Number(r.getAttribute("data-vertex")))}if(!r||r===t)break;r=r.parentNode}}const u={position:"absolute",top:0,left:0};function h(e){const{svgCanvasRef:t,paperTransform:n,style:r,children:o,...s}=e,{width:a,height:l,originX:c,originY:d,scale:h,paddingX:p,paddingY:g}=n,f=a*h,m=l*h;let y=u;return r&&(y={...y,...r}),(0,i.jsx)("svg",{ref:t,width:f,height:m,style:y,...s,children:(0,i.jsx)("g",{transform:`scale(${h},${h})translate(${c},${d})`,children:o})})}function p(e){return{x:e.width*e.scale+2*e.paddingX,y:e.height*e.scale+2*e.paddingY}}function g(e){return{x:-e.paddingX,y:-e.paddingY}}function f(e,t){return{x:(e.x+t.originX)*t.scale,y:(e.y+t.originY)*t.scale}}function m(e,t){return{x:e.x/t.scale-t.originX,y:e.y/t.scale-t.originY}}},(e,t,n)=>{n.r(t),n.d(t,{ElementLayer:()=>h});var i,r=n(102),o=n(61),s=n(111),a=n(58),l=n(67),c=n(92),d=n(96),u=n(107);!function(e){e[e.None=0]="None",e[e.ScanCell=1]="ScanCell",e[e.Render=2]="Render",e[e.RecomputeTemplate=6]="RecomputeTemplate",e[e.RecomputeBlurred=10]="RecomputeBlurred"}(i||(i={}));class h extends o.Component{listener=new a.EventObserver;redrawBatch={requests:new Map,forAll:i.None};delayedRedraw=new l.Debouncer;memoizedElements=new WeakMap;sizeRequests=new Map;delayedUpdateSizes=new l.Debouncer;constructor(e){super(e);const{model:t,renderingState:n}=this.props;this.state={elementStates:p(t,n.shared,this.redrawBatch,new Map)}}render(){const{style:e,model:t,renderingState:n}=this.props,{elementStates:i}=this.state,{memoizedElements:s}=this,a=[];for(const{id:r}of t.elements){const e=i.get(r);e&&a.push(e)}return(0,r.jsx)("div",{className:"reactodia-element-layer",style:e,children:a.map((e=>{let i=s.get(e);if(!i){i=(0,r.jsx)(f,{state:e,model:t,renderingState:n,onResize:this.requestSizeUpdate},e.element.id);const a=n.shared._decorateElement(e.element);a&&(i=(0,r.jsxs)(o.Fragment,{children:[i,a]},e.element.id)),s.set(e,i)}return i}))})}componentDidMount(){const{model:e,renderingState:t}=this.props;this.listener.listen(e.events,"changeCells",(e=>{e.updateAll?this.requestRedrawAll(i.ScanCell):e.changedElement&&this.requestRedraw(e.changedElement,i.ScanCell)})),this.listener.listen(e.events,"changeCellOrder",(()=>{this.requestRedrawAll(i.None)})),this.listener.listen(e.events,"elementEvent",(({data:e})=>{const t=e.changeExpanded||e.changeElementState;t&&this.requestRedraw(t.source,i.RecomputeTemplate);const n=e.changePosition;if(n&&this.requestRedraw(n.source,i.Render),e.requestedRedraw){let t=i.Render;if("template"===e.requestedRedraw.level)t=i.RecomputeTemplate;this.requestRedraw(e.requestedRedraw.source,t)}})),this.listener.listen(e.events,"changeLanguage",(()=>{this.requestRedrawAll(i.RecomputeTemplate)})),this.listener.listen(t.shared.events,"changeHighlight",(()=>{this.requestRedrawAll(i.RecomputeBlurred)})),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{(0,s.flushSync)((()=>{e===u.RenderingLayer.Element?this.delayedRedraw.runSynchronously():e===u.RenderingLayer.ElementSize&&this.delayedUpdateSizes.runSynchronously()}))}))}componentWillUnmount(){this.listener.stopListening(),this.delayedRedraw.dispose(),this.delayedUpdateSizes.dispose()}requestRedraw=(e,t)=>{if((this.redrawBatch.forAll|t)===this.redrawBatch.forAll)return;const n=this.redrawBatch.requests.get(e.id)||i.None;this.redrawBatch.requests.set(e.id,n|t),this.delayedRedraw.call(this.redrawElements)};requestRedrawAll(e){this.redrawBatch.forAll|=e,this.delayedRedraw.call(this.redrawElements)}redrawElements=()=>{this.setState(((e,t)=>({elementStates:p(t.model,t.renderingState.shared,this.redrawBatch,e.elementStates)})))};requestSizeUpdate=(e,t)=>{this.sizeRequests.set(e.id,{element:e,node:t}),this.delayedUpdateSizes.call(this.recomputeQueuedSizes)};recomputeQueuedSizes=()=>{const{renderingState:e}=this.props,t=this.sizeRequests;this.sizeRequests=new Map,t.forEach((({element:t,node:n})=>{const{clientWidth:i,clientHeight:r}=n;e.setElementSize(t,{width:i,height:r})}))}}function p(e,t,n,r){if(n.forAll===i.None&&0===n.requests.size)return r;const o=new Map;for(const s of e.elements){const e=s.id;let a=r.get(e);if(a){const r=(n.requests.get(e)||i.None)|n.forAll;r&i.Render&&(a={element:s,templateProps:(r&i.RecomputeTemplate)===i.RecomputeTemplate?g(a.element):a.templateProps,blurred:(r&i.RecomputeBlurred)===i.RecomputeBlurred?y(a.element,t):a.blurred}),o.set(e,a),n.requests.delete(e)}else o.set(s.id,{element:s,templateProps:g(s),blurred:y(s,t)})}return n.forAll=i.None,o}function g(e){return{elementId:e.id,element:e,isExpanded:e.isExpanded,elementState:e.elementState}}class f extends o.Component{listener=new a.EventObserver;render(){const{state:{element:e,blurred:t}}=this.props;if(e instanceof d.VoidElement)return(0,r.jsx)("div",{});const{x:n=0,y:i=0}=e.position,o=`translate(${n}px,${i}px)`,s="reactodia-overlaid-element "+(t?"reactodia-overlaid-element--blurred":"");return(0,r.jsx)("div",{className:s,"data-element-id":e.id,style:{position:"absolute",transform:o},tabIndex:0,ref:this.onMount,onLoad:this.onLoadOrErrorEvent,onError:this.onLoadOrErrorEvent,onClick:this.onClick,onDoubleClick:this.onDoubleClick,children:(0,r.jsx)(m,{...this.props})})}onMount=e=>{if(!e)return;const{state:t,onResize:n}=this.props;n(t.element,e)};onLoadOrErrorEvent=()=>{const{state:e,onResize:t}=this.props;t(e.element,(0,s.findDOMNode)(this))};onClick=e=>{if(e.target instanceof HTMLElement&&"a"===e.target.localName){const t=e.target,{renderingState:n,state:i}=this.props,r="openEntityIri"===e.target.getAttribute("data-iri-click-intent")?"openEntityIri":"openOtherIri";n.shared.onIriClick(decodeURI(t.href),i.element,r,e)}};onDoubleClick=e=>{e.preventDefault(),e.stopPropagation();const{model:t,state:{element:n}}=this.props;t.history.execute((0,c.setElementExpanded)(n,!n.isExpanded))};componentDidMount(){const{state:e,model:t}=this.props;this.listener.listen(e.element.events,"requestedFocus",(()=>{const e=(0,s.findDOMNode)(this);e&&e.focus()}))}componentWillUnmount(){this.listener.stopListening()}shouldComponentUpdate(e){return this.props.state!==e.state}componentDidUpdate(){const{state:e,onResize:t}=this.props;t(e.element,(0,s.findDOMNode)(this))}}class m extends o.Component{cachedTemplateClass;cachedTemplateProps;render(){const{state:e,renderingState:t}=this.props,{element:n,templateProps:i}=e,r=t.getElementTemplate(n);return this.cachedTemplateClass=r,this.cachedTemplateProps=i,o.createElement(r,i)}shouldComponentUpdate(e){const t=e.renderingState.getElementTemplate(e.state.element);return!(this.cachedTemplateClass===t&&this.cachedTemplateProps===e.state.templateProps)}}function y(e,t){return Boolean(t.highlighter&&!t.highlighter(e))}},e=>{e.exports=Se},(e,t,n)=>{n.r(t),n.d(t,{RenameLinkToLinkStateProvider:()=>a,SharedCanvasState:()=>s});var i=n(61),r=n(58),o=n(74);class s{listener=new r.EventObserver;source=new r.EventSource;events=this.source;disposed=!1;_canvasWidgets;dropOnPaperHandler;_highlighter;_elementDecorator;defaultElementTemplate;defaultLinkTemplate;defaultLayout;renameLinkProvider;constructor(e){const{defaultElementTemplate:t,defaultLinkTemplate:n,defaultLayout:i,renameLinkProvider:r}=e;this._canvasWidgets=new Map,this.defaultElementTemplate=t,this.defaultLinkTemplate=n,this.defaultLayout=i,this.renameLinkProvider=r}dispose(){this.disposed||(this.source.trigger("dispose",{source:this}),this.listener.stopListening(),this.disposed=!0)}findAllCanvases(){const e={canvases:[]};return this.source.trigger("findCanvas",e),e.canvases}findAnyCanvas(){const e=this.findAllCanvases();return e.length>0?e[0]:void 0}onIriClick(e,t,n,i){i.persist(),i.preventDefault(),this.source.trigger("iriClick",{iri:e,element:t,clickIntent:n,originalEvent:i})}get widgets(){return this._canvasWidgets}setCanvasWidget(e,t){const n=this._canvasWidgets,r=new Map(n);if(t){const n={element:i.cloneElement(t.element,{key:e}),attachment:t.attachment};r.set(e,n)}else r.delete(e);this._canvasWidgets=r,this.source.trigger("changeWidgets",{source:this,previous:n})}setHandlerForNextDropOnPaper(e){this.dropOnPaperHandler=e}tryHandleDropOnPaper(e){const{dropOnPaperHandler:t}=this;return!!t&&(this.dropOnPaperHandler=void 0,e.sourceEvent.preventDefault(),t(e),!0)}get highlighter(){return this._highlighter}setHighlighter(e){const t=this._highlighter;t!==e&&(this._highlighter=e,this.source.trigger("changeHighlight",{source:this,previous:t}))}_setElementDecorator(e){this._elementDecorator=e}_decorateElement(e){return this._elementDecorator?.(e)}}class a{canRename(e){return!0}getLabel(e){const{linkState:t}=e;if(t&&Object.prototype.hasOwnProperty.call(t,o.TemplateProperties.CustomLabel)){const e=t[o.TemplateProperties.CustomLabel];if("string"==typeof e)return e}}setLabel(e,t){e.setLinkState({...e.linkState,[o.TemplateProperties.CustomLabel]:0===t.length?void 0:t})}}},(e,t,n)=>{n.r(t),n.d(t,{HtmlSpinner:()=>s,Spinner:()=>o});var i=n(102);const r="reactodia-spinner";function o(e){const{position:t={x:0,y:0},size:n=50,statusText:o,errorOccurred:s}=e,a="m3.47,-19.7 a20,20 0 1,1 -6.95,0 m0,0 l-6,5 m6,-5 l-8,-0"+(s?"M-8,-8L8,8M-8,8L8,-8":"");return(0,i.jsxs)("g",{className:r,"data-error":s,transform:`translate(${t.x},${t.y})`,children:[(0,i.jsx)("g",{className:`${r}__arrow`,children:(0,i.jsx)("path",{d:a,transform:`scale(0.02)scale(${n})`,fill:"none",stroke:s?"red":"black",strokeWidth:"3",strokeLinecap:"round"})}),(0,i.jsx)("text",{style:{dominantBaseline:"middle"},x:n/2+5,children:o})]})}function s(e){const{width:t,height:n,errorOccurred:r}=e,s=Math.min(t,n);return(0,i.jsx)("svg",{width:t,height:n,children:(0,i.jsx)(o,{size:s,position:{x:t/2,y:n/2},errorOccurred:r})})}},(e,t,n)=>{n.r(t),n.d(t,{AuthoringState:()=>i,TemporaryState:()=>r});var i,r,o=n(59),s=n(68);function a(e,t){return e.sourceId===t||e.targetId===t}!function(e){function t(e){return{elements:new Map(e.elements),links:e.links.clone()}}function n(e){switch(e.type){case"entityAdd":case"entityChange":case"entityDelete":return!0;default:return!1}}function i(e,t){return n(t)?e.elements.get(t.data.id)===t:e.links.get(t.data)===t}function r(e,t){const n=e.elements.get(t);return Boolean(n&&"entityAdd"===n.type)}function l(e,t){const n=e.elements.get(t);return Boolean(n&&"entityDelete"===n.type)}function c(e,t){const n=e.links.get(t);return Boolean(n&&"relationAdd"===n.type)}e.empty={elements:new Map,links:new o.HashMap(s.hashLink,s.equalLinks)},e.isEmpty=function(e){return 0===e.elements.size&&0===e.links.size},e.clone=t,e.isEntityEvent=n,e.isLinkEvent=function(e){return!n(e)},e.has=i,e.discard=function(e,r){if(!i(e,r))return e;const o=t(e);if(n(r)){if(o.elements.delete(r.data.id),"entityAdd"===r.type)for(const{data:t}of e.links.values())a(t,r.data.id)&&o.links.delete(t)}else o.links.delete(r.data);return o},e.addEntity=function(e,n){const i=t(e);return i.elements.set(n.id,{type:"entityAdd",data:n}),i},e.addRelation=function(e,n){const i=t(e);return i.links.set(n,{type:"relationAdd",data:n}),i},e.changeEntity=function(e,n,i){const r=t(e);r.elements.delete(n.id);const o=e.elements.get(n.id);if(o&&"entityChange"!==o.type&&"entityDelete"!==o.type){if(r.elements.set(i.id,{type:"entityAdd",data:i}),n.id!==i.id)for(const t of e.links.values())if("relationChange"!==t.type&&a(t.data,n.id)){const e=(s=t.data,l=n.id,c=i.id,{...s,sourceId:s.sourceId===l?c:s.sourceId,targetId:s.targetId===l?c:s.targetId});r.links.delete(t.data),r.links.set(e,{type:"relationAdd",data:e})}}else{const e=i.id!==n.id;r.elements.set(n.id,{type:"entityChange",before:o&&"entityChange"===o.type?o.before:n,data:e?{...i,id:n.id}:i,newIri:e?i.id:void 0})}var s,l,c;return r},e.changeRelation=function(e,n,i){if(!(0,s.equalLinks)(n,i))throw new Error("Cannot move link to another element or change its type");const r=t(e),o=e.links.get(n);return r.links.set(n,{type:"relationChange",before:o&&"relationChange"===o.type?o.before:n,data:i}),r},e.deleteEntity=function(e,n){const i=t(e);i.elements.delete(n.id);for(const{data:t}of e.links.values())a(t,n.id)&&i.links.delete(t);return r(e,n.id)||i.elements.set(n.id,{type:"entityDelete",data:n}),i},e.deleteRelation=function(e,n){const i=t(e);return i.links.delete(n),c(e,n)||i.links.set(n,{type:"relationDelete",data:n}),i},e.discardAddedRelations=function(e,n){const i=t(e);for(const t of e.links.values())if("relationAdd"===t.type){const e=t.data;(n.has(e.sourceId)||n.has(e.targetId))&&i.links.delete(e)}return i},e.isAddedEntity=r,e.isDeletedEntity=l,e.hasEntityChangedIri=function(e,t){const n=e.elements.get(t);return Boolean(n&&"entityChange"===n.type&&n.newIri)},e.isAddedRelation=c,e.isDeletedRelation=function(e,t){const n=e.links.get(t);return n&&"relationDelete"===n.type||l(e,t.sourceId)||l(e,t.targetId)}}(i||(i={})),function(e){e.empty={elements:new Set,links:new o.HashSet(s.hashLink,s.equalLinks)},e.addEntity=function(e,t){if(e.elements.has(t.id))return e;const n=new Set(e.elements);return n.add(t.id),{...e,elements:n}},e.removeEntity=function(e,t){if(!e.elements.has(t.id))return e;const n=new Set(e.elements);return n.delete(t.id),{...e,elements:n}},e.addRelation=function(e,t){if(e.links.has(t))return e;const n=e.links.clone();return n.add(t),{...e,links:n}},e.removeRelation=function(e,t){if(!e.links.has(t))return e;const n=e.links.clone();return n.delete(t),{...e,links:n}}}(r||(r={}))},(e,t,n)=>{n.r(t),n.d(t,{BuiltinDialogType:()=>i});const i={connectionsMenu:"reactodia:connectionsMenu",editEntity:"reactodia:editEntity",editRelation:"reactodia:editRelation",findOrCreateEntity:"reactodia:findOrCreateEntity",renameLink:"reactodia:renameLink"}},(e,t,n)=>{n.r(t),n.d(t,{DataDiagramModel:()=>g,requestElementData:()=>m,restoreLinksBetweenElements:()=>y});var i=n(56),r=n(68),o=n(78),s=n(92),a=n(93),l=n(94),c=n(117),d=n(119),u=n(120),h=n(121),p=n(122);class g extends c.DiagramModel{dataGraph=new p.DataGraph;loadingScope;_dataProvider;fetcher;constructor(e){super(e),this._dataProvider=new o.EmptyDataProvider,this.fetcher=new u.DataFetcher(this.graph,this.dataGraph,this._dataProvider),this.subscribeGraph()}createLocale(e){return new f(this,e)}get extendedSource(){return this.source}get dataProvider(){return this._dataProvider}getTermFactory(){return this._dataProvider.factory}get operations(){return this.fetcher.operations}getOperationFailReason(e,t){return this.fetcher.getFailReason(e,t)}resetGraph(){this.dataGraph=new p.DataGraph,super.resetGraph(),this.loadingScope?.abort(),this.fetcher.dispose()}subscribeGraph(){this.graphListener.listen(this.dataGraph.events,"elementTypeEvent",(e=>{this.extendedSource.trigger("elementTypeEvent",e)})),this.graphListener.listen(this.dataGraph.events,"linkTypeEvent",(e=>{this.extendedSource.trigger("linkTypeEvent",e)})),this.graphListener.listen(this.dataGraph.events,"propertyTypeEvent",(e=>{this.extendedSource.trigger("propertyTypeEvent",e)})),super.subscribeGraph()}setDataProvider(e){this._dataProvider=e,this.fetcher=new u.DataFetcher(this.graph,this.dataGraph,e),this.graphListener.listen(this.fetcher.events,"changeOperations",(e=>{this.extendedSource.trigger("changeOperations",e)}))}async createNewDiagram(e){const{dataProvider:t,signal:n}=e;return this.importLayout({dataProvider:t,signal:n})}async importLayout(e){const{dataProvider:t,diagram:n=(0,h.emptyDiagram)(),preloadedElements:r,validateLinks:o=!1,hideUnusedLinkTypes:s=!1,signal:a}=e;this.resetGraph(),this.setDataProvider(t),this.loadingScope=new i.AbortScope(a),this.extendedSource.trigger("loadingStart",{source:this});const l=this.loadingScope.signal;try{if(l.throwIfAborted(),this.setLinkSettings(n.linkTypeOptions??[]),this.createGraphElements({diagram:n,preloadedElements:r,markLinksAsLayoutOnly:o}),s){const e=await this.dataProvider.knownLinkTypes({signal:l});l.throwIfAborted();const t=this.initLinkTypes(e);this.hideUnusedLinkTypes(t)}this.subscribeGraph();const t=[];for(const e of this.graph.getElements())for(const n of(0,d.iterateEntitiesOf)(e))r&&r.has(n.id)||t.push(n.id);const i=this.requestElementData(t),a=e.validateLinks?this.requestLinks():Promise.resolve();await Promise.all([i,a]),this.history.reset(),this.extendedSource.trigger("loadingSuccess",{source:this})}catch(c){throw this.extendedSource.trigger("loadingError",{source:this,error:c}),new Error("Reactodia: failed to import a layout",{cause:c})}finally{this.loadingScope?.abort(),this.loadingScope=void 0}}discardLayout(){this.resetGraph(),this.setDataProvider(new o.EmptyDataProvider),this.extendedSource.trigger("loadingStart",{source:this}),this.subscribeGraph(),this.history.reset(),this.extendedSource.trigger("loadingSuccess",{source:this})}exportLayout(){const e=new Set(this.graph.getLinks().map((e=>e.typeId))),t=new Map;for(const n of e)t.set(n,this.getLinkVisibility(n));return(0,h.serializeDiagram)({elements:this.graph.getElements(),links:this.graph.getLinks(),linkTypeVisibility:t})}initLinkTypes(e){const t=[];for(const n of e){const e=new d.LinkType({id:n.id,data:n});this.dataGraph.addLinkType(e),t.push(e)}return t}setLinkSettings(e){for(const t of e){const{visible:e=!0,showLabel:n=!0}=t,i=t.property,r=e&&n?"visible":e&&!n?"withoutLabel":"hidden";this.setLinkVisibility(i,r)}}createGraphElements(e){const{diagram:t,preloadedElements:n,markLinksAsLayoutOnly:i}=e,{elements:r,links:o,linkTypeVisibility:s}=(0,h.deserializeDiagram)(t,{preloadedElements:n,markLinksAsLayoutOnly:i}),a=this.history.startBatch("Import layout");for(const[c,d]of s)this.setLinkVisibility(c,d);const l=new Set;for(const c of o){const e=this.createLinkType(c.typeId);l.add(e.id)}for(const c of r)this.addElement(c);for(const c of o)this.addLink(c);a.store()}hideUnusedLinkTypes(e){const t=new Set;for(const n of this.graph.getLinks())t.add(n.typeId);for(const n of e)t.has(n.id)||this.setLinkVisibility(n.id,"hidden")}requestElementData(e){return this.fetcher.fetchElementData(e)}requestLinks(e={}){const{addedElements:t,linkTypes:n}=e,i=[];for(const o of this.graph.getElements())for(const e of(0,d.iterateEntitiesOf)(o))i.push(e.id);const r=t??i;return 0===i.length||0===r.length?Promise.resolve():this.fetcher.fetchLinks(i,r,n).then((e=>this.onLinkInfoLoaded(e)))}requestLinksOfType(e){return this.requestLinks({linkTypes:e})}createElement(e){const t="string"==typeof e?e:e.id,n=this.elements.filter((e=>e instanceof d.EntityElement&&e.iri===t));if(n.length>0)return n[0];let i="string"==typeof e?d.EntityElement.placeholderData(t):e;i={...i,id:i.id};const r=new d.EntityElement({data:i});return this.addElement(r),r}addLink(e){this.createLinkType(e.typeId),super.addLink(e)}onLinkInfoLoaded(e){let t;const n=()=>{t=!1},i=this.history.startBatch("Create loaded links");for(const r of e)this.createLinkType(r.linkTypeId),t=!0,this.extendedSource.trigger("createLoadedLink",{source:this,model:r,cancel:n}),t&&this.createLinks(r);i.discard()}createLinks(e){const t=this.graph.getElements().filter((t=>t instanceof d.EntityElement&&t.iri===e.sourceId||t instanceof d.EntityGroup&&t.itemIris.has(e.sourceId))),n=this.graph.getElements().filter((t=>t instanceof d.EntityElement&&t.iri===e.targetId||t instanceof d.EntityGroup&&t.itemIris.has(e.targetId))),i=this.history.startBatch("Create links"),r=[];for(const o of t)for(const t of n){const n=this.createRelation(o,t,e);r.push(n)}return i.store(),r}createRelation(e,t,n){const i=Array.from(this.graph.iterateLinks(e.id,t.id,n.linkTypeId));for(const a of i){if(a instanceof d.RelationLink&&(0,r.equalLinks)(a.data,n))return this.history.execute((0,s.setLinkState)(a,(0,h.markLayoutOnly)(a.linkState,!1))),this.history.execute((0,d.setRelationLinkData)(a,n)),a;if(a instanceof d.RelationGroup&&a.itemKeys.has(n)){const e=a.items.map((e=>(0,r.equalLinks)(e.data,n)?{...e,data:n,linkState:(0,h.markLayoutOnly)(e.linkState,!1)}:e));return this.history.execute((0,d.setRelationGroupItems)(a,e)),a}}for(const r of i)if(r.typeId==r.typeId){if(r instanceof d.RelationLink){const i=[{data:r.data,linkState:r.linkState},{data:n}],o=new d.RelationGroup({sourceId:e.id,targetId:t.id,typeId:n.linkTypeId,items:i});return this.removeLink(r.id),this.addLink(o),o}if(r instanceof d.RelationGroup){const e=[...r.items,{data:n}];return this.history.execute((0,d.setRelationGroupItems)(r,e)),r}}const o=new d.RelationLink({sourceId:e.id,targetId:t.id,data:n});return this.addLink(o),o}getElementType(e){return this.dataGraph.getElementType(e)}createElementType(e){const t=this.dataGraph.getElementType(e);if(t)return t;const n=new d.ElementType({id:e});return this.dataGraph.addElementType(n),this.fetcher.fetchElementType(n),n}getLinkType(e){return this.dataGraph.getLinkType(e)}createLinkType(e){const t=this.dataGraph.getLinkType(e);if(t)return t;const n=new d.LinkType({id:e});return this.dataGraph.addLinkType(n),this.fetcher.fetchLinkType(n),n}getPropertyType(e){return this.dataGraph.getPropertyType(e)}createPropertyType(e){const t=this.dataGraph.getPropertyType(e);if(t)return t;const n=new d.PropertyType({id:e});return this.dataGraph.addPropertyType(n),this.fetcher.fetchPropertyType(n),n}group(e){const t=this.history.startBatch("Group entities"),n=new Set;for(const a of e)n.add(a.data.id);const i=[],r=new Set;for(const a of e){i.push({data:a.data,elementState:a.elementState});for(const e of this.getElementLinks(a))r.add(e)}for(const a of r)this.removeLink(a.id);for(const a of e)this.removeElement(a.id);const o=(0,a.getContentFittingBox)(e,[],{getElementSize:()=>{}}),s=new d.EntityGroup({items:i,position:a.Rect.center(o)});return this.addElement(s),this.recreateLinks(r),t.store(),s}ungroupAll(e){const t=this.history.startBatch("Ungroup entities"),n=[],i=new Set;for(const r of e){for(const e of this.getElementLinks(r))i.add(e);this.removeElement(r.id);for(const e of r.items){const t=new d.EntityElement({data:e.data,position:r.position});this.addElement(t),n.push(t)}}return this.recreateLinks(i),t.store(),n}ungroupSome(e,t){const n=e.items.filter((e=>!t.has(e.data.id)));if(n.length<=1)return this.ungroupAll([e]);const i=this.history.startBatch("Ungroup entities"),r=new Set;for(const s of this.getElementLinks(e))s instanceof d.RelationLink?(t.has(s.data.sourceId)||t.has(s.data.targetId))&&r.add(s):s instanceof d.RelationGroup&&s.items.some((e=>t.has(e.data.sourceId)||t.has(e.data.targetId)))&&r.add(s);for(const s of r)this.removeLink(s.id);const o=[];for(const s of e.items)if(t.has(s.data.id)){const t=new d.EntityElement({data:s.data,position:e.position});this.addElement(t),o.push(t)}return i.history.execute((0,d.setEntityGroupItems)(e,n)),this.recreateLinks(r),i.store(),o}regroupLinks(e){const t=this.history.startBatch("Regroup relations");for(const n of e)this.removeLink(n.id);this.recreateLinks(new Set(e)),t.store()}recreateLinks(e){for(const t of e)if(t instanceof d.RelationLink)for(const e of this.createLinks(t.data))e instanceof d.RelationLink&&this.history.execute((0,s.setLinkState)(e,t.linkState));else if(t instanceof d.RelationGroup)for(const{data:e}of t.items)this.createLinks(e)}}class f extends c.DiagramLocaleFormatter{constructor(e,t){super(e,t)}formatElementTypes(e,t){return e.map((e=>{const n=this.model.getElementType(e);return this.formatLabel(n?.data?.label,e,t)})).sort()}formatPropertyList(e,t){const n=t??this.model.language,i=Object.keys(e).map((t=>{const i=this.model.getPropertyType(t),r=this.formatLabel(i?.data?.label,t),o=e[t],s=o.filter((e=>"NamedNode"===e.termType||""===e.language||e.language===n));return{propertyId:t,label:r,values:0===s.length?o:s}}));return i.sort(((e,t)=>e.label.localeCompare(t.label))),i}}function m(e,t){return l.Command.effect("Fetch element data",(()=>{e.requestElementData(t)}))}function y(e,t={}){return l.Command.effect("Restore links between elements",(()=>{e.requestLinks(t)}))}},(e,t,n)=>{n.r(t),n.d(t,{DiagramLocaleFormatter:()=>g,DiagramModel:()=>c});var i=n(57),r=n(58),o=n(68),s=n(70),a=n(96),l=n(118);class c{source=new r.EventSource;events=this.source;_language="en";_selection=[];graph=new l.Graph;graphListener=new r.EventObserver;history;locale;constructor(e){const{history:t,selectLabelLanguage:n=f}=e;this.history=t,this.locale=this.createLocale(n)}createLocale(e){return new g(this,e)}get language(){return this._language}setLanguage(e){if(!e)throw new Error("Cannot set empty language.");const t=this._language;t!==e&&(this._language=e,this.source.trigger("changeLanguage",{source:this,previous:t}))}get selection(){return this._selection}setSelection(e){const t=this._selection;if(t===e)return;const n=e.filter((e=>e instanceof a.Element));this.bringElements(n,"front"),this._selection=e,this.source.trigger("changeSelection",{source:this,previous:t})}get factory(){return this.getTermFactory()}get elements(){return this.graph.getElements()}get links(){return this.graph.getLinks()}getTermFactory(){return s.DefaultDataFactory}getElement(e){return this.graph.getElement(e)}getElementLinks(e){return this.graph.getElementLinks(e)}getLink(e){return this.graph.getLink(e)}findLink(e,t,n){for(const i of this.graph.iterateLinks(t,n,e))return i}sourceOf(e){return this.getElement(e.sourceId)}targetOf(e){return this.getElement(e.targetId)}getLinkVisibility(e){return this.graph.getLinkVisibility(e)}setLinkVisibility(e,t){this.graph.setLinkVisibility(e,t)}resetGraph(){this.graphListener&&(this.graphListener.stopListening(),this.graphListener=new r.EventObserver),this.graph=new l.Graph,this._selection=[],this.source.trigger("discardGraph",{source:this})}subscribeGraph(){this.graphListener.listen(this.graph.events,"changeCells",(e=>{this.triggerChangeCells(e)})),this.graphListener.listen(this.graph.events,"elementEvent",(e=>{this.triggerElementEvent(e)})),this.graphListener.listen(this.graph.events,"linkEvent",(e=>{this.triggerLinkEvent(e)})),this.graphListener.listen(this.graph.events,"changeLinkVisibility",(e=>{this.source.trigger("changeLinkVisibility",e)})),this.triggerChangeCells({updateAll:!0})}triggerChangeCells(e){if(this.selection.length>0){const e=this.selection.filter((e=>e instanceof a.Element?this.getElement(e.id):e instanceof a.Link&&this.getLink(e.id)));e.length<this.selection.length&&this.setSelection(e)}this.source.trigger("changeCells",e)}triggerElementEvent(e){this.source.trigger("elementEvent",e)}triggerLinkEvent(e){this.source.trigger("linkEvent",e)}reorderElements(e){this.graph.reorderElements(e),this.source.trigger("changeCellOrder",{source:this})}bringElements(e,t){0!==e.length&&this.reorderElements((0,i.moveComparator)(this.elements,e,"front"===t?"end":"start"))}addElement(e){this.history.execute(new d(this.graph,e,[]))}removeElement(e){const t=this.getElement(e);t&&this.history.execute(new u(this.graph,t))}addLink(e){this.history.execute(new h(this.graph,e))}removeLink(e){const t=this.graph.getLink(e);t&&this.history.execute(new p(this.graph,t))}}class d{graph;element;connectedLinks;constructor(e,t,n){this.graph=e,this.element=t,this.connectedLinks=n}get title(){return"Add element"}invoke(){const{graph:e,element:t,connectedLinks:n}=this;e.addElement(t);for(const i of n){e.getLink(i.id)||e.addLink(i)}return new u(e,t)}}class u{graph;element;constructor(e,t){this.graph=e,this.element=t}get title(){return"Remove element"}invoke(){const{graph:e,element:t}=this,n=[...e.getElementLinks(t)];return e.removeElement(t.id),new d(e,t,n)}}class h{graph;link;constructor(e,t){this.graph=e,this.link=t}get title(){return"Add link"}invoke(){const{graph:e,link:t}=this;return e.addLink(t),new p(e,t)}}class p{graph;link;constructor(e,t){this.graph=e,this.link=t}get title(){return"Remove link"}invoke(){const{graph:e,link:t}=this;return e.removeLink(t.id),new h(e,t)}}class g{model;selectLabelLanguage;constructor(e,t){this.model=e,this.selectLabelLanguage=t}selectLabel(e,t){const n=t??this.model.language,{selectLabelLanguage:i}=this;return i(e,n)}formatLabel(e,t,n){return function(e,t){if(e)return e.value;return s.getLocalName(t)||t}(e?this.selectLabel(e,n):void 0,t)}formatIri(e){return(0,o.isEncodedBlank)(e)?"(blank node)":`<${e}>`}}function f(e,t){if(0===e.length)return;let n,i;for(const r of e){if(r.language===t)return r;""===r.language?n=r:"en"===r.language&&(i=r)}return void 0!==n?n:void 0!==i?i:e[0]}},(e,t,n)=>{n.r(t),n.d(t,{Graph:()=>o});var i=n(57),r=n(58);class o{source=new r.EventSource;events=this.source;elements=new i.OrderedMap;links=new i.OrderedMap;elementLinks=new WeakMap;EMPTY_LINKS=[];linkTypeVisibility=new Map;getElements(){return this.elements.items}getLinks(){return this.links.items}getLink(e){return this.links.get(e)}getElementLinks(e){return this.elementLinks.get(e)??[]}*iterateLinks(e,t,n){const i=this.getElement(e),r=this.getElement(t);if(!i||!r)return;const o=this.elementLinks.get(i)??this.EMPTY_LINKS,s=this.elementLinks.get(r)??this.EMPTY_LINKS,a=o.length<=s.length?o:s;for(const l of a)l.sourceId!==e||l.targetId!==t||n&&l.typeId!==n||(yield l)}sourceOf(e){return this.getElement(e.sourceId)}targetOf(e){return this.getElement(e.targetId)}reorderElements(e){this.elements.reorder(e)}getElement(e){return this.elements.get(e)}addElement(e){if(this.getElement(e.id))throw new Error(`Element '${e.id}' already exists.`);e.events.onAny(this.onElementEvent),this.elements.push(e.id,e),this.source.trigger("changeCells",{updateAll:!1,changedElement:e})}onElementEvent=e=>{this.source.trigger("elementEvent",{data:e})};removeElement(e){const t=this.elements.get(e);if(t){const n={silent:!0},i=[...this.getElementLinks(t)];for(const e of i)this.removeLink(e.id,n);this.elements.delete(e),t.events.offAny(this.onElementEvent),this.source.trigger("changeCells",{updateAll:!1,changedElement:t,changedLinks:i})}}addLink(e){if(this.getLink(e.id))throw new Error(`Link already exists: ${e.id}`);const t=this.sourceOf(e);if(!t)throw new Error(`Link source not found: ${e.sourceId}`);const n=this.targetOf(e);if(!n)throw new Error(`Link target not found: ${e.targetId}`);let i=this.elementLinks.get(t);if(i||(i=[],this.elementLinks.set(t,i)),i.push(e),e.sourceId!==e.targetId){let t=this.elementLinks.get(n);t||(t=[],this.elementLinks.set(n,t)),t.push(e)}e.events.onAny(this.onLinkEvent),this.links.push(e.id,e),this.source.trigger("changeCells",{updateAll:!1,changedLinks:[e]})}onLinkEvent=e=>{this.source.trigger("linkEvent",{data:e})};removeLink(e,t){const n=this.links.delete(e);n&&(n.events.offAny(this.onLinkEvent),this.removeLinkReferences(n),t&&t.silent||this.source.trigger("changeCells",{updateAll:!1,changedLinks:[n]}))}removeLinkReferences(e){const t=this.getElement(e.sourceId);if(t){const n=this.elementLinks.get(t);n&&(s(n,e),0===n.length&&this.elementLinks.delete(t))}const n=this.getElement(e.targetId);if(n){const t=this.elementLinks.get(n);t&&(s(t,e),0===t.length&&this.elementLinks.delete(n))}}get linkVisibility(){return this.linkTypeVisibility}getLinkVisibility(e){return this.linkTypeVisibility.get(e)??"visible"}setLinkVisibility(e,t){const n=this.getLinkVisibility(e);t!==n&&(this.linkTypeVisibility.set(e,t),this.source.trigger("changeLinkVisibility",{source:e,previous:n}))}}function s(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}},(e,t,n)=>{n.r(t),n.d(t,{ElementType:()=>b,EntityElement:()=>l,EntityGroup:()=>d,LinkType:()=>w,PropertyType:()=>x,RelationGroup:()=>f,RelationLink:()=>p,changeEntityData:()=>v,changeRelationData:()=>S,iterateEntitiesOf:()=>h,iterateRelationsOf:()=>y,setEntityElementData:()=>c,setEntityGroupItems:()=>u,setRelationGroupItems:()=>m,setRelationLinkData:()=>g});var i=n(58),r=n(59),o=n(68),s=n(96),a=n(94);class l extends s.Element{_data;constructor(e){super(e),this._data=e.data}static placeholderData(e){return{id:e,types:[],label:[],properties:{}}}get entitySource(){return this.source}get iri(){return this._data.id}get data(){return this._data}setData(e){const t=this._data;t!==e&&(this._data=e,this.entitySource.trigger("changeData",{source:this,previous:t}),this.entitySource.trigger("requestedRedraw",{source:this,level:"template"}))}}function c(e,t){return a.Command.create("Set entity element data",(()=>{const n=e.data;return e.setData(t),c(e,n)}))}class d extends s.Element{_items;_itemIris=new Set;constructor(e){super(e),this._items=e.items??[],this.updateItemIris()}get entitySource(){return this.source}get items(){return this._items}setItems(e){const t=this._items;t!==e&&(this._items=e,this.updateItemIris(),this.entitySource.trigger("changeItems",{source:this,previous:t}),this.entitySource.trigger("requestedRedraw",{source:this,level:"template"}))}get itemIris(){return this._itemIris}updateItemIris(){this._itemIris.clear();for(const e of this._items)this._itemIris.add(e.data.id)}}function u(e,t){return a.Command.create("Set entity group items",(()=>{const n=e.items;return e.setItems(t),u(e,n)}))}function*h(e){if(e instanceof l)yield e.data;else if(e instanceof d)for(const t of e.items)yield t.data}class p extends s.Link{_data;constructor(e){super(e),this._data=e.data}get relationSource(){return this.source}getTypeId(){return this._data.linkTypeId}get data(){return this._data}setData(e){const t=this._data;t!==e&&(this._data=e,this.relationSource.trigger("changeData",{source:this,previous:t}),this.relationSource.trigger("requestedRedraw",{source:this}))}withDirection(e){if(e.sourceId!==this.data.sourceId&&e.sourceId!==this.data.targetId)throw new Error("New link source IRI is unrelated to original link");if(e.targetId!==this.data.sourceId&&e.targetId!==this.data.targetId)throw new Error("New link target IRI is unrelated to original link");const t=e.sourceId===this.data.sourceId?this.sourceId:this.targetId,n=e.targetId===this.data.targetId?this.targetId:this.sourceId;return new p({sourceId:t,targetId:n,data:e})}}function g(e,t){return a.Command.create("Set relation link data",(()=>{const n=e.data;return e.setData(t),g(e,n)}))}class f extends s.Link{_typeId;_items;_itemKeys=new r.HashSet(o.hashLink,o.equalLinks);_sources=new Set;_targets=new Set;constructor(e){super(e),this._typeId=e.typeId,this._items=e.items??[],this.updateItemKeys()}get relationSource(){return this.source}getTypeId(){return this._typeId}get items(){return this._items}setItems(e){for(const n of e)if(n.data.linkTypeId!==this._typeId)throw new Error("RelationGroup should have only items with same type IRI");const t=this._items;t!==e&&(this._items=e,this.updateItemKeys(),this.relationSource.trigger("changeItems",{source:this,previous:t}),this.relationSource.trigger("requestedRedraw",{source:this}))}get itemKeys(){return this._itemKeys}get itemSources(){return this._sources}get itemTargets(){return this._targets}updateItemKeys(){this._itemKeys.clear(),this._sources.clear(),this._targets.clear();for(const e of this._items)this._itemKeys.add(e.data),this._sources.add(e.data.sourceId),this._targets.add(e.data.targetId)}}function m(e,t){return a.Command.create("Set relation group items",(()=>{const n=e.items;return e.setItems(t),m(e,n)}))}function*y(e){if(e instanceof p)yield e.data;else if(e instanceof f)for(const t of e.items)yield t.data}class b{source=new i.EventSource;events=this.source;id;_data;constructor(e){const{id:t,data:n}=e;this.id=t,this.setData(n)}get data(){return this._data}setData(e){if(e&&e.id!==this.id)throw new Error("ElementTypeModel.id does not match ElementType.id");const t=this._data;t!==e&&(this._data=e,this.source.trigger("changeData",{source:this,previous:t}))}}class x{source=new i.EventSource;events=this.source;id;_data;constructor(e){const{id:t,data:n}=e;this.id=t,this.setData(n)}get data(){return this._data}setData(e){if(e&&e.id!==this.id)throw new Error("PropertyTypeModel.id does not match PropertyType.id");const t=this._data;t!==e&&(this._data=e,this.source.trigger("changeData",{source:this,previous:t}))}}class w{source=new i.EventSource;events=this.source;id;_data;constructor(e){const{id:t,data:n}=e;this.id=t,this.setData(n)}get data(){return this._data}setData(e){if(e&&e.id!==this.id)throw new Error("LinkTypeModel.id does not match LinkType.id");const t=this._data;t!==e&&(this._data=e,this.source.trigger("changeData",{source:this,previous:t}))}}function v(e,t,n){const i=a.Command.create("Change entity data",(()=>{const r=t,o=n.id,s=new Map,c=new Map,u=new Map,h=new Map,g=t=>{for(const n of e.getElementLinks(t))if(n instanceof p)u.set(n,n.data),n.setData(k(n.data,r,o));else if(n instanceof f&&(n.itemSources.has(r)||n.itemTargets.has(r))){h.set(n,n.items);const e=n.items.map((e=>({...e,data:k(e.data,r,o)})));n.setItems(e)}};for(const i of e.elements)if(i instanceof l)i.iri===t&&(s.set(i,i.data),i.setData(n),g(i));else if(i instanceof d&&i.itemIris.has(t)){c.set(i,i.items);const e=i.items.map((e=>e.data.id===t?{...e,data:n}:e));i.setItems(e),g(i)}return a.Command.create("Revert element data",(()=>{for(const[e,t]of s)e.setData(t);for(const[e,t]of c)e.setItems(t);for(const[e,t]of u)e.setData(t);for(const[e,t]of h)e.setItems(t);return i}))}));return i}function k(e,t,n){let i=e;return i.sourceId===t&&(i={...i,sourceId:n}),i.targetId===t&&(i={...i,targetId:n}),i}function S(e,t,n){if(!(0,o.equalLinks)(t,n))throw new Error("Cannot change typeId, sourceId or targetId when changing link data");return a.Command.create("Change relation data",(()=>{for(const i of e.links)i instanceof p&&(0,o.equalLinks)(i.data,t)&&i.setData(n);return S(e,n,t)}))}},(e,t,n)=>{n.r(t),n.d(t,{DataFetcher:()=>s});var i=n(58),r=n(67),o=n(119);class s{graph;dataGraph;dataProvider;source=new i.EventSource;events=this.source;cancellation=new AbortController;_operations=[];_failReasons=new Map;elementTypeQueue=new r.BufferingQueue((e=>{const t={type:"elementType",targets:new Set(e)},n=this.dataProvider.elementTypes({classIds:e,signal:this.signal}).then(this.onElementTypesLoaded);this.addOperation(t,n)}));linkTypeQueue=new r.BufferingQueue((e=>{const t={type:"linkType",targets:new Set(e)},n=this.dataProvider.linkTypes({linkTypeIds:e,signal:this.signal}).then(this.onLinkTypesLoaded);this.addOperation(t,n)}));propertyTypeQueue=new r.BufferingQueue((e=>{const t={type:"propertyType",targets:new Set(e)},n=this.dataProvider.propertyTypes({propertyIds:e,signal:this.signal}).then(this.onPropertyTypesLoaded);this.addOperation(t,n)}));constructor(e,t,n){this.graph=e,this.dataGraph=t,this.dataProvider=n}get signal(){return this.cancellation.signal}dispose(){this.cancellation.abort()}get operations(){return this._operations}getFailReason(e,t){const n=this._failReasons.get(e);return n?.get(t)}addOperation(e,t){const n=this._operations,i=[...n,e];t.then((()=>this.onOperationComplete(e)),(t=>this.onOperationComplete(e,t))),this._operations=i,this.source.trigger("changeOperations",{previous:n})}onOperationComplete(e,t){const n=this._operations,i=n.indexOf(e);if(i>=0){const e=[...n];e.splice(i,1),this._operations=e}switch(e.type){case"element":case"elementType":case"linkType":case"propertyType":{const n=this.ensureFailReasons(e.type);for(const i of e.targets)n.set(i,t)}}(this._operations!==n||t)&&this.source.trigger("changeOperations",{previous:n,fail:t?{operation:e,error:t}:void 0})}ensureFailReasons(e){let t=this._failReasons.get(e);return t||(t=new Map,this._failReasons.set(e,t)),t}fetchElementData(e){if(0===e.length)return Promise.resolve();const t={type:"element",targets:new Set(e)},n=this.dataProvider.elements({elementIds:[...e],signal:this.signal}).then(this.onElementInfoLoaded);return this.addOperation(t,n),n}onElementInfoLoaded=e=>{for(const t of this.graph.getElements())if(t instanceof o.EntityElement){const n=e.get(t.iri);n&&t.setData(n)}else if(t instanceof o.EntityGroup){let n=!1;for(const i of t.items)e.has(i.data.id)&&(n=!0);if(n){const n=t.items.map((t=>{const n=e.get(t.data.id);return n?{...t,data:n}:t}));t.setItems(n)}}};fetchLinks(e,t,n){const i=this.dataProvider.links({primary:e,secondary:t,linkTypeIds:n});return this.addOperation({type:"link"},i),i}fetchElementType(e){this.elementTypeQueue.push(e.id)}onElementTypesLoaded=e=>{for(const t of e.values()){const e=this.dataGraph.getElementType(t.id);e&&e.setData(t)}};fetchLinkType(e){this.linkTypeQueue.push(e.id)}onLinkTypesLoaded=e=>{for(const t of e.values()){const e=this.dataGraph.getLinkType(t.id);e&&e.setData(t)}};fetchPropertyType(e){this.propertyTypeQueue.push(e.id)}onPropertyTypesLoaded=e=>{for(const t of e.values()){const e=this.dataGraph.getPropertyType(t.id);e&&e.setData(t)}}}},(e,t,n)=>{n.r(t),n.d(t,{deserializeDiagram:()=>l,emptyDiagram:()=>o,markLayoutOnly:()=>c,serializeDiagram:()=>s});var i=n(74),r=n(119);function o(){return{"@context":i.DIAGRAM_CONTEXT_URL_V1,"@type":"Diagram",layoutData:{"@type":"Layout",elements:[],links:[]},linkTypeOptions:[]}}function s(e){const{elements:t,links:n,linkTypeVisibility:r}=e;let s;if(r){s=[];for(const[e,t]of r)"visible"!==t&&e!==i.PLACEHOLDER_LINK_TYPE&&s.push({"@type":"LinkTypeOptions",property:e,visible:"hidden"!==t,showLabel:"withoutLabel"!==t})}return{...o(),layoutData:a(t,n),linkTypeOptions:s}}function a(e,t){const n=[];for(const o of e)o instanceof r.EntityGroup?n.push({"@type":"ElementGroup","@id":o.id,items:o.items.map((e=>({"@type":"ElementItem",iri:e.data.id,elementState:e.elementState}))),position:o.position,elementState:o.elementState}):n.push({"@type":"Element","@id":o.id,iri:o instanceof r.EntityElement?o.iri:void 0,position:o.position,isExpanded:o.isExpanded,elementState:o.elementState});const i=[];for(const o of t)o instanceof r.RelationGroup?i.push({"@type":"LinkGroup","@id":o.id,property:o.typeId,source:{"@id":o.sourceId},target:{"@id":o.targetId},items:o.items.map((e=>({"@type":"LinkItem",sourceIri:e.data.sourceId,targetIri:e.data.targetId,linkState:e.linkState}))),vertices:[...o.vertices],linkState:o.linkState}):i.push({"@type":"Link","@id":o.id,property:o.typeId,source:{"@id":o.sourceId},target:{"@id":o.targetId},sourceIri:o instanceof r.RelationLink?o.data.sourceId:void 0,targetIri:o instanceof r.RelationLink?o.data.targetId:void 0,vertices:[...o.vertices],linkState:o.linkState});return{"@type":"Layout",elements:n,links:i}}function l(e,t={}){const{layoutData:n,linkTypeOptions:i}=e,o=new Map;if(i)for(const r of i){const{visible:e=!0,showLabel:t=!0}=r,n=r.property,i=e&&t?"visible":e&&!t?"withoutLabel":"hidden";o.set(n,i)}const{elements:s,links:a}=function(e,t){const{preloadedElements:n,markLinksAsLayoutOnly:i=!1}=t,o=new Map,s=[];for(const a of e.elements)switch(a["@type"]){case"Element":{const{"@id":e,iri:t,position:i,isExpanded:s,elementState:l}=a;if(t){const a=n?.get(t),c=a??r.EntityElement.placeholderData(t),d=new r.EntityElement({id:e,data:c,position:i,expanded:s,elementState:l});o.set(d.id,d)}break}case"ElementGroup":{const{"@id":e,items:t,position:i,elementState:s}=a,l=[];for(const o of t){const e=n?.get(o.iri);l.push({data:e??r.EntityElement.placeholderData(o.iri),elementState:o.elementState})}const c=new r.EntityGroup({id:e,items:l,position:i,elementState:s});o.set(c.id,c);break}}for(const a of e.links){const{"@id":e,property:t,source:n,target:l,vertices:d,linkState:u}=a,h=o.get(n["@id"]),p=o.get(l["@id"]);if(h&&p)switch(a["@type"]){case"Link":{const n=a.sourceIri??(h instanceof r.EntityElement?h.data.id:void 0),o=a.targetIri??(p instanceof r.EntityElement?p.data.id:void 0);if(h&&p&&n&&o){const a=new r.RelationLink({id:e,sourceId:h.id,targetId:p.id,data:{linkTypeId:t,sourceId:n,targetId:o,properties:{}},vertices:d,linkState:c(u,i)});s.push(a)}break}case"LinkGroup":{const n=[];for(const e of a.items)n.push({data:{linkTypeId:t,sourceId:e.sourceIri,targetId:e.targetIri,properties:{}},linkState:c(e.linkState,i)});const o=new r.RelationGroup({id:e,typeId:t,sourceId:h.id,targetId:p.id,items:n,vertices:d,linkState:u});s.push(o);break}}}return{elements:Array.from(o.values()),links:s}}(n,t);return{elements:s,links:a,linkTypeVisibility:o}}function c(e,t){const n=e&&Object.prototype.hasOwnProperty.call(e,i.TemplateProperties.LayoutOnly)&&Boolean(e[i.TemplateProperties.LayoutOnly]);if(n&&!t){const{[i.TemplateProperties.LayoutOnly]:t,...n}=e;return n}return!n&&t?{...e,[i.TemplateProperties.LayoutOnly]:!0}:e}},(e,t,n)=>{n.r(t),n.d(t,{DataGraph:()=>r});var i=n(58);class r{source=new i.EventSource;events=this.source;classesById=new Map;propertiesById=new Map;linkTypes=new Map;getLinkType(e){return this.linkTypes.get(e)}addLinkType(e){if(this.getLinkType(e.id))throw new Error(`Link type already exists: ${e.id}`);e.events.onAny(this.onLinkTypeEvent),this.linkTypes.set(e.id,e)}onLinkTypeEvent=e=>{this.source.trigger("linkTypeEvent",{data:e})};getPropertyType(e){return this.propertiesById.get(e)}addPropertyType(e){if(this.getPropertyType(e.id))throw new Error(`Property type already exists: ${e.id}`);e.events.onAny(this.onPropertyTypeEvent),this.propertiesById.set(e.id,e)}onPropertyTypeEvent=e=>{this.source.trigger("propertyTypeEvent",{data:e})};getElementType(e){return this.classesById.get(e)}getElementTypes(){const e=[];return this.classesById.forEach((t=>e.push(t))),e}addElementType(e){if(this.getElementType(e.id))throw new Error(`Element type already exists: ${e.id}`);e.events.onAny(this.onElementTypeEvent),this.classesById.set(e.id,e)}onElementTypeEvent=e=>{this.source.trigger("elementTypeEvent",{data:e})}}},(e,t,n)=>{n.r(t),n.d(t,{EditorController:()=>d});var i=n(58),r=n(68),o=n(96),s=n(94),a=n(114),l=n(119),c=n(124);class d{listener=new i.EventObserver;source=new i.EventSource;events=this.source;model;_authoringCommands;_inAuthoringMode=!1;_metadataProvider;_validationProvider;_authoringState=a.AuthoringState.empty;_validationState=c.ValidationState.empty;_temporaryState=a.TemporaryState.empty;cancellation=new AbortController;constructor(e){const{model:t,authoringCommands:n,metadataProvider:i,validationProvider:r}=e;this.model=t,this._authoringCommands=n,this._metadataProvider=i,this._validationProvider=r,this.listener.listen(this.events,"changeValidationState",(e=>{for(const t of this.model.elements){if(!(t instanceof l.EntityElement))continue;const n=e.previous.elements.get(t.iri);this.validationState.elements.get(t.iri)!==n&&t.redraw()}})),this.listener.listen(this.events,"changeAuthoringState",(e=>{this.validateChangedFrom(e.previous)})),document.addEventListener("keyup",this.onKeyUp),this.cancellation.signal.addEventListener("abort",(()=>{document.removeEventListener("keyup",this.onKeyUp)}))}dispose(){this.listener.stopListening(),this.cancellation.abort()}get authoringCommands(){return this._authoringCommands}get inAuthoringMode(){return this._inAuthoringMode&&Boolean(this._metadataProvider)}setAuthoringMode(e){const t=this._inAuthoringMode,n=e&&Boolean(this._metadataProvider);n!==t&&(this._inAuthoringMode=n,this.source.trigger("changeMode",{source:this,previous:t}))}get metadataProvider(){return this._metadataProvider}get validationProvider(){return this._validationProvider}get authoringState(){return this._authoringState}setAuthoringState(e){this._authoringState!==e&&this.model.history.execute(this.updateAuthoringState(e))}updateAuthoringState(e){const t=this._authoringState;return s.Command.create("Create or delete entities and links",(()=>(this._authoringState=e,this.source.trigger("changeAuthoringState",{source:this,previous:t}),this.updateAuthoringState(t))))}get validationState(){return this._validationState}setValidationState(e){const t=this._validationState;e!==t&&(this._validationState=e,this.source.trigger("changeValidationState",{source:this,previous:t}))}get temporaryState(){return this._temporaryState}setTemporaryState(e){const t=this._temporaryState;e!==t&&(this._temporaryState=e,this.source.trigger("changeTemporaryState",{source:this,previous:t}))}validateChangedFrom(e){if(!this.validationProvider)return;const t=(0,c.changedElementsToValidate)(e,this.authoringState,this.model);this.revalidateEntities(t)}revalidateEntities(e){this.validationProvider&&(0,c.validateElements)(e,this.validationProvider,this.model,this,this.cancellation.signal)}onKeyUp=e=>{"Delete"===e.key&&document.activeElement&&"input"!==document.activeElement.localName&&this.removeSelectedElements()};removeSelectedElements(){const e=this.model.selection;e.length>0&&(this.model.setSelection([]),this.removeItems(e))}removeItems(e){const t=this.model.history.startBatch(),n=new Set;for(const r of e)if(r instanceof o.Element){for(const e of(0,l.iterateEntitiesOf)(r))n.add(e.id);this.model.removeElement(r.id)}else if(r instanceof o.Link)for(const e of(0,l.iterateRelationsOf)(r))a.AuthoringState.isAddedRelation(this.authoringState,e)&&this.deleteRelation(e);const i=new Set;for(const r of n){const e=this.authoringState.elements.get(r);e&&this.discardChange(e),i.add(r)}if(i.size>0){const e=a.AuthoringState.discardAddedRelations(this.authoringState,i);this.setAuthoringState(e)}t.store()}createEntity(e,t={}){const n=this.model.history.startBatch("Create new entity"),i=this.model.createElement(e);return i.setExpanded(!0),t.temporary?(this.setTemporaryState(a.TemporaryState.addEntity(this.temporaryState,i.data)),n.discard()):(this.setAuthoringState(a.AuthoringState.addEntity(this._authoringState,i.data)),n.store()),i}changeEntity(e,t){const n=h(u(this.model,e),e);if(!n)return;const i=this.model.history.startBatch("Edit entity"),r=a.AuthoringState.changeEntity(this._authoringState,n,t),o=r.elements.get(e)||r.elements.get(t.id);this.model.history.execute((0,l.changeEntityData)(this.model,e,o.data)),this.setAuthoringState(r),i.store()}deleteEntity(e){const t=this.authoringState,n=u(this.model,e),i=h(n,e);if(!i)return;const r=this.model.history.startBatch("Delete entity");for(const s of n)this.removeRelationsFromLinks(this.model.getElementLinks(s),(e=>a.AuthoringState.isAddedRelation(t,e)));const o=t.elements.get(e);o&&this.discardChange(o),this.setAuthoringState(a.AuthoringState.deleteEntity(t,i)),r.store()}createRelation(e,t={}){if(this.model.findLink(e.typeId,e.sourceId,e.targetId))throw Error("The relation with same (source IRI, target IRI, type) already exists");const n=this.model.history.startBatch("Create new link");return this.model.addLink(e),t.temporary||this.model.createLinks(e.data),!function(e,t){for(const n of e.links)for(const e of(0,l.iterateRelationsOf)(n))if((0,r.equalLinks)(e,t))return!0;return!1}(this.model,e.data)?n.discard():t.temporary?(this.setTemporaryState(a.TemporaryState.addRelation(this.temporaryState,e.data)),n.discard()):(this.setAuthoringState(a.AuthoringState.addRelation(this._authoringState,e.data)),n.store()),e}changeRelation(e,t){const n=this.model.history.startBatch("Change link");if((0,r.equalLinks)(e,t))this.model.history.execute((0,l.changeRelationData)(this.model,e,t)),this.setAuthoringState(a.AuthoringState.changeRelation(this._authoringState,e,t));else{let n=this._authoringState;n=a.AuthoringState.deleteRelation(n,e),n=a.AuthoringState.addRelation(n,t),a.AuthoringState.isAddedRelation(this._authoringState,e)&&this.removeRelationsFromLinks(this.model.links,(t=>(0,r.equalLinks)(t,e))),this.model.createLinks(t),this.setAuthoringState(n)}n.store()}moveRelationSource(e){const{link:t,newSource:n}=e,i=this.model.history.startBatch("Move link to another element");this.changeRelation(t.data,{...t.data,sourceId:n.iri});const r=this.model.findLink(t.typeId,n.id,t.targetId);return r.setVertices(t.vertices),i.store(),r}moveRelationTarget(e){const{link:t,newTarget:n}=e,i=this.model.history.startBatch("Move link to another element");this.changeRelation(t.data,{...t.data,targetId:n.iri});const r=this.model.findLink(t.typeId,t.sourceId,n.id);return r.setVertices(t.vertices),i.store(),r}deleteRelation(e){const t=this.authoringState;if(a.AuthoringState.isDeletedRelation(t,e))return;const n=this.model.history.startBatch("Delete link"),i=a.AuthoringState.deleteRelation(t,e);a.AuthoringState.isAddedRelation(t,e)&&this.removeRelationsFromLinks(this.model.links,(t=>(0,r.equalLinks)(t,e))),this.setAuthoringState(i),n.store()}removeAllTemporaryCells(){const{temporaryState:e}=this,t=[];if(e.elements.size>0)for(const n of this.model.elements)n instanceof l.EntityElement&&e.elements.has(n.iri)&&t.push(n);if(e.links.size>0)for(const n of this.model.links)n instanceof l.RelationLink&&e.links.has(n.data)&&t.push(n);t.length>0&&this.removeTemporaryCells(t)}removeTemporaryCells(e){const{temporaryState:t}=this;let n=t;const i=this.model.history.startBatch();for(const r of e)r instanceof l.EntityElement?t.elements.has(r.iri)&&(n=a.TemporaryState.removeEntity(n,r.data),this.model.removeElement(r.id)):r instanceof l.RelationLink&&t.links.has(r.data)&&(n=a.TemporaryState.removeRelation(n,r.data),this.model.removeLink(r.id));i.discard(),this.setTemporaryState(n)}discardChange(e){const t=a.AuthoringState.discard(this._authoringState,e);if(t===this._authoringState)return;const n=this.model.history.startBatch("Discard change");switch(e.type){case"entityAdd":for(const t of u(this.model,e.data.id))t instanceof l.EntityElement?this.model.removeElement(t.id):t instanceof l.EntityGroup&&this.discardItemFromGroup(t,e.data.id);break;case"entityChange":this.model.history.execute((0,l.changeEntityData)(this.model,e.data.id,e.before));break;case"relationAdd":this.removeRelationsFromLinks(this.model.links,(t=>(0,r.equalLinks)(t,e.data)));break;case"relationChange":this.model.history.execute((0,l.changeRelationData)(this.model,e.data,e.before))}this.setAuthoringState(t),n.store()}discardItemFromGroup(e,t){const n=e.items.filter((e=>e.data.id!==t));this.model.history.execute((0,l.setEntityGroupItems)(e,n)),this.removeRelationsFromLinks(this.model.getElementLinks(e),(({sourceId:e,targetId:n})=>e===t||n===t)),n.length<=1&&this.model.ungroupAll([e])}removeRelationsFromLinks(e,t){const n=[],i=[];for(const r of e)if(r instanceof l.RelationLink)t(r.data)&&n.push(r);else if(r instanceof l.RelationGroup&&r.items.some((e=>t(e.data)))){const e=r.items.filter((e=>!t(e.data)));this.model.history.execute((0,l.setRelationGroupItems)(r,e)),i.push(r)}for(const r of n)this.model.removeLink(r.id);this.model.regroupLinks(i)}}function u(e,t){return e.elements.filter((e=>e instanceof l.EntityElement&&e.iri===t||e instanceof l.EntityGroup&&e.itemIris.has(t)))}function h(e,t){for(const n of e)for(const e of(0,l.iterateEntitiesOf)(n))if(e.id===t)return e}},(e,t,n)=>{n.r(t),n.d(t,{ValidationState:()=>i,changedElementsToValidate:()=>l,getMaxSeverity:()=>h,validateElements:()=>c});var i,r=n(56),o=n(59),s=n(68),a=n(119);function l(e,t,n){const i=new o.HashMap(s.hashLink,s.equalLinks);e.links.forEach(((e,t)=>i.set(t,!0))),t.links.forEach(((e,t)=>i.set(t,!0)));const r=new Set;i.forEach(((n,i)=>{t.links.get(i)!==e.links.get(i)&&r.add(i.sourceId)}));for(const o of n.elements)for(const i of(0,a.iterateEntitiesOf)(o)){const s=t.elements.get(i.id),l=e.elements.get(i.id);if(s!==l&&(r.add(i.id),"entityDelete"===(s||l).type))for(const e of n.getElementLinks(o))for(const t of(0,a.iterateRelationsOf)(e))t.targetId===i.id&&t.sourceId!==i.id&&r.add(t.sourceId)}return r}function c(e,t,n,o,s){const l=o.validationState,c=i.createMutable();for(const i of n.elements)for(const u of(0,a.iterateEntitiesOf)(i)){if(c.elements.has(u.id))continue;const h=[];for(const e of n.getElementLinks(i))for(const t of(0,a.iterateRelationsOf)(e))t.sourceId===u.id&&h.push(t);if(e.has(u.id)){const e={target:u,outboundLinks:h,state:o.authoringState,graph:n,signal:s},i=(0,r.mapAbortedToNull)(t.validate(e),s),a={loading:!0,items:[]},l={loading:!0,items:[]};c.elements.set(u.id,a),h.forEach((e=>c.links.set(e,l))),d(i,a,l,e,o)}else{c.elements.set(u.id,l.elements.get(u.id));for(const e of h)c.links.set(e,l.links.get(e))}}o.setValidationState(c)}async function d(e,t,n,r,a){let l;try{if(l=await e,null===l)return}catch(h){console.error("Failed to validate element",r.target,h);l={items:[{type:"element",target:r.target.id,severity:"error",message:"Failed to validate element"}]}}const c=[],d=new o.HashMap(s.hashLink,s.equalLinks);r.outboundLinks.forEach((e=>d.set(e,[])));for(const i of l.items)"element"===i.type&&i.target===r.target.id?c.push(i):"link"===i.type&&d.has(i.target)&&d.get(i.target).push(i);let u=a.validationState;u.elements.get(r.target.id)===t&&(u=i.setElementItems(u,r.target.id,c)),d.forEach(((e,t)=>{u.links.get(t)===n&&(u=i.setLinkItems(u,t,e))})),a.setValidationState(u)}!function(e){function t(){return{elements:new Map,links:new o.HashMap(s.hashLink,s.equalLinks)}}e.empty=t(),e.emptyElement={loading:!1,items:[]},e.emptyLink={loading:!1,items:[]},e.createMutable=t,e.setElementItems=function(e,t,n){const i=new Map(e.elements);return n.length>0?i.set(t,{loading:!1,items:n}):i.delete(t),{...e,elements:i}},e.setLinkItems=function(e,t,n){const i=e.links.clone();return n.length>0?i.set(t,{loading:!1,items:n}):i.delete(t),{...e,links:i}}}(i||(i={}));const u=new Map([["info",0],["warning",1],["error",2]]);function h(e){let t="info",n=u.get(t)??-1;for(const{severity:i}of e){const e=u.get(i)??-1;e>n&&(n=e,t=i)}return t}},(e,t,n)=>{n.r(t),n.d(t,{subscribeElementTypes:()=>i,subscribeLinkTypes:()=>o,subscribePropertyTypes:()=>r});const i=(e,t,n)=>{const i=t.createElementType(e);return i.events.on("changeData",n),()=>i.events.off("changeData",n)},r=(e,t,n)=>{const i=t.createPropertyType(e);return i.events.on("changeData",n),()=>i.events.off("changeData",n)},o=(e,t,n)=>{const i=t.createLinkType(e);return i.events.on("changeData",n),()=>i.events.off("changeData",n)}},(e,t,n)=>{n.r(t),n.d(t,{OverlayController:()=>h});var i=n(102),r=n(61),o=n(56),s=n(58),a=n(60),l=n(90),c=n(96),d=n(113),u=n(127);class h{listener=new s.EventObserver;source=new s.EventSource;events=this.source;model;view;_openedDialog;_tasks=new Set;_taskError;constructor(e){const{model:t,view:n}=e;this.model=t,this.view=n,this.listener.listen(this.model.events,"changeSelection",(()=>{const e=1===this.model.selection.length?this.model.selection[0]:void 0;this.openedDialog&&this.openedDialog.target!==e&&this.hideDialog()})),n.setCanvasWidget("selectionHandler",{element:(0,i.jsx)(y,{onCanvasPointerUp:this.onAnyCanvasPointerUp}),attachment:"viewport"})}get openedDialog(){return this._openedDialog}dispose(){this.listener.stopListening()}onAnyCanvasPointerUp=e=>{const{sourceEvent:t,target:n,triggerAsClick:i}=e;t.ctrlKey||t.shiftKey||t.metaKey||this.openedDialog&&this.openedDialog.holdSelection||(n instanceof c.Element?(this.model.setSelection([n]),n.focus()):n instanceof c.Link?this.model.setSelection([n]):n instanceof c.LinkVertex?this.model.setSelection([n.link]):!n&&i&&(this.model.setSelection([]),this.hideDialog(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()))};startTask(e={}){const{title:t,delay:n=0}=e;0===this._tasks.size&&this._taskError&&(this._taskError=void 0);const i=n>0&&0===this._tasks.size,r={title:t,setError:e=>{this._taskError={error:e}},end:()=>{this._tasks.delete(r),this.updateTaskSpinner()},[p]:!i};return this._tasks.add(r),this.updateTaskSpinner(),i&&(0,o.delay)(n).then((()=>{if(this._tasks.has(r)){for(const e of this._tasks)e[p]=!0;this.updateTaskSpinner()}})),r}showSpinnerWhile(e){const t=this.startTask();(async()=>{try{await e}catch(n){console.error(n),t.setError(new Error("Unknown error occurred",{cause:n}))}finally{t.end()}})()}updateTaskSpinner(){if(this._taskError){const e=function(e){if(e&&"object"==typeof e&&"message"in e){const t=e.message;if("string"==typeof t)return t}return}(this._taskError.error);this.setSpinner({statusText:e,errorOccurred:!0})}else{let e,t=!1;for(const n of this._tasks)if(n[p]&&(t=!0),n.title){if(void 0!==e){e="Multiple tasks are in progress";break}e=n.title}t?this.setSpinner({statusText:e}):this.setSpinner(void 0)}}setSpinner(e){this.view.setCanvasWidget("loadingWidget",e?{element:(0,i.jsx)(g,{spinnerProps:e}),attachment:"viewport"}:null)}showDialog(e){const{target:t,style:n,dialogType:r,content:o,holdSelection:s=!1,onClose:a}=e;this._openedDialog&&this._openedDialog.target!==t&&this.hideDialog();const l=this._openedDialog;this._openedDialog={target:t,knownType:r,holdSelection:s,onClose:a};const c=()=>this.hideDialog();t?this.view.setCanvasWidget("dialog",{element:(0,i.jsx)(u.Dialog,{...n,target:t,onHide:c,children:o}),attachment:"overElements"}):this.view.setCanvasWidget("dialog",{element:(0,i.jsx)(f,{...n,onHide:c,children:o}),attachment:"viewport"}),this.source.trigger("changeOpenedDialog",{source:this,previous:l})}hideDialog(){if(this._openedDialog){const e=this._openedDialog;this._openedDialog=void 0,e.onClose?.(),this.view.setCanvasWidget("dialog",null),this.source.trigger("changeOpenedDialog",{source:this,previous:e})}}}const p=Symbol("OverlayTask.active");function g(e){const{spinnerProps:t}=e,n=m(),r={x:t.statusText?n.width/3:n.width/2,y:n.height/2};return(0,i.jsx)("div",{className:"reactodia-loading-widget",children:(0,i.jsx)("svg",{width:n.width,height:n.height,children:(0,i.jsx)(d.Spinner,{position:r,...t})})})}function f(e){const{...t}=e,n=m(),o=r.useMemo((()=>({width:n.width-20,height:n.height-20})),[n,10]);return(0,i.jsx)("div",{className:"reactodia-viewport-dialog-overlay",children:(0,i.jsx)(u.Dialog,{...t,centered:!0,maxSize:o})})}function m(){const{canvas:e}=(0,l.useCanvas)(),t=(0,a.useFrameDebouncedStore)((0,a.useEventStore)(e.events,"resize"));return(0,a.useSyncStoreWithComparator)(t,(()=>{const{clientWidth:t,clientHeight:n}=e.metrics.area;return{width:t,height:n}}),((e,t)=>e.width===t.width&&e.height===t.height))}function y(e){const{onCanvasPointerUp:t}=e,{canvas:n}=(0,l.useCanvas)();return r.useEffect((()=>{const e=new s.EventObserver;return e.listen(n.events,"pointerUp",t),()=>e.stopListening()}),[t]),null}},(e,t,n)=>{n.r(t),n.d(t,{Dialog:()=>m});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(90),c=n(96),d=n(93),u=n(128);const h="reactodia-dialog",p={width:300,height:320},g={width:250,height:250},f={width:800,height:800};class m extends r.Component{static contextType=l.CanvasContext;unsubscribeFromTarget=void 0;handler=new a.EventObserver;updateAll=()=>this.forceUpdate();startSize;constructor(e){super(e),this.state={}}componentDidMount(){this.listenToTarget(this.props.target),this.props.target&&this.focusOn()}componentDidUpdate(e){this.props.target!==e.target&&this.listenToTarget(this.props.target)}componentWillUnmount(){this.listenToTarget(void 0)}listenToTarget(e){if(this.unsubscribeFromTarget&&(this.unsubscribeFromTarget(),this.unsubscribeFromTarget=void 0),e){const{model:t}=this.context;e instanceof c.Element?this.listenToElement(e):e instanceof c.Link&&this.listenToLink(e),this.handler.listen(t.events,"changeLanguage",this.updateAll),this.unsubscribeFromTarget=()=>{this.handler.stopListening()}}}listenToElement(e){const{canvas:t}=this.context;this.handler.listen(e.events,"changePosition",this.updateAll),this.handler.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.updateAll()}))}listenToLink(e){const{canvas:t,model:n}=this.context,i=n.getElement(e.sourceId),r=n.getElement(e.targetId);this.listenToElement(i),this.listenToElement(r),this.handler.listen(e.events,"changeVertices",this.updateAll),this.handler.listen(t.renderingState.events,"changeLinkLabelBounds",(t=>{t.source===e&&this.updateAll()}))}calculatePositionForElement(e){const{defaultSize:t=p}=this.props,{canvas:n}=this.context,i=(0,d.boundsOf)(e,n.renderingState),{y:r}=n.metrics.paperToScrollablePaneCoords(i.x,i.y),{x:o,y:s}=n.metrics.paperToScrollablePaneCoords(i.x+i.width,i.y+i.height);return{x:o+40,y:(r+s)/2-t.height/2}}calculatePositionForLink(e){const{canvas:t,model:n}=this.context,i=n.getElement(e.sourceId),r=n.getElement(e.targetId);if(!i||!r)throw new Error("Source and target are not specified");const o=t.renderingState.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s,l=(0,d.computePolyline)((0,d.boundsOf)(i,t.renderingState),(0,d.boundsOf)(r,t.renderingState),a),c=(0,d.computePolylineLength)(l),u=(0,d.getPointAlongPolyline)(l,c/2),{x:h,y:p}=t.metrics.paperToScrollablePaneCoords(u.x,u.y);return{y:p+20,x:h+20}}calculatePosition(){const{target:e,offset:t={x:0,y:0},calculatePosition:n}=this.props,{canvas:i}=this.context;if(n){const e=n(i);if(e){const{x:n,y:r}=i.metrics.paperToScrollablePaneCoords(e.x,e.y);return{x:n+t.x,y:r+t.y}}}return e instanceof c.Element?this.calculatePositionForElement(e):e instanceof c.Link?this.calculatePositionForLink(e):void 0}getViewPortScrollablePoints(){const{canvas:e}=this.context,{clientWidth:t,clientHeight:n}=e.metrics.area;return{min:e.metrics.clientToScrollablePaneCoords(0,0),max:e.metrics.clientToScrollablePaneCoords(t,n)}}getDialogScrollablePoints(){const{defaultSize:e=p}=this.props,{x:t,y:n}=this.calculatePosition()??{x:0,y:0},i={x:t-20,y:n-20};return{min:i,max:{x:i.x+e.width+40,y:i.y+e.height+40}}}focusOn(){const{canvas:e}=this.context,{min:t,max:n}=this.getViewPortScrollablePoints(),{min:i,max:r}=this.getDialogScrollablePoints();let o=0;i.x<t.x?o=i.x-t.x:r.x>n.x&&(o=r.x-n.x);let s=0;i.y<t.y?s=i.y-t.y:r.y>n.y&&(s=r.y-n.y);const a={x:t.x+(n.x-t.x)/2+o,y:t.y+(n.y-t.y)/2+s},l=e.metrics.scrollablePaneToPaperCoords(a.x,a.y);e.centerTo(l)}onStartDragging=e=>{const{defaultSize:t=p,maxSize:n=f}=this.props;this.startSize={x:Math.min(this.state.width||t.width,n.width),y:Math.min(this.state.height||t.height,n.height)}};calculateHeight(e){const{defaultSize:t=p,minSize:n=g,maxSize:i=f}=this.props,r=Math.min(t.height,n.height),o=Math.max(t.height,i.height);return Math.max(r,Math.min(o,e))}calculateWidth(e){const{defaultSize:t=p,minSize:n=g,maxSize:i=f}=this.props,r=Math.min(t.width,n.width),o=Math.max(t.width,i.width);return Math.max(r,Math.min(o,e))}onDragHandle=(e,t,n)=>{const i=this.props.centered?2:1,r=t?this.calculateWidth(this.startSize.x+t*i):void 0,o=n?this.calculateHeight(this.startSize.y+n*i):void 0;this.setState((e=>({width:r??e.width,height:o??e.height})))};render(){const{defaultSize:e=p,maxSize:t=f,caption:n,onHide:r,resizableBy:o="all",closable:a=!0}=this.props,l=this.calculatePosition(),c=this.state.width??e.width,d=this.state.height??e.height,g={left:l?.x,top:l?.y,width:Math.min(c,t.width),height:Math.min(d,t.height)};return(0,i.jsxs)("div",{className:h,role:"dialog","aria-labelledby":n?"reactodia-dialog-caption":void 0,style:g,children:[(0,i.jsxs)("div",{className:`${h}__header`,children:[(0,i.jsx)("div",{id:"reactodia-dialog-caption",className:`${h}__caption`,title:n,children:n}),a?(0,i.jsx)("button",{title:"Close",className:s()("reactodia-btn",`${h}__close-button`),onClick:r}):null]}),this.props.children,"y"===o||"all"===o?(0,i.jsx)(u.DraggableHandle,{className:`${h}__bottom-handle`,axis:"y",onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandle}):null,"x"===o||"all"===o?(0,i.jsx)(u.DraggableHandle,{className:`${h}__right-handle`,axis:"x",onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandle}):null,"none"===o?null:(0,i.jsx)(u.DraggableHandle,{className:`${h}__bottom-right-handle`,axis:o,onBeginDragHandle:this.onStartDragging,onDragHandle:this.onDragHandle})]})}}},(e,t,n)=>{n.r(t),n.d(t,{DraggableHandle:()=>o});var i=n(102),r=n(61);class o extends r.Component{holdState;render(){const{onBeginDragHandle:e,onDragHandle:t,onEndDragHandle:n,...r}=this.props;return(0,i.jsx)("div",{...r,onPointerDown:this.onPointerDown,children:this.props.children})}componentWillUnmount(){this.removeListeners()}onPointerDown=e=>{if(this.holdState||e.target!==e.currentTarget)return;if(e.button)return;const{pageX:t,pageY:n,currentTarget:i,pointerId:r}=e;e.preventDefault(),this.holdState={origin:{pageX:t,pageY:n},target:i,pointerId:r},i.addEventListener("pointermove",this.onPointerMove),i.addEventListener("pointerup",this.onPointerUp),i.addEventListener("pointercancel",this.onPointerUp),i.setPointerCapture(r);const{onBeginDragHandle:o}=this.props;o(e)};onPointerMove=e=>{if(!this.holdState)return;e.preventDefault();const{origin:t}=this.holdState,{axis:n,onDragHandle:i}=this.props;i(e,"y"===n?0:e.pageX-t.pageX,"x"===n?0:e.pageY-t.pageY)};onPointerUp=e=>{this.removeListeners();const{onEndDragHandle:t}=this.props;t?.(e)};removeListeners(){if(this.holdState){const{target:e,pointerId:t}=this.holdState;this.holdState=void 0,e.releasePointerCapture(t),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp)}}}},(e,t,n)=>{n.r(t),n.d(t,{WithFetchStatus:()=>c});var i,r=n(61),o=n(106),s=n.n(o),a=n(130);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.Error=2]="Error"}(i||(i={}));const l="reactodia-fetch-status";function c(e){const{type:t,target:n,children:o}=e,{model:c}=(0,a.useWorkspace)(),[u,h]=r.useState(c.getOperationFailReason(t,n)?i.Error:i.None);return r.useEffect((()=>{const e=e=>{h((()=>{if(e&&d(e.operation,t,n))return i.Error;for(const e of c.operations)if(d(e,t,n))return i.Loading;return c.getOperationFailReason(t,n)?i.Error:i.None}))};e();const r=t=>{e(t.fail)};return c.events.on("changeOperations",r),()=>c.events.off("changeOperations",r)}),[t,n]),u===i.None?o:r.cloneElement(o,{className:s()(o.props.className,u===i.Loading?`${l}--loading`:u===i.Error?`${l}--error`:void 0)})}function d(e,t,n){return e.type===t&&e.targets.has(n)}},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceContext:()=>o,WorkspaceEventKey:()=>i,useWorkspace:()=>s});var i,r=n(61);!function(e){e.searchUpdateCriteria="search:updateCriteria",e.searchQueryItem="search:queryItems",e.connectionsLoadLinks="connections:loadLinks",e.connectionsExpandLink="connections:expandLink",e.connectionsLoadElements="connections:loadElements",e.editorChangeSelection="editor:changeSelection",e.editorToggleDialog="editor:toggleDialog",e.editorAddElements="editor:addElements"}(i||(i={}));const o=r.createContext(null);function s(){const e=r.useContext(o);if(!e)throw new Error("Missing Reactodia workspace context");return e}},(e,t,n)=>{n.r(t),n.d(t,{ClassicTemplate:()=>h});var i=n(102),r=n(106),o=n.n(r),s=n(65),a=n(119),l=n(125),c=n(129),d=n(130);const u="reactodia-classic-template";function h(e){const{element:t,isExpanded:n}=e,r=t instanceof a.EntityElement?t.data:void 0,{model:h,getElementTypeStyle:g}=(0,d.useWorkspace)();if((0,s.useKeyedSyncStore)(l.subscribeElementTypes,r?r.types:[],h),(0,s.useKeyedSyncStore)(l.subscribePropertyTypes,r&&n?Object.keys(r.properties):[],h),!r)return null;const f=r?.types??[],{color:m,icon:y}=g(f),b=f.length>0?h.locale.formatElementTypes(f).join(", "):"Thing",x=h.locale.formatLabel(r?.label,r.id),w=h.locale.formatPropertyList(r?.properties??{}),v=r?.image?(0,i.jsx)("div",{className:`${u}__thumbnail`,children:(0,i.jsx)("img",{className:`${u}__thumbnail-image`,src:r.image})}):void 0,k=n?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:`${u}__expander`,children:[(0,i.jsx)("div",{className:`${u}__iri-heading`,children:"IRI:"}),(0,i.jsx)("div",{className:`${u}__iri-container`,children:(0,i.jsx)("a",{className:`${u}__iri`,title:r.id,href:r.id,children:r.id})})]}),(0,i.jsx)("hr",{className:`${u}__divider`}),p(w)]}):null;return(0,i.jsxs)("div",{className:o()(u,n?`${u}--expanded`:`${u}--collapsed`),style:{backgroundColor:m,borderColor:m},"data-expanded":n,children:[(0,i.jsxs)("div",{className:`${u}__type-line`,title:x,children:[(0,i.jsx)("div",{className:`${u}__type-line-icon`,"aria-hidden":"true",children:(0,i.jsx)("img",{src:y})}),(0,i.jsx)("div",{title:b,className:`${u}__type-line-text-container`,children:(0,i.jsx)("div",{className:`${u}__type-line-text`,children:b})})]}),v,(0,i.jsxs)("div",{className:`${u}__body`,style:{borderColor:m},children:[(0,i.jsx)(c.WithFetchStatus,{type:"element",target:r.id,children:(0,i.jsx)("span",{className:`${u}__label`,title:x,children:x})}),k]})]})}function p(e){return e.length>0?(0,i.jsx)("div",{className:`${u}__property-table`,children:e.map((({propertyId:e,label:t,values:n})=>{const r=n.map(((e,t)=>(0,i.jsx)("div",{className:`${u}__property-value`,title:e.value,children:e.value},t)));return(0,i.jsxs)("div",{className:`${u}__property-row`,children:[(0,i.jsx)(c.WithFetchStatus,{type:"propertyType",target:e,children:(0,i.jsx)("div",{className:`${u}__property-label`,title:`${t} (${e})`,children:t})}),(0,i.jsx)("div",{className:`${u}__property-values`,children:r})]},e)}))}):(0,i.jsx)("div",{children:"no properties"})}},(e,t,n)=>{n.r(t),n.d(t,{DefaultLinkPathTemplate:()=>f,DefaultLinkTemplate:()=>p});var i=n(102),r=n(106),o=n.n(r),s=n(65),a=n(74),l=n(101),c=n(119),d=n(125),u=n(129),h=n(130);const p={markerTarget:{d:"M0,0 L0,8 L9,4 z",width:9,height:8,fill:"black"},renderLink:e=>(0,i.jsx)(f,{...e})},g="reactodia-default-link";function f(e){const{link:t,className:n,path:r,pathProps:p,markerSource:f,markerTarget:m,getPathPosition:y,route:b,primaryLabelProps:x,propertyLabelProps:w,propertyLabelStartLine:v=1,prependLabels:k=null}=e,{model:S,view:{renameLinkProvider:L}}=(0,h.useWorkspace)();(0,s.useKeyedSyncStore)(d.subscribeLinkTypes,[t.typeId],S),(0,s.useKeyedSyncStore)(d.subscribePropertyTypes,t instanceof c.RelationLink?Object.keys(t.data.properties):[],S);const _=L?.getLabel(t);let M=null;if("visible"===S.getLinkVisibility(t.typeId)){const e=`${g}__label-text`,n=`${g}__label-background`,r=S.getLinkType(t.typeId),s=_??S.locale.formatLabel(r?.data?.label,t.typeId),a=t instanceof c.RelationLink?S.locale.formatPropertyList(t.data.properties):[];M=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.LinkLabel,{...x,primary:!0,link:t,position:y(.5),textAnchor:b?.labelTextAnchor??x?.textAnchor,textClass:o()(e,x?.textClass),rectClass:o()(n,x?.rectClass),title:x?.title??`${s} ${S.locale.formatIri(t.typeId)}`,content:_?s:(0,i.jsx)(u.WithFetchStatus,{type:"linkType",target:t.typeId,children:(0,i.jsx)("tspan",{children:s})})}),k,a.map(((r,s)=>(0,i.jsx)(l.LinkLabel,{...w,link:t,position:y(.5),line:v+s,textAnchor:b?.labelTextAnchor??w?.textAnchor,textClass:o()(e,w?.textClass),rectClass:o()(n,w?.rectClass),title:w?.title??`${r.label} ${S.locale.formatIri(r.propertyId)}`,content:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.WithFetchStatus,{type:"propertyType",target:r.propertyId,children:(0,i.jsxs)("tspan",{children:[r.label,":\xa0"]})}),r.values.map((e=>e.value)).join(", ")]})},r.propertyId))),t instanceof c.RelationGroup?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.LinkLabel,{className:`${g}__source-count`,link:t,position:y(.1),textClass:e,rectClass:n,title:`${t.itemSources.size} source elements`,content:(0,i.jsx)(i.Fragment,{children:t.itemSources.size})}),(0,i.jsx)(l.LinkLabel,{className:`${g}__target-count`,link:t,position:y(.9),textClass:e,rectClass:n,title:`${t.itemTargets.size} target elements`,content:(0,i.jsx)(i.Fragment,{children:t.itemTargets.size})})]}):null]})}const{linkState:I}=t,T=p?.stroke??"black";return(0,i.jsxs)("g",{className:o()(g,t instanceof c.RelationGroup?`${g}--group`:void 0,_?`${g}--renamed`:void 0,n),children:[(0,i.jsx)(l.LinkPath,{path:r,pathProps:{fill:"none",...p,className:o()(`${g}__path`,p?.className),stroke:T,strokeDasharray:I?.[a.TemplateProperties.LayoutOnly]?"5,5":p?.strokeDasharray},markerSource:f,markerTarget:m}),M,0===t.vertices.length?null:(0,i.jsx)(l.LinkVertices,{linkId:t.id,vertices:t.vertices,fill:T})]})}},(e,t,n)=>{n.r(t),n.d(t,{GroupPaginator:()=>a});var i=n(102),r=n(106),o=n.n(r);const s="reactodia-group-paginator";function a(e){const{pageIndex:t,pageCount:n,onChangePage:r,pageSize:a,pageSizes:l,onChangePageSize:c}=e,d=n-1;return(0,i.jsxs)("div",{className:s,children:[(0,i.jsx)("button",{type:"button",className:o()("reactodia-btn",`${s}__previous`),name:"Go to the next page",disabled:t<=0,onClick:()=>r(t-1)}),(0,i.jsxs)("div",{className:`${s}__status`,children:[t+1," of ",n]}),(0,i.jsx)("button",{type:"button",className:o()("reactodia-btn",`${s}__next`),title:"Go to the previous page",disabled:t>=d,onClick:()=>r(t+1)}),(0,i.jsx)("select",{className:`${s}__page-size`,title:"Number of items to display per page",value:a,onPointerDown:e=>e.stopPropagation(),onChange:e=>c(Number(e.currentTarget.value)),children:l.map((e=>(0,i.jsx)("option",{value:e,children:e},e)))})]})}},(e,t,n)=>{n.r(t),n.d(t,{StandardTemplate:()=>b});var i=n(61),r=n(102),o=n(106),s=n.n(o),a=n(65),l=n(68),c=n(74),d=n(90),u=n(113),h=n(119),p=n(125),g=n(129),f=n(135),m=n(130),y=n(133);function b(e){const{element:t}=e;return t instanceof h.EntityElement?(0,r.jsx)(S,{...e,data:t.data,target:t}):t instanceof h.EntityGroup?(0,r.jsx)(L,{...e,items:t.items,target:t}):null}const x="reactodia-standard-template",w="http://xmlns.com/foaf/0.1/name",v=10,k=[5,10,15,20,30];function S(e){const{data:t,isExpanded:n,elementState:o,target:d}=e,u=(0,m.useWorkspace)(),{model:h,editor:y,getElementTypeStyle:b}=u;(0,a.useKeyedSyncStore)(p.subscribeElementTypes,t?t.types:[],h),(0,a.useKeyedSyncStore)(p.subscribePropertyTypes,t&&n?Object.keys(t.properties):[],h);const w=(0,f.useAuthoredEntity)(t,n),v=M(t,h.locale),k=I(t,h.locale),{color:S,icon:L}=b(t.types),_={"--reactodia-standard-entity-color":S},N=h.locale.formatPropertyList(t.properties),C=function(){if(n||!o)return;return o[c.TemplateProperties.PinnedProperties]}()??{},A=N.filter((e=>Boolean(Object.prototype.hasOwnProperty.call(C,e.propertyId)&&C[e.propertyId])));return(0,r.jsxs)("div",{style:_,className:s()(x,`${x}--standalone`,T(t,y.authoringState)),children:[(0,r.jsx)("div",{className:`${x}__main`,children:(0,r.jsxs)("div",{className:`${x}__body`,children:[(0,r.jsxs)("div",{className:`${x}__body-horizontal`,children:[t.image?(0,r.jsx)("div",{className:`${x}__thumbnail`,"aria-hidden":"true",children:(0,r.jsx)("img",{src:t.image,className:`${x}__thumbnail-image`})}):L?(0,r.jsx)("div",{className:`${x}__thumbnail`,"aria-hidden":"true",children:(0,r.jsx)("img",{src:L,className:`${x}__thumbnail-icon`})}):(0,r.jsx)("div",{className:`${x}__thumbnail`,"aria-hidden":"true",children:k.length>0?k.charAt(0).toUpperCase():"\u2733"}),(0,r.jsxs)("div",{className:`${x}__body-content`,children:[(0,r.jsx)("div",{title:k,className:`${x}__type`,children:(0,r.jsx)("div",{className:`${x}__type-value`,children:0===t.types.length?"Thing":t.types.map(((e,t)=>{const n=h.getElementType(e),o=h.locale.formatLabel(n?.data?.label,e);return(0,r.jsxs)(i.Fragment,{children:[0===t?null:", ",(0,r.jsx)(g.WithFetchStatus,{type:"elementType",target:e,children:(0,r.jsx)("span",{children:o})})]},e)}))})}),(0,r.jsx)(g.WithFetchStatus,{type:"element",target:t.id,children:(0,r.jsx)("div",{className:`${x}__label`,title:v,children:v})})]})]}),A.length>0?(0,r.jsx)("div",{className:`${x}__pinned-props`,children:(0,r.jsx)(E,{properties:A})}):null]})}),n?(0,r.jsxs)("div",{className:`${x}__dropdown`,children:[t.image?(0,r.jsx)("div",{className:`${x}__photo`,children:(0,r.jsx)("img",{src:t.image,className:`${x}__photo-image`})}):null,(0,r.jsxs)("div",{className:`${x}__dropdown-content`,children:[function(){const e=void 0===w.editedIri?t.id:w.editedIri;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:`${x}__iri`,children:[(0,r.jsxs)("div",{className:`${x}__iri-key`,children:["IRI",w.editedIri?"\xa0(edited)":"",":"]}),(0,r.jsx)("div",{className:`${x}__iri-value`,children:(0,l.isEncodedBlank)(e)?(0,r.jsx)("span",{children:"(blank node)"}):(0,r.jsx)("a",{href:e,title:e,"data-iri-click-intent":"openEntityIri",children:e})})]}),(0,r.jsx)("hr",{className:`${x}__hr`})]})}(),(0,r.jsx)(E,{properties:N}),y.inAuthoringMode?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("hr",{className:`${x}__hr`,"data-reactodia-no-export":"true"}),(0,r.jsx)(j,{target:d,entityContext:w})]}):null]})]}):null]})}function L(e){const{items:t,target:n,elementState:o,groupPageSize:a=v,groupPageSizes:l=k}=e,{canvas:u}=(0,d.useCanvas)(),h=(0,m.useWorkspace)(),{getElementStyle:p}=h,{color:g}=p(n),f={"--reactodia-standard-group-color":g},b=o?.[c.TemplateProperties.GroupPageSize];let w="number"==typeof b?b:a;w=Number.isFinite(w)?w:a;const S=Math.max(Math.ceil(t.length/w),1),L=o?.[c.TemplateProperties.GroupPageIndex];let M="number"==typeof L?L:0;M=Number.isFinite(M)?M:0,M=Math.min(Math.max(M,0),S-1);const I=M*w,T=t.slice(I,Math.min(I+w,t.length)),E=1===S?0:I+w-t.length;return(0,r.jsxs)("div",{className:s()(x,`${x}--group`),style:f,role:"list",children:[T.map((t=>(0,i.createElement)(_,{...e,key:t.data.id,data:t.data,isExpanded:!1,target:n,canvas:u,workspace:h}))),Array.from({length:E},((e,t)=>(0,r.jsx)("div",{className:`${x}__item-filler`,"aria-hidden":!0,children:"\xa0"},t))),(0,r.jsx)(y.GroupPaginator,{pageIndex:M,pageCount:S,onChangePage:e=>n.setElementState({...n.elementState,[c.TemplateProperties.GroupPageIndex]:e}),pageSize:w,pageSizes:l,onChangePageSize:e=>n.setElementState({...n.elementState,[c.TemplateProperties.GroupPageSize]:e})})]})}function _(e){const{data:t,target:n,canvas:i,workspace:{model:o,editor:l,ungroupSome:c,getElementTypeStyle:d}}=e;(0,a.useKeyedSyncStore)(p.subscribeElementTypes,t?t.types:[],o);const u=M(t,o.locale),h=`${u}\nIRI:${o.locale.formatIri(t.id)}\nTypes: ${I(t,o.locale)}`,f=T(t,l.authoringState),{color:m}=d(t.types),y={"--reactodia-standard-entity-color":m};return(0,r.jsxs)("div",{className:s()(`${x}__item`,f),style:y,role:"listitem",children:[(0,r.jsx)("div",{className:`${x}__item-stripe`,"aria-hidden":"true"}),(0,r.jsxs)("div",{className:`${x}__item-body`,children:[(0,r.jsx)(g.WithFetchStatus,{type:"element",target:t.id,children:(0,r.jsx)("div",{className:`${x}__label`,title:h,children:u})}),(0,r.jsx)("button",{type:"button",className:s()(`${x}__ungroup-one-button`,"reactodia-btn reactodia-btn-default"),"data-reactodia-no-export":"true",title:"Ungroup an entity",onClick:()=>c({group:n,entities:new Set([t.id]),canvas:i})})]})]})}function M(e,t){const n=Object.prototype.hasOwnProperty.call(e.properties,w)?e.properties[w]:void 0;if(n){const i=n.filter((e=>"Literal"===e.termType));if(i.length>0)return t.formatLabel(i,e.id)}return t.formatLabel(e.label,e.id)}function I(e,t){return e.types.length>0?t.formatElementTypes(e.types).join(", "):"Thing"}function T(e,t){const n=t.elements.get(e.id);if(n)switch(n.type){case"entityAdd":return`${x}--new`;case"entityChange":return`${x}--changed`;case"entityDelete":return`${x}--deleted`;default:return}}function E(e){const{properties:t}=e;return 0===t.length?(0,r.jsx)("div",{children:"no properties"}):(0,r.jsx)("div",{role:"list",className:`${x}__properties`,children:t.map((({propertyId:e,label:t,values:n})=>(0,r.jsxs)("div",{role:"listitem",className:`${x}__properties-row`,children:[(0,r.jsx)(g.WithFetchStatus,{type:"propertyType",target:e,children:(0,r.jsx)("div",{className:`${x}__properties-key`,title:`${t} (${e})`,children:t})}),(0,r.jsx)("div",{className:`${x}__properties-values`,children:n.map(((e,t)=>(0,r.jsx)("div",{className:`${x}__properties-value`,title:e.value,lang:"Literal"===e.termType&&e.language?e.language:void 0,children:e.value},t)))})]},e)))})}function j(e){const{target:t,entityContext:{canEdit:n,canDelete:i,onEdit:o,onDelete:a}}=e;return(0,r.jsxs)("div",{className:`${x}__actions`,"data-reactodia-no-export":"true",children:[(0,r.jsx)("button",{type:"button",className:s()(`${x}__delete-button`,"reactodia-btn reactodia-btn-default"),title:i?"Delete entity":"Deletion is unavailable for the selected element",disabled:!i,onClick:a,children:void 0===n?(0,r.jsx)(u.HtmlSpinner,{width:15,height:12}):"Delete"}),(0,r.jsx)("button",{type:"button",className:s()(`${x}__edit-button`,"reactodia-btn reactodia-btn-default"),title:n?"Edit entity":"Editing is unavailable for the selected element",disabled:!n,onClick:()=>o(t),children:void 0===n?(0,r.jsx)(u.HtmlSpinner,{width:15,height:12}):"Edit"})]})}},(e,t,n)=>{n.r(t),n.d(t,{useAuthoredEntity:()=>d});var i,r=n(61),o=n(56),s=n(60),a=n(119),l=n(130);!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Delete=2]="Delete",e[e.All=3]="All"}(i||(i={}));const c={canEdit:!1,canDelete:!1,onEdit:()=>{},onDelete:()=>{}};function d(e,t){const{editor:n}=(0,l.useWorkspace)(),d=n.inAuthoringMode?e:void 0,[u,h]=r.useState(),p=(0,s.useObservedProperty)(n.events,"changeAuthoringState",(()=>d?n.authoringState.elements.get(d.id):void 0));return r.useEffect((()=>{const e=new AbortController;return d?t&&(!n.metadataProvider||p&&"entityDelete"===p.type?h(i.None):(0,o.mapAbortedToNull)(n.metadataProvider.canModifyEntity(d,{signal:e.signal}),e.signal).then((e=>{if(null===e)return;const{canEdit:t,canDelete:n}=e;h((t?i.Edit:i.None)|(n?i.Delete:i.None))}))):h(i.None),()=>e.abort()}),[d,p,t]),d?{editedIri:p&&"entityChange"===p.type?p.newIri:void 0,canEdit:void 0===u?void 0:Boolean(u&i.Edit),canDelete:void 0===u?void 0:Boolean(u&i.Delete),onEdit:e=>{e instanceof a.EntityElement&&n.authoringCommands.trigger("editEntity",{target:e})},onDelete:()=>{n.deleteEntity(d.id)}}:c}},(e,t,n)=>{n.r(t),n.d(t,{SemanticTypeStyles:()=>h});const i=n(137),r=n(138),o=n(139),s=n(140),a=n(141),l=n(142),c=n(143),d=n(144),u=n(145),h=e=>-1!==e.indexOf("http://www.w3.org/2002/07/owl#Class")||-1!==e.indexOf("http://www.w3.org/2000/01/rdf-schema#Class")?{color:"#eaac77",icon:i}:-1!==e.indexOf("http://www.w3.org/2002/07/owl#ObjectProperty")?{color:"#34c7f3",icon:r}:-1!==e.indexOf("http://www.w3.org/2002/07/owl#DatatypeProperty")?{color:"#34c7f3",icon:o}:-1!==e.indexOf("http://xmlns.com/foaf/0.1/Person")||-1!==e.indexOf("http://www.wikidata.org/entity/Q5")?{color:"#eb7777",icon:s}:-1!==e.indexOf("http://www.wikidata.org/entity/Q6256")?{color:"#77ca98",icon:a}:-1!==e.indexOf("http://schema.org/Organization")||-1!==e.indexOf("http://dbpedia.org/ontology/Organisation")||-1!==e.indexOf("http://xmlns.com/foaf/0.1/Organization")||-1!==e.indexOf("http://www.wikidata.org/entity/Q43229")?{color:"#77ca98",icon:l}:-1!==e.indexOf("http://www.wikidata.org/entity/Q618123")?{color:"#bebc71",icon:c}:-1!==e.indexOf("http://www.wikidata.org/entity/Q1190554")?{color:"#b4b1fb",icon:d}:-1!==e.indexOf("http://www.wikidata.org/entity/Q488383")?{color:"#53ccb2",icon:u}:void 0},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMyIgeT0iMjIiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjZWFhYzc3Ig0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDI2cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIEMNCiAgICA8L3RleHQ+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMCIgeT0iMjAiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjMzRjN2YzIg0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIE9QDQogICAgPC90ZXh0Pg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAyNiI+DQogICAgPHRleHQgeD0iMCIgeT0iMjAiIGNsYXNzPSJ0ZXh0IiBmaWxsPSIjMzRjN2YzIg0KICAgICAgICBzdHlsZT0iZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgIERQDQogICAgPC90ZXh0Pg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzNTAgMzUwIj4NCgk8cGF0aCBmaWxsPSIjZWI3Nzc3IiBkPSJNMTc1LDE3MS4xNzNjMzguOTE0LDAsNzAuNDYzLTM4LjMxOCw3MC40NjMtODUuNTg2QzI0NS40NjMsMzguMzE4LDIzNS4xMDUsMCwxNzUsMHMtNzAuNDY1LDM4LjMxOC03MC40NjUsODUuNTg3DQoJCUMxMDQuNTM1LDEzMi44NTUsMTM2LjA4NCwxNzEuMTczLDE3NSwxNzEuMTczeiIvPg0KCTxwYXRoIGZpbGw9IiNlYjc3NzciIGQ9Ik00MS45MDksMzAxLjg1M0M0MS44OTcsMjk4Ljk3MSw0MS44ODUsMzAxLjA0MSw0MS45MDksMzAxLjg1M0w0MS45MDksMzAxLjg1M3oiLz4NCgk8cGF0aCBmaWxsPSIjZWI3Nzc3IiBkPSJNMzA4LjA4NSwzMDQuMTA0QzMwOC4xMjMsMzAzLjMxNSwzMDguMDk4LDI5OC42MywzMDguMDg1LDMwNC4xMDRMMzA4LjA4NSwzMDQuMTA0eiIvPg0KCTxwYXRoIGZpbGw9IiNlYjc3NzciIGQ9Ik0zMDcuOTM1LDI5OC4zOTdjLTEuMzA1LTgyLjM0Mi0xMi4wNTktMTA1LjgwNS05NC4zNTItMTIwLjY1N2MwLDAtMTEuNTg0LDE0Ljc2MS0zOC41ODQsMTQuNzYxDQoJCXMtMzguNTg2LTE0Ljc2MS0zOC41ODYtMTQuNzYxYy04MS4zOTUsMTQuNjktOTIuODAzLDM3LjgwNS05NC4zMDMsMTE3Ljk4MmMtMC4xMjMsNi41NDctMC4xOCw2Ljg5MS0wLjIwMiw2LjEzMQ0KCQljMC4wMDUsMS40MjQsMC4wMTEsNC4wNTgsMC4wMTEsOC42NTFjMCwwLDE5LjU5MiwzOS40OTYsMTMzLjA4LDM5LjQ5NmMxMTMuNDg2LDAsMTMzLjA4LTM5LjQ5NiwxMzMuMDgtMzkuNDk2DQoJCWMwLTIuOTUxLDAuMDAyLTUuMDAzLDAuMDA1LTYuMzk5QzMwOC4wNjIsMzA0LjU3NSwzMDguMDE4LDMwMy42NjQsMzA3LjkzNSwyOTguMzk3eiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj4NCiAgICA8cGF0aCBmaWxsPSIjNzdjYTk4IiBkPSJNNDcyLjkyOCwzNC43NTJjLTQuNDE2LTMuMDA4LTEwLjAxNi0zLjU1Mi0xNC45NDQtMS42Yy0xLjAyNCwwLjQxNi0xMDYuODgsNDIuMDQ4LTE5NS4xNjgsMC4zODQNCgkJCUMxODYuNzItMi40MzIsMTAyLjkxMiwxNC40LDY0LDI1Ljc2VjE2YzAtOC44MzItNy4xNjgtMTYtMTYtMTZjLTguODMyLDAtMTYsNy4xNjgtMTYsMTZ2MzJ2MjU2djE5MmMwLDguODMyLDcuMTY4LDE2LDE2LDE2DQoJCQljOC44MzIsMCwxNi03LjE2OCwxNi0xNlYzMTUuMzI4YzI4LjM4NC05LjE4NCwxMTIuNjA4LTMxLjEzNiwxODUuMTg0LDMuMTM2YzM0LjU5MiwxNi4zNTIsNzAuNzg0LDIxLjc5MiwxMDMuNjQ4LDIxLjc5Mg0KCQkJYzYzLjIsMCwxMTQuMDE2LTIwLjEyOCwxMTcuMTg0LTIxLjQwOGM2LjAxNi0yLjQ2NCw5Ljk4NC04LjMyLDkuOTg0LTE0Ljg0OFY0OEM0ODAsNDIuNjg4LDQ3Ny4zNDQsMzcuNzI4LDQ3Mi45MjgsMzQuNzUyeiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj4NCiAgICA8cGF0aCBmaWxsPSIjNzdjYTk4IiBkPSJNMTU1LDBIMTVDNi43MTYsMCwwLDYuNzE2LDAsMTV2MzVoMTcwVjE1QzE3MCw2LjcxNiwxNjMuMjg0LDAsMTU1LDB6Ii8+DQogICAgPHBhdGggZmlsbD0iIzc3Y2E5OCIgZD0iTTUwNC40NjQsMTQyLjk4OWMtNC42NjItMi42NzQtMTAuMzk3LTIuNjUxLTE1LjAzNiwwLjA2M0wzNDEsMjI5Ljg1MlYxNTZjMC01LjM3NC0yLjg3NS0xMC4zMzctNy41MzYtMTMuMDExDQoJCQljLTQuNjYyLTIuNjc0LTEwLjM5Ny0yLjY1MS0xNS4wMzYsMC4wNjNMMTcwLDIyOS44NTJWODBIMHY0MTdjMCw4LjI4NCw2LjcxNiwxNSwxNSwxNWg0ODJjOC4yODQsMCwxNS02LjcxNiwxNS0xNVYxNTYNCgkJCUM1MTIsMTUwLjYyNiw1MDkuMTI1LDE0NS42NjMsNTA0LjQ2NCwxNDIuOTg5eiBNMjMwLDQwNi41YzAsOC4yODQtNi43MTYsMTUtMTUsMTVoLTYwYy04LjI4NCwwLTE1LTYuNzE2LTE1LTE1di02MA0KCQkJYzAtOC4yODQsNi43MTYtMTUsMTUtMTVoNjBjOC4yODQsMCwxNSw2LjcxNiwxNSwxNVY0MDYuNXogTTQwMSw0MDYuNWMwLDguMjg0LTYuNzE2LDE1LTE1LDE1aC02MGMtOC4yODQsMC0xNS02LjcxNi0xNS0xNXYtNjANCgkJCWMwLTguMjg0LDYuNzE2LTE1LDE1LTE1aDYwYzguMjg0LDAsMTUsNi43MTYsMTUsMTVWNDA2LjV6Ii8+DQo8L3N2Zz4NCg=="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI0Ny44MjVweCIgaGVpZ2h0PSI0Ny44MjVweCIgdmlld0JveD0iMCAwIDQ3LjgyNSA0Ny44MjUiPg0KICAgIDxwYXRoIGZpbGw9IiNiZWJjNzEiIGQ9Ik0zNi40MzksMTIuNjQ2YzAtNi45MTktNS42MDgtMTIuNTI3LTEyLjUyOC0xMi41MjdTMTEuMzg0LDUuNzI3LDExLjM4NCwxMi42NDZjMCw5LjkxMywxMi41MjcsMjQuNTgyLDEyLjUyNywyNC41ODINCgkJCQlTMzYuNDM5LDIyLjUwOCwzNi40MzksMTIuNjQ2eiBNMTcuNzMzLDExLjg5OGMwLTMuNDEzLDIuNzY3LTYuMTc5LDYuMTc5LTYuMTc5czYuMTc5LDIuNzY2LDYuMTc5LDYuMTc5DQoJCQkJYzAsMy40MTMtMi43NjcsNi4xNzktNi4xNzksNi4xNzlTMTcuNzMzLDE1LjMxMSwxNy43MzMsMTEuODk4eiIvPg0KICAgIDxjaXJjbGUgZmlsbD0iI2JlYmM3MSIgY3g9IjIzLjkxMSIgY3k9IjExLjg5OCIgcj0iMy4wMzgiLz4NCiAgICA8cGF0aCBmaWxsPSIjYmViYzcxIiBkPSJNMzAuOTk0LDMyLjg3Yy0xLjAyMSwxLjQ3Ni0xLjk3OSwyLjc2MS0yLjc3NywzLjc5M2M3LjkxNiwwLjQ3NiwxMy4xMDQsMi4xODUsMTUuMDM0LDMuNDU2DQoJCQkJYy0yLjI2MSwxLjQ5MS04Ljk3OSwzLjU4Ny0xOS4zMzgsMy41ODdjLTEwLjM1OCwwLTE3LjA3Ny0yLjA5Ny0xOS4zMzgtMy41ODdjMS45My0xLjI3MSw3LjExNC0yLjk3OSwxNS4wMjItMy40NTUNCgkJCQljLTAuOC0xLjAzMi0xLjc1OS0yLjMxNi0yLjc4MS0zLjc5MkM3LjA3NSwzMy44MzEsMCwzNi43MTMsMCw0MC4xMThjMCw0LjE5LDEwLjcwNyw3LjU4OCwyMy45MTMsNy41ODgNCgkJCQljMTMuMjA3LDAsMjMuOTEyLTMuMzk2LDIzLjkxMi03LjU4OEM0Ny44MjcsMzYuNzExLDQwLjc0NCwzMy44MjgsMzAuOTk0LDMyLjg3eiIvPg0KPC9zdmc+DQo="},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI5Ny40NzNweCIgaGVpZ2h0PSI5Ny40NzNweCIgdmlld0JveD0iMCAwIDk3LjQ3MyA5Ny40NzMiPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjQxLjU2OSIgeT0iNDcuNzUzIiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMyIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjQxLjU2OSIgeT0iNjcuNzU0IiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMiIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjE4LjU2OSIgeT0iNjcuNzU0IiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMiIvPg0KCTxyZWN0IGZpbGw9IiNiNGIxZmIiIHg9IjE4LjU2OSIgeT0iNDcuNzUzIiB3aWR0aD0iMTQuMzMzIiBoZWlnaHQ9IjE0LjMzMyIvPg0KCTxwYXRoIGZpbGw9IiNiNGIxZmIiIGQ9Ik05NS40NzIsMTQuNDY2SDg0LjQyN1YyLjcwMWMwLTEuMTA0LTAuODk2LTItMi0ySDY1LjgxMWMtMS4xMDQsMC0yLDAuODk2LTIsMnYxMS43NjVIMzMuNjYyVjIuNzAxYzAtMS4xMDQtMC44OTYtMi0yLTINCgkJCQlIMTUuMDQ1Yy0xLjEwNCwwLTIsMC44OTYtMiwydjExLjc2NUgyYy0xLjEwNCwwLTIsMC44OTYtMiwydjc4LjMwNWMwLDEuMTA0LDAuODk2LDIsMiwyaDkzLjQ3M2MxLjEwNCwwLDItMC44OTYsMi0yVjE2LjQ2Ng0KCQkJCUM5Ny40NzIsMTUuMzYyLDk2LjU3NiwxNC40NjYsOTUuNDcyLDE0LjQ2NnogTTY5LjY0NSw4LjAzN2MwLTAuODI4LDAuNjcyLTEuNSwxLjUtMS41aDUuOTQ3YzAuODI5LDAsMS41LDAuNjcyLDEuNSwxLjV2MjAuMzQNCgkJCQljMCwwLjgyOC0wLjY3MSwxLjUtMS41LDEuNWgtNS45NDdjLTAuODI4LDAtMS41LTAuNjcyLTEuNS0xLjVWOC4wMzd6IE0xOC44OCw4LjAzN2MwLTAuODI4LDAuNjcxLTEuNSwxLjUtMS41aDUuOTQ3DQoJCQkJYzAuODI5LDAsMS41LDAuNjcyLDEuNSwxLjV2MjAuMzRjMCwwLjgyOC0wLjY3MSwxLjUtMS41LDEuNUgyMC4zOGMtMC44MjksMC0xLjUtMC42NzItMS41LTEuNVY4LjAzN3ogTTg3LjA2OCw4NC45MDINCgkJCQljMCwwLjgyOC0wLjY3LDEuNS0xLjUsMS41SDExLjkwM2MtMC44MjksMC0xLjUtMC42NzItMS41LTEuNXYtNDBjMC0wLjgyOCwwLjY3MS0xLjUsMS41LTEuNWg3My42NjZjMC44MywwLDEuNSwwLjY3MiwxLjUsMS41DQoJCQkJVjg0LjkwMnoiLz4NCgk8cmVjdCBmaWxsPSIjYjRiMWZiIiB4PSI2NC41NjgiIHk9IjQ3Ljc1MyIgd2lkdGg9IjE0LjMzNCIgaGVpZ2h0PSIxNC4zMzMiLz4NCgk8cmVjdCBmaWxsPSIjYjRiMWZiIiB4PSI2NC41NjgiIHk9IjY3Ljc1NCIgd2lkdGg9IjE0LjMzNCIgaGVpZ2h0PSIxNC4zMzIiLz4NCjwvc3ZnPg0K"},e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IiBoZWlnaHQ9IjUwcHgiIHZpZXdCb3g9IjAgMCA1MCA1MCI+DQogICAgPHBhdGggZmlsbD0iIzUzY2NiMiIgZD0iTTI2LjEyLDE0LjQ4OGMwLjg3OS0xLjQ2OCwyLjI3LTMuNTY5LDQuMDI3LTUuNTg1aDAuMDAyYzEuNDg4LTEuNzExLDQuNDAyLTMuOTA3LDQuNDAyLTMuOTA3DQoJCQljMC40MzgtMC4zMzEsMC4zOTEtMC43OTItMC4xMDctMS4wMjRsLTMuNTIyLTEuNjQ2Yy0wLjQ5OC0wLjIzMy0xLjE3NS0wLjA2My0xLjUwNSwwLjM3NmMwLDAtMi42MDUsMy43MzctNS42NzEsMTEuNjkyDQoJCQljLTkuNDgtNC4yODgtMTguNDkxLDEuNzE4LTE4LjQ5MSwxMi4xNjJjMCwxMC45MDksOC4zOTMsMjcuNDgsMTkuNzQzLDIyLjQ3OGMxMS45NTQsNS4xNzMsMTkuNzQ5LTExLjU2OCwxOS43NDktMjIuNDc4DQoJCQlDNDQuNzQ3LDE2LjAyMiwzNi42NDcsOS44NDYsMjYuMTIsMTQuNDg4eiIvPg0KICAgIDxwYXRoIGZpbGw9IiM1M2NjYjIiIGQ9Ik0yMy45OTcsMTAuOTU1YzAuNTQ4LTAuMDQ2LDEuMDMyLTAuNTMxLDEuMDc2LTEuMDc4YzAsMCwwLjM1Mi00LjI2Ni0yLjYyMS03LjI0MmMtMi45ODItMi45NzctNy4yNC0yLjYyMi03LjI0LTIuNjIyDQoJCQljLTAuNTQ4LDAuMDQ2LTEuMDMyLDAuNTMxLTEuMDc3LDEuMDc4YzAsMC0wLjM1OCw0LjI2OCwyLjYxOSw3LjI0NUMxOS43MjksMTEuMzEsMjMuOTk3LDEwLjk1NSwyMy45OTcsMTAuOTU1eiIvPg0KPC9zdmc+DQo="},(e,t,n)=>{n.r(t),n.d(t,{LINK_STYLE_SHOW_IRI:()=>a,OntologyLinkTemplates:()=>h});var i=n(102),r=n(74),o=n(101),s=n(132);const a={...s.DefaultLinkTemplate,renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,prependLabels:(0,i.jsx)(o.LinkLabel,{link:e.link,position:e.getPathPosition(.5),line:1,textStyle:{fill:"gray",fontSize:12,fontWeight:"lighter"},content:e.link.typeId}),propertyLabelStartLine:2})},l={...s.DefaultLinkTemplate,markerTarget:{fill:"#f8a485",stroke:"#cf8e76"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#f8a485"}})},c={...s.DefaultLinkTemplate,markerTarget:{fill:"#34c7f3",stroke:"#38b5db"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#34c7f3"}})},d={...s.DefaultLinkTemplate,markerTarget:{fill:"#34c7f3",stroke:"#38b5db"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#34c7f3"}})},u={...s.DefaultLinkTemplate,markerTarget:{fill:"#8cd965",stroke:"#5b9a3b"},renderLink:e=>(0,i.jsx)(s.DefaultLinkPathTemplate,{...e,pathProps:{stroke:"#8cd965"}})},h=e=>"http://www.w3.org/2000/01/rdf-schema#subClassOf"===e?l:"http://www.w3.org/2000/01/rdf-schema#domain"===e?c:"http://www.w3.org/2000/01/rdf-schema#range"===e?d:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?u:e===r.PLACEHOLDER_LINK_TYPE?{...s.DefaultLinkTemplate,markerTarget:{fill:"none"}}:void 0},(e,t,n)=>{n.r(t),n.d(t,{Dropdown:()=>l,DropdownMenu:()=>d,DropdownMenuItem:()=>f,useDropdownMenu:()=>h,useInsideDropdown:()=>m});var i=n(102),r=n(61),o=n(106),s=n.n(o);const a="reactodia-dropdown";function l(e){const{className:t,expanded:n,toggle:o,onClickOutside:l,children:c}=e,d=r.useRef(null);return r.useLayoutEffect((()=>{if(l&&n){const e=e=>{e.target instanceof Node&&!d.current?.contains(e.target)&&l()};return document.body.addEventListener("pointerdown",e),()=>document.body.removeEventListener("pointerdown",e)}}),[l,n]),(0,i.jsxs)("nav",{ref:d,className:s()(t,a,n?`${a}--expanded`:`${a}--collapsed`),children:[o,(0,i.jsx)("div",{className:`${a}__content`,children:c})]})}const c="reactodia-dropdown-menu";function d(e){const{className:t,title:n,children:o}=e,[a,d]=r.useState(!1),h=r.useMemo((()=>({expanded:a,setExpanded:d})),[a,d]),g=r.useCallback((()=>d(!1)),[d]);return(0,i.jsx)(u.Provider,{value:h,children:(0,i.jsx)(l,{className:s()(t,c),expanded:a,toggle:(0,i.jsx)(p,{title:n}),onClickOutside:g,children:(0,i.jsx)("ul",{role:"menu",className:`${c}__items`,children:o})})})}const u=r.createContext(null);function h(){const e=r.useContext(u);if(!e)throw new Error("Missing Reactodia dropdown menu context");return e}function p(e){const{title:t}=e,{setExpanded:n}=h();return(0,i.jsx)("button",{type:"button",className:`${c}__toggle reactodia-btn reactodia-btn-default`,title:t,onClick:()=>n((e=>!e))})}const g="reactodia-dropdown-menu-item";function f(e){const{className:t,title:n,disabled:o,onSelect:a,children:l}=e,c=h(),d=r.useCallback((()=>{c?.setExpanded((()=>!1)),a?.()}),[a,c]);return(0,i.jsx)("li",{role:"menuitem",className:s()(t,g,o?`${g}--disabled`:void 0,"reactodia-btn reactodia-btn-default"),title:n,onClick:o?void 0:d,children:l})}function m(){const e=r.useContext(u);return Boolean(e)}},(e,t,n)=>{n.r(t),n.d(t,{ListElementView:()=>c,formatEntityTitle:()=>p,highlightSubstring:()=>h,startDragElements:()=>d});var i=n(102),r=n(106),o=n.n(r),s=n(149),a=n(130);const l="reactodia-list-element-view";function c(e){const{model:t,getElementTypeStyle:n}=(0,a.useWorkspace)(),{element:r,className:c,highlightText:d,disabled:u,selected:g,onClick:f,onDragStart:m}=e,{h:y,c:b,l:x}=(0,s.hcl)(n(r.types).color),w=g&&!u?(0,s.hcl)(y,b,1.2*x):(0,s.hcl)("white"),v=o()(l,u?`${l}--disabled`:void 0,c),k=t.locale.formatLabel(r.label,r.id);return(0,i.jsx)("li",{className:v,role:"option",draggable:!u&&Boolean(m),title:p(r,t),style:{background:(0,s.hcl)(y,b,x).toString()},onClick:e=>{!u&&f&&(e.persist(),f(e,r))},onDragStart:m,children:(0,i.jsx)("div",{className:`${l}__label`,style:{background:w.toString()},children:h(k,d)})})}function d(e,t){try{e.dataTransfer.setData("application/x-reactodia-elements",JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}return!1}const u={className:"reactodia-text-highlight"};function h(e,t,n=u){if(!t)return(0,i.jsx)("span",{children:e});const r=e.toLowerCase().indexOf(t.toLowerCase());if(r<0)return(0,i.jsx)("span",{children:e});const o=r+t.length,s=e.substring(0,r),a=e.substring(r,o),l=e.substring(o);return(0,i.jsxs)("span",{children:[s,(0,i.jsx)("span",{...n,children:a}),l]})}function p(e,t){const n=t.locale.formatLabel(e.label,e.id),i=t.locale.formatIri(e.id);let r="";return e.types.length>0&&(r=`\nClasses: ${t.locale.formatElementTypes(e.types).join(", ")}`),`${n} ${i}${r}`}},e=>{e.exports=i},(e,t,n)=>{n.r(t),n.d(t,{ProgressBar:()=>o});var i=n(102);const r="reactodia-progress-bar";function o(e){const{state:t,title:n,percent:o=100,height:s=20}=e,a=`${r} ${r}--${t}`,l="loading"===t||"error"===t;return(0,i.jsx)("div",{className:a,style:{height:l?s:0},children:(0,i.jsx)("div",{className:`${r}__bar`,style:{width:`${o}%`},title:n,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o})})}},(e,t,n)=>{n.r(t),n.d(t,{SearchInput:()=>u,useSearchInputStore:()=>h});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(60),c=n(67);const d="reactodia-search-input";function u(e){const{className:t,inputProps:n={},store:r,children:o}=e,a=(0,l.useObservedProperty)(r.events,"changeValue",(()=>r.value)),c=(0,l.useObservedProperty)(r.events,"changeMode",(()=>r.mode));return(0,i.jsxs)("div",{className:s()(d,t),children:[(0,i.jsx)("input",{...n,type:n.type??"text",className:s()(`${d}__input`,"reactodia-form-control",n.className),placeholder:n.placeholder??"Search for...",value:a,onChange:e=>r.change({value:e.currentTarget.value,action:"input"}),onKeyUp:e=>{"Enter"===e.key&&r.change({value:r.value,action:"submit"})}}),r.value?(0,i.jsx)("div",{className:`${d}__clear-container`,children:(0,i.jsx)("button",{type:"button",className:`${d}__clear`,onClick:()=>r.change({value:"",action:"clear"}),children:(0,i.jsx)("span",{"aria-hidden":"true"})})}):null,"explicit"===c?(0,i.jsx)("button",{type:"button",title:"Search",className:s()(`${d}__submit`,"reactodia-btn","reactodia-btn-default"),onClick:()=>r.change({value:r.value,action:"submit"})}):null,o]})}function h(e){const{initialValue:t,submitTimeout:n="immediate",allowSubmit:i}=e,[o]=r.useState((()=>new p(t)));return r.useEffect((()=>{o.setDebounceTimeout(n),o.setAllowSubmit(i)})),o}class p{events=new a.EventSource;_value;_mode="debounce";debouncer=new c.Debouncer(0);allowSubmit;constructor(e){this._value=e}get mode(){return this._mode}get value(){return this._value}setDebounceTimeout(e){switch(e){case"immediate":case"explicit":this.debouncer.setTimeout(0),this._mode=e;break;default:this.debouncer.setTimeout(e),this._mode="debounce"}}setAllowSubmit(e){this.allowSubmit=e}change(e){const{value:t,action:n}=e;if(this.debouncer.dispose(),t!==this._value||"input"!==n){const e=this._value;this._value=t,this.events.trigger("changeValue",{source:this,previous:e,action:n})}switch(n){case"input":"explicit"!==this._mode&&this.trySubmit(t,{debounce:"debounce"===this._mode});break;case"submit":this.trySubmit(t,{debounce:!1});break;case"clear":this.events.trigger("clearSearch",{source:this,value:t})}}trySubmit(e,t){!this.allowSubmit||this.allowSubmit(e)?t.debounce?this.debouncer.call((()=>this.events.trigger("executeSearch",{source:this,value:e}))):this.events.trigger("executeSearch",{source:this,value:e}):this.events.trigger("clearSearch",{source:this,value:e})}}},(e,t,n)=>{n.r(t),n.d(t,{SearchResults:()=>d});var i=n(102),r=n(61),o=n(58),s=n(67),a=n(119),l=n(130),c=n(148);function d(e){const t=(0,l.useWorkspace)();return(0,i.jsx)(h,{...e,workspace:t})}const u=!0;class h extends r.Component{listener=new o.EventObserver;delayedChangeCells=new s.Debouncer;root;startSelection=0;endSelection=0;render(){const{items:e,footer:t,workspace:{model:n}}=this.props,r=p(n);return(0,i.jsxs)("ul",{ref:this.onRootMount,className:"reactodia-search-results",role:"listbox","aria-multiselectable":!0,"aria-label":"Select one or many elements",tabIndex:-1,onFocus:this.addKeyListener,onBlur:this.removeKeyListener,children:[e.map((e=>this.renderResultItem(e,r))),t]})}onRootMount=e=>{this.root=e};renderResultItem(e,t){const{useDragAndDrop:n=u}=this.props,r=this.canBeSelected(e,t);return(0,i.jsx)(c.ListElementView,{element:e,highlightText:this.props.highlightText,disabled:!r,selected:this.props.selection.has(e.id),onClick:r?this.onItemClick:void 0,onDragStart:n?t=>{const{selection:n}=this.props,i=[];return n.forEach((e=>i.push(e))),n.has(e.id)||i.push(e.id),(0,c.startDragElements)(t,i)}:void 0},e.id)}componentDidMount(){const{workspace:{model:e}}=this.props;this.listener.listen(e.events,"changeCells",(()=>{this.delayedChangeCells.call(this.onChangeCells)}))}onChangeCells=()=>{const{items:e,selection:t,workspace:{model:n}}=this.props;if(0===t.size)e.length>0&&this.forceUpdate();else{const e=new Set(t);for(const i of n.elements)i instanceof a.EntityElement&&t.has(i.iri)&&e.delete(i.iri);this.updateSelection(e)}};componentWillUnmount(){this.removeKeyListener(),this.listener.stopListening(),this.delayedChangeCells.dispose()}updateSelection(e){const{onSelectionChanged:t}=this.props;t(e)}addKeyListener=()=>{document.addEventListener("keydown",this.onKeyDown)};removeKeyListener=()=>{document.removeEventListener("keydown",this.onKeyDown)};onKeyDown=e=>{const{items:t}=this.props,n=38===e.keyCode||38===e.which,i=40===e.keyCode||40===e.which;if(n||i)if(e.shiftKey){n?this.endSelection=this.getNextIndex(this.endSelection,0):i&&(this.endSelection=this.getNextIndex(this.endSelection,1));const e=Math.min(this.startSelection,this.endSelection),t=Math.max(this.startSelection,this.endSelection),r=this.selectRange(e,t);this.updateSelection(r),this.focusOn(this.endSelection)}else{const e=Math.min(this.startSelection,this.endSelection),r=Math.max(this.startSelection,this.endSelection);n?this.startSelection=this.getNextIndex(e,0):i&&(this.startSelection=this.getNextIndex(r,1)),this.endSelection=this.startSelection;const o=t[this.startSelection],s=new Set;s.add(o.id),this.updateSelection(s),this.focusOn(this.startSelection)}e.preventDefault()};onItemClick=(e,t)=>{e.preventDefault();const{items:n,selection:i,onSelectionChanged:r,singleSelectOnClick:o}=this.props,s=n.indexOf(t);let a;if(e.shiftKey&&-1!==this.startSelection){const e=Math.min(this.startSelection,s),t=Math.max(this.startSelection,s);a=this.selectRange(e,t)}else{this.endSelection=this.startSelection=s;const n=e.ctrlKey||e.metaKey;!o||n?(a=new Set(i),i.has(t.id)?a.delete(t.id):a.add(t.id)):(a=new Set,a.add(t.id))}r(a)};selectRange(e,t){const{items:n,workspace:{model:i}}=this.props,r=p(i),o=new Set;for(let s=e;s<=t;s++){const e=n[s];this.canBeSelected(e,r)&&o.add(e.id)}return o}getNextIndex(e,t){const{items:n,workspace:{model:i}}=this.props;if(0===n.length)return e;const r=p(i),o=0===t?-1:1;for(let s=1;s<n.length;s++){let t=e+s*o;if(t<0&&(t+=n.length),t>=n.length&&(t-=n.length),this.canBeSelected(n[t],r))return t}return e}canBeSelected(e,t){const{useDragAndDrop:n=u}=this.props;return!n||!t.has(e.id)}focusOn(e){const t=this.root.parentElement,n=t.getBoundingClientRect(),i=this.root.children.item(e),r=i.getBoundingClientRect(),o=r.top-n.top,s=r.bottom-n.top;o<0?t.scrollTop+=o:s>n.height&&(t.scrollTop+=s-n.height),i.focus()}}function p(e){const t=new Set;for(const n of e.elements)for(const e of(0,a.iterateEntitiesOf)(n))t.add(e.id);return t}},(e,t,n)=>{n.r(t),n.d(t,{ViewportDock:()=>h,getParentDockAlignment:()=>p});var i=n(102),r=n(61),o=n(106),s=n.n(o);const a="reactodia-viewport-dock",l={n:`${a}--row-n`,s:`${a}--row-s`,w:`${a}--column-w`,e:`${a}--column-e`},c={nw:`${a}--dock-nw`,n:`${a}--dock-n`,ne:`${a}--dock-ne`,e:`${a}--dock-e`,se:`${a}--dock-se`,s:`${a}--dock-s`,sw:`${a}--dock-sw`,w:`${a}--dock-w`},d={nw:"start",n:"center",ne:"end",e:"end",se:"end",s:"center",sw:"start",w:"start"},u={nw:"start",n:"start",ne:"start",e:"center",se:"end",s:"end",sw:"end",w:"center"};function h(e){const{dock:t,dockOffsetX:n=0,dockOffsetY:o=0,children:h}=e,p={"--reactodia-viewport-dock-offset-x":`${n}px`,"--reactodia-viewport-dock-offset-y":`${o}px`,"--reactodia-viewport-dock-align-x":d[t],"--reactodia-viewport-dock-align-y":u[t]};return(0,i.jsx)("div",{className:s()(a,l[t]??`${a}--corner`),style:p,children:r.cloneElement(h,{className:s()(h.props.className,c[t])})})}function p(e){const t=getComputedStyle(e);return[t.getPropertyValue("--reactodia-viewport-dock-align-x"),t.getPropertyValue("--reactodia-viewport-dock-align-y")]}},(e,t,n)=>{n.r(t),n.d(t,{ClassTree:()=>i.ClassTree});var i=n(155)},(e,t,n)=>{n.r(t),n.d(t,{ClassTree:()=>x});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(56),l=n(57),c=n(58),d=n(60),u=n(67),h=n(113),p=n(156),g=n(150),f=n(151),m=n(130),y=n(157),b=n(158);function x(e){const{searchStore:t,searchTimeout:n=200,minSearchTermLength:r=2}=e,o=(0,f.useSearchInputStore)({initialValue:"",submitTimeout:n,allowSubmit:e=>S(e).length>=r}),s=t??o,a=(0,d.useObservedProperty)(s.events,"changeValue",(()=>S(s.value))),l=(0,d.useObservedProperty)(s.events,"changeMode",(()=>"explicit"===s.mode)),c=(0,m.useWorkspace)();return(0,i.jsx)(k,{...e,isControlled:Boolean(t),searchStore:s,normalizedTerm:a,minSearchTermLength:r,requireSubmit:l,workspace:c})}const w="reactodia-class-tree",v=new Map;class k extends r.Component{listener=new c.EventObserver;searchListener=new c.EventObserver;delayedClassUpdate=new u.Debouncer;loadClassesOperation=new AbortController;refreshOperation=new AbortController;createElementCancellation=new AbortController;constructor(e){super(e),this.state={fetchedGraph:void 0,refreshingState:"none",roots:[],filteredRoots:[],appliedSearchText:"",constructibleClasses:new Map,showOnlyConstructible:!1}}render(){const{className:e,isControlled:t,searchStore:n,normalizedTerm:r,minSearchTermLength:o,requireSubmit:a,workspace:{editor:l}}=this.props,{fetchedGraph:c,refreshingState:d,appliedSearchText:u,roots:m,filteredRoots:y,selectedNode:x,constructibleClasses:k,showOnlyConstructible:S}=this.state,L=u?r:void 0;return(0,i.jsxs)("div",{className:s()(w,t?`${w}--controlled`:void 0,e),children:[(0,i.jsx)("div",{className:`${w}__filter`,children:(0,i.jsxs)("div",{className:`${w}__filter-group`,children:[t?null:(0,i.jsx)(f.SearchInput,{store:n,inputProps:{name:"reactodia-class-tree-filter"}}),l.inAuthoringMode?(0,i.jsxs)("label",{className:`${w}__only-creatable`,children:[(0,i.jsx)("input",{type:"checkbox",name:"reactodia-class-tree-only-constructible",checked:S,onChange:this.onShowOnlyCreatableChange})," Show only constructible"]}):null]})}),(0,i.jsx)(g.ProgressBar,{state:d,title:"Loading element type tree"}),c?.classTree?(0,i.jsx)(b.Forest,{className:`${w}__tree reactodia-scrollable`,nodes:y,searchText:L,selectedNode:x,onSelect:this.onSelectNode,creatableClasses:l.inAuthoringMode?k:v,onClickCreate:this.onCreateInstance,onDragCreate:this.onDragCreate,footer:0===y.length?(0,i.jsx)(p.NoSearchResults,{className:`${w}__no-results`,hasQuery:y!==m,minSearchTermLength:o,requireSubmit:a,message:0===m.length?"No classes found.":void 0}):null}):(0,i.jsx)("div",{className:`${w}__spinner`,children:(0,i.jsx)(h.HtmlSpinner,{width:30,height:30,errorOccurred:Boolean(c?.fetchError)})})]})}componentDidMount(){const{workspace:{model:e,editor:t}}=this.props;this.listener.listen(e.events,"changeLanguage",(()=>this.refreshClassTree())),this.listener.listen(e.events,"loadingStart",(()=>{this.initClassTree()})),this.listener.listen(t.events,"changeMode",(()=>this.refreshClassTree())),this.listenSearch(),this.initClassTree()}componentDidUpdate(e){this.props.searchStore.events!==e.searchStore.events&&this.listenSearch()}listenSearch(){const{searchStore:e}=this.props;this.searchListener.stopListening(),this.searchListener.listen(e.events,"executeSearch",(({value:e})=>{this.performSearch(e)})),this.searchListener.listen(e.events,"clearSearch",(()=>{this.performSearch("")}))}componentWillUnmount(){this.listener.stopListening(),this.searchListener.stopListening(),this.delayedClassUpdate.dispose(),this.loadClassesOperation.abort(),this.refreshOperation.abort(),this.createElementCancellation.abort()}async initClassTree(){const{workspace:{model:e}}=this.props,{fetchedGraph:t}=this.state,{dataProvider:n}=e;t&&t.dataProvider===n?this.refreshClassTree():n?this.setState({fetchedGraph:void 0},(()=>{this.fetchTypeGraph(n)})):this.refreshClassTree()}async fetchTypeGraph(e){const t=new AbortController;this.loadClassesOperation.abort(),this.loadClassesOperation=t;let n=null;try{n=await(0,a.mapAbortedToNull)(e.knownElementTypes({signal:t.signal}),t.signal)}catch(r){return console.error(r),void this.setState({fetchedGraph:{dataProvider:e,fetchError:r}})}if(null===n)return;const i=function(e){const t=new Map;for(const l of e.elementTypes){const e={id:l.id,label:l.label,count:l.count,children:[]};t.set(e.id,e)}const n=new Map;for(const[c,d]of e.subtypeOf)(0,l.multimapAdd)(n,c,d);const i=[],r=new Set,o=new Set,s=e=>{if(o.has(e))return;r.add(e);const t=n.get(e);if(t)for(const n of t)r.has(n)?i.push([e,n]):s(n);r.delete(e)};for(const l of t.keys())s(l);for(const[l,c]of i){const e=n.get(l);e&&e.delete(c)}const a=[];for(const l of t.values()){const e=n.get(l.id);if(e&&0!==e.size)for(const n of e){const e=t.get(n);e&&e.children.push(l)}else a.push(l)}return a}(n);this.setState({fetchedGraph:{dataProvider:e,classTree:i}},(()=>{this.refreshClassTree()}))}performSearch=e=>{const t=S(e);this.setState((e=>_({...e,appliedSearchText:t})))};onShowOnlyCreatableChange=e=>{this.setState((e=>_({...e,showOnlyConstructible:!e.showOnlyConstructible})))};onSelectNode=e=>{const{instancesSearchCommands:t}=this.props;this.setState({selectedNode:e},(()=>{t?.trigger("setCriteria",{criteria:{elementType:e.iri}})}))};onCreateInstance=e=>{this.createInstanceAt(e.iri)};onDragCreate=e=>{const{workspace:{view:t}}=this.props;t.setHandlerForNextDropOnPaper((t=>{this.createInstanceAt(e.iri,t)}))};refreshClassTree=()=>{const e=new AbortController;this.refreshOperation.abort(),this.refreshOperation=e,this.setState(((t,n)=>{const{workspace:{model:i,editor:r}}=n,o=t.fetchedGraph?.classTree;if(!o)return{refreshingState:"none"};let s="none";if(r.inAuthoringMode){const n=function(e,t){const n=new Set,i=t=>{e.has(t.id)||n.add(t.id),t.children.forEach(i)};return t.forEach(i),n}(t.constructibleClasses,o);n.size>0&&(s="loading",this.queryCreatableTypes(n,e.signal))}const a=function(e,t){const n=e=>{const i=[];for(const r of e)i.push({iri:r.id,data:r,label:t.locale.formatLabel(r.label,r.id),derived:n(r.children)});return i};return n(e)}(o,i);return _({...t,roots:L(a),refreshingState:s})}))};async queryCreatableTypes(e,t){const{workspace:{editor:n}}=this.props,{metadataProvider:i}=n;if(i)try{const n=await(0,a.mapAbortedToNull)(i.filterConstructibleTypes(e,{signal:t}),t);if(null===n)return;this.setState((t=>{const i=new Map(t.constructibleClasses);return e.forEach((e=>{i.set(e,n.has(e))})),_({...t,constructibleClasses:i,refreshingState:"completed"})}))}catch(r){console.error(r),this.setState((e=>_({...e,refreshingState:"error"})))}}async createInstanceAt(e,t){const{workspace:{model:n,view:i,editor:r}}=this.props,o=n.history.startBatch(),s=this.createElementCancellation.signal,l=await(0,a.mapAbortedToNull)(r.metadataProvider.createEntity(e,{signal:s}),s);if(null===l)return;const c=r.createEntity(l);let d;if(t)d=[t.source,t.position];else{const e=i.findAnyCanvas();e&&(d=[e,M(e)])}if(d){const[e,t]=d;c.setPosition(t),e.renderingState.syncUpdate(),function(e,t,n){const i=n.getElementSize(e)??{width:0,height:0};e.setPosition({x:t.x-i.width/2,y:t.y-i.height/2})}(c,t,e.renderingState)}o.store(),n.setSelection([c]),r.authoringCommands.trigger("editEntity",{target:c})}}function S(e){return e.trim().toLowerCase()}function L(e){function t(e){if(0===e.length)return e;const t=e.map(n);return t.sort(i),t}function n(e){return y.TreeNode.setDerived(e,t(e.derived))}function i(e,t){return e.label.localeCompare(t.label)}return t(e)}function _(e){let t=e.roots;return e.appliedSearchText&&(t=function(e,t){if(0===e.length)return e;function n(e,i){const r=i.derived.reduce(n,[]);return(r.length>0||i.label.toLowerCase().indexOf(t)>=0)&&e.push(y.TreeNode.setDerived(i,r)),e}return e.reduce(n,[])}(t,e.appliedSearchText)),e.showOnlyConstructible&&(t=function(e,t){function n(e,i){const r=i.derived.reduce(n,[]);return(r.length>0||t.get(i.iri))&&e.push(y.TreeNode.setDerived(i,r)),e}return e.reduce(n,[])}(t,e.constructibleClasses)),{...e,filteredRoots:t}}function M(e){const t=e.metrics.area;return e.metrics.clientToPaperCoords(t.clientWidth/2,t.clientHeight/2)}},(e,t,n)=>{n.r(t),n.d(t,{NoSearchResults:()=>a});var i=n(102),r=n(106),o=n.n(r);const s="reactodia-no-search-results";function a(e){const{className:t,hasQuery:n,minSearchTermLength:r=1,requireSubmit:a,message:l}=e,c=l??(n?"No results found.":r<=1?a?"Submit a term to search.":"Type a term to search.":a?`Submit at least ${r} characters to\xa0search.`:`Type at least ${r} characters to\xa0search`);return(0,i.jsx)("div",{className:o()(s,t),children:c})}},(e,t,n)=>{n.r(t),n.d(t,{TreeNode:()=>i});const i={setDerived:(e,t)=>({...e,derived:t})}},(e,t,n)=>{n.r(t),n.d(t,{Forest:()=>u,Leaf:()=>d});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(130),l=n(148);const c="reactodia-class-tree-item";class d extends r.Component{static contextType=a.WorkspaceContext;constructor(e,t){super(e,t),this.state={expanded:Boolean(this.props.searchText)}}componentDidUpdate(e){this.props.searchText!==e.searchText&&this.setState({expanded:Boolean(this.props.searchText)})}render(){const{getElementTypeStyle:e}=this.context,{node:t,...n}=this.props,{selectedNode:r,searchText:o,creatableClasses:a}=n,{expanded:d}=this.state,h=0===t.derived.length?`${c}__toggle`:d?`${c}__toggle-expanded`:`${c}__toggle-collapsed`,{icon:p}=e([t.iri]),g=Boolean(r&&r.iri===t.iri),f=s()(`${c}__body`,g?`${c}__body--selected`:void 0),m=(0,l.highlightSubstring)(t.label,o,{className:`${c}__highlighted-term`});return(0,i.jsxs)("div",{className:c,role:"treeitem","aria-expanded":d,"aria-selected":g,children:[(0,i.jsxs)("div",{className:`${c}__row`,children:[(0,i.jsx)("div",{className:h,onClick:this.toggle,role:"button"}),(0,i.jsxs)("a",{className:f,href:t.iri,onClick:this.onClick,children:[(0,i.jsx)("div",{className:`${c}__icon-container`,children:p?(0,i.jsx)("img",{role:"presentation",className:`${c}__icon`,src:p}):(0,i.jsx)("div",{className:0===t.derived.length?`${c}__default-icon-leaf`:`${c}__default-icon-parent`})}),(0,i.jsx)("span",{className:`${c}__label`,children:m}),t.data?.count?(0,i.jsx)("span",{className:`${c}__count reactodia-badge`,children:t.data.count}):null]}),a.get(t.iri)?(0,i.jsx)("div",{role:"button",title:"Click or drag to create new entity of this type",className:s()(`${c}__create-button`,"reactodia-btn reactodia-btn-default"),draggable:!0,onClick:this.onClickCreate,onDragStart:this.onDragCreate}):null]}),d&&t.derived.length>0?(0,i.jsx)(u,{className:`${c}__children`,nodes:t.derived,...n}):null]})}onClick=e=>{e.preventDefault();const{node:t,onSelect:n}=this.props;n(t)};toggle=()=>{this.setState((e=>({expanded:!e.expanded})))};onClickCreate=()=>{this.props.onClickCreate(this.props.node)};onDragCreate=e=>{e.dataTransfer.setData("text",""),this.props.onDragCreate(this.props.node)}}class u extends r.Component{render(){const{className:e,nodes:t,root:n,footer:r,...o}=this.props;return(0,i.jsxs)("div",{className:e,role:n?"tree":void 0,children:[t.map((e=>(0,i.jsx)(d,{node:e,...o},`node-${e.iri}`))),r]})}}},(e,t,n)=>{n.r(t),n.d(t,{Canvas:()=>d});var i=n(102),r=n(61),o=n(160),s=n(107),a=n(119),l=n(130);const c="reactodia-canvas";function d(e){const{model:t,view:n}=(0,l.useWorkspace)(),{elementTemplateResolver:d,linkTemplateResolver:u,linkRouter:h,showScrollbars:p,zoomOptions:g,watermarkSvg:f,watermarkUrl:m,children:y}=e,[b]=r.useState((()=>new s.MutableRenderingState({model:t,shared:n,elementTemplateResolver:d?e=>{const t=e instanceof a.EntityElement?e.data:void 0;return d(t?.types??[],e)}:void 0,linkTemplateResolver:u,linkRouter:h})));return(0,i.jsx)("div",{className:c,children:(0,i.jsx)(o.PaperArea,{model:t,renderingState:b,zoomOptions:g,hideScrollBars:!p,watermarkSvg:f,watermarkUrl:m,children:y})})}},(e,t,n)=>{n.r(t),n.d(t,{PaperArea:()=>x});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(56),l=n(58),c=n(67),d=n(90),u=n(91),h=n(92),p=n(96),g=n(93),f=n(109),m=n(107),y=n(161);const b="reactodia-paper-area";class x extends r.Component{listener=new l.EventObserver;source=new l.EventSource;events=this.source;area;svgCanvasRef=r.createRef();pageSize={x:1500,y:800};canvasContext;viewportAnimation;cssAnimations=0;movingState;delayedPaperAdjust=new c.Debouncer;scrollBeforeUpdate;_pointerMode="panning";_zoomOptions;resizeObserver;metrics;constructor(e,t){super(e,t);const{zoomOptions:n={}}=this.props;this.state={width:this.pageSize.x,height:this.pageSize.y,originX:0,originY:0,scale:1,paddingX:0,paddingY:0},this.resizeObserver=new ResizeObserver(this.onResize),this.metrics=new class extends w{paperArea;constructor(e){super(),this.paperArea=e}get area(){return this.paperArea.area}get transform(){const{width:e,height:t,originX:n,originY:i,scale:r,paddingX:o,paddingY:s}=this.paperArea.state;return{width:e,height:t,originX:n,originY:i,scale:r,paddingX:o,paddingY:s}}getClientRect(){return this.paperArea.area.getBoundingClientRect()}}(this),this.canvasContext={canvas:this,model:e.model},this._zoomOptions={min:n.min??.2,max:n.max??2,maxFit:n.maxFit??1,step:n.step??.1,fitPadding:n.fitPadding??20,requireCtrl:n.requireCtrl??!0}}get renderingState(){return this.props.renderingState}get pointerMode(){return this._pointerMode}setPointerMode(e){const t=this._pointerMode;t!==e&&(this._pointerMode=e,this.source.trigger("changePointerMode",{source:this,previous:t}))}get zoomOptions(){return this._zoomOptions}render(){const{model:e,renderingState:t,hideScrollBars:n,watermarkSvg:r,watermarkUrl:o}=this.props,a=this.metrics.getTransform(),l=s()(b,n?`${b}--hide-scrollbars`:void 0,this.isAnimatingGraph()?`${b}--animated`:void 0),c=Array.from(this.getAllWidgets());return(0,i.jsx)(d.CanvasContext.Provider,{value:this.canvasContext,children:(0,i.jsxs)("div",{className:l,children:[(0,i.jsxs)("div",{className:`${b}__area`,ref:this.onAreaMount,onPointerDown:this.onAreaPointerDown,children:[(0,i.jsx)(f.Paper,{model:e,renderingState:t,paperTransform:a,svgCanvasRef:this.svgCanvasRef,onPointerDown:this.onPaperPointerDown,onContextMenu:this.onContextMenu,onScrollCapture:this.onPaperScrollCapture,linkLayerWidgets:(0,i.jsx)("div",{className:`${b}__widgets`,onPointerDown:this.onWidgetsPointerDown,children:c.filter((e=>"overLinks"===e.attachment)).map((e=>S(e.element)))}),elementLayerWidgets:(0,i.jsx)("div",{className:`${b}__widgets`,onPointerDown:this.onWidgetsPointerDown,children:c.filter((e=>"overElements"===e.attachment)).map((e=>S(e.element)))})}),r?(0,i.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",children:(0,i.jsx)("img",{className:`${b}__watermark`,src:r,draggable:!1})}):null]}),c.filter((e=>"viewport"===e.attachment)).map((e=>S(e.element)))]})})}onAreaMount=e=>{this.area=e};componentDidMount(){this.adjustPaper((()=>this.centerTo()));const{model:e,renderingState:t}=this.props,n=()=>this.delayedPaperAdjust.call(this.adjustPaper);this.listener.listen(e.events,"changeCells",n),this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&n()})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{e.changeVertices&&n()})),this.listener.listen(t.events,"changeElementSize",n),this.listener.listen(t.events,"syncUpdate",(({layer:e})=>{e===m.RenderingLayer.PaperArea&&this.delayedPaperAdjust.runSynchronously()})),this.listener.listen(t.shared.events,"changeWidgets",(()=>{this.forceUpdate()})),this.listener.listen(t.shared.events,"findCanvas",(e=>{e.canvases.push(this)})),this.area.addEventListener("dragover",this.onDragOver),this.area.addEventListener("drop",this.onDragDrop),this.area.addEventListener("scroll",this.onScroll,{passive:!0}),this.area.addEventListener("wheel",this.onWheel,{passive:!1}),this.resizeObserver.observe(this.area)}componentDidUpdate(e,t){if(this.scrollBeforeUpdate){const{scale:e,originX:n,originY:i,paddingX:r,paddingY:o}=this.state,s=(n-t.originX)*e+(r-t.paddingX),a=(i-t.originY)*e+(o-t.paddingY),l=this.scrollBeforeUpdate.left+s,c=this.scrollBeforeUpdate.top+a;this.area.scrollLeft=l,this.area.scrollTop=c,this.scrollBeforeUpdate=void 0}}componentWillUnmount(){this.stopListeningToPointerMove(),this.listener.stopListening(),this.delayedPaperAdjust.dispose(),this.area.removeEventListener("dragover",this.onDragOver),this.area.removeEventListener("drop",this.onDragDrop),this.area.removeEventListener("scroll",this.onScroll),this.area.removeEventListener("wheel",this.onWheel),this.resizeObserver.disconnect()}*getAllWidgets(){const{renderingState:e,children:t}=this.props;for(const n of r.Children.toArray(t))if(r.isValidElement(n)){const e=(0,u.extractCanvasWidget)(n);e?yield e:console.warn("Unexpected non-widget canvas child: ",n)}yield*e.shared.widgets.values()}onWidgetsPointerDown=e=>{e.stopPropagation()};getContentFittingBox(){const{model:e,renderingState:t}=this.props,{elements:n,links:i}=e;return(0,g.getContentFittingBox)(n,i,t)}computeAdjustedBox(){const e=this.getContentFittingBox(),t=e.x,n=e.y,i=e.x+e.width,r=e.y+e.height,{x:o,y:s}=this.pageSize,a=Math.floor(t/o),l=Math.floor(n/s),c=Math.ceil(i/o),d=Math.ceil(r/s),u=-a*o,h=-l*s;return{width:Math.max(c-a,1)*o,height:Math.max(d-l,1)*s,originX:u,originY:h}}adjustPaper=e=>{const{clientWidth:t,clientHeight:n}=this.area,i={...this.computeAdjustedBox(),paddingX:Math.ceil(t),paddingY:Math.ceil(n)},r=this.state;i.width===r.width&&i.height===r.height&&i.originX===r.originX&&i.originY===r.originY&&i.paddingX===r.paddingX&&i.paddingY===r.paddingY?e&&e():(this.scrollBeforeUpdate={left:this.area.scrollLeft,top:this.area.scrollTop},this.setState(i,e))};onAreaPointerDown=e=>{e.target===this.area&&this.onPaperPointerDown(e,void 0)};onPaperPointerDown=(e,t)=>{if(0!==e.button)return;if(this.movingState)return void this.handleMultiPointerDown(e);const{model:n}=this.props,i=h.RestoreGeometry.capture(n),r=n.history.startBatch(i.title);let o,s;if((t||"mouse"===e.pointerType)&&e.preventDefault(),void 0===t){if(this.shouldStartPanning(e)){const{scrollLeft:e,scrollTop:t}=this.area;o={scrollLeft:e,scrollTop:t},function(){if(document.getSelection){const e=document.getSelection();e?.removeAllRanges?.()}}()}}else if(t instanceof p.Element&&this.shouldStartElementMove(e)){const{x:n,y:i}=this.metrics.pageToPaperCoords(e.pageX,e.pageY),{x:r,y:o}=t.position;s={pointerX:n,pointerY:i,elementX:r,elementY:o}}const{pageX:a,pageY:l}=e;this.movingState={pointers:new Map,pointerMoved:!1,target:t,batch:r,restoreGeometry:i,originPointerId:e.pointerId,origin:{pageX:a,pageY:l},panningOrigin:o,movingElementOrigin:s,pinchOrigin:void 0},this.handleMultiPointerDown(e),document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp),"mouse"!==e.pointerType&&document.addEventListener("pointercancel",this.onPointerCancel),this.source.trigger("pointerDown",{source:this,sourceEvent:e,target:t,panning:Boolean(o)})};handleMultiPointerDown(e){if(!this.movingState)return;const{pointers:t}=this.movingState;t.set(e.pointerId,{x:e.pageX,y:e.pageY}),this.movingState.pinchOrigin||2!==t.size||(e.preventDefault(),this.movingState.pinchOrigin={pointers:new Map(t),metrics:this.metrics.snapshot()})}shouldStartPanning(e){const t="selection"===this._pointerMode;return"mouse"===e.pointerType&&e.shiftKey===t&&!(e.ctrlKey||e.altKey)}shouldStartElementMove(e){return"mouse"===e.pointerType}onPointerMove=e=>{if(!this.movingState||this.scrollBeforeUpdate)return;const{renderingState:t}=this.props,{origin:n,target:i,panningOrigin:r,movingElementOrigin:o}=this.movingState,s=e.pageX-n.pageX,a=e.pageY-n.pageY;e.isPrimary&&Math.abs(s)>=1&&Math.abs(a)>=1&&(this.movingState.pointerMoved=!0);const l=Boolean(r);if(this.handleMultiPointerMove(e));else if(void 0===i)e.preventDefault(),r&&(this.area.classList.add(`${b}--panning`),this.area.scrollLeft=r.scrollLeft-s,this.area.scrollTop=r.scrollTop-a),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l});else if(i instanceof p.Element){if(e.preventDefault(),o){const{x:n,y:r}=this.metrics.pageToPaperCoords(e.pageX,e.pageY),{pointerX:s,pointerY:a,elementX:c,elementY:d}=o;i.setPosition({x:c+n-s,y:d+r-a}),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l}),t.syncUpdate()}}else if(i instanceof p.Link){e.preventDefault();const t=this.metrics.pageToPaperCoords(e.pageX,e.pageY),n=this.generateLinkVertex(i,t);n.createAt(t),this.movingState.target=n}else if(i instanceof p.LinkVertex){e.preventDefault();const n=this.metrics.pageToPaperCoords(e.pageX,e.pageY);i.moveTo(n),this.source.trigger("pointerMove",{source:this,sourceEvent:e,target:i,panning:l}),t.syncUpdate()}};handleMultiPointerMove(e){if(!this.movingState)return!1;const{pointers:t,pinchOrigin:n}=this.movingState;if(t.set(e.pointerId,{x:e.pageX,y:e.pageY}),!n)return!1;const[[i,r],[o,s]]=n.pointers,a=t.get(i),l=t.get(o);if(!a||!l)return!1;const c=g.Vector.scale(g.Vector.add(a,l),.5),d=g.Vector.scale(g.Vector.add(r,s),.5),u=g.Vector.length(g.Vector.subtract(l,a))/Math.max(g.Vector.length(g.Vector.subtract(s,r)),1),h=n.metrics,p=h.clientToPaperCoords(h.area.clientWidth/2,h.area.clientHeight/2),f=h.pageToPaperCoords(c.x,c.y),m=h.pageToPaperCoords(d.x,d.y),y=g.Vector.add(m,g.Vector.scale(g.Vector.subtract(p,f),1/u)),b=h.getTransform().scale*u;return this.centerTo(y,{scale:b}),!0}generateLinkVertex(e,t){const{model:n,renderingState:i}=this.props,r=e.vertices,o=r?[...r]:[],s=n.getElement(e.sourceId),a=n.getElement(e.targetId),l=(0,g.computePolyline)((0,g.boundsOf)(s,i),(0,g.boundsOf)(a,i),o),c=(0,g.findNearestSegmentIndex)(l,t);return new p.LinkVertex(e,c)}onPointerUp=e=>{if(this.movingState){const{originPointerId:t,pointers:n,pinchOrigin:i}=this.movingState;n.delete(e.pointerId),(e.pointerId===t||i&&n.size<2)&&this.stopListeningToPointerMove(e)}};onPointerCancel=e=>{this.stopListeningToPointerMove()};onPaperScrollCapture=(e,t)=>{t instanceof p.Element&&this.movingState&&this.stopListeningToPointerMove()};stopListeningToPointerMove=e=>{const t=this.movingState;if(this.movingState=void 0,t&&(this.area.classList.remove(`${b}--panning`),document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp),document.removeEventListener("pointercancel",this.onPointerCancel)),e&&t&&!t.pinchOrigin){const{pointerMoved:n,target:i,batch:r,restoreGeometry:o}=t;this.source.trigger("pointerUp",{source:this,sourceEvent:e,target:i,panning:Boolean(t.panningOrigin),triggerAsClick:!n});const s=o.filterOutUnchanged();s.hasChanges()&&r.history.registerToUndo(s),r.store()}};onWheel=e=>{if(this.shouldStartZooming(e)){e.preventDefault();const t=Math.max(-1,Math.min(1,e.deltaY||e.deltaX)),n=this.metrics.pageToPaperCoords(e.pageX,e.pageY);this.zoomBy(.1*-t,{pivot:n})}};shouldStartZooming(e){return Boolean(e.ctrlKey)===this.zoomOptions.requireCtrl}onResize=()=>{this.source.trigger("resize",{source:this})};centerTo(e,t={}){const{width:n,height:i}=this.state,r=e||{x:n/2,y:i/2};if("number"==typeof t.scale){const{min:e,max:n}=this.zoomOptions;let i=t.scale;i=Math.max(i,e),i=Math.min(i,n);const o={center:r,scale:{x:i,y:i}};return this.setViewportState(o,t)}{const e={center:r};return this.setViewportState(e,t)}}centerContent(e={}){const t=this.getContentFittingBox();return this.centerTo({x:t.x+t.width/2,y:t.y+t.height/2},e)}getScale(){return this.state.scale}setScale(e,t){let n=e;const{min:i,max:r}=this.zoomOptions;let o;if(n=Math.max(n,i),n=Math.min(n,r),t&&t.pivot){const{x:e,y:i}=t.pivot,r=this.metrics.clientToPaperCoords(this.area.clientWidth/2,this.area.clientHeight/2),s=n/this.state.scale;o={center:{x:e-(e-r.x)/s,y:i-(i-r.y)/s},scale:{x:n,y:n}}}else o={scale:{x:n,y:n}};return this.setViewportState(o,t)}zoomBy(e,t){return this.setScale(this.getScale()+e,t)}zoomIn(e){return this.zoomBy(this.zoomOptions.step,e)}zoomOut(e){return this.zoomBy(-this.zoomOptions.step,e)}zoomToFit(e={}){const{model:t,renderingState:n}=this.props,{elements:i}=t;if(0===i.length)return this.centerTo();const r=(0,g.getContentFittingBox)(i,[],n);return this.zoomToFitRect(r,e)}zoomToFitRect(e,t={}){const{clientWidth:n,clientHeight:i}=this.area;if(0===e.width)return Promise.resolve();const{min:r,maxFit:o,fitPadding:s}=this.zoomOptions,a={x:e.x-s,y:e.y-s,width:e.width+s,height:e.height+s},{width:l}=(0,y.fitRectKeepingAspectRatio)(a.width,a.height,n,i);let c=l/a.width;c=Math.max(c,r),c=Math.min(c,o);const d={center:{x:a.x+a.width/2,y:a.y+a.height/2},scale:{x:c,y:c}};return this.setViewportState(d,t)}onDragOver=e=>{e.preventDefault&&e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const{x:t,y:n}=k(this.area,e);return!1};onDragDrop=e=>{const{renderingState:t}=this.props,{x:n,y:i}=k(this.area,e),r={source:this,sourceEvent:e,position:this.metrics.clientToPaperCoords(n,i)};t.shared.tryHandleDropOnPaper(r)||this.source.trigger("drop",r)};onScroll=e=>{this.source.trigger("scroll",{source:this,sourceEvent:e})};onContextMenu=(e,t)=>{this.source.trigger("contextMenu",{source:this,sourceEvent:e,target:t})};makeToSVGOptions(e){const{model:t,renderingState:n}=this.props,{removeByCssSelectors:i=[]}=e,r=this.svgCanvasRef.current;if(!r)throw new Error("Cannot find SVG canvas to export");return{model:t,sizeProvider:n,paper:r,contentBox:this.getContentFittingBox(),getOverlaidElement:e=>this.area.querySelector(`[data-element-id='${e}']`),preserveDimensions:!0,convertImagesToDataUris:!0,removeByCssSelectors:["[data-reactodia-no-export]",...i],watermarkSvg:this.props.watermarkSvg}}exportSvg(e={}){return(0,y.toSVG)(this.makeToSVGOptions(e))}exportRaster(e={}){return(0,y.toDataURL)({...e,...this.makeToSVGOptions(e)})}isAnimatingGraph(){return this.cssAnimations>0}animateGraph(e,t){this.changeGraphAnimationCount(1),e();const n="number"==typeof t?t:500;return(0,a.delay)(n).then((()=>this.onGraphAnimationEnd()))}onGraphAnimationEnd(){this.changeGraphAnimationCount(-1)}changeGraphAnimationCount(e){const t=this.cssAnimations+e;if(t<0)return;const n=this.isAnimatingGraph();this.cssAnimations=t;n!==this.isAnimatingGraph()&&(this.forceUpdate(),this.source.trigger("changeAnimatingGraph",{source:this,previous:n}))}get viewportState(){const{clientWidth:e,clientHeight:t}=this.area,{originX:n,originY:i,paddingX:r,paddingY:o,scale:s}=this.state;return{center:{x:(this.area.scrollLeft+e/2-r)/s-n,y:(this.area.scrollTop+t/2-o)/s-i},scale:{x:s,y:s}}}setViewportState(e,t){this.viewportAnimation&&this.viewportAnimation.cancellation.abort();const n=this.viewportState,i={...n,...e};if(t&&(t.animate||t.duration&&t.duration>0)){const e={from:n,to:i,cancellation:new AbortController},r="number"==typeof t.duration?t.duration:500,o=(0,c.animateInterval)(r,(e=>{const t=(0,c.easeInOutBezier)(e),r={center:{x:n.center.x+(i.center.x-n.center.x)*t,y:n.center.y+(i.center.y-n.center.y)*t},scale:{x:n.scale.x+(i.scale.x-n.scale.x)*t,y:n.scale.y+(i.scale.y-n.scale.y)*t}};this.applyViewportState(r)}),e.cancellation.signal);return this.viewportAnimation=e,o.then((()=>{this.viewportAnimation=void 0}))}return this.applyViewportState(i),Promise.resolve()}applyViewportState(e){const t=this.state.scale,n=e.scale.x,i=e.center;this.setState({scale:n},(()=>{const{originX:e,originY:r,paddingX:o,paddingY:s}=this.state,a=(i.x+e)*n,l=(i.y+r)*n,{clientWidth:c,clientHeight:d}=this.area;this.area.scrollLeft=a-c/2+o,this.area.scrollTop=l-d/2+s,n!==t&&this.source.trigger("changeScale",{source:this,previous:t})}))}}class w{snapshot(){const{clientWidth:e,clientHeight:t,offsetWidth:n,offsetHeight:i,scrollLeft:r,scrollTop:o}=this.area,{left:s,right:a,top:l,bottom:c}=this.getClientRect();return new v({clientWidth:e,clientHeight:t,offsetWidth:n,offsetHeight:i,scrollLeft:r,scrollTop:o},{left:s,right:a,top:l,bottom:c},this.transform)}getTransform(){return this.transform}getPaperSize(){const{width:e,height:t,scale:n}=this.transform;return{width:e/n,height:t/n}}getViewportPageRect(){const{left:e,right:t,top:n,bottom:i}=this.getClientRect();return{x:e+window.scrollX,y:n+window.scrollY,width:t-e,height:i-n}}pageToPaperCoords(e,t){const{left:n,top:i}=this.getClientRect();return this.clientToPaperCoords(e-(n+window.scrollX),t-(i+window.scrollY))}paperToPageCoords(e,t){const{x:n,y:i}=this.paperToScrollablePaneCoords(e,t),{x:r,y:o}=this.scrollablePaneToClientCoords(n,i),{left:s,top:a}=this.getClientRect();return{x:r+(s+window.scrollX),y:o+(a+window.scrollY)}}clientToPaperCoords(e,t){const{x:n,y:i}=this.clientToScrollablePaneCoords(e,t);return this.scrollablePaneToPaperCoords(n,i)}clientToScrollablePaneCoords(e,t){const{paddingX:n,paddingY:i}=this.transform,{scrollLeft:r,scrollTop:o}=this.area;return{x:e+r-n,y:t+o-i}}scrollablePaneToClientCoords(e,t){const{paddingX:n,paddingY:i}=this.transform,{scrollLeft:r,scrollTop:o}=this.area;return{x:e-r+n,y:t-o+i}}scrollablePaneToPaperCoords(e,t){const{scale:n,originX:i,originY:r}=this.transform;return{x:e/n-i,y:t/n-r}}paperToScrollablePaneCoords(e,t){const{scale:n,originX:i,originY:r}=this.transform;return{x:(e+i)*n,y:(t+r)*n}}}class v extends w{area;clientRect;transform;constructor(e,t,n){super(),this.area=e,this.clientRect=t,this.transform=n}getClientRect(){return this.clientRect}snapshot(){return this}}function k(e,t){const n=(t.target instanceof SVGElement&&null!==t.target.ownerSVGElement?t.target.ownerSVGElement:t.target).getBoundingClientRect(),i=e.getBoundingClientRect();return{x:t.offsetX+(n.left-i.left),y:t.offsetY+(n.top-i.top)}}function S(e){return r.cloneElement(e)}},(e,t,n)=>{n.r(t),n.d(t,{dataURLToBlob:()=>g,fitRectKeepingAspectRatio:()=>p,toDataURL:()=>h,toSVG:()=>l});var i=n(93);const r="http://www.w3.org/2000/svg",o=2,s={x:100,y:100},a='<?xml version="1.0" encoding="UTF-8"?>';function l(e){return c(e).then((t=>{const n=(new XMLSerializer).serializeToString(t);return e.addXmlHeader?a+n:n}))}function c(e){const{contentBox:t,watermarkSvg:n,removeByCssSelectors:a=[],borderPadding:l=s}=e,{svgClone:c,imageBounds:u}=function(e,t){const{model:n,sizeProvider:o,paper:s,getOverlaidElement:a}=e,l=s.cloneNode(!0);function c(){let e=l.firstChild;for(;e;){if(e instanceof SVGGElement)return e;e=e.nextSibling}}l.removeAttribute("class"),l.removeAttribute("style");const u=c();u.removeAttribute("transform"),u.setAttribute("class","reactodia-exported-canvas");const h={};for(const p of n.elements){const e=a(p.id);if(!e)continue;const n=document.createElementNS(r,"g"),s=e.firstChild.cloneNode(!0);n.setAttribute("class","reactodia-exported-element");const l=document.createElementNS(r,"foreignObject");l.appendChild(s);const{x:c,y:g,width:f,height:m}=(0,i.boundsOf)(p,o);l.setAttribute("transform",`translate(${c},${g})`),l.setAttribute("width",(f+t).toString()),l.setAttribute("height",(m+t).toString()),n.appendChild(l),u.appendChild(n);const y=s.querySelectorAll("img");d(e.querySelectorAll("img"),((e,t)=>{const n=`export-key-${t}`;y[t].setAttribute("export-key",n),h[n]={width:e.clientWidth,height:e.clientHeight}}))}return{svgClone:l,imageBounds:h}}(e,o),h=t.width+2*l.x,p=t.height+2*l.y;e.preserveDimensions?(c.setAttribute("width",h.toString()),c.setAttribute("height",p.toString())):(c.setAttribute("width","100%"),c.setAttribute("height","100%"));const g={x:t.x-l.x,y:t.y-l.y,width:h,height:p};c.setAttribute("viewBox",`${g.x} ${g.y} ${g.width} ${g.height}`),n&&function(e,t,n){const i="reactodia-exported-watermark",o=120,s=20,a=document.createElementNS(r,"image");a.setAttributeNS("http://www.w3.org/1999/xlink","href",n),a.setAttribute("class",i);const l=Math.min(.2*t.width,o),c=t.x+t.width-l-s,d=t.y+s;a.setAttribute("x",c.toString()),a.setAttribute("y",d.toString()),a.setAttribute("width",l.toString()),a.setAttribute("opacity","0.3"),e.insertBefore(a,e.firstChild)}(c,g,n);const f=[];d(c.querySelectorAll("img"),(e=>f.push(e)));const m=Promise.all(f.map((t=>{const n=t.getAttribute("export-key");if(t.removeAttribute("export-key"),n){const{width:i,height:r}=u[n];return t.setAttribute("width",i.toString()),t.setAttribute("height",r.toString()),e.convertImagesToDataUris?async function(e){const t=e.src;if(!t||t.startsWith("data:"))return t;const n=t.match(/\.([a-zA-Z0-9]+)[^.a-zA-Z0-9]?[^.]*$/),i=n?n[1].toLowerCase():void 0;if("svg"===i)try{const e=await fetch(t),n=await e.text();if(n.length>0)return"data:image/svg+xml,"+encodeURIComponent(n)}catch(s){}const r=await function(e){const t=new Image;t.crossOrigin="anonymous";const n=new Promise(((e,n)=>{t.onload=()=>e(t),t.onerror=e=>n(e)}));return t.src=e,n}(e.src),o=document.createElement("canvas");o.width=r.width,o.height=r.height;o.getContext("2d").drawImage(r,0,0);try{const e="image/"+("jpg"===i?"jpeg":"png");return o.toDataURL(e)}catch(a){throw new Error(`Failed to convert image to data URI: ${t}`,{cause:a})}}(t).then((e=>{e&&"data:image/svg+xml,"!==e&&(t.src=e)})).catch((e=>{console.warn("Failed to export image: "+t.src,e)})):Promise.resolve()}return Promise.resolve()})));return m.then((()=>{const e=function(e){const t=new Set;for(let r=0;r<document.styleSheets.length;r++){let n;try{const e=document.styleSheets[r];if(n=e.cssRules||e.rules,!n)continue}catch(i){continue}for(let i=0;i<n.length;i++){const r=n[i];if(r instanceof CSSStyleRule){const n=r.selectorText.replace(/::[a-zA-Z-]+$/,"");e.querySelector(n)&&t.add(r)}}}const n=[];return t.forEach((e=>n.push(e.cssText))),n.join("\n")}(c),t=document.createElementNS("http://www.w3.org/2000/svg","defs");t.innerHTML=`<style>${e}</style>`,c.insertBefore(t,c.firstChild);for(const n of a)for(const e of c.querySelectorAll(n))e.remove();return c}))}function d(e,t){for(let n=0;n<e.length;n++)t(e[n],n)}const u={width:4096,height:4096};async function h(e){const{mimeType:t="image/png",maxFallbackSize:n=u}=e,i={...e,convertImagesToDataUris:!0,mockImages:!1,preserveDimensions:!0},r=await c(i),o={width:Number(r.getAttribute("width")),height:Number(r.getAttribute("height"))},s="number"==typeof e.width||"number"==typeof e.height?{width:e.width,height:e.height}:function(e,t){const n=Math.min(t.width/e.width,t.height/e.height),i=Math.min(2,n),r=Math.floor(e.width*i),o=Math.floor(e.height*i);return{width:r,height:o}}(o,n),{innerSize:a,outerSize:l,offset:d}=function(e,t){const n=p(e.width,e.height,t.width,t.height),i={width:Math.floor(n.width),height:Math.floor(n.height)},r={width:"number"==typeof t.width?t.width:i.width,height:"number"==typeof t.height?t.height:i.height},o={x:Math.round((r.width-i.width)/2),y:Math.round((r.height-i.height)/2)};return{innerSize:i,outerSize:r,offset:o}}(o,s);r.setAttribute("width",a.width.toString()),r.setAttribute("height",a.height.toString());const h=(new XMLSerializer).serializeToString(r),{canvas:g,context:f}=function(e,t,n){const i=document.createElement("canvas");i.width=e,i.height=t;const r=i.getContext("2d");n&&(r.fillStyle=n,r.fillRect(0,0,e,t));return{canvas:i,context:r}}(l.width,l.height,e.backgroundColor),m=await(y="data:image/svg+xml,"+encodeURIComponent(h),new Promise(((e,t)=>{const n=new Image;n.onload=function(){e(n)},n.onerror=function(e){t(e)},n.src=y})));var y;return f.drawImage(m,d.x,d.y,a.width,a.height),g.toDataURL(t,e.quality)}function p(e,t,n,i){if("number"!=typeof n&&"number"!=typeof i)return{width:e,height:t};const r=e/t;return n="number"==typeof n?n:i*r,(i="number"==typeof i?i:n/r)*r<=n?{width:i*r,height:i}:{width:n,height:n/r}}function g(e){const t=";base64,";if(-1===e.indexOf(t)){const t=e.split(","),n=t[0].split(":")[1],i=decodeURIComponent(t[1]);return new Blob([i],{type:n})}{const n=e.split(t),i=n[0].split(":")[1],r=window.atob(n[1]),o=r.length,s=new Uint8Array(o);for(let e=0;e<o;++e)s[e]=r.charCodeAt(e);return new Blob([s],{type:i})}}},(e,t,n)=>{n.r(t),n.d(t,{ConnectionsMenu:()=>L});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(67),c=n(69),d=n(90),u=n(91),h=n(92),p=n(96),g=n(93),f=n(113),m=n(115),y=n(116),b=n(119),x=n(129),w=n(151),v=n(130),k=n(148),S=n(152);function L(e){const{commands:t}=e,n=(0,v.useWorkspace)(),{canvas:o}=(0,d.useCanvas)(),s=r.useRef("alphabet");return r.useEffect((()=>{const r=new a.EventObserver;return r.listen(t,"show",(({targets:t})=>{if(0===t.length)return;const{model:r,overlay:a}=n,l=t.length>1?new _(t,r,o):void 0,c=l??t[0],d=new Set;for(const e of t)for(const t of(0,b.iterateEntitiesOf)(e))d.add(t.id);a.showDialog({target:c,dialogType:m.BuiltinDialogType.connectionsMenu,style:{caption:"Connections",defaultSize:{width:310,height:340},minSize:{width:300,height:250}},content:(0,i.jsx)(M,{...e,placeTarget:c,targetIris:Array.from(d),initialMode:s.current,onChangeMode:e=>{s.current=e},onCancel:()=>a.hideDialog(),workspace:n,canvas:o}),onClose:()=>l?.removeFrom(r)})})),()=>r.stopListening()}),[t]),null}(0,u.defineCanvasWidget)(L,(e=>({element:e,attachment:"viewport"})));class _ extends p.VoidElement{listener=new a.EventObserver;constructor(e,t,n){super({});const i=new Set(e),r=()=>{const{x:t,y:i,width:r,height:o}=(0,g.getContentFittingBox)(e,[],n.renderingState);this.setPosition({x:t+r,y:i+o/2})};r();const o=t.history.startBatch();t.addElement(this),o.discard(),this.listener.listen(t.events,"changeCells",(e=>{(e.changedElement===this||e.updateAll)&&t.getElement(this.id)!==this&&this.listener.stopListening()})),this.listener.listen(t.events,"elementEvent",(({data:e})=>{e.changePosition&&i.has(e.changePosition.source)&&r()})),this.listener.listen(n.renderingState.events,"changeElementSize",(e=>{i.has(e.source)&&r()}))}removeFrom(e){if(this.listener.stopListening(),e.getElement(this.id)===this){const t=e.history.startBatch();e.removeElement(this.id),t.discard()}}}function M(e){const t=(0,w.useSearchInputStore)({initialValue:"",submitTimeout:200}),n=(0,w.useSearchInputStore)({initialValue:""});return(0,i.jsx)(E,{...e,connectionSearch:t,objectSearch:n})}const I="reactodia-connections-menu",T=100;class E extends r.Component{ALL_RELATED_ELEMENTS_LINK;handler=new a.EventObserver;linkTypesListener=new a.EventObserver;delayedUpdateAll=new l.Debouncer;suggestionCancellation=new AbortController;linksScrolledListRef=r.createRef();linksScrollPosition;constructor(e){super(e);const{targetIris:t,initialMode:n,suggestProperties:i,workspace:{model:r}}=this.props;this.ALL_RELATED_ELEMENTS_LINK={id:"urn:reactodia:allLinks",label:[r.factory.literal("All")]};const o=Boolean(i)&&1===t.length;this.state={loadingState:"none",panel:"connections",connectionSortMode:o?n:"alphabet",connectionSuggestions:{filterKey:null,scores:new Map}}}updateAll=()=>this.forceUpdate();scheduleUpdateAll=()=>{this.delayedUpdateAll.call(this.updateAll)};componentDidMount(){const{connectionSearch:e,objectSearch:t,workspace:{model:n}}=this.props;this.handler.listen(n.events,"changeLanguage",this.scheduleUpdateAll),this.handler.listen(e.events,"changeValue",this.updateAll),this.handler.listen(e.events,"executeSearch",(({value:e})=>{this.loadSuggestions(e)})),this.handler.listen(t.events,"changeValue",this.updateAll),this.loadLinks()}getSnapshotBeforeUpdate(e,t){return"objects"===this.state.panel&&"connections"===t.panel&&this.linksScrolledListRef.current&&(this.linksScrollPosition=this.linksScrolledListRef.current.scrollTop),0}componentDidUpdate(e,t){"connections"===this.state.panel&&"objects"===t.panel&&void 0!==this.linksScrollPosition&&this.linksScrolledListRef.current&&(this.linksScrolledListRef.current.scrollTop=this.linksScrollPosition)}componentWillUnmount(){this.handler.stopListening(),this.linkTypesListener.stopListening(),this.delayedUpdateAll.dispose(),this.suggestionCancellation.abort()}async loadLinks(){const{targetIris:e,workspace:{model:t,triggerWorkspaceEvent:n}}=this.props;this.setState({loadingState:"loading",connections:{links:[],counts:new Map}});const i=e.length>1,r=new Map;try{await Promise.all(e.map((e=>t.dataProvider.connectedLinkStats({elementId:e,inexactCount:i}).then((e=>{for(const{id:t,inCount:n,outCount:o,inexact:s}of e){const e=r.get(t)??{inCount:0,outCount:0,inexact:!1};r.set(t,{inexact:Boolean(i||e.inexact||s),inCount:e.inCount+n,outCount:e.outCount+o})}})))))}catch(s){return console.error(s),void this.setState({loadingState:"error"})}const o=Array.from(r.keys(),(e=>t.createLinkType(e)?.data??{id:e,label:[]}));r.set(this.ALL_RELATED_ELEMENTS_LINK.id,Array.from(r.values()).reduce(((e,t)=>({inexact:Boolean(e.inexact||t.inexact),inCount:e.inCount+t.inCount,outCount:e.outCount+t.outCount})),{inCount:0,outCount:0,inexact:!1})),this.setState({loadingState:"completed",connections:{links:o,counts:r}},(()=>{this.resubscribeOnLinkTypeEvents(),n(v.WorkspaceEventKey.connectionsLoadLinks),this.loadSuggestions("")}))}resubscribeOnLinkTypeEvents(){const{workspace:{model:e}}=this.props,{connections:t}=this.state;if(this.linkTypesListener.stopListening(),t){for(const{id:i}of t.links){const t=e.createLinkType(i);this.linkTypesListener.listen(t.events,"changeData",this.scheduleUpdateAll)}const n=new Set(t.links.map((e=>e.id)));this.linkTypesListener.listen(e.events,"changeLinkVisibility",(e=>{n.has(e.source)&&this.scheduleUpdateAll()}))}}async loadObjects(e){const{targetIris:t,workspace:{model:n,triggerWorkspaceEvent:i}}=this.props,{linkType:r,direction:o,pageCount:s}=e;this.setState({loadingState:"loading",objects:{chunk:e,elements:[]}});const a=new Map;try{await Promise.all(t.map((e=>n.dataProvider.lookup({refElementId:e,refElementLinkId:r.id===this.ALL_RELATED_ELEMENTS_LINK.id?void 0:r.id,linkDirection:o,limit:s*T}).then((e=>{for(const{element:t}of e)a.set(t.id,t)})))))}catch(d){return console.error(d),void this.setState({loadingState:"error"})}const l=new Set;for(const u of n.elements)u instanceof b.EntityElement&&l.add(u.iri);const c=Array.from(a.values(),(e=>({model:e,presentOnDiagram:l.has(e.id)})));this.setState({loadingState:"completed",objects:{chunk:e,elements:c}},(()=>{i(v.WorkspaceEventKey.connectionsLoadElements)}))}async loadSuggestions(e){const{targetIris:t,suggestProperties:n,workspace:{model:i}}=this.props,{loadingState:r,panel:o,connectionSortMode:s,connections:a,connectionSuggestions:l}=this.state;if(this.suggestionCancellation.abort(),n&&1===t.length&&"connections"===o&&"completed"===r&&a&&(e.length>0||"smart"===s)&&l.filterKey!==e){const r=t[0],o=i.language,s=e.trim(),l=a.links.map((e=>e.id));this.suggestionCancellation=new AbortController;const c=this.suggestionCancellation.signal,d=await n({elementId:r,token:s,properties:l,lang:o,signal:c}),u=new Map;for(const e of d)u.set(e.propertyIri,e);this.setState((t=>({connectionSuggestions:{...t.connectionSuggestions,filterKey:e,scores:u}})))}}render(){const{connectionSearch:e,objectSearch:t}=this.props,{panel:n}=this.state;return(0,i.jsxs)("div",{className:I,children:[this.getBreadCrumbs(),(0,i.jsx)(w.SearchInput,{className:`${I}__search`,store:"connections"===n?e:t,inputProps:{name:"reactodia-connection-menu-filter"},children:this.renderSortSwitches()}),this.getBody()]})}getBreadCrumbs(){const{workspace:{model:e}}=this.props,{objects:t,panel:n}=this.state;if(t&&"objects"===n){const{linkType:n,direction:r}=t.chunk,{label:o}=e.getLinkType(n.id)?.data??n,s=e.locale.formatLabel(o,n.id);return(0,i.jsxs)("span",{className:`${I}__breadcrumbs`,children:[(0,i.jsx)("a",{className:`${I}__breadcrumbs-link`,onClick:this.onCollapseLink,children:"Link types"}),"\xa0/\xa0",s," ",r?`(${r})`:null]})}return null}onExpandLink=e=>{const{objectSearch:t,workspace:{triggerWorkspaceEvent:n}}=this.props,{objects:i}=this.state;this.setState({panel:"objects"},(()=>t.change({value:"",action:"clear"})));i&&i.chunk.linkType.id===e.linkType.id&&i.chunk.direction===e.direction||this.loadObjects(e),n(v.WorkspaceEventKey.connectionsExpandLink)};onCollapseLink=()=>{this.setState({panel:"connections",loadingState:"completed"})};getBody(){const{targetIris:e,instancesSearchCommands:t,connectionSearch:n,objectSearch:r,workspace:{model:o}}=this.props,{panel:s,connectionSortMode:a,loadingState:l,objects:c,connections:d,connectionSuggestions:u}=this.state;return"error"===l?(0,i.jsx)(A,{error:!0}):c&&"objects"===s?(0,i.jsx)(C,{data:c,onMoveToFilter:this.onMoveToFilter,model:o,filterKey:r.value,loading:"loading"===l,onPressAddSelected:this.onAddSelectedElements}):d&&"connections"===s?"loading"===l||"smart"===a&&null===u.filterKey?(0,i.jsx)(A,{}):(0,i.jsx)(j,{targetIris:e,data:d,suggestions:u,model:o,filterKey:n.value,sortMode:a,allRelatedLink:this.ALL_RELATED_ELEMENTS_LINK,onExpandLink:this.onExpandLink,onMoveToFilter:t&&1===e.length?this.onMoveToFilter:void 0,scrolledListRef:this.linksScrolledListRef}):(0,i.jsx)("div",{})}onAddSelectedElements=(e,t)=>{const{onCancel:n}=this.props,{objects:i}=this.state,r=e.map((e=>e.model.id)),o=i?i.chunk.linkType.id:void 0,s=i&&o!==this.ALL_RELATED_ELEMENTS_LINK.id;this.placeElements(r,s?o:void 0,t),n()};placeElements(e,t,n){const{placeTarget:i,workspace:{model:r,triggerWorkspaceEvent:o},canvas:s}=this.props,a=r.history.startBatch("Add connected elements");let l=[];switch(n){case"separately":l=e.map((e=>r.createElement(e)));break;case"grouped":{const t=new b.EntityGroup({items:e.map((e=>({data:b.EntityElement.placeholderData(e)})))});r.addElement(t),l=[t];break}}s.renderingState.syncUpdate(),a.history.execute((0,h.placeElementsAroundTarget)({target:i,elements:l,graph:r,sizeProvider:s.renderingState})),t&&"hidden"===r.getLinkVisibility(t)&&a.history.execute((0,h.changeLinkTypeVisibility)(r,t,"visible")),a.history.execute((0,y.requestElementData)(r,e)),a.history.execute((0,y.restoreLinksBetweenElements)(r,{addedElements:e})),a.store(),o(v.WorkspaceEventKey.editorAddElements)}onMoveToFilter=e=>{const{targetIris:t,instancesSearchCommands:n}=this.props,{linkType:i,direction:r}=e,o=1===t.length?t[0]:void 0;o&&(i.id===this.ALL_RELATED_ELEMENTS_LINK.id?n?.trigger("setCriteria",{criteria:{refElement:o}}):n?.trigger("setCriteria",{criteria:{refElement:o,refElementLink:i.id,linkDirection:r}}))};renderSortSwitches(){const{targetIris:e,suggestProperties:t}=this.props,{panel:n}=this.state;return"connections"===n&&t&&1===e.length?(0,i.jsxs)("div",{className:`${I}__sort-switches`,children:[this.renderSortSwitch("alphabet",`${I}__sort-label-alpha`,"Sort alphabetically"),this.renderSortSwitch("smart",`${I}__sort-label-smart`,"Smart sort")]}):null}renderSortSwitch(e,t,n){const{connectionSortMode:r}=this.state;return(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"radio",name:"sort",id:e,value:e,className:`${I}__sort-switch`,onChange:this.onSortChange,checked:r===e}),(0,i.jsx)("label",{htmlFor:e,title:n,className:s()(`${I}__sort-switch-label`,t)})]})}onSortChange=e=>{const{onChangeMode:t,connectionSearch:n}=this.props,{connectionSortMode:i}=this.state,r=e.target.value;i!==r&&this.setState({connectionSortMode:r},(()=>{t(r),n.change({value:n.value,action:"submit"})}))}}class j extends r.Component{isSmartMode(){return"smart"===this.props.sortMode&&!this.props.filterKey}compareLinks=(e,t)=>{const{model:n}=this.props,i=n.locale.formatLabel(e.label,e.id),r=n.locale.formatLabel(t.label,t.id);return i.localeCompare(r)};compareLinksByWeight=(e,t)=>{const{model:n,suggestions:i}=this.props,{scores:r}=i,o=n.locale.formatLabel(e.label,e.id),s=n.locale.formatLabel(t.label,t.id),a=r.has(e.id)?r.get(e.id).score:0,l=r.has(t.id)?r.get(t.id).score:0;return a>l?-1:a<l?1:o.localeCompare(s)};getLinks(){const{model:e,data:t,filterKey:n}=this.props;return(t.links||[]).map((t=>e.getLinkType(t.id)?.data??t)).filter((t=>{const i=e.locale.formatLabel(t.label,t.id).toLowerCase();return!n||i.indexOf(n.toLowerCase())>=0})).sort(this.compareLinks)}getProbableLinks(){const{model:e,data:t,suggestions:n}=this.props,{scores:i}=n,r=this.isSmartMode();return(t.links??[]).map((t=>e.getLinkType(t.id)?.data??t)).filter((e=>i.has(e.id)&&(i.get(e.id).score>0||r))).sort(this.compareLinksByWeight)}getViews=(e,t)=>{const{model:n,data:r,suggestions:o}=this.props,{scores:s}=o,a=[],l=(e,o)=>{const{inCount:l,outCount:c,inexact:d}=r.counts.get(e.id)??{inCount:0,outCount:0,inexact:!1},u="in"===o?l:c;if(0===u)return;const h=t?"-probable":"";a.push((0,i.jsx)(N,{link:e,onExpandLink:this.props.onExpandLink,model:n,count:d&&u>0?"some":u,direction:o,filterKey:t?"":this.props.filterKey,onMoveToFilter:this.props.onMoveToFilter,probability:s.has(e.id)&&t?s.get(e.id).score:0},`${o}-${e.id}-${h}`))};for(const i of e)l(i,"in"),l(i,"out");return a};render(){const{model:e,allRelatedLink:t,scrolledListRef:n}=this.props,r=this.isSmartMode(),o=r?[]:this.getLinks(),a=this.getProbableLinks().filter((e=>-1===o.indexOf(e))),l=this.getViews(o),c=this.getViews(a,!0);let d;if(0===l.length&&0===c.length)d=(0,i.jsx)("label",{className:`${I}__links-no-results`,children:"No results"});else if(d=l,l.length>1||r&&c.length>1){const n=this.props.data.counts,{inCount:r,outCount:o,inexact:s}=n.get(t.id),a=r+o;d=[(0,i.jsx)(N,{link:t,onExpandLink:this.props.onExpandLink,model:e,count:s&&a>0?"some":a,onMoveToFilter:this.props.onMoveToFilter},t.id),(0,i.jsx)("hr",{className:`${I}__links-list-hr`},"reactodia-hr-line")].concat(d)}let u=null;return 0!==c.length&&(u=[r?null:(0,i.jsx)("li",{className:`${I}__links-probably-label`,children:"Probably, you are looking for..."},"probable-links"),c]),(0,i.jsxs)("ul",{ref:n,className:s()("reactodia-scrollable",`${I}__links-list`,0===l.length&&0===c.length?`${I}__links-list-empty`:void 0),children:[d,u]})}}class N extends r.Component{render(){const{model:e,link:t,filterKey:n,direction:r,count:o,probability:s=0}=this.props,a=e.locale.formatLabel(t.label,t.id),l=Math.round(100*s),c=(0,k.highlightSubstring)(a+(l>0?" ("+l+"%)":""),n),d="in"===r?"source":"out"===r?"target":"all connected";return(0,i.jsxs)("li",{"data-linktypeid":t.id,className:`${I}__link`,title:`${d} of "${a}" ${e.locale.formatIri(t.id)}`,onClick:()=>this.onExpandLink(),children:["in"===r||"out"===r?(0,i.jsxs)("div",{className:`${I}__link-direction`,children:["in"===r&&(0,i.jsx)("div",{className:`${I}__link-direction-in`}),"out"===r&&(0,i.jsx)("div",{className:`${I}__link-direction-out`})]}):null,(0,i.jsx)(x.WithFetchStatus,{type:"linkType",target:t.id,children:(0,i.jsx)("div",{className:`${I}__link-title`,children:c})}),"some"===o?null:(0,i.jsx)("span",{className:`reactodia-badge ${I}__link-count`,children:o<=T?o:"100+"}),this.props.onMoveToFilter?(0,i.jsx)("div",{className:`${I}__link-filter-button`,onClick:this.onMoveToFilter,title:"Set as filter in the Instances panel"}):null,(0,i.jsx)("div",{className:`${I}__link-navigate-button`,title:`Navigate to ${d} "${a}" elements`})]})}onExpandLink(){const{count:e,direction:t}=this.props;this.props.onExpandLink({chunkId:(0,c.generate128BitID)(),linkType:this.props.link,direction:t,expectedCount:e,pageCount:1})}onMoveToFilter=e=>{e.stopPropagation();const{link:t,count:n,direction:i,onMoveToFilter:r}=this.props;r?.({chunkId:(0,c.generate128BitID)(),linkType:t,direction:i,expectedCount:n,pageCount:1})}}class C extends r.Component{constructor(e){super(e),this.state=C.makeStateFromProps(e)}static getDerivedStateFromProps(e,t){return t&&t.chunkId===e.data.chunk.chunkId?null:C.makeStateFromProps(e)}static makeStateFromProps(e){return{chunkId:e.data.chunk.chunkId,selection:new Set}}onSelectAll=()=>{const e=this.props.data.elements;if(0===e.length)return;const t=D(e,this.state.selection)?new Set:function(e){const t=new Set;for(const n of e)n.presentOnDiagram||t.add(n.model.id);return t}(this.props.data.elements);this.updateSelection(t)};getFilteredObjects(){if(!this.props.filterKey)return this.props.data.elements;const e=this.props.filterKey.toLowerCase();return this.props.data.elements.filter((t=>{const n=this.props.model.locale.formatLabel(t.model.label,t.model.id).toLowerCase();return n&&n.indexOf(e)>=0}))}getItems(e){const t={},n=[];for(const i of e)t[i.model.id]||(t[i.model.id]=!0,n.push(i.model));return n}updateSelection=e=>{this.setState({selection:e})};renderCounter(e){const{data:{chunk:t,elements:n}}=this.props,r=`${e}\xa0of\xa0${n.length}`;let o=null;if("some"!==t.expectedCount){const e=Math.min(T,t.expectedCount)-n.length,r=Math.abs(e)>T?"100+":Math.abs(e).toString();o=(0,i.jsx)("span",{className:`${I}__objects-extra`,title:0===e?void 0:e>0?"Unavailable nodes":"Extra nodes",children:0===e?null:`\xa0(${r})`})}return(0,i.jsxs)("div",{className:`${I}__objects-count`,children:[(0,i.jsx)("span",{children:r}),o]})}render(){const{data:e,filterKey:t,onPressAddSelected:n,onMoveToFilter:r}=this.props,{selection:o}=this.state,a=this.getFilteredObjects(),l=D(a,o),c=a.filter((e=>!e.presentOnDiagram)),d=c.filter((e=>o.has(e.model.id))),u=d.length>0?d:c;return(0,i.jsxs)("div",{className:`${I}__objects`,children:[(0,i.jsx)("div",{className:`${I}__objects-select-all`,children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",name:"reactodia-connections-menu-select-all",checked:l&&c.length>0,onChange:this.onSelectAll,disabled:0===c.length}),"Select All"]})}),this.props.loading?(0,i.jsx)("div",{className:`${I}__objects-loading`,children:(0,i.jsx)(A,{})}):0===a.length?(0,i.jsx)("div",{className:`${I}__objects-no-results`,children:"No results"}):(0,i.jsxs)("div",{className:`${I}__objects-list`,children:[(0,i.jsx)(S.SearchResults,{items:this.getItems(a),selection:this.state.selection,onSelectionChanged:this.updateSelection,highlightText:t}),"some"!==e.chunk.expectedCount&&e.chunk.expectedCount>T?r?(0,i.jsx)("div",{className:`${I}__move-to-filter`,onClick:()=>r(e.chunk),children:"The list was truncated, for more data click here to use the filter panel"}):(0,i.jsx)("div",{className:`${I}__move-to-filter`,children:"The list was truncated."}):null]}),(0,i.jsxs)("div",{className:`${I}__objects-statusbar`,children:[this.renderCounter(d.length),(0,i.jsx)("div",{className:`${I}__objects-spacer`,"aria-hidden":"true"}),(0,i.jsx)("button",{className:s()(`${I}__objects-add-button`,"reactodia-btn reactodia-btn-secondary"),disabled:this.props.loading||u.length<=1,onClick:()=>n(u,"grouped"),children:"Add as group"}),(0,i.jsx)("button",{className:s()(`${I}__objects-add-button`,"reactodia-btn reactodia-btn-primary"),disabled:this.props.loading||0===c.length,onClick:()=>n(u,"separately"),children:d.length>0?"Add selected":"Add all"})]})]})}}function A(e){return(0,i.jsx)("div",{className:`${I}__spinner`,children:(0,i.jsx)(f.HtmlSpinner,{width:30,height:30,errorOccurred:Boolean(e.error)})})}function D(e,t){let n=!0;for(const i of e)i.presentOnDiagram||(n=n&&t.has(i.model.id));return n}},(e,t,n)=>{n.r(t),n.d(t,{DropOnCanvas:()=>d});var i=n(61),r=n(58),o=n(90),s=n(91),a=n(93),l=n(116),c=n(130);function d(e){const{canvas:t}=(0,o.useCanvas)(),{model:n,triggerWorkspaceEvent:s}=(0,c.useWorkspace)();return i.useEffect((()=>{const e=new r.EventObserver;return e.listen(t.events,"drop",(e=>{e.sourceEvent.preventDefault();const i=function(e){const t=(t,n=!1)=>{try{const i=e.dataTransfer.getData(t);if(!i)return;let r;try{r=JSON.parse(i)}catch(e){r=[n?decodeURI(i):i]}return 0===r.length?void 0:r}catch(e){return}};return t("application/x-reactodia-elements")||t("text/uri-list",!0)||t("text")||[]}(e.sourceEvent);if(i.length>0){const r=n.history.startBatch("Drag and drop onto diagram"),o=function(e,t,n,i){const r=e.map((e=>i.createElement(e)));for(const a of r)a.setPosition(t);n.renderingState.syncUpdate();let{x:o,y:s}=t,l=!0;for(const c of r){let{width:e,height:t}=(0,a.boundsOf)(c,n.renderingState);0===e&&(e=100),0===t&&(t=50),l&&(l=!1,o-=e/2,s-=t/2),c.setPosition({x:o,y:s}),s+=t+20}return r}(i,e.position,t,n),d=o.map((e=>e.iri));r.history.execute((0,l.requestElementData)(n,d)),r.history.execute((0,l.restoreLinksBetweenElements)(n,{addedElements:i})),r.store(),o.length>0&&o[o.length-1].focus(),n.setSelection(o),s(c.WorkspaceEventKey.editorAddElements)}})),()=>e.stopListening()}),[]),null}(0,s.defineCanvasWidget)(d,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{Halo:()=>h});var i=n(102),r=n(61),o=n(58),s=n(60),a=n(90),l=n(91),c=n(96),d=n(93),u=n(165);function h(e){const{model:t,canvas:n}=(0,a.useCanvas)(),r=(0,s.useObservedProperty)(t.events,"changeSelection",(()=>t.selection));if(1===r.length){const[t]=r;if(t instanceof c.Element)return(0,i.jsx)(p,{...e,target:t,canvas:n})}return null}(0,l.defineCanvasWidget)(h,(e=>({element:e,attachment:"overElements"})));class p extends r.Component{targetListener=new o.EventObserver;constructor(e){super(e),this.state={}}componentDidMount(){const{target:e}=this.props;this.listenToElement(e)}componentDidUpdate(e){e.target!==this.props.target&&this.listenToElement(this.props.target)}componentWillUnmount(){this.listenToElement(void 0)}listenToElement(e){const{canvas:t}=this.props;this.targetListener.stopListening(),e&&(this.targetListener.listenAny(e.events,this.onElementEvent),this.targetListener.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.forceUpdate()})))}onElementEvent=e=>{(e.changePosition||e.changeExpanded)&&this.forceUpdate()};render(){const{target:e,canvas:t,margin:n=5,connectionsMenuCommands:r,instancesSearchCommands:o,children:s}=this.props,a=(0,d.boundsOf)(e,t.renderingState),{x:l,y:c}=t.metrics.paperToScrollablePaneCoords(a.x,a.y),{x:h,y:p}=t.metrics.paperToScrollablePaneCoords(a.x+a.width,a.y+a.height),g={left:l-n,top:c-n,width:h-l+2*n,height:p-c+2*n};return(0,i.jsx)("div",{className:"reactodia-halo",style:g,children:s??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.SelectionActionGroup,{dock:"nw",dockColumn:1}),(0,i.jsx)(u.SelectionActionRemove,{dock:"ne"}),(0,i.jsx)(u.SelectionActionExpand,{dock:"s"}),(0,i.jsx)(u.SelectionActionAnchor,{dock:"w"}),(0,i.jsx)(u.SelectionActionConnections,{dock:"e",commands:r}),(0,i.jsx)(u.SelectionActionAddToFilter,{dock:"se",commands:o}),(0,i.jsx)(u.SelectionActionEstablishLink,{dock:"sw"})]})})}}},(e,t,n)=>{n.r(t),n.d(t,{SelectionAction:()=>v,SelectionActionAddToFilter:()=>N,SelectionActionAnchor:()=>E,SelectionActionConnections:()=>j,SelectionActionEstablishLink:()=>A,SelectionActionExpand:()=>T,SelectionActionGroup:()=>C,SelectionActionLayout:()=>I,SelectionActionRemove:()=>_,SelectionActionSpinner:()=>L,SelectionActionZoomToFit:()=>M});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(56),l=n(58),c=n(60),d=n(90),u=n(92),h=n(96),p=n(93),g=n(113),f=n(114),m=n(115),y=n(119),b=n(166),x=n(130);const w="reactodia-selection-action";function v(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a,disabled:l,onSelect:c,onMouseDown:d,children:u}=e;return(0,i.jsx)("button",{type:"button",className:s()(w,k(t),o),style:S(n,r),title:a,disabled:l,onClick:c,onMouseDown:d,children:u})}function k(e){switch(e){case"nw":return`${w}--dock-nw`;case"n":return`${w}--dock-n`;case"ne":return`${w}--dock-ne`;case"e":return`${w}--dock-e`;case"se":return`${w}--dock-se`;case"s":return`${w}--dock-s`;case"sw":return`${w}--dock-sw`;case"w":return`${w}--dock-w`;default:return}}function S(e,t){return{"--reactodia-dock-x":t??0,"--reactodia-dock-y":e??0}}function L(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a}=e;return(0,i.jsx)("div",{role:"button",className:s()(o,k(t),`${w}__spinner`),style:S(n,r),title:a,children:(0,i.jsx)(g.HtmlSpinner,{width:20,height:20})})}function _(e){const{className:t,title:n,...r}=e,{model:o,editor:a}=(0,x.useWorkspace)(),l=o.selection.filter((e=>e instanceof h.Element));let c=0,d=0;for(const i of l)i instanceof y.EntityElement&&(d++,f.AuthoringState.isAddedEntity(a.authoringState,i.iri)&&c++);const u=1===c&&1===d;return(0,i.jsx)(v,{...r,className:s()(t,u?`${w}__delete`:`${w}__remove`),title:n||(u?"Delete new element":1===l.length?"Remove an element from the diagram":"Remove selected elements from the diagram"),onSelect:()=>a.removeSelectedElements()})}function M(e){const{className:t,title:n,...r}=e,{model:o,canvas:a}=(0,d.useCanvas)(),l=o.selection.filter((e=>e instanceof h.Element));return l.length<=1?null:(0,i.jsx)(v,{...r,className:s()(t,`${w}__zoomToFit`),title:n??"Zoom to fit selected elements into view",onSelect:()=>{const e=new Set;for(const n of l)for(const t of o.getElementLinks(n))e.add(t);const t=(0,p.getContentFittingBox)(l,e,a.renderingState);a.zoomToFitRect(t,{animate:!0})}})}function I(e){const{className:t,title:n,...r}=e,{performLayout:o}=(0,x.useWorkspace)(),{model:a,canvas:l}=(0,d.useCanvas)(),c=a.selection.filter((e=>e instanceof h.Element));return c.length<=1?null:(0,i.jsx)(v,{...r,className:s()(t,`${w}__layout`),title:n??"Layout selected elements using force-directed algorithm",onSelect:()=>{o({canvas:l,selectedElements:new Set(c),animate:!0})}})}function T(e){const{className:t,title:n,...o}=e,{model:a}=(0,x.useWorkspace)(),d=a.selection.filter((e=>e instanceof h.Element)),p=function(e,t){return r.useCallback((n=>{if(0===t.length)return()=>{};const i=new Set(t),r=new l.EventObserver;return r.listen(e.events,"elementEvent",(({data:e})=>{e.changeExpanded&&i.has(e.changeExpanded.source)&&n()})),()=>r.stopListening()}),[e.events,t])}(a,d),g=(0,c.useFrameDebouncedStore)(p),f=(0,c.useSyncStore)(g,(()=>d.every((e=>e.isExpanded))));return d.every((e=>e instanceof y.EntityGroup))?null:(0,i.jsx)(v,{...o,className:s()(t,f?`${w}__collapse`:`${w}__expand`),title:n??(1===d.length?"Expand an element to reveal additional properties":"Expand all elements  to reveal additional properties"),onSelect:()=>{if(1===d.length){const e=d[0];a.history.execute((0,u.setElementExpanded)(e,!e.isExpanded))}else{const e=a.history.startBatch(f?"Collapse elements":"Expand elements");for(const t of d)e.history.execute((0,u.setElementExpanded)(t,!f));e.store()}}})}function E(e){const{dock:t,dockRow:n,dockColumn:r,className:o,title:a,onSelect:l}=e,{model:c,canvas:u}=(0,d.useCanvas)(),p=c.selection.filter((e=>e instanceof h.Element));if(1!==p.length)return null;const[g]=p;return g instanceof y.EntityElement?(0,i.jsx)("a",{role:"button",className:s()(w,k(t),o,`${w}__link`),style:S(n,r),href:g.iri,title:a??"Jump to resource",onClick:e=>{l?l(g,e):u.renderingState.shared.onIriClick(g.iri,g,"jumpToEntity",e)}}):null}function j(e){const{className:t,title:n,commands:r,...o}=e,{model:a,overlay:l}=(0,x.useWorkspace)(),d=(0,c.useObservedProperty)(l.events,"changeOpenedDialog",(()=>l.openedDialog?.knownType===m.BuiltinDialogType.connectionsMenu)),u=a.selection.filter((e=>e instanceof h.Element));let p=0;for(const i of u)for(const e of(0,y.iterateEntitiesOf)(i))p++;return r&&p>0?(0,i.jsx)(v,{...o,className:s()(t,d?`${w}__navigate-close`:`${w}__navigate-open`),title:n??"Navigate to connected elements",onSelect:()=>{d?l.hideDialog():r.trigger("show",{targets:u})}}):null}function N(e){const{className:t,title:n,commands:r,...o}=e,{model:a}=(0,d.useCanvas)(),l=a.selection.filter((e=>e instanceof h.Element));if(!r||1!==l.length)return null;const[c]=l;return c instanceof y.EntityElement?(0,i.jsx)(v,{...o,className:s()(t,`${w}__add-to-filter`),title:n??"Search for connected elements",onSelect:()=>{r.trigger("setCriteria",{criteria:{refElement:c.iri}})}}):null}function C(e){const{className:t,title:n,...r}=e,o=(0,x.useWorkspace)(),{model:a}=o,{canvas:l}=(0,d.useCanvas)(),c=a.selection.filter((e=>e instanceof h.Element)),u=c.length>0&&c.every((e=>e instanceof y.EntityElement)),p=c.length>0&&c.every((e=>e instanceof y.EntityGroup));return 0===c.length||1===c.length&&u?null:(0,i.jsx)(v,{...r,className:s()(t,p?`${w}__ungroup`:`${w}__group`),disabled:!(u||p),title:n??(p?"Ungroup entities":"Group entities"),onMouseDown:async()=>{if(u){const e=await(0,b.groupEntitiesAnimated)(c,l,o);a.setSelection([e])}else if(p){const e=await(0,b.ungroupAllEntitiesAnimated)(c,l,o);a.setSelection(e)}}})}function A(e){const{className:t,title:n,...o}=e,{model:l,editor:u}=(0,x.useWorkspace)(),{canvas:p}=(0,d.useCanvas)(),g=(0,c.useObservedProperty)(u.events,"changeMode",(()=>u.inAuthoringMode)),f=l.selection.filter((e=>e instanceof h.Element)),m=1===f.length?f[0]:void 0,b=function(e,t){const[n,i]=r.useState(),o=t instanceof y.EntityElement?t:void 0,s=(0,c.useEventStore)(o?.events,"changeData"),l=(0,c.useSyncStore)(s,(()=>o?.data)),d=(0,c.useEventStore)(e.events,"changeAuthoringState"),u=(0,c.useFrameDebouncedStore)(d),h=(0,c.useSyncStore)(u,(()=>e.authoringState)),p=t instanceof y.EntityElement?h.elements.get(t.iri):void 0;return r.useEffect((()=>{const t=new AbortController;if(e.metadataProvider&&l){if(p&&"entityDelete"===p.type)i(!1);else{i(void 0);const n=t.signal;(0,a.mapAbortedToNull)(e.metadataProvider.canConnect(l,void 0,void 0,{signal:n}),n).then((e=>{null!==e&&i(e.length>0)}))}return()=>t.abort()}i(!1)}),[l,p]),n}(u,g?m:void 0);if(!(m instanceof y.EntityElement&&g))return null;if(void 0===b){const{dock:t,dockRow:n,dockColumn:r}=e;return(0,i.jsx)(L,{dock:t,dockRow:n,dockColumn:r})}return(0,i.jsx)(v,{...o,className:s()(t,`${w}__establish-link`),disabled:!b,title:n??(b?"Establish link":"Establishing link is not allowed for the element"),onMouseDown:e=>{const t=p.metrics.pageToPaperCoords(e.pageX,e.pageY);u.authoringCommands.trigger("startDragEdit",{operation:{mode:"connect",source:m,point:t}})}})}},(e,t,n)=>{n.r(t),n.d(t,{groupEntitiesAnimated:()=>o,ungroupAllEntitiesAnimated:()=>s,ungroupSomeEntitiesAnimated:()=>a});var i=n(92),r=n(93);async function o(e,t,n){const{model:o}=n,s=o.history.startBatch("Group entities"),a=i.RestoreGeometry.capturePartial(e,[]),l=(0,r.getContentFittingBox)(e,[],t.renderingState),c=r.Rect.center(l);await t.animateGraph((()=>{for(const n of e){const e=(0,r.boundsOf)(n,t.renderingState),i={x:c.x-e.width/2,y:c.y-e.height/2},o=r.Vector.normalize(r.Vector.subtract(n.position,c));n.setPosition(r.Vector.add(i,r.Vector.scale(o,Math.min(e.width,e.height)/2)))}})),s.history.registerToUndo(a);const d=[...e].sort(((e,t)=>{const n=o.locale.formatLabel(e.data.label,e.data.id),i=o.locale.formatLabel(t.data.label,t.data.id);return n.localeCompare(i)})),u=o.group(d);t.renderingState.syncUpdate();const h=(0,r.boundsOf)(u,t.renderingState);return u.setPosition({x:c.x-h.width/2,y:c.y-h.height/2}),s.store(),u}async function s(e,t,n){const{model:i,performLayout:r}=n,o=i.history.startBatch("Ungroup entities"),s=i.ungroupAll(e);return await r({canvas:t,selectedElements:new Set(s),animate:!0,zoomToFit:!1}),o.store(),s}async function a(e,t,n,r){const{model:o}=r,s=o.history.startBatch("Ungroup entities"),a=o.ungroupSome(e,t);return n.renderingState.syncUpdate(),await n.animateGraph((()=>{s.history.execute((0,i.placeElementsAroundTarget)({target:e,elements:a.filter((e=>t.has(e.data.id))),graph:o,sizeProvider:n.renderingState}))})),s.store(),a}},(e,t,n)=>{n.r(t),n.d(t,{HaloLink:()=>p});var i=n(102),r=n(61),o=n(58),s=n(60),a=n(90),l=n(91),c=n(96),d=n(93),u=n(109),h=n(168);function p(e){const{canvas:t,model:n}=(0,a.useCanvas)(),r=(0,s.useEventStore)(n.events,"changeSelection");if(1===(0,s.useSyncStore)(r,(()=>n.selection)).length){const[r]=n.selection;if(r instanceof c.Link)return(0,i.jsx)(b,{...e,target:r,model:n,canvas:t})}return null}(0,l.defineCanvasWidget)(p,(e=>({element:e,attachment:"overElements"})));const g="reactodia-halo-link",f=0,m=20,y=5;class b extends r.Component{targetListener=new o.EventObserver;constructor(e){super(e),this.state={actionContext:b.makeActionContext(this.props)}}static makeActionContext(e){const{target:t,model:n,canvas:i,buttonSize:r=m,buttonMargin:o=y}=e,s=function(e,t,n){const i=t.getElement(e.sourceId),r=t.getElement(e.targetId);if(!i||!r)return;const o=n.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s;return(0,d.computePolyline)((0,d.boundsOf)(i,n),(0,d.boundsOf)(r,n),a)}(t,n,i.renderingState);if(!s)return null;const a=(0,d.computePolylineLength)(s);return{link:t,polyline:s,buttonSize:r,getPosition:(e,t)=>{const n=(r+o)*t,l=(0,d.getPointAlongPolyline)(s,"source"===e?n:a-n),{x:c,y:u}=i.metrics.paperToScrollablePaneCoords(l.x,l.y);return{top:u-r/2,left:c-r/2}},getAngleInDegrees:e=>{const t=s["source"===e?1:s.length-1],n=s["source"===e?0:s.length-2],i=d.Vector.normalize(d.Vector.subtract(n,t));return Math.atan2(i.y,i.x)*(180/Math.PI)}}}componentDidMount(){const{target:e}=this.props;this.listenToTarget(e)}componentDidUpdate(e){this.props.target!==e.target&&this.listenToTarget(this.props.target),this.props.target===e.target&&this.props.buttonSize===e.buttonSize&&this.props.buttonMargin===e.buttonMargin||this.updateActionContext()}componentWillUnmount(){this.listenToTarget(void 0)}listenToTarget(e){const{model:t,canvas:n}=this.props;if(this.targetListener.stopListening(),e){const i=t.getElement(e.sourceId),r=t.getElement(e.targetId);this.targetListener.listen(i.events,"changePosition",this.updateActionContext),this.targetListener.listen(r.events,"changePosition",this.updateActionContext),this.targetListener.listen(e.events,"changeVertices",this.updateActionContext),this.targetListener.listen(n.renderingState.events,"changeElementSize",(e=>{e.source!==i&&e.source!==r||this.updateActionContext()}))}}updateActionContext=()=>{this.setState(((e,t)=>({actionContext:b.makeActionContext(t)})))};render(){const{canvas:e,highlightMargin:t=f,buttonSize:n=m,buttonMargin:r=y,children:o}=this.props,{actionContext:s}=this.state;if(!s)return null;const a={"--reactodia-link-button-size":`${n}px`,"--reactodia-link-button-margin":`${r}px`};return(0,i.jsxs)("div",{className:`${g}`,style:a,children:[(0,i.jsx)(x,{actionContext:s,margin:t,canvas:e}),(0,i.jsx)(h.LinkActionContext.Provider,{value:s,children:o??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.LinkActionMoveEndpoint,{dockSide:"target"}),(0,i.jsx)(h.LinkActionMoveEndpoint,{dockSide:"source"}),(0,i.jsx)(h.LinkActionEdit,{dockSide:"target",dockIndex:1}),(0,i.jsx)(h.LinkActionDelete,{dockSide:"target",dockIndex:2}),(0,i.jsx)(h.LinkActionRename,{})]})})]})}}function x(e){const{actionContext:{link:t,polyline:n},margin:r,canvas:o}=e,a=(0,s.useEventStore)(o.renderingState.events,"changeLinkLabelBounds"),l=(0,s.useSyncStore)(a,(()=>o.renderingState.getLinkLabelBounds(t)));if(!l)return null;const{x:c,y:h}=o.metrics.paperToScrollablePaneCoords(l.x,l.y),{x:p,y:f}=o.metrics.paperToScrollablePaneCoords(l.x+l.width,l.y+l.height),m={left:c-r,top:h-r,width:p-c+2*r,height:f-h+2*r},y=(0,d.pathFromPolyline)(n);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:`${g}__label-highlight`,style:m}),(0,i.jsx)(u.TransformedSvgCanvas,{paperTransform:o.metrics.getTransform(),style:{overflow:"visible",pointerEvents:"none"},children:(0,i.jsx)("path",{className:`${g}__path-highlight`,d:y})})]})}},(e,t,n)=>{n.r(t),n.d(t,{LinkAction:()=>y,LinkActionContext:()=>g,LinkActionDelete:()=>w,LinkActionEdit:()=>x,LinkActionMoveEndpoint:()=>k,LinkActionRename:()=>S,LinkActionSpinner:()=>b,useLinkActionContext:()=>f});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(56),l=n(60),c=n(90),d=n(113),u=n(114),h=n(119),p=n(130);const g=r.createContext(null);function f(){const e=r.useContext(g);if(!e)throw new Error("Missing context for LinkAction");return e}const m="reactodia-link-action";function y(e){const{dockSide:t,dockIndex:n,disabled:r,className:o,title:a,onSelect:l,onMouseDown:c,children:d}=e,{getPosition:u}=f();return(0,i.jsx)("button",{role:"button",className:s()(o,m),style:u(t,n),disabled:r,title:a,onClick:l,onMouseDown:c,children:d})}function b(e){const{dockSide:t,dockIndex:n,className:r,title:o}=e,{buttonSize:a,getPosition:l}=f();return(0,i.jsx)("div",{className:s()(r,`${m}__spinner`),style:l(t,n),title:o,children:(0,i.jsx)(d.HtmlSpinner,{width:a,height:a})})}function x(e){const{className:t,title:n,...r}=e,{link:o}=f(),{model:a,editor:c}=(0,p.useWorkspace)(),d=(0,l.useObservedProperty)(c.events,"changeMode",(()=>c.inAuthoringMode)),g=v(d?o:void 0,a,c),x=(0,l.useObservedProperty)(c.events,"changeAuthoringState",(()=>o instanceof h.RelationLink&&u.AuthoringState.isDeletedRelation(c.authoringState,o.data)));if(!(d&&o instanceof h.RelationLink)||x)return null;if(void 0===g){const{dockSide:t,dockIndex:n}=e;return(0,i.jsx)(b,{dockSide:t,dockIndex:n})}return(0,i.jsx)(y,{...r,className:s()(t,`${m}__button`,`${m}__edit`),title:n??(g.canChangeType?"Edit relation":"Cannot edit the relation"),disabled:!g.canChangeType,onSelect:()=>c.authoringCommands.trigger("editRelation",{target:o})})}function w(e){const{className:t,title:n,...r}=e,{link:o}=f(),{model:a,editor:c}=(0,p.useWorkspace)(),d=v(o,a,c),g=(0,l.useObservedProperty)(c.events,"changeAuthoringState",(()=>o instanceof h.RelationLink&&u.AuthoringState.isDeletedRelation(c.authoringState,o.data)));if(!(c.inAuthoringMode&&o instanceof h.RelationLink)||g)return null;if(void 0===d){const{dockSide:t,dockIndex:n}=e;return(0,i.jsx)(b,{dockSide:t,dockIndex:n})}return(0,i.jsx)(y,{...r,className:s()(t,`${m}__button`,`${m}__delete`),title:n??(d.canDelete?"Delete relation":"Cannot delete the relation"),disabled:!d.canDelete,onSelect:()=>c.deleteRelation(o.data)})}function v(e,t,n){const[i,o]=r.useState(),s=(0,l.useEventStore)(n.events,"changeAuthoringState"),c=(0,l.useFrameDebouncedStore)(s),d=(0,l.useSyncStore)(c,(()=>n.authoringState));return r.useEffect((()=>{const i=new AbortController;if(n.metadataProvider&&e instanceof h.RelationLink){if(function(e,t){return u.AuthoringState.isDeletedEntity(e,t.data.sourceId)||u.AuthoringState.isDeletedEntity(e,t.data.targetId)}(d,e))o({});else{o(void 0);const r=t.getElement(e.sourceId),s=t.getElement(e.targetId),l=i.signal;(0,a.mapAbortedToNull)(n.metadataProvider.canModifyRelation(e.data,r.data,s.data,{signal:l}),l).then((e=>{null!==e&&o(e)}))}return()=>i.abort()}o({})}),[e,d]),i}function k(e){const{dockSide:t,className:n,title:r,...o}=e,{link:a,buttonSize:d,getAngleInDegrees:g}=f(),{canvas:b}=(0,c.useCanvas)(),{editor:x}=(0,p.useWorkspace)(),w=(0,l.useObservedProperty)(x.events,"changeMode",(()=>x.inAuthoringMode)),v=(0,l.useObservedProperty)(x.events,"changeAuthoringState",(()=>a instanceof h.RelationLink&&u.AuthoringState.isDeletedRelation(x.authoringState,a.data)));if(!(w&&a instanceof h.RelationLink))return null;const k=g(t);return(0,i.jsx)(y,{...o,dockSide:t,dockIndex:0,className:s()(n,`${m}__endpoint`),title:r??("source"===t?"Move link source":"Move link target"),disabled:v,onMouseDown:e=>{const n=b.metrics.pageToPaperCoords(e.pageX,e.pageY);x.authoringCommands.trigger("startDragEdit",{operation:{mode:"source"===t?"moveSource":"moveTarget",link:a,point:n}})},children:(0,i.jsx)("svg",{width:d,height:d,style:{transform:`rotate(${k}deg)`},children:(0,i.jsx)("g",{transform:`scale(${d})`,children:"source"===t?(0,i.jsx)("circle",{r:.5,cx:.5,cy:.5,fill:"#198AD3"}):(0,i.jsx)("polygon",{points:"0,0.5 1,1 1,0",fill:"#198AD3"})})})})}function S(e){const{className:t,title:n}=e,{link:r}=f(),{canvas:o}=(0,c.useCanvas)(),{view:{renameLinkProvider:a},editor:d}=(0,p.useWorkspace)(),u=(0,l.useEventStore)(o.renderingState.events,"changeLinkLabelBounds"),h=(0,l.useSyncStore)(u,(()=>o.renderingState.getLinkLabelBounds(r)));if(!a?.canRename(r)||!h)return null;const{x:g,y:y,width:b,height:x}=h,{x:w,y:v}=o.metrics.paperToScrollablePaneCoords(g+b,y+x/2),k=17,S={width:15,height:k,left:w,top:v-k/2};return(0,i.jsx)("button",{className:s()(t,`${m}__rename`),style:S,title:n??"Rename link",onClick:()=>d.authoringCommands.trigger("renameLink",{target:r})})}},(e,t,n)=>{n.r(t),n.d(t,{InstancesSearch:()=>S,createRequest:()=>I});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(60),c=n(67),d=n(92),u=n(96),h=n(93),p=n(116),g=n(119),f=n(130),m=n(170),y=n(156),b=n(150),x=n(151),w=n(152);const v=n(23),k=n(24);function S(e){const{searchStore:t,searchTimeout:n="explicit",minSearchTermLength:r=3}=e,o=(0,x.useSearchInputStore)({initialValue:"",submitTimeout:n,allowSubmit:e=>e.length>=r}),s=t??o,a=(0,l.useObservedProperty)(s.events,"changeMode",(()=>"explicit"===s.mode)),c=(0,f.useWorkspace)();return(0,i.jsx)(M,{...e,isControlled:Boolean(t),searchStore:s,minSearchTermLength:r,requireSubmit:a,workspace:c})}const L="reactodia-instances-search",_=100;class M extends r.Component{listener=new a.EventObserver;criteriaListener=new a.EventObserver;searchListener=new a.EventObserver;delayedUpdateAll=new c.Debouncer;requestCancellation=new AbortController;currentRequest;constructor(e){super(e),this.state={criteria:{},resultId:0,selection:new Set}}componentDidMount(){const{commands:e,workspace:t}=this.props,{model:n,triggerWorkspaceEvent:i}=t;this.listener.listen(n.events,"changeLanguage",(()=>this.forceUpdate())),this.listener.listen(n.events,"loadingStart",(()=>{this.setState({criteria:{}},(()=>this.props.searchStore.change({value:"",action:"clear"})))})),this.listener.listen(e,"setCriteria",(({criteria:e})=>{i(f.WorkspaceEventKey.searchUpdateCriteria),this.setState({criteria:e},(()=>{this.props.searchStore.change({value:e.text??"",action:"clear"}),this.props.onChangeCriteria?.(this.state.criteria)}))})),this.listenSearch(),this.resubscribeToCriteria(),this.queryItems(!1)}componentDidUpdate(e,t){this.props.searchStore.events!==e.searchStore.events&&this.listenSearch(),this.state.criteria!==t.criteria&&(this.resubscribeToCriteria(),this.queryItems(!1))}listenSearch(){const{searchStore:e}=this.props;this.searchListener.stopListening(),this.searchListener.listen(e.events,"executeSearch",(({value:e})=>{this.submitCriteriaUpdate(e,{triggerChange:!1})})),this.searchListener.listen(e.events,"clearSearch",(()=>{this.submitCriteriaUpdate("",{triggerChange:!1})}))}componentWillUnmount(){this.listener.stopListening(),this.criteriaListener.stopListening(),this.searchListener.stopListening(),this.requestCancellation.abort(),this.currentRequest=void 0}resubscribeToCriteria(){const{workspace:{model:e}}=this.props,{criteria:t}=this.state;if(this.criteriaListener.stopListening(),t.elementType){const n=e.createElementType(t.elementType);n&&this.criteriaListener.listen(n.events,"changeData",this.scheduleUpdateAll)}if(t.refElement){const n=e.elements.find((e=>e instanceof g.EntityElement&&e.iri===t.refElement));n&&this.criteriaListener.listen(n.events,"changeData",this.scheduleUpdateAll)}if(t.refElementLink){const n=e.createLinkType(t.refElementLink);n&&this.criteriaListener.listen(n.events,"changeData",this.scheduleUpdateAll)}}scheduleUpdateAll=()=>{this.delayedUpdateAll.call(this.updateAll)};updateAll=()=>this.forceUpdate();render(){const{className:e,isControlled:t,searchStore:n,minSearchTermLength:r,requireSubmit:o}=this.props,a=this.state.querying?"loading":this.state.error?"error":this.state.items?"completed":"none",l=this.state.items??[],c=this.state.querying||0===this.state.selection.size;return(0,i.jsxs)("div",{className:s()(L,t?`${L}--controlled`:void 0,e),children:[(0,i.jsxs)("div",{className:`${L}__criteria`,children:[this.renderCriteria(),t?null:(0,i.jsx)(x.SearchInput,{store:n,className:`${L}__text-criteria`,inputProps:{name:"reactodia-instances-search-text"}})]}),(0,i.jsx)(b.ProgressBar,{state:a,title:"Querying for elements"}),(0,i.jsxs)("div",{className:`${L}__rest reactodia-scrollable`,children:[(0,i.jsx)(w.SearchResults,{items:l,highlightText:this.state.criteria.text,selection:this.state.selection,onSelectionChanged:this.onSelectionChanged,footer:0===l.length?(0,i.jsx)(y.NoSearchResults,{hasQuery:void 0!==this.state.items,minSearchTermLength:r,requireSubmit:o}):null}),(0,i.jsx)("div",{className:`${L}__rest-end`,children:(0,i.jsx)("button",{type:"button",className:`${L}__load-more reactodia-btn reactodia-btn-primary`,disabled:this.state.querying,style:{display:this.state.moreItemsAvailable?void 0:"none"},onClick:()=>this.queryItems(!0),children:"Show more"})})]},this.state.resultId),(0,i.jsxs)("div",{className:s()(`${L}__actions`,c?`${L}__actions-hidden`:void 0),"aria-hidden":c?"true":void 0,children:[(0,i.jsx)("button",{type:"button",className:`${L}__action reactodia-btn reactodia-btn-secondary`,disabled:this.state.querying||this.state.selection.size<=1,onClick:()=>this.placeSelectedItems("group"),children:"Add as group"}),(0,i.jsx)("button",{type:"button",className:`${L}__action reactodia-btn reactodia-btn-primary`,disabled:this.state.querying||0===this.state.selection.size,onClick:()=>this.placeSelectedItems("separately"),children:"Add selected"})]})]})}onSelectionChanged=e=>{this.setState({selection:e})};renderCriteria(){const{workspace:{model:e}}=this.props,{criteria:t}=this.state,n=[];if(t.elementType){const r=e.getElementType(t.elementType),o=e.locale.formatLabel(r?.data?.label,t.elementType);n.push((0,i.jsxs)("div",{className:`${L}__criterion`,children:[this.renderRemoveCriterionButtons((()=>this.setState({criteria:{...t,elementType:void 0}},(()=>this.props.onChangeCriteria?.(this.state.criteria))))),"Has type ",(0,i.jsx)("span",{className:`${L}__criterion-class`,title:t.elementType,children:o})]},"hasType"))}else if(t.refElement){const r=function(e,t){for(const n of e.elements)for(const e of(0,g.iterateEntitiesOf)(n))if(e.id===t)return e;return}(e,t.refElement)??g.EntityElement.placeholderData(t.refElement);let o;if(t.refElementLink){const n=e.getLinkType(t.refElementLink);o=e.locale.formatLabel(n?.data?.label,t.refElementLink)}n.push((0,i.jsxs)("div",{className:`${L}__criterion`,children:[this.renderRemoveCriterionButtons((()=>this.setState({criteria:{...t,refElement:void 0,refElementLink:void 0}},(()=>this.props.onChangeCriteria?.(this.state.criteria))))),"Connected to ",(0,i.jsx)(m.InlineEntity,{target:r}),t.refElementLink&&(0,i.jsxs)("span",{children:[" through ",(0,i.jsx)("span",{className:`${L}__criterion-link-type`,title:t.refElementLink,children:o}),"in"===t.linkDirection&&(0,i.jsxs)("span",{children:[" as ",(0,i.jsx)("img",{className:`${L}__link-direction`,src:v}),"\xa0source"]}),"out"===t.linkDirection&&(0,i.jsxs)("span",{children:[" as ",(0,i.jsx)("img",{className:`${L}__link-direction`,src:k}),"\xa0target"]})]})]},"hasLinkedElement"))}return(0,i.jsx)("div",{className:`${L}__criterions`,children:n})}renderRemoveCriterionButtons(e){return(0,i.jsx)("div",{className:`${L}__criterion-remove reactodia-btn-group reactodia-btn-group-xs`,children:(0,i.jsx)("button",{type:"button",title:"Remove criteria",className:s()(`${L}__criterion-remove-button`,"reactodia-btn reactodia-btn-default"),onClick:e})})}submitCriteriaUpdate(e,t){const{onChangeCriteria:n}=this.props;this.setState((t=>{const n=""===e?void 0:e;return{criteria:{...t.criteria,text:n}}}),t.triggerChange?()=>n?.(this.state.criteria):void 0)}queryItems(e){const{workspace:{model:t,triggerWorkspaceEvent:n}}=this.props;let i;if(this.requestCancellation.abort(),e){if(!this.currentRequest)throw new Error("Cannot request more items without initial request.");const{limit:e}=this.currentRequest;i={...this.currentRequest,limit:"number"==typeof e?e+_:e}}else i=I(this.state.criteria);if(!(i.text||i.elementTypeId||i.refElementId||i.refElementLinkId))return void this.setState({querying:!1,error:void 0,items:void 0,selection:new Set,moreItemsAvailable:!1});this.requestCancellation=new AbortController;const r=this.requestCancellation.signal;i={...i,signal:r},this.currentRequest=i,this.setState({querying:!0,error:void 0,moreItemsAvailable:!1}),t.dataProvider.lookup(i).then((e=>{r.aborted||(this.processFilterData(e),n(f.WorkspaceEventKey.searchQueryItem))})).catch((e=>{r.aborted||(console.error(e),this.setState({querying:!1,error:e}))}))}processFilterData(e){const t="number"==typeof this.currentRequest.limit&&this.currentRequest.limit>_,n=new Set;if(t)for(const o of this.state.items)n.add(o.id);const i=t?[...this.state.items]:[];for(const{element:o}of e)n.has(o.id)||i.push(o);const r="number"==typeof this.currentRequest.limit&&e.length>=this.currentRequest.limit;t?this.setState({querying:!1,items:i,error:void 0,moreItemsAvailable:r}):this.setState({querying:!1,resultId:this.state.resultId+1,items:i,selection:new Set,error:void 0,moreItemsAvailable:r})}placeSelectedItems(e){const{onAddElements:t,workspace:{model:n,view:i}}=this.props,r=i.findAnyCanvas(),{items:o,selection:s}=this.state;if(!r||0===s.size)return;const a=n.history.startBatch("Add selected elements"),l=o?o.filter((e=>s.has(e.id))):Array.from(s,g.EntityElement.placeholderData);let c;if("separately"===e){const e=new u.VoidElement({position:T(r,.3,.5)});c=l.map((e=>n.createElement(e))),r.renderingState.syncUpdate(),a.history.execute((0,d.placeElementsAroundTarget)({target:e,elements:c,graph:n,sizeProvider:r.renderingState,distance:150}))}else{const e=new g.EntityGroup({items:l.map((e=>({data:e}))),position:T(r,.5,.5)});c=[e],n.addElement(e),r.renderingState.syncUpdate();const{x:t,y:i,width:o,height:s}=(0,h.boundsOf)(e,r.renderingState);e.setPosition({x:t-o/2,y:i-s/2})}const f=Array.from(s);a.history.execute((0,p.requestElementData)(n,f)),a.history.execute((0,p.restoreLinksBetweenElements)(n,{addedElements:f})),a.store(),t?.(c)}}function I(e){const{text:t,elementType:n,refElement:i,refElementLink:r,linkDirection:o}=e;return{text:t,elementTypeId:n,refElementId:i,refElementLinkId:r,linkDirection:o,limit:_}}function T(e,t,n){const i=e.metrics.area;return e.metrics.clientToPaperCoords(i.clientWidth*t,i.clientHeight*n)}},(e,t,n)=>{n.r(t),n.d(t,{InlineEntity:()=>a});var i=n(102),r=n(130),o=n(148);const s="reactodia-inline-entity";function a(e){const{target:t}=e,{model:n,getElementTypeStyle:a}=(0,r.useWorkspace)(),l=n.locale.formatLabel(t.label,t.id),{color:c}=a(t.types),d={"--reactodia-inline-entity-color":c};return(0,i.jsx)("span",{className:s,style:d,title:(0,o.formatEntityTitle)(t,n),children:(0,i.jsx)("span",{className:`${s}__label`,children:l})})}},(e,t,n)=>{n.r(t),n.d(t,{LinkTypesToolbox:()=>x});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(60),c=n(67),d=n(92),u=n(96),h=n(119),p=n(129),g=n(130),f=n(170),m=n(148),y=n(156),b=n(151);function x(e){const{searchStore:t,searchTimeout:n=200,minSearchTermLength:r=1}=e,o=(0,b.useSearchInputStore)({initialValue:"",submitTimeout:n,allowSubmit:e=>e.length>=r}),s=t??o,a=(0,l.useObservedProperty)(s.events,"changeMode",(()=>"explicit"===s.mode)),c=(0,g.useWorkspace)();return(0,i.jsx)(k,{...e,isControlled:Boolean(t),searchStore:s,minSearchTermLength:r,requireSubmit:a,workspace:c})}const w="reactodia-links-toolbox",v=!0;class k extends r.Component{listener=new a.EventObserver;selectionListener=new a.EventObserver;searchListener=new a.EventObserver;linkListener=new a.EventObserver;debounceSelection=new c.Debouncer(50);delayedUpdateAll=new c.Debouncer;constructor(e){super(e),this.state={filteredLinks:{term:"",diagramHasLink:!1,selection:[],selectionLinks:new Set,links:[]}}}componentDidMount(){const{workspace:{model:e}}=this.props;this.listener.listen(e.events,"loadingSuccess",this.updateOnCurrentSelection),this.listener.listen(e.events,"changeLanguage",this.updateOnCurrentSelection),this.subscribeToSelectionChanges(),this.listenSearch(),this.updateOnCurrentSelection()}componentDidUpdate(e,t){const{trackSelected:n=v,searchStore:i}=this.props;n!==e.trackSelected&&this.subscribeToSelectionChanges(),i.events!==e.searchStore.events&&this.listenSearch(),this.state.filteredLinks!==t.filteredLinks&&this.subscribeOnFilteredLinksEvents()}listenSearch(){const{searchStore:e}=this.props;this.searchListener.stopListening(),this.searchListener.listen(e.events,"executeSearch",(({value:e})=>{this.setState(((t,n)=>S(t,e,n)))})),this.searchListener.listen(e.events,"clearSearch",(()=>{this.setState(((e,t)=>S(e,"",t)))}))}componentWillUnmount(){this.listener.stopListening(),this.selectionListener.stopListening(),this.searchListener.stopListening(),this.linkListener.stopListening(),this.debounceSelection.dispose(),this.delayedUpdateAll.dispose()}subscribeToSelectionChanges(){const{trackSelected:e=v,workspace:{model:t}}=this.props;this.selectionListener.stopListening(),e&&this.selectionListener.listen(t.events,"changeSelection",(()=>{this.debounceSelection.call(this.updateOnCurrentSelection)}))}updateOnCurrentSelection=()=>{this.setState(((e,t)=>S(e,t.searchStore.value,t)))};subscribeOnFilteredLinksEvents(){const{workspace:{model:e}}=this.props,{filteredLinks:t}=this.state;this.linkListener.stopListening();const n=new Set;for(const i of t.links)n.add(i.iri),this.linkListener.listen(i.type.events,"changeData",this.onLinkChanged);this.linkListener.listen(e.events,"changeLinkVisibility",(e=>{n.has(e.source)&&this.onLinkChanged()}))}onLinkChanged=()=>{this.delayedUpdateAll.call((()=>this.forceUpdate()))};render(){const{className:e,isControlled:t,searchStore:n,minSearchTermLength:r,requireSubmit:o,workspace:{model:a}}=this.props,{filteredLinks:l}=this.state,c=l.links.filter((e=>l.selectionLinks.has(e.iri))),d=l.links.filter((e=>!l.selectionLinks.has(e.iri)));return(0,i.jsxs)("div",{className:s()(w,t?`${w}--controlled`:void 0,e),children:[(0,i.jsxs)("div",{className:`${w}__heading`,children:[t?null:(0,i.jsx)(b.SearchInput,{store:n,className:`${w}__filter`,inputProps:{name:"reactodia-link-types-filter"}}),(0,i.jsxs)("div",{className:`${w}__switch-all`,children:[(0,i.jsx)(_,{onSetVisibility:e=>M(a,e,l.links),disabled:0===l.links.length}),(0,i.jsx)("span",{children:"\xa0Switch all"})]})]}),(0,i.jsx)("div",{className:`${w}__rest`,children:(0,i.jsxs)("div",{className:"reactodia-scrollable",children:[c.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{role:"heading",className:`${w}__links-heading`,children:[(0,i.jsxs)("b",{children:["Connected to","\xa0"]}),1===l.selection.length?(0,i.jsx)(f.InlineEntity,{target:l.selection[0]}):"selected entities"]}),this.renderLinks(c)]}):null,c.length>0&&d.length>0?(0,i.jsx)("div",{role:"heading",className:`${w}__links-heading`,children:(0,i.jsx)("b",{children:"Other links"})}):null,this.renderLinks(d),0===l.links.length?(0,i.jsx)(y.NoSearchResults,{className:`${w}__no-results`,hasQuery:l.term.length>0,minSearchTermLength:r,requireSubmit:o,message:l.diagramHasLink?void 0:"No links found."}):null]})})]})}renderLinks(e){const{instancesSearchCommands:t,workspace:{model:n}}=this.props,{filteredLinks:r}=this.state;return(0,i.jsx)("ul",{className:`${w}__links`,children:e.map((e=>(0,i.jsx)(L,{model:n,link:e,onAddToFilter:t&&r.selectionLinks.has(e.iri)?this.onAddToFilter:void 0,filterKey:r.term},e.iri)))})}onAddToFilter=e=>{const{instancesSearchCommands:t}=this.props,{filteredLinks:n}=this.state;1===n.selection.length&&t?.trigger("setCriteria",{criteria:{refElement:n.selection[0].id,refElementLink:e}})}}function S(e,t,n){const{trackSelected:i=v,workspace:{model:r}}=n,o=new Set;for(const c of r.links)o.add(c.typeId);const s=Array.from(o,(e=>r.createLinkType(e))).map((e=>({iri:e.id,type:e,label:r.locale.formatLabel(e.data?.label,e.id)}))).filter((e=>e.label.toLowerCase().indexOf(t.toLowerCase())>=0)).sort(((e,t)=>e.label.localeCompare(t.label))),a=new Map,l=new Set;if(i)for(const c of r.selection)if(c instanceof u.Element){for(const e of(0,h.iterateEntitiesOf)(c))a.set(e.id,e);for(const e of r.getElementLinks(c))l.add(e.typeId)}return{...e,filteredLinks:{term:t,diagramHasLink:o.size>0,selection:Array.from(a.values()),selectionLinks:l,links:s}}}function L(e){const{model:t,link:n,filterKey:r,onAddToFilter:o}=e;return(0,i.jsxs)("li",{"data-linktypeid":n.iri,className:`${w}__link-item`,children:[(0,i.jsx)(_,{className:`${w}__link-buttons`,visibility:t.getLinkVisibility(n.iri),onSetVisibility:e=>M(t,e,[n])}),(0,i.jsx)(p.WithFetchStatus,{type:"linkType",target:n.iri,children:(0,i.jsx)("div",{className:`${w}__link-title`,children:(0,m.highlightSubstring)(n.label,r)})}),o?(0,i.jsx)("div",{className:`${w}__filter-button`,onClick:()=>o(n.iri)}):null]})}function _(e){const{className:t,visibility:n,onSetVisibility:r,disabled:o}=e;return(0,i.jsxs)("div",{className:s()(t,"reactodia-btn-group reactodia-btn-group-xs"),children:[(0,i.jsx)("button",{title:"Hide links and labels",className:s()(`${w}__toggle-invisible`,"reactodia-btn reactodia-btn-default","hidden"===n?"active":void 0),disabled:o,onClick:()=>r("hidden")}),(0,i.jsx)("button",{title:"Show only lines for links (without labels)",className:s()(`${w}__toggle-lines-only`,"reactodia-btn reactodia-btn-default","withoutLabel"===n?"active":void 0),disabled:o,onClick:()=>r("withoutLabel")}),(0,i.jsx)("button",{id:"visible",title:"Show links with labels",className:s()(`${w}__toggle-visible`,"reactodia-btn reactodia-btn-default","visible"===n?"active":void 0),disabled:o,onClick:()=>r("visible")})]})}function M(e,t,n){const i=e.history.startBatch("Change link types visibility");for(const r of n)e.history.execute((0,d.changeLinkTypeVisibility)(e,r.iri,t));i.store()}},(e,t,n)=>{n.r(t),n.d(t,{Navigator:()=>p});var i=n(102),r=n(61),o=n(67),s=n(58),a=n(90),l=n(91),c=n(93),d=n(109),u=n(130),h=n(153);function p(e){const{canvas:t}=(0,a.useCanvas)(),n=(0,u.useWorkspace)();return(0,i.jsx)(_,{...e,canvas:t,workspace:n})}const g="reactodia-navigator",f="auto",m=.4,y=300,b=160,x=.2,w="#F5F5F5",v="#F5F5F5",k="#FFFFFF",S={color:"#EEEEEE",width:2},L={color:"#EEEEEE",width:2,dash:[5,5]};class _ extends r.Component{delayedRedraw=new o.Debouncer;delayedSizeCheck=new o.Debouncer;listener=new s.EventObserver;canvas;transform;isDraggingViewport=!1;constructor(e){super(e);const{expanded:t=f}=this.props;this.state={expanded:Boolean(t),autoToggle:"auto"===t,allowExpand:!0}}componentDidMount(){const{canvas:e,workspace:{model:t}}=this.props,{renderingState:n}=e;this.listener.listen(t.events,"changeCells",this.scheduleRedraw),this.listener.listen(t.events,"elementEvent",this.scheduleRedraw),this.listener.listen(e.events,"pointerMove",this.scheduleRedraw),this.listener.listen(e.events,"scroll",this.scheduleRedraw),this.listener.listen(e.events,"resize",(()=>{this.delayedSizeCheck.call(this.onCheckSize)})),this.listener.listen(n.shared.events,"changeHighlight",this.scheduleRedraw),this.listener.listen(n.events,"changeElementSize",this.scheduleRedraw),this.onCheckSize()}shouldComponentUpdate(e,t){return!(e.dock===this.props.dock&&e.dockOffsetX===this.props.dockOffsetX&&e.dockOffsetY===this.props.dockOffsetY&&e.width===this.props.width&&e.height===this.props.height&&t===this.state)}componentWillUnmount(){this.delayedRedraw.dispose(),this.delayedSizeCheck.dispose(),this.listener.stopListening(),this.stopDragViewport()}scheduleRedraw=()=>{this.state.expanded&&this.delayedRedraw.call(this.draw)};draw=()=>{const{canvas:e,workspace:{model:t},width:n=y,height:i=b,backgroundFill:r=w,scrollablePaneFill:o=v}=this.props,s=e.metrics.getTransform();this.calculateTransform(s);const a=this.canvas.getContext("2d");if(a.fillStyle=r,a.clearRect(0,0,n,i),a.fillRect(0,0,n,i),0===t.elements.length)return;const l=(0,d.paneTopLeft)(s),u=c.Vector.add(l,(0,d.totalPaneSize)(s)),h=I(l,s,this.transform),p=I(u,s,this.transform);a.fillStyle=o,a.fillRect(h.x,h.y,p.x-h.x,p.y-h.y),a.save();const{clientWidth:g,clientHeight:f}=e.metrics.area,m=e.metrics.clientToScrollablePaneCoords(0,0),x=e.metrics.clientToScrollablePaneCoords(g,f),{x:k,y:S}=I(m,s,this.transform),{x:L,y:_}=I(x,s,this.transform),M={x:k,y:S,width:L-k,height:_-S};this.fillViewport(a,M),this.drawElements(a,s),this.strokeViewport(a,M),a.restore()};drawElements(e,t){const{canvas:n,workspace:{model:i}}=this.props;i.elements.forEach((i=>{const{x:r,y:o,width:s,height:a}=(0,c.boundsOf)(i,n.renderingState);e.fillStyle=this.chooseElementColor(i);const{x:l,y:d}=T({x:r,y:o},t,this.transform),{x:u,y:h}=T({x:r+s,y:o+a},t,this.transform);e.fillRect(l,d,u-l,h-d)}))}chooseElementColor(e){const{canvas:t,workspace:{getElementStyle:n}}=this.props,{highlighter:i}=t.renderingState.shared;if(i&&!i(e))return"lightgray";const{color:r}=n(e);return r}fillViewport(e,t){const{viewportFill:n=k}=this.props;e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)}strokeViewport(e,t){const{width:n=y,height:i=b,viewportStroke:r=S,overflowStroke:o=L}=this.props,{x:s,y:a}=t,l=s+t.width,c=a+t.height;if(M(e,r),e.strokeRect(s,a,l-s,c-a),e.beginPath(),s<0){const t=e.lineWidth;e.moveTo(t,a),e.lineTo(t,c)}if(a<0){const t=e.lineWidth;e.moveTo(s,t),e.lineTo(l,t)}if(l>n){const t=n-e.lineWidth;e.moveTo(t,a),e.lineTo(t,c)}if(c>i){const t=i-e.lineWidth;e.moveTo(s,t),e.lineTo(l,t)}M(e,o),e.stroke()}calculateTransform(e){const{canvas:t,workspace:{model:n},width:i=y,height:r=b,scalePadding:o=x}=this.props,s=(0,c.getContentFittingBox)(n.elements,n.links,t.renderingState),a=Math.max(s.width,i/.25)*o,l=Math.max(s.height,r/.25)*o,u=(0,d.paneFromPaperCoords)({x:s.x-a,y:s.y-l},e),h=(0,d.paneFromPaperCoords)({x:s.x+s.width+a,y:s.y+s.height+l},e),p=h.x-u.x,g=h.y-u.y,f=Math.min(i/p,r/g),m={x:(i-p*f)/2,y:(r-g*f)/2};this.transform={scale:f,canvasOffset:m,paneOffset:u}}canvasFromPageCoords(e,t){const{top:n,left:i}=this.canvas.getBoundingClientRect();return{x:e-i-window.scrollX,y:t-n-window.scrollY}}onCheckSize=()=>{const{canvas:e,autoCollapseFraction:t=m,width:n=y,height:i=b}=this.props,{expanded:r,autoToggle:o,allowExpand:s}=this.state,{clientWidth:a,clientHeight:l}=e.metrics.area,c=n<.9*a&&i<.9*l,d=c&&n<a*t&&i<l*t;o&&r!==d?this.setState({expanded:d,allowExpand:c},this.scheduleRedraw):c!==s&&this.setState({allowExpand:c})};render(){const{dock:e="se",dockOffsetX:t,dockOffsetY:n,width:r=y,height:o=b}=this.props,{expanded:s,allowExpand:a}=this.state,l=s&&a;return(0,i.jsx)(h.ViewportDock,{dock:e,dockOffsetX:t,dockOffsetY:n,children:(0,i.jsxs)("div",{className:`${g} ${g}--${l?"expanded":"collapsed"}`,style:l?{width:r,height:o}:void 0,children:[(0,i.jsx)("canvas",{ref:this.onCanvasMount,width:r,height:o,onMouseDown:e=>{this.startDragViewport(),this.onDragViewport(e)},onWheel:this.onWheel}),(0,i.jsx)("button",{type:"button",className:`${g}__toggle`,title:s?"Collapse navigator":"Expand navigator",disabled:!a,onClick:this.onToggleClick,children:(0,i.jsx)("div",{className:`${g}__toggle-icon`})})]})})}onCanvasMount=e=>{this.canvas=e};startDragViewport(){this.isDraggingViewport||(this.isDraggingViewport=!0,document.addEventListener("mousemove",this.onDragViewport),document.addEventListener("mouseup",this.onMouseUp))}stopDragViewport(){this.isDraggingViewport&&(this.isDraggingViewport=!1,document.removeEventListener("mousemove",this.onDragViewport),document.removeEventListener("mouseup",this.onMouseUp))}onDragViewport=e=>{if(e.preventDefault(),this.isDraggingViewport){const{canvas:t}=this.props,n=function(e,t,n){const i={x:n.paneOffset.x+(e.x-n.canvasOffset.x)/n.scale,y:n.paneOffset.y+(e.y-n.canvasOffset.y)/n.scale};return(0,d.paperFromPaneCoords)(i,t)}(this.canvasFromPageCoords(e.pageX,e.pageY),t.metrics.getTransform(),this.transform);t.centerTo(n)}};onMouseUp=()=>{this.stopDragViewport()};onWheel=e=>{e.preventDefault();const{canvas:t}=this.props,n=Math.max(-1,Math.min(1,e.deltaY||e.deltaX));t.zoomBy(.1*-n)};onToggleClick=()=>{this.setState((e=>({expanded:!e.expanded,autoToggle:!1})),this.scheduleRedraw)}}function M(e,t){const{color:n="transparent",width:i=1,dash:r=[]}=t;e.strokeStyle=n,e.lineWidth=i,e.setLineDash(r)}function I(e,t,n){return{x:n.canvasOffset.x+(e.x-n.paneOffset.x)*n.scale,y:n.canvasOffset.y+(e.y-n.paneOffset.y)*n.scale}}function T(e,t,n){return I((0,d.paneFromPaperCoords)(e,t),0,n)}(0,l.defineCanvasWidget)(p,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{Selection:()=>g});var i=n(102),r=n(61),o=n(57),s=n(58),a=n(60),l=n(90),c=n(91),d=n(96),u=n(93),h=n(165);const p="reactodia-selection";function g(e){const{model:t,canvas:n}=(0,l.useCanvas)(),c=(0,a.useEventStore)(t.events,"changeSelection"),u=(0,a.useSyncStoreWithComparator)(c,(()=>t.selection.filter((e=>e instanceof d.Element))),o.shallowArrayEqual),[h,p]=r.useState();return r.useEffect((()=>{let e;const i=new s.EventObserver;let r;i.listen(n.events,"pointerDown",(t=>{const i="selection"!==t.source.pointerMode,r=t.sourceEvent.shiftKey===i;if(!t.target&&!t.panning&&r){t.sourceEvent.preventDefault();const{pageX:i,pageY:r}=t.sourceEvent;e={pageX:i,pageY:r},p(f(e,e,n.metrics)),o()}}));const o=()=>{r?.stopListening(),r=new s.EventObserver,r.listen(n.events,"pointerMove",(t=>{const{pageX:i,pageY:r}=t.sourceEvent;e&&p(f(e,{pageX:i,pageY:r},n.metrics))}))};return i.listen(n.events,"pointerUp",(i=>{const{pageX:o,pageY:s}=i.sourceEvent;if(r?.stopListening(),p(void 0),i.triggerAsClick){const e="selection"!==i.source.pointerMode;(i.sourceEvent.shiftKey===e||t.selection.length>1)&&i.target instanceof d.Element&&(i.sourceEvent.preventDefault(),y(i.target,t))}else if(e){!function(e,t,n){const i=new Set(t.selection),r=Array.from(m(t.elements,e,i,n.renderingState));r.length>0&&t.setSelection([...t.selection,...r])}(f(e,{pageX:o,pageY:s},n.metrics),t,n)}e=void 0})),()=>{i.stopListening(),r?.stopListening()}}),[]),h||u.length>1?(0,i.jsx)(b,{...e,model:t,canvas:n,selectedElements:u,highlightedBox:h}):null}function f(e,t,n){const{x:i,y:r}=n.pageToPaperCoords(e.pageX,e.pageY),{x:o,y:s}=n.pageToPaperCoords(t.pageX,t.pageY);return{x:Math.min(i,o),y:Math.min(r,s),width:Math.abs(o-i),height:Math.abs(s-r)}}function*m(e,t,n,i){for(const r of e){const e=(0,u.boundsOf)(r,i);!n.has(r)&&u.Rect.intersects(t,e)&&(yield r)}}function y(e,t){const{selection:n}=t,i=n.includes(e)?n.filter((t=>t!=e)):[...n,e];t.setSelection(i)}function b(e){const{model:t,canvas:n,selectedElements:o,highlightedBox:l,boxMargin:c=5,itemMargin:d=2,connectionsMenuCommands:g,children:f}=e,y=function(e,t,n){return r.useCallback((i=>{if(0===n.length)return()=>{};const r=new Set(n),o=new s.EventObserver;return o.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&r.has(e.changePosition.source)&&i()})),o.listen(t.renderingState.events,"changeElementSize",(e=>{r.has(e.source)&&i()})),()=>o.stopListening()}),[e.events,t.renderingState.events,n])}(t,n,o),b=(0,a.useFrameDebouncedStore)(y),v=x((0,a.useSyncStoreWithComparator)(b,(()=>(0,u.getContentFittingBox)(o,[],n.renderingState)),u.Rect.equals),c,n.metrics),k=l?Array.from(m(t.elements,l,new Set(o),n.renderingState)):[],S=r.useRef();S.current||(S.current=new w(n,t));const L=S.current;return L.setElements(o),(0,i.jsxs)("div",{className:p,children:[o.length>1?(0,i.jsxs)(i.Fragment,{children:[o.map((e=>(0,i.jsx)("div",{className:`${p}__selectedItem`,style:x((0,u.boundsOf)(e,n.renderingState),d,n.metrics)},e.id))),(0,i.jsx)("div",{className:`${p}__selectedActions`,style:v,children:f??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.SelectionActionZoomToFit,{dock:"nw",dockColumn:1}),(0,i.jsx)(h.SelectionActionLayout,{dock:"nw",dockColumn:2}),(0,i.jsx)(h.SelectionActionGroup,{dock:"nw",dockColumn:3}),(0,i.jsx)(h.SelectionActionRemove,{dock:"ne"}),(0,i.jsx)(h.SelectionActionConnections,{dock:"e",commands:g}),(0,i.jsx)(h.SelectionActionExpand,{dock:"s"})]})}),(0,i.jsx)("div",{className:`${p}__selectedBox`,style:v,onClick:L.onClick,onPointerDown:L.onPointerDown,onPointerMove:L.onPointerMove,onPointerUp:L.onPointerUp,onPointerCancel:L.onPointerUp})]}):null,l?(0,i.jsx)("div",{className:`${p}__highlightedBox`,style:x(l,0,n.metrics)}):null,k.map((e=>(0,i.jsx)("div",{className:`${p}__highlightedItem`,style:x((0,u.boundsOf)(e,n.renderingState),d,n.metrics)},e.id)))]})}function x(e,t,n){const{x:i,y:r}=n.paperToScrollablePaneCoords(e.x,e.y),{x:o,y:s}=n.paperToScrollablePaneCoords(e.x+e.width,e.y+e.height);return{left:i-t,top:r-t,width:o-i+2*t,height:s-r+2*t}}(0,c.defineCanvasWidget)(g,(e=>({element:e,attachment:"overElements"})));class w{canvas;model;elements=[];moveState;constructor(e,t){this.canvas=e,this.model=t}setElements(e){this.elements=e}onClick=e=>{if(this.isToggleSelectionEvent(e)){e.preventDefault();const t=this.canvas.metrics.pageToPaperCoords(e.pageX,e.pageY),n=(0,u.findElementAtPoint)(this.model.elements,t,this.canvas.renderingState);n&&y(n,this.model)}};onPointerDown=e=>{const{canvas:t,elements:n}=this;if(this.isToggleSelectionEvent(e))return;e.preventDefault(),e.currentTarget.setPointerCapture(e.pointerId);const i=t.metrics.pageToPaperCoords(e.pageX,e.pageY),r=new Map;for(const o of n)r.set(o,o.position);this.moveState={origin:i,positions:r}};isToggleSelectionEvent(e){return e.shiftKey}onPointerMove=e=>{const{canvas:t,moveState:n}=this;if(n){e.preventDefault();const{x:i,y:r}=t.metrics.pageToPaperCoords(e.pageX,e.pageY),o=i-n.origin.x,s=r-n.origin.y;for(const[e,t]of n.positions)e.setPosition({x:t.x+o,y:t.y+s});t.renderingState.syncUpdate()}};onPointerUp=e=>{this.moveState&&(e.preventDefault(),this.moveState=void 0)}}},(e,t,n)=>{n.r(t),n.d(t,{Toolbar:()=>d});var i=n(102),r=n(106),o=n.n(r),s=n(91),a=n(147),l=n(153);const c="reactodia-toolbar";function d(e){const{dock:t,dockOffsetX:n,dockOffsetY:r,menu:s,children:d}=e;return(0,i.jsx)(l.ViewportDock,{dock:t,dockOffsetX:n,dockOffsetY:r,children:(0,i.jsxs)("div",{className:c,children:[s?(0,i.jsx)(a.DropdownMenu,{className:`${c}__menu`,title:"Open menu",children:s}):null,d?(0,i.jsx)("div",{className:o()(`${c}__quick-access-group`,"reactodia-btn-group","reactodia-btn-group-sm"),children:d}):null]})})}(0,s.defineCanvasWidget)(d,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{ToolbarAction:()=>f,ToolbarActionClearAll:()=>b,ToolbarActionExport:()=>x,ToolbarActionLayout:()=>k,ToolbarActionOpen:()=>m,ToolbarActionRedo:()=>v,ToolbarActionSave:()=>y,ToolbarActionUndo:()=>w,ToolbarLanguageSelector:()=>S});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(176),l=n(60),c=n(90),d=n(161),u=n(114),h=n(147),p=n(130);const g="reactodia-toolbar-action";function f(e){const{className:t,title:n,disabled:r,onSelect:o,children:a}=e;return(0,h.useInsideDropdown)()?(0,i.jsx)(h.DropdownMenuItem,{className:t,title:n,disabled:r,onSelect:o,children:a}):(0,i.jsx)("button",{type:"button",className:s()(t,"reactodia-btn reactodia-btn-default"),title:n,disabled:r,onClick:o,children:a})}function m(e){const{className:t,fileAccept:n,onSelect:o,children:a,...l}=e,c=r.useRef(null);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.DropdownMenuItem,{...l,className:s()(t,`${g}__open`),onSelect:()=>{c.current?.click()},children:a}),(0,i.jsx)("input",{ref:c,type:"file",className:`${g}__open-input`,accept:n,onChange:e=>{if(e.currentTarget.files){const t=e.currentTarget.files[0];o(t)}}})]})}function y(e){const{className:t,mode:n,onSelect:r,children:o,...a}=e,{model:c,editor:d}=(0,p.useWorkspace)(),f=(0,l.useObservedProperty)(c.history.events,"historyChanged",(()=>c.history.undoStack.length>0)),m=(0,l.useObservedProperty)(d.events,"changeAuthoringState",(()=>!u.AuthoringState.isEmpty(d.authoringState)));let y=!0;return"layout"===n?y=f&&!m:"authoring"===n&&(y=m),(0,i.jsx)(h.DropdownMenuItem,{...a,className:s()(t,`${g}__save`),disabled:!y,onSelect:r,children:o})}function b(e){const{className:t,title:n,...r}=e,{model:o,editor:a}=(0,p.useWorkspace)();return(0,i.jsx)(f,{...r,className:s()(t,`${g}__clear-all`),title:n??"Remove all elements and links from the diagram",onSelect:()=>{const e=o.history.startBatch("Clear all");a.removeItems([...o.elements]),e.store()},children:"Clear All"})}function x(e){const{className:t,title:n,kind:r,fileName:o="diagram",rasterOptions:l,...u}=e,{canvas:h}=(0,c.useCanvas)();return"exportRaster"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__export-image`),title:n??"Export the diagram as a PNG image",onSelect:()=>{const e=l??{backgroundColor:"white"};h.exportRaster(e).then((e=>{const t=(0,d.dataURLToBlob)(e);(0,a.saveAs)(t,`${o}.png`)}))},children:"Export as PNG"}):"exportSvg"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__export-image`),title:n??"Export the diagram as an SVG image",onSelect:()=>{h.exportSvg({addXmlHeader:!0}).then((e=>{const t=new Blob([e],{type:"image/svg+xml"});(0,a.saveAs)(t,`${o}.svg`)}))},children:"Export as SVG"}):"print"===r?(0,i.jsx)(f,{...u,className:s()(t,`${g}__print`),title:n??"Print the diagram",onSelect:()=>{const e=window.open("",void 0,"width=1280,height=720");h.exportSvg().then((t=>{e.document.write(t),e.document.close(),e.print()}))},children:"Print"}):null}function w(e){const{className:t,title:n,...r}=e,{model:{history:o}}=(0,c.useCanvas)(),a=(0,h.useInsideDropdown)(),d=(0,l.useObservedProperty)(o.events,"historyChanged",(()=>{const{undoStack:e}=o;return 0===e.length?void 0:e[e.length-1]}));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__undo`),disabled:!d,title:n??(d&&d.title?`Undo: ${d.title}`:"Undo last command"),onSelect:()=>o.undo(),children:a?"Undo":null})}function v(e){const{className:t,title:n,...r}=e,{model:{history:o}}=(0,c.useCanvas)(),a=(0,h.useInsideDropdown)(),d=(0,l.useObservedProperty)(o.events,"historyChanged",(()=>{const{redoStack:e}=o;return 0===o.redoStack.length?void 0:e[e.length-1]}));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__redo`),disabled:!d,title:n??(d&&d.title?`Redo: ${d.title}`:"Redo last command"),onSelect:()=>o.redo(),children:a?"Redo":null})}function k(e){const{className:t,title:n,...r}=e,{performLayout:o}=(0,p.useWorkspace)(),{model:a,canvas:d}=(0,c.useCanvas)(),u=(0,l.useObservedProperty)(a.events,"changeCells",(()=>a.elements.length));return(0,i.jsx)(f,{...r,className:s()(t,`${g}__layout`),title:n??"Layout diagram using force-directed algorithm",disabled:0===u,onSelect:()=>{o({canvas:d,animate:!0})},children:"Layout"})}function S(e){const{className:t,title:n,languages:r}=e,{model:o}=(0,c.useCanvas)(),a=(0,l.useObservedProperty)(o.events,"changeLanguage",(()=>o.language));return 0===r.length?null:(0,i.jsxs)("div",{className:s()(t,`${g}__language-selector`),title:n??"Select language for the data (labels, properties, etc)",children:[(0,i.jsx)("label",{htmlFor:"reactodia-language-selector"}),(0,i.jsx)("select",{id:"reactodia-language-selector",value:a,onChange:e=>o.setLanguage(e.currentTarget.value),children:r.map((({code:e,label:t})=>(0,i.jsx)("option",{value:e,children:t},e)))})]})}},e=>{e.exports=be},(e,t,n)=>{n.r(t),n.d(t,{SearchSectionElementTypes:()=>i.SearchSectionElementTypes,SearchSectionEntities:()=>i.SearchSectionEntities,SearchSectionLinkTypes:()=>i.SearchSectionLinkTypes,UnifiedSearch:()=>o.UnifiedSearch,useUnifiedSearchSection:()=>r.useUnifiedSearchSection});var i=n(178),r=n(179),o=n(180)},(e,t,n)=>{n.r(t),n.d(t,{SearchSectionElementTypes:()=>u,SearchSectionEntities:()=>p,SearchSectionLinkTypes:()=>m});var i=n(102),r=n(61),o=n(58),s=n(154),a=n(169),l=n(171),c=n(179);const d="reactodia-search-section-element-types";function u(e){const{searchTimeout:t=200,minSearchTermLength:n=2,instancesSearchCommands:r}=e,{searchStore:o,shouldRender:a}=(0,c.useUnifiedSearchSection)({searchTimeout:t,allowSubmit:e=>e.length>=n});return a?(0,i.jsx)(s.ClassTree,{className:d,searchStore:o,instancesSearchCommands:r}):null}const h="reactodia-search-section-entities";function p(e){const{searchTimeout:t=600,minSearchTermLength:n=3,instancesSearchCommands:s}=e,{shouldRender:l,setSectionActive:d,searchStore:u}=(0,c.useUnifiedSearchSection)({searchTimeout:t,allowSubmit:e=>e.length>=n});return r.useEffect((()=>{if(s){const e=new o.EventObserver;return e.listen(s,"setCriteria",(({criteria:e})=>{d(!0,g(e))})),()=>e.stopListening()}}),[l,s]),(0,i.jsx)(a.InstancesSearch,{className:h,searchStore:u,onChangeCriteria:e=>{l&&d(!0,g(e))},onAddElements:()=>{d(!1)},commands:s})}function g(e){return e.text||e.elementType||e.refElement?e:void 0}const f="reactodia-search-section-link-types";function m(e){const{searchTimeout:t=200,minSearchTermLength:n=1,instancesSearchCommands:r}=e,{shouldRender:o,isSectionActive:s,searchStore:a}=(0,c.useUnifiedSearchSection)({searchTimeout:t,allowSubmit:e=>e.length>=n});return o?(0,i.jsx)(l.LinkTypesToolbox,{className:f,trackSelected:s,searchStore:a,instancesSearchCommands:r}):null}},(e,t,n)=>{n.r(t),n.d(t,{UnifiedSearchSectionContext:()=>s,useUnifiedSearchSection:()=>a});var i=n(61),r=n(58),o=n(151);const s=i.createContext(null);function a(e={}){const t=i.useContext(s);if(!t)throw new Error("Missing Reactodia unified search section context");const{searchStore:n,isSectionActive:a,setSectionActive:l}=t,[c,d]=i.useState(a),{searchTimeout:u=0,allowSubmit:h}=e,p=(0,o.useSearchInputStore)({initialValue:n.value,submitTimeout:u,allowSubmit:h});return i.useLayoutEffect((()=>{if(a){d(!0);const e=new r.EventObserver;return e.listen(n.events,"changeValue",(({source:e,action:t})=>{p.change({value:e.value,action:t})})),p.change({value:n.value,action:"submit"}),()=>e.stopListening()}}),[a]),i.useEffect((()=>{c&&p.change({value:n.value,action:"submit"})}),[c]),{shouldRender:c,isSectionActive:a,setSectionActive:l,searchStore:p}}},(e,t,n)=>{n.r(t),n.d(t,{UnifiedSearch:()=>m});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(60),l=n(67),c=n(90),d=n(147),u=n(151),h=n(153),p=n(128),g=n(179);const f="reactodia-unified-search";function m(e){const{sections:t,commands:n,defaultWidth:o=300,defaultHeight:s=350,minWidth:l=200,minHeight:c=150,offsetWithMaxWidth:h=20,offsetWithMaxHeight:p=20}=e,[g,m]=r.useState(!1),[w,v]=r.useState(y.empty),k=(0,u.useSearchInputStore)({initialValue:""}),S=(0,a.useObservedProperty)(k.events,"changeValue",(()=>k.value));r.useEffect((()=>{const e=()=>{v(w.deactivate()),m(!1)};return k.events.on("clearSearch",e),()=>k.events.off("clearSearch",e)}),[k,w,v,m]);const[L,_]=r.useState({width:o,height:s}),M=r.useRef({width:1/0,height:1/0}),I={width:Math.min(L.width,M.current.width),height:Math.min(L.height,M.current.height)},T=r.useMemo((()=>t.map((e=>({...e,context:{searchStore:k,isSectionActive:e.key===w?.key,setSectionActive:(t,n)=>{t?(v(w.activate(e.key,n)),m(!0)):(v(w.deactivate()),m(!1))}}})))),[t,k,w,v,m]),E=r.useRef(null);r.useEffect((()=>{if(n){const e=({sectionKey:e})=>{e&&(t.some((t=>t.key===e))?v(w.activate(e)):console.warn(`Unified search: cannot activate section that does not exists: ${e}`)),E.current?.focus()};return n.on("focus",e),()=>n.off("focus",e)}}),[n,t,w,m,v]);const j=S.length>0||void 0!==w.getSearchExtra(),N=r.useCallback((()=>{j||m(!1)}),[j,m]);return(0,i.jsx)(d.Dropdown,{className:f,expanded:g,onClickOutside:N,toggle:(0,i.jsx)(b,{inputRef:E,searchTerm:S,setSearchTerm:e=>k.change({value:e,action:"input"}),onSubmit:()=>{},onClear:j?()=>k.change({value:"",action:"clear"}):void 0,expanded:g,setExpanded:e=>{if(e){if(void 0===w.key){const e=t.some((e=>e.key===w.previousActive))?w.previousActive:t.length>0?t[0].key:void 0;e&&v(w.activate(e))}}else v(w.deactivate());m(e)},minWidth:l,panelSize:I}),children:(0,i.jsx)(x,{sections:T,activeSectionKey:w.key,onActivateSection:e=>v(w.switch(e)),size:I,minSize:{width:l,height:c},offsetForMaxSize:{x:h,y:p},onResize:e=>{const t={width:Math.max(e.width,l),height:Math.max(e.height,c)};L.width===t.width&&L.height===t.height||_(t)},setMaxSize:e=>{M.current=e,(L.width>e.width||L.height>e.height)&&_({...L})}})})}class y{key;previousActive;searchExtras;static empty=new y(void 0,void 0,{});constructor(e,t,n){this.key=e,this.previousActive=t,this.searchExtras=n}getSearchExtra(){const{key:e,searchExtras:t}=this;if(void 0!==e&&Object.prototype.hasOwnProperty.call(t,e))return t[e]}activate(e,t){if(this.key===e&&this.getSearchExtra()===t)return this;const n=this.key===e?this.previousActive:this.key,i={...this.searchExtras,[e]:t};return new y(e,n,i)}deactivate(){return new y(void 0,this.key,this.searchExtras)}switch(e){return this.key===e?this:new y(e,this.key,this.searchExtras)}}function b(e){const{inputRef:t,searchTerm:n,setSearchTerm:r,onSubmit:o,onClear:a,expanded:l,setExpanded:c,minWidth:d,panelSize:u}=e;return(0,i.jsxs)("div",{className:s()(`${f}__toggle`),style:{width:u?.width},children:[(0,i.jsx)("input",{ref:t,type:"text",className:`${f}__search-input`,style:{minWidth:d},placeholder:"Search for...",name:"reactodia-search",value:n,onClick:()=>c(!0),onFocus:()=>c(!0),onChange:e=>r(e.currentTarget.value),onKeyUp:e=>{switch(e.key){case"Enter":n.length>0&&c(!0),o();break;case"Escape":a?a():c(!1);break;default:c(!0)}}}),a?(0,i.jsx)("button",{type:"button",title:"Clear",className:`${f}__clear-button`,onClick:a}):l?(0,i.jsx)("button",{type:"button",title:"Close",className:`${f}__collapse-button`,onClick:()=>c(!1)}):(0,i.jsx)("div",{className:`${f}__search-icon`,onClick:()=>t.current?.focus()})]})}function x(e){const{sections:t,activeSectionKey:n,onActivateSection:o,size:a,minSize:d,offsetForMaxSize:u,onResize:m,setMaxSize:y}=e,{canvas:b}=(0,c.useCanvas)(),x=r.useRef(null),w=r.useRef(),v=()=>{if(!x.current)return;const{x:e,y:t,width:n,height:i}=x.current.getBoundingClientRect(),r=e+window.scrollX,o=t+window.scrollY,[s]=(0,h.getParentDockAlignment)(x.current),a=b.metrics.getViewportPageRect();w.current={bounds:{x:r,y:o,width:n,height:i},centeredByX:"center"===s,centerOffsetX:Math.max(2*r+n-2*a.x-a.width,0)}};!function(e){const{canvas:t}=(0,c.useCanvas)(),n=r.useRef();r.useLayoutEffect((()=>{n.current=e})),r.useLayoutEffect((()=>{const e=new l.Debouncer,i=()=>{const t=n.current;t&&e.call(t)};return t.events.on("resize",i),n.current?.(),()=>{e.dispose(),t.events.off("resize",i)}}),[])}((()=>{if(w.current||v(),w.current){const{bounds:e,centeredByX:t,centerOffsetX:n}=w.current,i=b.metrics.getViewportPageRect(),r=i.x+i.width,o=i.y+i.height;let s;s=t?i.width-n-u.x:r-e.x-u.x;const a=Math.max(s,d.width),l=Math.max(o-e.y-u.y,d.height);y({width:a,height:l})}}));const k=(e,t,n)=>{if(w.current){const{bounds:e,centeredByX:i}=w.current;m({width:e.width+t*(i?2:1),height:e.height+n})}};return(0,i.jsxs)("div",{ref:x,className:`${f}__panel`,style:{width:a.width,height:a.height},children:[(0,i.jsx)("div",{className:`${f}__section-tabs`,children:t.map((e=>(0,i.jsx)("button",{className:s()(`${f}__section-tab`,"reactodia-btn-default",e.key===n?"active":void 0),onClick:()=>o(e.key),children:e.label},e.key)))}),t.map((e=>(0,i.jsx)(g.UnifiedSearchSectionContext.Provider,{value:e.context,children:(0,i.jsx)("div",{className:s()(`${f}__section`,e.context.isSectionActive?`${f}__section--active`:void 0),children:e.component})},e.key))),(0,i.jsx)(p.DraggableHandle,{axis:"y",className:`${f}__bottom-handle`,onBeginDragHandle:v,onDragHandle:k}),(0,i.jsx)(p.DraggableHandle,{axis:"x",className:`${f}__right-handle`,onBeginDragHandle:v,onDragHandle:k}),(0,i.jsx)(p.DraggableHandle,{axis:"all",className:`${f}__corner-handle`,onBeginDragHandle:v,onDragHandle:k})]})}},(e,t,n)=>{n.r(t),n.d(t,{VisualAuthoring:()=>r.VisualAuthoring,useAuthoredEntity:()=>i.useAuthoredEntity});var i=n(135),r=n(182)},(e,t,n)=>{n.r(t),n.d(t,{VisualAuthoring:()=>x});var i=n(102),r=n(61),o=n(58),s=n(68),a=n(91),l=n(114),c=n(115),d=n(119),u=n(183),h=n(185),p=n(186),g=n(188),f=n(130),m=n(189),y=n(190),b=n(191);function x(e){const{propertyEditor:t}=e,{model:n,view:a,editor:x,overlay:w}=(0,f.useWorkspace)();return r.useLayoutEffect((()=>{const e=new o.EventObserver;a.setCanvasWidget("states",{element:(0,i.jsx)(b.LinkStateWidget,{}),attachment:"overLinks"});const t=e=>{if(e instanceof d.EntityElement)return(0,i.jsx)(y.ElementDecorator,{target:e,position:e.position})},n=()=>{a._setElementDecorator(x.inAuthoringMode?t:void 0)};return e.listen(x.events,"changeMode",(()=>n())),n(),e.listen(w.events,"changeOpenedDialog",(({previous:e})=>{e&&e.target&&x.removeTemporaryCells([e.target])})),()=>{e.stopListening(),a.setCanvasWidget("states",null),a._setElementDecorator(void 0)}}),[]),r.useLayoutEffect((()=>{const e=new o.EventObserver;return e.listen(x.authoringCommands,"startDragEdit",(({operation:e})=>{const t=(0,i.jsx)(m.EditLayer,{operation:e,onFinishEditing:()=>{a.setCanvasWidget("editLayer",null)}});a.setCanvasWidget("editLayer",{element:t,attachment:"overElements"})})),e.listen(x.authoringCommands,"editEntity",(({target:e})=>{const n=t=>{w.hideDialog(),x.changeEntity(e.data.id,t)};let r=e.data;const o=x.authoringState.elements.get(e.data.id);o&&"entityChange"==o.type&&o.newIri&&(r={...e.data,id:o.newIri});const s=()=>w.hideDialog(),a=t?t({elementData:e.data,onSubmit:n,onCancel:s}):(0,i.jsx)(h.EditEntityForm,{entity:r,onApply:n,onCancel:s});w.showDialog({target:e,dialogType:c.BuiltinDialogType.editEntity,style:{caption:"Edit entity"},content:a,holdSelection:!0})})),e.listen(x.authoringCommands,"findOrCreateEntity",(e=>{const{link:t,source:n,target:r,targetIsNew:o}=e,s=(0,i.jsx)(p.FindOrCreateEntityForm,{source:n,target:r,initialTargetIsNew:o,originalLink:t,onAfterApply:()=>{w.hideDialog(),l.AuthoringState.isAddedEntity(x.authoringState,r.iri)&&x.authoringCommands.trigger("editEntity",{target:r})},onCancel:()=>w.hideDialog()});w.showDialog({target:r,dialogType:c.BuiltinDialogType.findOrCreateEntity,style:{caption:"Establish New Connection",minSize:{width:250,height:320}},content:s,onClose:()=>x.removeAllTemporaryCells()})})),e.listen(x.authoringCommands,"editRelation",(({target:e})=>{const t=n.getElement(e.sourceId).data,r=n.getElement(e.targetId).data,o=(0,i.jsx)(u.EditRelationForm,{link:e.data,source:t,target:r,onChange:t=>{if(x.temporaryState.links.has(e.data)){w.hideDialog();const n=e.withDirection(t),i=x.createRelation(n,{temporary:!0});x.authoringCommands.trigger("editRelation",{target:i})}},onApply:t=>{if(x.temporaryState.links.has(e.data)){x.removeTemporaryCells([e]);const n=e.withDirection(t);x.createRelation(n)}else(0,s.equalLinks)(e.data,t)&&(0,s.equalProperties)(e.data.properties,t.properties)||x.changeRelation(e.data,t);w.hideDialog()},onCancel:()=>w.hideDialog()}),a=x.temporaryState.links.has(e.data)?"Establish new relation":"Edit relation";w.showDialog({target:e,dialogType:c.BuiltinDialogType.editRelation,style:{defaultSize:{width:300,height:180},resizableBy:"x",caption:a},content:o,onClose:()=>x.removeTemporaryCells([e])})})),e.listen(x.authoringCommands,"renameLink",(({target:e})=>{const t={width:300,height:165};w.showDialog({target:e,dialogType:c.BuiltinDialogType.renameLink,style:{defaultSize:t,resizableBy:"x",caption:"Rename Link",offset:{x:25,y:-t.height/2},calculatePosition:t=>{const n=t.renderingState.getLinkLabelBounds(e);if(n){const{x:e,y:t,width:i,height:r}=n;return{x:e+i,y:t+r/2}}}},content:(0,i.jsx)(g.RenameLinkForm,{link:e,onFinish:()=>w.hideDialog()})})})),()=>e.stopListening()}),[]),null}(0,a.defineCanvasWidget)(x,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{EditRelationForm:()=>d});var i=n(102),r=n(61),o=n(68),s=n(150),a=n(130),l=n(184);const c="reactodia-form";class d extends r.Component{static contextType=a.WorkspaceContext;validationCancellation=new AbortController;constructor(e,t){super(e,t),this.state={linkValue:{value:{link:e.link,direction:"out"},validated:!0,allowChange:!0}}}componentDidMount(){this.validate()}componentDidUpdate(e,t){const{linkValue:n}=this.state;(0,o.equalLinks)(n.value.link,t.linkValue.value.link)||this.validate(),n!==t.linkValue&&n.validated&&n.allowChange&&this.props.onChange(n.value.link)}componentWillUnmount(){this.validationCancellation.abort()}validate(){const{link:e}=this.props,{linkValue:{value:t}}=this.state;this.setState({isValidating:!0}),this.validationCancellation.abort(),this.validationCancellation=new AbortController;const n=this.validationCancellation.signal;(0,l.validateLinkType)(t.link,e,this.context,n).then((e=>{n.aborted||this.setState((({linkValue:t})=>({linkValue:{...t,...e,validated:!0},isValidating:!1})))}))}render(){const{source:e,target:t}=this.props,{linkValue:n,isValidating:r}=this.state,o=!n.error;return(0,i.jsxs)("div",{className:c,children:[(0,i.jsxs)("div",{className:`${c}__body`,children:[(0,i.jsx)(l.LinkTypeSelector,{linkValue:n,source:e,target:t,onChange:e=>this.setState({linkValue:{value:e,error:void 0,validated:!1,allowChange:!1}})}),r?(0,i.jsx)("div",{className:`${c}__progress`,children:(0,i.jsx)(s.ProgressBar,{state:"loading",title:"Validating selected link type",height:10})}):null]}),(0,i.jsxs)("div",{className:`${c}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${c}__apply-button`,onClick:()=>this.props.onApply(n.value.link),disabled:!o||r,children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}}},(e,t,n)=>{n.r(t),n.d(t,{LinkTypeSelector:()=>p,validateLinkType:()=>g});var i=n(102),r=n(61),o=n(56),s=n(58),a=n(68),l=n(74),c=n(113),d=n(119),u=n(130);const h="reactodia-form";class p extends r.Component{static contextType=u.WorkspaceContext;listener=new s.EventObserver;cancellation=new AbortController;constructor(e,t){super(e,t),this.state={dataLinkTypes:[]}}updateAll=()=>this.forceUpdate();componentDidMount(){this.fetchPossibleLinkTypes()}componentDidUpdate(e){const{source:t,target:n}=this.props;e.source===t&&e.target===n||(this.setState({dataLinkTypes:void 0}),this.fetchPossibleLinkTypes())}componentWillUnmount(){this.listener.stopListening(),this.cancellation.abort()}async fetchPossibleLinkTypes(){const{model:e,editor:{metadataProvider:t}}=this.context,{source:n,target:i}=this.props;if(!t)return;const r=await(0,o.mapAbortedToNull)(t.canConnect(n,i,void 0,{signal:this.cancellation.signal}),this.cancellation.signal);if(null===r)return;const s=new Set,a=new Set;for(const{inLinks:o,outLinks:c}of r){for(const e of o)s.add(e);for(const e of c)a.add(e)}const l=[];for(const o of a)l.push({iri:o,direction:"out"});for(const o of s)l.push({iri:o,direction:"in"});l.sort(function(e){return(t,n)=>{const i=e.getLinkType(t.iri),r=e.getLinkType(n.iri),o=e.locale.formatLabel(i?.data?.label,t.iri),s=e.locale.formatLabel(r?.data?.label,n.iri),a=o.localeCompare(s);return 0!==a?a:"out"===t.direction&&"in"===n.direction?-1:"in"===t.direction&&"out"===n.direction?1:0}}(e)),this.setState({dataLinkTypes:l}),this.listenToLinkLabels(l.map((t=>e.createLinkType(t.iri))))}listenToLinkLabels(e){for(const t of e)this.listener.listen(t.events,"changeData",this.updateAll)}onChangeType=e=>{const{link:t,direction:n}=this.props.linkValue.value,i=parseInt(e.currentTarget.value,10),{iri:r,direction:o}=this.state.dataLinkTypes[i];let s={...t,linkTypeId:r};n!==o&&(s={...s,sourceId:t.targetId,targetId:t.sourceId}),this.props.onChange({link:s,direction:o})};renderPossibleLinkType=({iri:e,direction:t},n)=>{const{model:r}=this.context,{source:o,target:s}=this.props,a=r.getLinkType(e),l=r.locale.formatLabel(a?.data?.label,e);let[c,d]=[o,s].map((e=>r.locale.formatLabel(e.label,e.id)));return"in"===t&&([c,d]=[d,c]),(0,i.jsxs)("option",{value:n,children:[l," [",c," \u2192 ",d,"]"]},n)};render(){const{linkValue:e,disabled:t}=this.props,{dataLinkTypes:n}=this.state,r=(n??[]).findIndex((({iri:t,direction:n})=>t===e.value.link.linkTypeId&&n===e.value.direction));return(0,i.jsxs)("div",{className:`${h}__control-row`,children:[(0,i.jsx)("label",{children:"Relation Type"}),n?(0,i.jsxs)("select",{className:"reactodia-form-control",name:"reactodia-link-type-selector-select",value:r,onChange:this.onChangeType,disabled:t,children:[(0,i.jsx)("option",{value:-1,disabled:!0,children:"Select relation type"}),n.map(this.renderPossibleLinkType)]}):(0,i.jsx)("div",{children:(0,i.jsx)(c.HtmlSpinner,{width:20,height:20})}),e.error?(0,i.jsx)("span",{className:`${h}__control-error`,children:e.error}):""]})}}async function g(e,t,{model:n,editor:i},r){if(e.linkTypeId===l.PLACEHOLDER_LINK_TYPE)return{error:"Required.",allowChange:!0};if((0,a.equalLinks)(e,t))return{error:void 0,allowChange:!0};if(function(e,t){for(const n of e.links)for(const e of(0,d.iterateRelationsOf)(n))if((0,a.equalLinks)(e,t))return!0;return!1}(n,e)&&!i.temporaryState.links.has(e))return{error:"The relation already exists.",allowChange:!1};return(await n.dataProvider.links({primary:[e.sourceId],secondary:[e.targetId],linkTypeIds:[e.linkTypeId],signal:r})).some((t=>(0,a.equalLinks)(t,e)))?{error:"The relation already exists.",allowChange:!1}:{error:void 0,allowChange:!0}}},(e,t,n)=>{n.r(t),n.d(t,{EditEntityForm:()=>a});var i=n(102),r=n(61),o=n(130);const s="reactodia-form";class a extends r.Component{static contextType=o.WorkspaceContext;constructor(e,t){super(e,t),this.state={elementModel:e.entity}}componentDidUpdate(e){this.props.entity!==e.entity&&this.setState({elementModel:this.props.entity})}renderProperty(e,t){const{model:n}=this.context,r=n.getPropertyType(e),o=n.locale.formatLabel(r?.data?.label,e);return(0,i.jsx)("div",{className:`${s}__row`,children:(0,i.jsxs)("label",{children:[o,t.map(((e,t)=>(0,i.jsx)("input",{name:"reactodia-edit-entity-property",className:"reactodia-form-control",defaultValue:e.value},t)))]})},e)}renderProperties(){const{properties:e}=this.props.entity,t=Object.keys(e);return(0,i.jsx)("div",{children:t.map((t=>this.renderProperty(t,e[t])))})}renderType(){const{model:e}=this.context,{elementModel:t}=this.state,n=e.locale.formatElementTypes(t.types).join(", ");return(0,i.jsxs)("label",{children:["Type",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-type",value:n,disabled:!0})]})}onChangeIri=e=>{const t=e.target.value;this.setState((e=>({elementModel:{...e.elementModel,id:t}})))};renderIri(){const{elementModel:e}=this.state;return(0,i.jsxs)("label",{children:["IRI",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-iri",defaultValue:e.id,onChange:this.onChangeIri})]})}onChangeLabel=e=>{const{model:t}=this.context,n=e.target,i=n.value.length>0?[t.factory.literal(n.value)]:[];this.setState({elementModel:{...this.state.elementModel,label:i}})};renderLabel(){const{model:e}=this.context,t=e.locale.selectLabel(this.state.elementModel.label),n=t?t.value:"";return(0,i.jsxs)("label",{children:["Label",(0,i.jsx)("input",{className:"reactodia-form-control",name:"reactodia-edit-entity-label",value:n,onChange:this.onChangeLabel})]})}render(){return(0,i.jsxs)("div",{className:s,children:[(0,i.jsxs)("div",{className:`reactodia-scrollable ${s}__body`,children:[(0,i.jsx)("div",{className:`${s}__row`,children:this.renderIri()}),(0,i.jsx)("div",{className:`${s}__row`,children:this.renderType()}),(0,i.jsx)("div",{className:`${s}__row`,children:this.renderLabel()}),this.renderProperties()]}),(0,i.jsxs)("div",{className:`${s}__controls`,children:[(0,i.jsx)("button",{type:"button",className:`reactodia-btn reactodia-btn-primary ${s}__apply-button`,onClick:()=>this.props.onApply(this.state.elementModel),children:"Apply"}),(0,i.jsx)("button",{type:"button",className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}}},(e,t,n)=>{n.r(t),n.d(t,{FindOrCreateEntityForm:()=>p});var i=n(102),r=n(61),o=n(113),s=n(114),a=n(119),l=n(150),c=n(130),d=n(187),u=n(184);const h="reactodia-form";class p extends r.Component{static contextType=c.WorkspaceContext;link;validationCancellation=new AbortController;constructor(e,t){super(e,t);const{target:n,initialTargetIsNew:i,originalLink:r}=this.props;this.link=r,this.state={elementValue:{value:n.data,isNew:i,loading:!1,validated:!0,allowChange:!0},linkValue:{value:{link:r.data,direction:"out"},validated:!0,allowChange:!0}}}componentDidMount(){this.validate()}componentWillUnmount(){this.validationCancellation.abort()}validate(){const{originalLink:e}=this.props,{elementValue:t,linkValue:n}=this.state;this.setState({isValidating:!0}),this.validationCancellation.abort(),this.validationCancellation=new AbortController;const i=this.validationCancellation.signal,r=(0,d.validateElementType)(t.value),o=(0,u.validateLinkType)(n.value.link,e.data,this.context,i);Promise.all([r,o]).then((([e,r])=>{i.aborted||(this.setState({isValidating:!1}),this.setElementOrLink({elementValue:{...t,...e,validated:!0},linkValue:{...n,...r,validated:!0}}))}))}render(){const{source:e,originalLink:t}=this.props,{elementValue:n,linkValue:r,isValidating:s}=this.state,a=!n.error&&!r.error;return(0,i.jsxs)("div",{className:h,children:[(0,i.jsxs)("div",{className:`${h}__body`,children:[(0,i.jsx)(d.ElementTypeSelector,{source:e.data,elementValue:n,onChange:e=>{this.setElementOrLink({elementValue:{value:e.value,isNew:e.isNew,loading:e.loading,error:void 0,validated:!1,allowChange:!1},linkValue:{value:{link:{...t.data,targetId:e.value.id},direction:"out"},validated:!1,allowChange:!1}})}}),n.loading?(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)(o.HtmlSpinner,{width:20,height:20}),"\xa0Loading entity..."]}):(0,i.jsx)(u.LinkTypeSelector,{linkValue:r,source:e.data,target:n.value,onChange:e=>this.setElementOrLink({linkValue:{value:e,error:void 0,validated:!1,allowChange:!1}}),disabled:void 0!==n.error}),s?(0,i.jsx)("div",{className:`${h}__progress`,children:(0,i.jsx)(l.ProgressBar,{state:"loading",title:"Validating selected element and link types",height:10})}):null]}),(0,i.jsxs)("div",{className:`${h}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${h}__apply-button`,onClick:this.onApply,disabled:n.loading||!a||s,children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:this.props.onCancel,children:"Cancel"})]})]})}setElementOrLink({elementValue:e,linkValue:t}){const{model:n,editor:i}=this.context;this.setState((n=>({elementValue:e||n.elementValue,linkValue:t||n.linkValue})),(()=>{const{source:e,target:t}=this.props,{elementValue:r,linkValue:o}=this.state;if((r&&!r.validated||o&&!o.validated)&&this.validate(),r&&r.validated&&r.allowChange){const e=t.data;let o=i.temporaryState;o=s.TemporaryState.removeEntity(o,e),o=s.TemporaryState.removeRelation(o,this.link.data),i.setTemporaryState(o);const l=n.history.startBatch();l.history.execute((0,a.changeEntityData)(n,t.iri,r.value)),l.discard(),o=s.TemporaryState.addEntity(o,t.data),o=s.TemporaryState.addRelation(o,this.link.data),i.setTemporaryState(o)}if(o&&o.validated&&o.allowChange){i.removeTemporaryCells([this.link]);const n=new a.RelationLink({sourceId:e.id,targetId:t.id,data:{...o.value.link,sourceId:e.iri,targetId:t.iri}}).withDirection(o.value.link);this.link=i.createRelation(n,{temporary:!0})}}))}onApply=()=>{const{model:e,editor:t}=this.context,{source:n,target:i,onAfterApply:r}=this.props,{elementValue:o,linkValue:l}=this.state,c=this.link;o.isNew||t.setTemporaryState(s.TemporaryState.removeEntity(t.temporaryState,o.value)),t.removeTemporaryCells([i,c]);const d=e.history.startBatch(o.isNew?"Create new entity":"Link to entity");o.isNew?(e.addElement(i),i.setExpanded(!0),t.setAuthoringState(s.AuthoringState.addEntity(t.authoringState,i.data))):e.requestLinks({addedElements:[o.value.id]});const u=new a.RelationLink({sourceId:n.id,targetId:i.id,data:{...c.data,sourceId:n.iri,targetId:i.iri}}).withDirection(l.value.link);t.createRelation(u),d.store(),r()}}},(e,t,n)=>{n.r(t),n.d(t,{ElementTypeSelector:()=>y,ElementTypeSelectorInner:()=>w,validateElementType:()=>v});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(56),l=n(58),c=n(74),d=n(113),u=n(119),h=n(148),p=n(156),g=n(151),f=n(169),m=n(130);function y(e){const t=(0,g.useSearchInputStore)({initialValue:"",submitTimeout:200}),n=(0,m.useWorkspace)();return(0,i.jsx)(w,{...e,searchStore:t,workspace:n})}const b="reactodia-element-selector",x="reactodia-form";class w extends r.Component{listener=new l.EventObserver;cancellation=new AbortController;filterCancellation=new AbortController;loadingItemCancellation=new AbortController;constructor(e){super(e),this.state={elementTypesState:"none",existingElements:[],existingElementsState:"none"}}componentDidMount(){const{searchStore:e,workspace:{model:t}}=this.props;this.listener.listen(t.events,"elementTypeEvent",(({data:e})=>{const{elementTypes:t}=this.state,n=e.changeData;n&&t&&t.includes(n.source.id)&&this.forceUpdate()})),this.listener.listen(e.events,"changeValue",(({source:e})=>{0===e.value.length?this.searchExistingElements(""):this.forceUpdate()})),this.listener.listen(e.events,"executeSearch",(({value:e})=>{this.searchExistingElements(e)})),this.fetchPossibleElementTypes()}componentWillUnmount(){this.listener.stopListening(),this.cancellation.abort(),this.filterCancellation.abort(),this.loadingItemCancellation.abort()}async fetchPossibleElementTypes(){const{source:e,workspace:{model:t,editor:{metadataProvider:n}}}=this.props;if(!n)return;const i=await(0,a.mapAbortedToNull)(n.canConnect(e,void 0,void 0,{signal:this.cancellation.signal}),this.cancellation.signal);if(null===i)return;const r=new Set;for(const{targetTypes:s}of i)for(const e of s)r.add(e);const o=Array.from(r).sort(function(e){return(t,n)=>{const i=e.getElementType(t),r=e.getElementType(n),o=e.locale.formatLabel(i?.data?.label,t),s=e.locale.formatLabel(r?.data?.label,n);return o.localeCompare(s)}}(t));this.setState({elementTypes:o})}async searchExistingElements(e){const{workspace:{model:t}}=this.props;if(this.filterCancellation.abort(),this.setState({existingElements:[],existingElementsState:"none"}),e.length>0){this.setState({existingElementsState:"loading"}),this.filterCancellation=new AbortController;const i=this.filterCancellation.signal,r=(0,f.createRequest)({text:e});let o;try{if(o=await(0,a.mapAbortedToNull)(t.dataProvider.lookup(r),i),null===o)return}catch(n){return console.error("Error looking up existing entities",n),void this.setState({existingElementsState:"error"})}const s=o.map((e=>e.element));this.setState({existingElements:s,existingElementsState:"none"})}}onElementTypeChange=async e=>{this.setState({elementTypesState:"loading"}),this.loadingItemCancellation.abort(),this.loadingItemCancellation=new AbortController;const t=this.loadingItemCancellation.signal,{onChange:n,workspace:{editor:{metadataProvider:i}}}=this.props,r=e.target.value;let o;try{if(o=await(0,a.mapAbortedToNull)(i.createEntity(r,{signal:t}),t),null===o)return}catch(s){return console.error("Error calling MetadataProvider.createEntity()",s),void this.setState({elementTypesState:"error"})}this.setState({elementTypesState:"none"}),n({value:o,isNew:!0,loading:!1})};renderPossibleElementType=e=>{const{workspace:{model:t}}=this.props,n=t.getElementType(e),r=t.locale.formatLabel(n?.data?.label,e);return(0,i.jsx)("option",{value:e,children:r},e)};renderElementTypeSelector(){const{elementValue:e}=this.props,{elementTypes:t,elementTypesState:n}=this.state,r=e.value.types.length?e.value.types[0]:"";return"none"!==n?(0,i.jsx)(d.HtmlSpinner,{width:20,height:20,errorOccurred:"error"===n}):(0,i.jsxs)("div",{className:`${x}__control-row`,children:[(0,i.jsx)("label",{children:"Entity Type"}),t?(0,i.jsxs)("select",{className:"reactodia-form-control",name:"reactodia-element-type-selector-select",value:r,onChange:this.onElementTypeChange,children:[(0,i.jsx)("option",{value:c.PLACEHOLDER_ELEMENT_TYPE,disabled:!0,children:"Select entity type"}),t.map(this.renderPossibleElementType)]}):(0,i.jsx)("div",{children:(0,i.jsx)(d.HtmlSpinner,{width:20,height:20})}),e.error?(0,i.jsx)("span",{className:`${x}__control-error`,children:e.error}):""]})}renderExistingElementsList(){const{elementValue:e,workspace:{model:t,editor:n}}=this.props,{elementTypes:r,existingElements:o,existingElementsState:s}=this.state;return"none"!==s?(0,i.jsx)("div",{className:`${b}__results-spinner`,children:(0,i.jsx)(d.HtmlSpinner,{width:30,height:30,errorOccurred:"error"===s})}):o.length>0?o.map((o=>{const s=!n.temporaryState.elements.has(o.id)&&Boolean(t.elements.find((e=>e instanceof u.EntityElement&&e.iri===o.id))),a=Boolean(r&&r.find((e=>o.types.indexOf(e)>=0)));return(0,i.jsx)(h.ListElementView,{element:o,disabled:s||!a,selected:o.id===e.value.id,onClick:(e,t)=>this.onSelectExistingItem(t)},o.id)})):(0,i.jsx)(p.NoSearchResults,{hasQuery:!0})}async onSelectExistingItem(e){const{onChange:t,workspace:{model:n}}=this.props;this.loadingItemCancellation.abort(),this.loadingItemCancellation=new AbortController;const i=this.loadingItemCancellation.signal;t({value:e,isNew:!1,loading:!0});const r=await n.dataProvider.elements({elementIds:[e.id]});if(i.aborted)return;t({value:r.get(e.id),isNew:!1,loading:!1})}render(){const{searchStore:e}=this.props;return(0,i.jsxs)("div",{className:s()(`${x}__row`,b),children:[(0,i.jsx)(g.SearchInput,{store:e,className:`${b}__search`,inputProps:{className:`${b}__search-input`,name:"reactodia-element-type-selector-search",autoFocus:!0},children:(0,i.jsx)("span",{className:`${b}__search-icon`})}),e.value.length>0?(0,i.jsx)("div",{className:`${b}__existing-elements-list`,role:"listbox","aria-label":"Select an existing element to put on a diagram",children:this.renderExistingElementsList()}):(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:`${b}__separator`,children:(0,i.jsx)("i",{className:`${b}__separator-text`,children:"or create new entity"})}),this.renderElementTypeSelector()]})]})}}function v(e){const t=e.types.indexOf(c.PLACEHOLDER_ELEMENT_TYPE)<0?void 0:"Required.";return Promise.resolve({error:t,allowChange:!0})}},(e,t,n)=>{n.r(t),n.d(t,{RenameLinkForm:()=>l});var i=n(102),r=n(61),o=n(60),s=n(130);const a="reactodia-form";function l(e){const{link:t,onFinish:n}=e,{model:l,view:{renameLinkProvider:c}}=(0,s.useWorkspace)(),d=l.getLinkType(t.typeId),u=(0,o.useEventStore)(d?.events,"changeData"),h=(0,o.useSyncStore)(u,(()=>d?.data?.label)),p=r.useMemo((()=>l.locale.formatLabel(h,t.typeId)),[t,h]),[g,f]=r.useState(c?.getLabel(t)??p);return(0,i.jsxs)("div",{className:a,children:[(0,i.jsx)("div",{className:`${a}__body`,children:(0,i.jsxs)("div",{className:`${a}__row`,children:[(0,i.jsx)("label",{children:"Label"}),(0,i.jsx)("input",{className:"reactodia-form-control",placeholder:p,autoFocus:!0,value:g,onChange:e=>f(e.target.value)})]})}),(0,i.jsxs)("div",{className:`${a}__controls`,children:[(0,i.jsx)("button",{className:`reactodia-btn reactodia-btn-primary ${a}__apply-button`,onClick:()=>{c&&c.setLabel(t,g),n()},children:"Apply"}),(0,i.jsx)("button",{className:"reactodia-btn reactodia-btn-default",onClick:n,children:"Cancel"})]})]})}},(e,t,n)=>{n.r(t),n.d(t,{EditLayer:()=>y});var i=n(102),r=n(61),o=n(56),s=n(58),a=n(74),l=n(90),c=n(96),d=n(93),u=n(101),h=n(109),p=n(113),g=n(114),f=n(119),m=n(130);function y(e){const t=(0,m.useWorkspace)(),{canvas:n}=(0,l.useCanvas)();return(0,i.jsx)(b,{...e,workspace:t,canvas:n})}class b extends r.Component{listener=new s.EventObserver;cancellation=new AbortController;canDropOnElementCancellation=new AbortController;temporaryLink;temporaryElement;oldLink;constructor(e){super(e),this.state={}}componentDidMount(){const{operation:e}=this.props;switch(e.mode){case"connect":this.beginCreatingLink(e);break;case"moveSource":case"moveTarget":this.beginMovingLink(e);break;default:throw new Error(`Unknown edit mode: "${e.mode}"`)}this.forceUpdate(),this.queryCanConnectToAny(),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}componentWillUnmount(){this.listener.stopListening(),this.cancellation.abort(),this.canDropOnElementCancellation.abort(),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}beginCreatingLink(e){const{workspace:{model:t,editor:n}}=this.props,{source:i,point:r}=e,o=this.createTemporaryElement(r),s=new f.RelationLink({sourceId:i.id,targetId:o.id,data:{linkTypeId:a.PLACEHOLDER_LINK_TYPE,sourceId:i.iri,targetId:"",properties:{}}}),l=n.createRelation(s,{temporary:!0});t.setLinkVisibility(l.typeId,"withoutLabel"),this.temporaryElement=o,this.temporaryLink=l}beginMovingLink(e){const{workspace:{model:t,editor:n}}=this.props,{mode:i,link:r,point:o}=e;this.oldLink=r,t.removeLink(r.id);const{sourceId:s,targetId:a,data:l,vertices:c,linkState:d}=r,u=this.createTemporaryElement(o),h=new f.RelationLink({sourceId:"moveSource"===i?u.id:s,targetId:"moveTarget"===i?u.id:a,data:{...l,sourceId:"moveSource"===i?"":l.sourceId,targetId:"moveTarget"===i?"":l.targetId},vertices:c,linkState:d}),p=n.createRelation(h,{temporary:!0});this.temporaryElement=u,this.temporaryLink=p}createTemporaryElement(e){const{workspace:{model:t}}=this.props,n=new c.VoidElement({});n.setPosition(e);const i=t.history.startBatch();return t.addElement(n),i.discard(),n}onMouseMove=e=>{const{workspace:{model:t},canvas:n}=this.props,{targetElement:i,waitingForMetadata:r}=this.state;if(e.preventDefault(),e.stopPropagation(),r)return;const o=n.metrics.pageToPaperCoords(e.pageX,e.pageY);this.temporaryElement.setPosition(o);const s=(0,d.findElementAtPoint)(t.elements,o,n.renderingState);s!==i&&this.queryCanDropOnElement(s),this.setState({targetElement:s})};queryCanConnectToAny(){const{workspace:{model:e,editor:t}}=this.props;if(!t.metadataProvider)return void this.setState({connectionsToAny:[]});this.setState({connectionsToAny:void 0});const n=this.temporaryLink,i=e.getElement(n.sourceId);(0,o.mapAbortedToNull)(t.metadataProvider.canConnect(i.data,void 0,n.data.linkTypeId===a.PLACEHOLDER_LINK_TYPE?void 0:n.data.linkTypeId,{signal:this.cancellation.signal}),this.cancellation.signal).then((e=>{null!==e&&this.setState({connectionsToAny:e})}),(e=>{console.error("Error calling MetadataProvider.canConnect() without target",e),this.setState({connectionsToAny:[]})}))}queryCanDropOnElement(e){const{operation:t,workspace:{model:n,editor:i}}=this.props;if(this.canDropOnElementCancellation.abort(),this.canDropOnElementCancellation=new AbortController,!(i.metadataProvider&&e instanceof f.EntityElement))return void this.setState({connectionsToTarget:[]});const r=i.authoringState.elements.get(e.iri);if(r&&"entityDelete"===r.type)return void this.setState({connectionsToTarget:[]});this.setState({connectionsToTarget:void 0});const s=this.temporaryLink;let l,c;switch(t.mode){case"connect":case"moveTarget":l=n.getElement(s.sourceId).data,c=e.data;break;case"moveSource":l=e.data,c=n.getElement(s.targetId).data}const d=this.canDropOnElementCancellation.signal;(0,o.mapAbortedToNull)(i.metadataProvider.canConnect(l,c,s.data.linkTypeId===a.PLACEHOLDER_LINK_TYPE?void 0:s.data.linkTypeId,{signal:d}),d).then((e=>{null!==e&&this.setState({connectionsToTarget:e})}),(e=>{console.error("Error calling MetadataProvider.canConnect() with target",e),this.setState({connectionsToAny:[]})}))}onMouseUp=e=>{const{canvas:t}=this.props;if(this.state.waitingForMetadata)return;this.setState({waitingForMetadata:!0});const n=t.metrics.pageToPaperCoords(e.pageX,e.pageY);this.executeEditOperation(n)};async executeEditOperation(e){const{operation:t,canvas:n,workspace:{model:i,editor:r}}=this.props;try{const{targetElement:o,connectionsToAny:s,connectionsToTarget:a}=this.state;this.oldLink&&i.addLink(this.oldLink);const l=o?a:s;if(l&&l.length>0){let s,a=o;switch(t.mode){case"connect":{a||(a=await this.createNewElement(l),a.setPosition(e),n.renderingState.syncUpdate(),function(e,t,n){const{width:i,height:r}=n.getElementSize(e)??{width:0,height:0};e.setPosition({x:t.x-i/2,y:t.y-r/2})}(a,e,n.renderingState));const t=i.getElement(this.temporaryLink.sourceId);s=await this.createNewLink(t,a,l);break}case"moveSource":s=r.moveRelationSource({link:this.oldLink,newSource:o});break;case"moveTarget":s=r.moveRelationTarget({link:this.oldLink,newTarget:o});break;default:throw new Error("Unknown edit mode")}if(o){const e=s||this.oldLink;i.setSelection([e]),r.authoringCommands.trigger("editRelation",{target:e})}else if(a&&s){i.setSelection([a]);const e=i.getElement(s.sourceId);r.authoringCommands.trigger("findOrCreateEntity",{link:s,source:e,target:a,targetIsNew:!0})}}}finally{this.cleanupAndFinish()}}async createNewElement(e){const{workspace:{editor:t}}=this.props;if(!t.metadataProvider)throw new Error("Cannot create new element without metadata provider");const n=new Set;for(const{targetTypes:o}of e)for(const e of o)n.add(e);const i=1===n.size?Array.from(n)[0]:a.PLACEHOLDER_ELEMENT_TYPE,r=await t.metadataProvider.createEntity(i,{signal:this.cancellation.signal});return t.createEntity(r,{temporary:!0})}async createNewLink(e,t,n){const{workspace:{model:i,editor:r}}=this.props;if(!r.metadataProvider)return;const o=new Set,s=new Set;for(const{targetTypes:a,inLinks:f,outLinks:m}of n)if(t.data.types.some((e=>a.has(e)))){for(const e of f)o.add(e);for(const e of m)s.add(e)}let l,c;0===o.size&&1===s.size?(l=[...s][0],c="out"):1===o.size&&0===s.size?(l=[...o][0],c="in"):(l=a.PLACEHOLDER_LINK_TYPE,c="out");let[d,u]=[e,t];"in"===c&&([d,u]=[u,d]);const h=await r.metadataProvider.createRelation(d.data,u.data,l,{signal:this.cancellation.signal}),p=new f.RelationLink({sourceId:d.id,targetId:u.id,data:h}),g=i.findLink(p.typeId,p.sourceId,p.targetId);return g instanceof f.RelationLink?g:r.createRelation(p,{temporary:!0})}cleanupAndFinish(){const{onFinishEditing:e,workspace:{model:t,editor:n}}=this.props,i=t.history.startBatch();t.removeElement(this.temporaryElement.id),t.removeLink(this.temporaryLink.id),n.setTemporaryState(g.TemporaryState.removeRelation(n.temporaryState,this.temporaryLink.data)),i.discard(),e()}render(){const{workspace:{model:e},canvas:t}=this.props,{waitingForMetadata:n}=this.state;if(!this.temporaryLink)return null;const r=t.metrics.getTransform(),o=t.renderingState;return(0,i.jsxs)(h.TransformedSvgCanvas,{paperTransform:r,style:{overflow:"visible"},children:[(0,i.jsx)(u.LinkMarkers,{renderingState:o}),this.renderHighlight(),this.renderCanDropIndicator(),n?null:(0,i.jsx)(u.LinkLayer,{model:e,renderingState:o,links:[this.temporaryLink]})]})}renderHighlight(){const{canvas:e}=this.props,{targetElement:t,connectionsToTarget:n,waitingForMetadata:r}=this.state;if(!t)return null;const{x:o,y:s,width:a,height:l}=(0,d.boundsOf)(t,e.renderingState);if(void 0===n||r)return(0,i.jsxs)("g",{transform:`translate(${o},${s})`,children:[(0,i.jsx)("rect",{width:a,height:l,fill:"white",fillOpacity:.5}),(0,i.jsx)(p.Spinner,{size:30,position:{x:a/2,y:l/2}})]});const c=n&&n.length>0?"#5cb85c":"#c9302c";return(0,i.jsx)("rect",{x:o,y:s,width:a,height:l,fill:"transparent",stroke:c,strokeWidth:3})}renderCanDropIndicator(){const{targetElement:e,connectionsToAny:t,waitingForMetadata:n}=this.state;if(e)return null;const{x:r,y:o}=this.temporaryElement.position;let s;return s=void 0===t?(0,i.jsx)(p.Spinner,{size:1.2,position:{x:.5,y:-.5}}):t.length>0?(0,i.jsx)("path",{d:"M0.5,0 L0.5,-1 M0,-0.5 L1,-0.5",strokeWidth:.2,stroke:"#5cb85c"}):(0,i.jsxs)("g",{children:[(0,i.jsx)("circle",{cx:"0.5",cy:"-0.5",r:"0.5",fill:"none",strokeWidth:.2,stroke:"#c9302c"}),(0,i.jsx)("path",{d:"M0.5,0 L0.5,-1",strokeWidth:.2,stroke:"#c9302c",transform:"rotate(-45 0.5 -0.5)"})]}),(0,i.jsxs)("g",{transform:`translate(${r} ${o})scale(40)`,children:[(0,i.jsx)("rect",{x:-.5,y:-.5,width:1,height:1,fill:"rgba(0, 0, 0, 0.1)",rx:.25,ry:.25}),n?(0,i.jsx)(p.Spinner,{size:.8}):(0,i.jsx)("g",{transform:"translate(0.5, -0.5)scale(0.25)",children:s})]})}}},(e,t,n)=>{n.r(t),n.d(t,{ElementDecorator:()=>h});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(90),c=n(113),d=n(124),u=n(130);function h(e){const{canvas:t}=(0,l.useCanvas)(),n=(0,u.useWorkspace)();return(0,i.jsx)(g,{...e,canvas:t,workspace:n})}const p="reactodia-authoring-state";class g extends r.Component{listener=new a.EventObserver;constructor(e){super(e);const{target:t,workspace:{editor:n}}=this.props;this.state={state:n.authoringState.elements.get(t.iri),validation:n.validationState.elements.get(t.iri),isTemporary:n.temporaryState.elements.has(t.iri)}}componentDidMount(){const{target:e,canvas:t,workspace:{editor:n}}=this.props;this.listener.listen(t.renderingState.events,"changeElementSize",(t=>{t.source===e&&this.forceUpdate()})),this.listener.listen(n.events,"changeAuthoringState",(t=>{const i=n.authoringState.elements.get(e.iri);i!==t.previous.elements.get(e.iri)&&this.setState({state:i})})),this.listener.listen(n.events,"changeValidationState",(t=>{const i=n.validationState.elements.get(e.iri);i!==t.previous.elements.get(e.iri)&&this.setState({validation:i})})),this.listener.listen(n.events,"changeTemporaryState",(t=>{const i=n.temporaryState.elements.has(e.iri);i!==t.previous.elements.has(e.iri)&&this.setState({isTemporary:i})})),this.listener.listen(e.events,"changeData",(t=>{t.previous.id!==e.iri&&this.setState({isTemporary:n.temporaryState.elements.has(e.iri),validation:n.validationState.elements.get(e.iri),state:n.authoringState.elements.get(e.iri)})}))}componentWillUnmount(){this.listener.stopListening()}shouldComponentUpdate(e,t){return this.state.state!==t.state||this.state.validation!==t.validation||this.state.isTemporary!==t.isTemporary||this.props.position!==e.position}renderElementOutlines(){const{target:e,canvas:t}=this.props,{state:n,isTemporary:r}=this.state,{width:o,height:s}=t.renderingState.getElementSize(e)??{width:0,height:0};if(r)return[(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"rgba(255, 255, 255, 0.5)"},`${e.id}-opacity`),(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"url(#stripe-pattern)"},`${e.id}-stripes`)];if(n&&"entityDelete"===n.type){const t=o,n=s;return(0,i.jsxs)("g",{children:[(0,i.jsx)("rect",{x:0,y:0,width:o,height:s,fill:"white",fillOpacity:.5}),(0,i.jsx)("line",{x1:0,y1:0,x2:t,y2:n,stroke:"red"}),(0,i.jsx)("line",{x1:t,y1:0,x2:0,y2:n,stroke:"red"})]},e.id)}return null}renderValidationIcon(e,t){const n=(0,d.getMaxSeverity)(t.items);return(0,i.jsxs)("div",{className:s()(`${p}__item-validation`,f(n)),title:e,children:[t.loading?(0,i.jsx)(c.HtmlSpinner,{width:15,height:17}):(0,i.jsx)("div",{className:`${p}__item-validation-icon`}),!t.loading&&t.items.length>0?t.items.length:void 0]})}renderElementValidations(){const{workspace:{model:e}}=this.props,{validation:t}=this.state;if(!t)return null;const n=t.items.map((t=>{if(t.propertyType){const n=e.getPropertyType(t.propertyType);return`${e.locale.formatLabel(n?.data?.label,t.propertyType)}: ${t.message}`}return t.message})).join("\n");return this.renderValidationIcon(n,t)}renderElementState(){const{target:e,workspace:{editor:t}}=this.props,{state:n}=this.state;if(n){let r,o;switch(n.type){case"entityAdd":r="New",o="Revert creation of the element";break;case"entityChange":r="Change",o="Revert all changes in properties of the element";break;case"entityDelete":r="Delete",o="Revert deletion of the element"}return(0,i.jsx)("div",{className:`${p}__state-indicator`,style:{left:0,top:0},children:(0,i.jsx)("div",{className:`${p}__state-indicator-container`,children:(0,i.jsxs)("div",{className:`${p}__state-indicator-body`,children:[(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:`${p}__state-label`,children:r}),"[",(0,i.jsx)("span",{className:`${p}__state-cancel`,onClick:()=>t.discardChange(n),title:o,children:"cancel"}),"]"]}),this.renderElementValidations()]})})},e.id)}return null}render(){const{target:e,canvas:t}=this.props,{position:n}=e,r=t.renderingState.getElementSize(e)??{width:0,height:0},o=`translate(${n.x}px,${n.y}px)`,s=this.renderElementOutlines(),a=this.renderElementState();return s||a?(0,i.jsxs)("div",{style:{position:"absolute",transform:o},children:[s?(0,i.jsxs)("svg",{width:r.width,height:r.height,style:{position:"absolute",pointerEvents:"none",overflow:"visible"},children:[(0,i.jsx)("defs",{children:(0,i.jsx)("pattern",{id:"stripe-pattern",patternUnits:"userSpaceOnUse",width:13,height:13,patternTransform:"rotate(45)",children:(0,i.jsx)("line",{x1:0,y:0,x2:0,y2:13,stroke:"#ddd",strokeWidth:10,strokeOpacity:.2})})}),this.renderElementOutlines()]}):null,a]}):null}}function f(e){switch(e){case"info":return`${p}--severity-info`;case"warning":return`${p}--severity-warning`;case"error":return`${p}--severity-error`;default:return}}},(e,t,n)=>{n.r(t),n.d(t,{LinkStateWidget:()=>b});var i=n(102),r=n(61),o=n(106),s=n.n(o),a=n(58),l=n(67),c=n(90),d=n(93),u=n(109),h=n(107),p=n(113),g=n(114),f=n(119),m=n(124),y=n(130);function b(e){const t=(0,y.useWorkspace)(),{canvas:n}=(0,c.useCanvas)();return(0,i.jsx)(v,{...e,workspace:t,canvas:n})}const x="reactodia-authoring-state",w=5;class v extends r.Component{listener=new a.EventObserver;delayedUpdate=new l.Debouncer;componentDidMount(){this.listenEvents()}componentWillUnmount(){this.listener.stopListening()}listenEvents(){const{workspace:{model:e,editor:t},canvas:n}=this.props;this.listener.listen(e.events,"elementEvent",(({data:e})=>{e.changePosition&&this.scheduleUpdate()})),this.listener.listen(e.events,"linkEvent",(({data:e})=>{e.changeVertices&&this.scheduleUpdate()})),this.listener.listen(e.events,"changeCells",this.scheduleUpdate),this.listener.listen(t.events,"changeAuthoringState",this.scheduleUpdate),this.listener.listen(t.events,"changeTemporaryState",this.scheduleUpdate),this.listener.listen(t.events,"changeValidationState",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"changeElementSize",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"changeLinkLabelBounds",this.scheduleUpdate),this.listener.listen(n.renderingState.events,"syncUpdate",(({layer:e})=>{e===h.RenderingLayer.Overlay&&this.delayedUpdate.runSynchronously()}))}scheduleUpdate=()=>{this.delayedUpdate.call(this.performUpdate)};performUpdate=()=>{this.forceUpdate()};calculateLinkPath(e){const t=this.calculatePolyline(e);return(0,d.pathFromPolyline)(t)}calculatePolyline(e){const{workspace:{model:t},canvas:n}=this.props,i=t.getElement(e.sourceId),r=t.getElement(e.targetId),o=n.renderingState.getRouting(e.id),s=e.vertices||[],a=o?o.vertices:s;return(0,d.computePolyline)((0,d.boundsOf)(i,n.renderingState),(0,d.boundsOf)(r,n.renderingState),a)}renderLinkStateLabels(){const{workspace:{model:e,editor:t}}=this.props,n=[];for(const r of e.links){if(!(r instanceof f.RelationLink))continue;let e=null;const o=t.authoringState.links.get(r.data);if(o){let n,r;switch(o.type){case"relationAdd":n="New",r="Revert creation of the link";break;case"relationChange":n="Change",r="Revert all changes in properties of the link";break;case"relationDelete":n="Delete",r="Revert deletion of the link"}e=(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:`${x}__state-label`,children:n}),"[",(0,i.jsx)("span",{className:`${x}__state-cancel`,onClick:()=>t.discardChange(o),title:r,children:"cancel"}),"]"]})}const s=this.renderLinkValidations(r.data);if(e||s){const t=this.getLinkStateLabelPosition(r);if(t){const o={left:t.x,top:t.y};n.push((0,i.jsx)("div",{className:`${x}__state-indicator`,style:o,children:(0,i.jsx)("div",{className:`${x}__state-indicator-container`,children:(0,i.jsxs)("div",{className:`${x}__state-indicator-body`,children:[e,s]})})},r.id))}}}return n}renderLinkStateHighlighting(){const{workspace:{model:e,editor:t}}=this.props,n=[];for(const r of e.links)if(r instanceof f.RelationLink)if(t.temporaryState.links.has(r.data)){const e=this.calculateLinkPath(r);n.push((0,i.jsx)("path",{d:e,fill:"none",stroke:"grey",strokeWidth:5,strokeOpacity:.5,strokeDasharray:"8 8"},r.id))}else{const e=t.authoringState.links.get(r.data),o=g.AuthoringState.isDeletedRelation(t.authoringState,r.data),s=g.AuthoringState.hasEntityChangedIri(t.authoringState,r.data.sourceId)||g.AuthoringState.hasEntityChangedIri(t.authoringState,r.data.targetId);if(e||o||s){const t=this.calculateLinkPath(r);let a;o?a="red":s?a="blue":e&&(a="relationChange"===e.type?"blue":"green"),n.push((0,i.jsx)("path",{d:t,fill:"none",stroke:a,strokeWidth:5,strokeOpacity:.5},r.id))}}return n}getLinkStateLabelPosition(e){const{canvas:t,linkLabelMargin:n=w}=this.props,i=t.renderingState.getLinkLabelBounds(e);if(i){const{x:e,y:t}=i;return{x:e,y:t-n/2}}{const t=this.calculatePolyline(e),n=(0,d.computePolylineLength)(t);return(0,d.getPointAlongPolyline)(t,n/2)}}renderLinkValidations(e){const{workspace:{editor:t}}=this.props,{validationState:n}=t,i=n.links.get(e);if(!i)return null;const r=i.items.map((e=>e.message)).join("\n");return this.renderValidationIcon(r,i)}renderValidationIcon(e,t){const n=(0,m.getMaxSeverity)(t.items);return(0,i.jsxs)("div",{className:s()(`${x}__item-validation`,k(n)),title:e,children:[t.loading?(0,i.jsx)(p.HtmlSpinner,{width:15,height:17}):(0,i.jsx)("div",{className:`${x}__item-validation-icon`}),!t.loading&&t.items.length>0?t.items.length:void 0]})}render(){const{workspace:{editor:e},canvas:t}=this.props,n=t.metrics.getTransform(),{scale:r,originX:o,originY:s}=n;if(!e.inAuthoringMode)return null;const a={position:"absolute",left:0,top:0,transform:`scale(${r},${r})translate(${o}px,${s}px)`};return(0,i.jsxs)("div",{className:`${x}`,children:[(0,i.jsx)(u.TransformedSvgCanvas,{paperTransform:n,style:{overflow:"visible",pointerEvents:"none"},children:this.renderLinkStateHighlighting()}),(0,i.jsx)("div",{className:`${x}__validation-layer`,style:a,children:this.renderLinkStateLabels()})]})}}function k(e){switch(e){case"info":return`${x}--severity-info`;case"warning":return`${x}--severity-warning`;case"error":return`${x}--severity-error`;default:return}}},(e,t,n)=>{n.r(t),n.d(t,{ZoomControl:()=>u});var i=n(102),r=n(106),o=n.n(r),s=n(60),a=n(90),l=n(91),c=n(153);const d="reactodia-zoom-control";function u(e){const{dock:t,dockOffsetX:n,dockOffsetY:r,showPointerModeToggle:l}=e,{canvas:u}=(0,a.useCanvas)(),h=(0,s.useObservedProperty)(u.events,"changePointerMode",(()=>u.pointerMode));return(0,i.jsx)(c.ViewportDock,{dock:t,dockOffsetX:n,dockOffsetY:r,children:(0,i.jsxs)("div",{className:d,children:[(0,i.jsx)("button",{type:"button",className:o()(`${d}__zoom-in-button`,"reactodia-btn reactodia-btn-default"),title:"Zoom In",onClick:()=>u.zoomIn()}),(0,i.jsx)("button",{type:"button",className:o()(`${d}__zoom-out-button`,"reactodia-btn reactodia-btn-default"),title:"Zoom Out",onClick:()=>u.zoomOut()}),(0,i.jsx)("button",{type:"button",className:o()(`${d}__zoom-fit-button`,"reactodia-btn reactodia-btn-default"),title:"Fit to Screen",onClick:()=>u.zoomToFit({animate:!0})}),l?(0,i.jsx)("button",{type:"button",className:o()(`${d}__selection-mode-button`,"reactodia-btn reactodia-btn-default","selection"===h?"active":void 0),title:"Toggle selection mode:\nDrag pointer to select, Shift + Pointer to pan the canvas",onClick:()=>u.setPointerMode("panning"===h?"selection":"panning")}):null]})})}(0,l.defineCanvasWidget)(u,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{ClassicToolbar:()=>L,ClassicWorkspace:()=>S});var i=n(102),r=n(61),o=n(58),s=n(91),a=n(159),l=n(154),c=n(162),d=n(163),u=n(164),h=n(167),p=n(169),g=n(171),f=n(172),m=n(173),y=n(174),b=n(175),x=n(181),w=n(192),v=n(194),k=n(197);function S(e){const{leftColumn:t,rightColumn:n,canvas:s,canvasWidgets:y,connectionsMenu:b,dropOnCanvas:S,halo:_,haloLink:M,selection:I,navigator:T,zoomControl:E,visualAuthoring:j,toolbar:N,classTree:C,instancesSearch:A,linkToolbox:D}=e,[P]=r.useState((()=>e.connectionsMenuCommands??new o.EventSource)),[O]=r.useState((()=>e.instancesSearchCommands??new o.EventSource));return(0,i.jsx)(k.WorkspaceRoot,{children:(0,i.jsxs)(v.WorkspaceLayoutRow,{children:[(0,i.jsxs)(v.WorkspaceLayoutColumn,{defaultSize:275,...t,children:[(0,i.jsx)(v.WorkspaceLayoutItem,{id:"classes",heading:"Classes",children:(0,i.jsx)(l.ClassTree,{...C,instancesSearchCommands:O})}),(0,i.jsx)(v.WorkspaceLayoutItem,{id:"instances",heading:"Instances",children:(0,i.jsx)(p.InstancesSearch,{...A,commands:O})})]}),(0,i.jsx)(v.WorkspaceLayoutItem,{id:"canvas",children:(0,i.jsxs)(a.Canvas,{...s,children:[(0,i.jsx)(x.VisualAuthoring,{...j}),null===b?null:(0,i.jsx)(c.ConnectionsMenu,{...b,commands:P,instancesSearchCommands:O}),null===S?null:(0,i.jsx)(d.DropOnCanvas,{...S}),null===_?null:(0,i.jsx)(u.Halo,{..._,instancesSearchCommands:O,connectionsMenuCommands:null===b?void 0:P}),null===M?null:(0,i.jsx)(h.HaloLink,{...M}),null===I?null:(0,i.jsx)(m.Selection,{...I,connectionsMenuCommands:null===b?void 0:P}),null===T?null:(0,i.jsx)(f.Navigator,{dock:"se",...T}),null===N?null:(0,i.jsx)(L,{dock:"nw",...N}),null===E?null:(0,i.jsx)(w.ZoomControl,{dock:"sw",...E}),y]})}),(0,i.jsx)(v.WorkspaceLayoutColumn,{defaultSize:275,defaultCollapsed:!0,...n,children:(0,i.jsx)(v.WorkspaceLayoutItem,{id:"connections",heading:"Connections",children:(0,i.jsx)(g.LinkTypesToolbox,{...D,instancesSearchCommands:O})})})]})})}function L(e){const{dock:t,dockOffsetX:n,dockOffsetY:r,menu:o,children:s,languages:a=[]}=e,l=null===o?null:o??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.ToolbarActionClearAll,{}),(0,i.jsx)(b.ToolbarActionExport,{kind:"exportRaster"}),(0,i.jsx)(b.ToolbarActionExport,{kind:"exportSvg"}),(0,i.jsx)(b.ToolbarActionExport,{kind:"print"})]}),c=null===s?null:s??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.ToolbarActionUndo,{}),(0,i.jsx)(b.ToolbarActionRedo,{}),(0,i.jsx)(b.ToolbarActionLayout,{}),(0,i.jsx)(b.ToolbarLanguageSelector,{languages:a})]});return(0,i.jsx)(y.Toolbar,{dock:t,dockOffsetX:n,dockOffsetY:r,menu:l,children:c})}(0,s.defineCanvasWidget)(L,(e=>({element:e,attachment:"viewport"})))},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceLayoutColumn:()=>c,WorkspaceLayoutItem:()=>d,WorkspaceLayoutResizeContext:()=>u,WorkspaceLayoutRow:()=>l});var i=n(102),r=n(61),o=n(195),s=n(196);const a=28;function l(e){return h(e,"row")}function c(e){return h(e,"column")}function d(e){return e.children}const u=r.createContext(null);function h(e,t){const{animationDuration:n,children:l}=e,c=r.useContext(u),h=r.Children.count(l),p=r.Children.map(l,((e,n)=>{let r;"row"!==t||e.props.undocked||(0===n?r=s.DockSide.Left:n===h-1&&(r=s.DockSide.Right));let o=e.props.collapsedSize;return void 0===o&&"row"===t&&(o=a),(0,i.jsx)(s.AccordionItem,{heading:e.type===d?e.props.heading:void 0,dockSide:r,defaultSize:e.props.defaultSize,defaultCollapsed:e.props.defaultCollapsed,collapsedSize:o,minSize:e.props.minSize,children:e},e.type===d?e.props.id:n)}));return(0,i.jsx)(o.Accordion,{direction:"row"===t?"horizontal":"vertical",onStartResize:c?.onStartResize,onResize:c?.onResize,animationDuration:n,children:p})}},(e,t,n)=>{n.r(t),n.d(t,{Accordion:()=>s});var i=n(102),r=n(61);const o="reactodia-accordion";class s extends r.Component{static defaultProps={direction:"vertical",animationDuration:300};element;items=[];dragOrigin;defaultProps;isScrollable=!1;constructor(e){super(e);const t=r.Children.count(this.props.children);this.state={sizes:[],collapsed:[],resizing:!1,percents:r.Children.map(this.props.children,(()=>100/t+"%"))}}componentDidMount(){this.updateSizes()}componentDidUpdate(e,t){const{direction:n,children:i,onResize:o,animationDuration:s}=this.props;r.Children.count(i)!==r.Children.count(e.children)&&this.updateSizes();const{sizes:a,resizing:l}=this.state;a!==t.sizes&&o&&(l?o(n):setTimeout((()=>o(n)),s))}get isVertical(){return"vertical"===this.props.direction}clientSize(e){const{clientWidth:t,clientHeight:n}=e;return this.isVertical?n:t}offsetSize(e){const{offsetWidth:t,offsetHeight:n}=e;return this.isVertical?n:t}updateSizes(){const{children:e}=this.props,t=new Map;r.Children.forEach(e,((e,n)=>{if("object"!=typeof e)return;const{defaultSize:i,defaultCollapsed:r,collapsedSize:o,minSize:s}=e.props;void 0!==s&&(this.isScrollable=!0),t.set(n,{defaultSize:i,defaultCollapsed:r,collapsedSize:o,minSize:s})})),this.defaultProps=t,this.setState((({collapsed:t})=>{const n=this.clientSize(this.element.parentElement);let i=n,o=r.Children.count(e);const s=[];this.defaultProps.forEach((({defaultSize:e,defaultCollapsed:n=!1},r)=>{let a=void 0===t[r]?n:t[r];const l=r===this.defaultProps.size-1,c=s.findIndex((e=>!e))<0;l&&c&&(a=!1);const d=a?this.sizeWhenCollapsed(r):e;d&&(i-=d,o-=1),s.push(a)}));const a=[],l=[];return this.defaultProps.forEach((({defaultSize:e,minSize:t},r)=>{let c=i/o;const d=this.sizeWhenCollapsed(r);s[r]?c=d:void 0!==e?c=e:void 0!==t&&c<t&&(c=d+t),c<d&&(c=d,s[r]=!0);const u=100*c/n+"%";a.push(c),l.push(u)})),{sizes:a,percents:l,collapsed:s}}))}render(){const{direction:e}=this.props,{resizing:t}=this.state,n=t?`${o}--resizing`:"",r=this.isScrollable?`${o}--scrollable`:"";return(0,i.jsx)("div",{className:`${o} ${o}--${e} ${n} ${r}`,ref:this.onElementMount,children:this.renderItems()})}onElementMount=e=>{this.element=e};renderItems(){const{sizes:e,percents:t,collapsed:n}=this.state,{children:i,direction:o}=this.props;return r.Children.map(i,((s,a)=>{if("object"!=typeof s)throw new Error("Accordion should have only AccordionItem elements as children");const l=a===r.Children.count(i)-1,c=n[a]?e[a]:t[a],d={ref:e=>{e&&(this.items[a]=e)},collapsed:n[a],size:c,direction:o,onChangeCollapsed:e=>this.onItemChangeCollapsed({itemIndex:a,itemCollapsed:e}),onBeginDragHandle:l?void 0:()=>this.onBeginDragHandle(a),onDragHandle:l?void 0:(e,t)=>this.onDragHandle(a,e,t),onEndDragHandle:this.onEndDragHandle};return r.cloneElement(s,d)}))}onBeginDragHandle(e){this.dragOrigin={totalSize:this.clientSize(this.element),sizes:this.computeEffectiveItemSizes(),collapsed:[...this.state.collapsed]},this.setState({resizing:!0},(()=>{const{direction:e,onStartResize:t}=this.props;t&&t(e)}))}onEndDragHandle=()=>{this.setState({resizing:!1})};computeEffectiveItemSizes(){const e=[];return this.items.forEach(((t,n)=>{if(t)if(this.state.collapsed[n]){const t=this.sizeWhenCollapsed(n);e.push(t)}else e.push(this.offsetSize(t.element))})),e}sizeWhenCollapsed=e=>{const t=this.items[e],{collapsedSize:n}=this.defaultProps.get(e);if(void 0!==n)return n;return(t.header?this.clientSize(t.header):0)+(this.offsetSize(t.element)-this.clientSize(t.element))};onDragHandle(e,t,n){const i=[...this.dragOrigin.sizes],r=[...this.dragOrigin.collapsed],o=this.dragOrigin.totalSize;new a(i,r,o,this.sizeWhenCollapsed).distribute(e+1,this.isVertical?n:t);const s=i.map((e=>100*e/o+"%"));this.setState({sizes:i,percents:s,collapsed:r})}onItemChangeCollapsed({itemIndex:e,itemCollapsed:t}){const n=this.clientSize(this.element),i=this.computeEffectiveItemSizes();if(1===i.length)return;const r=[...this.state.collapsed],o=i[e],s=this.sizeWhenCollapsed(e),l=new a(i,r,n,this.sizeWhenCollapsed);if(t){const t=Math.max(o-s,0);i[e]=s,e===i.length-1?l.expand(t,e-1):l.expand(t,e+1)}else{const{defaultSize:t,minSize:r}=this.defaultProps.get(e),o=(t||n/i.length)-s;let a=0;a=e===i.length-1?l.collapseForward({shift:o,from:e-1,to:e}):l.collapseForward({shift:o,from:e+1,to:i.length}),a=Math.max(a,l.leftoverSize()),a<o&&(a+=l.collapseForward({shift:o-a,from:0,to:e})),void 0!==r&&a<r&&(a=r),i[e]=Math.round(s+a)}r[e]=t;const c=i.map((e=>100*e/n+"%"));this.setState({sizes:i,percents:c,collapsed:r})}}class a{sizes;collapsed;totalSize;sizeWhenCollapsed;constructor(e,t,n,i){this.sizes=e,this.collapsed=t,this.totalSize=n,this.sizeWhenCollapsed=i}distribute(e,t){if(t>0){let n=this.collapseForward({shift:t,from:e,to:this.sizes.length});n=Math.max(n,this.leftoverSize()),this.expand(n,e-1)}else{let n=this.collapseBackward({shift:-t,from:0,to:e});n=Math.max(n,this.leftoverSize()),this.expand(n,e)}}collapseForward({shift:e,from:t,to:n}){if(e<=0)return 0;let i=e;for(let r=t;r<n;r++)i=this.collapse(i,r);return e-i}collapseBackward({shift:e,from:t,to:n}){if(e<=0)return 0;let i=e;for(let r=n-1;r>=t;r--)i=this.collapse(i,r);return e-i}collapse(e,t){if(this.collapsed[t])return e;const n=this.sizes[t],i=this.sizeWhenCollapsed(t),r=Math.round(Math.max(n-e,i));return this.sizes[t]=r,this.collapsed[t]=r<=i,e-(n-r)}expand(e,t){if(e<=0)return 0;const n=this.sizes[t],i=Math.round(n+e);return this.sizes[t]=i,this.collapsed[t]=i<=this.sizeWhenCollapsed(t),i-n}leftoverSize(){const e=this.sizes.reduce(((e,t)=>e+t),0);return Math.max(this.totalSize-e,0)}}},(e,t,n)=>{n.r(t),n.d(t,{AccordionItem:()=>l,DockSide:()=>i});var i,r=n(102),o=n(61),s=n(128);!function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"}(i||(i={}));const a="reactodia-accordion-item";class l extends o.Component{static defaultProps={direction:"vertical"};_element;_header;constructor(e){super(e),this.state={resizing:!1}}get element(){return this._element}get header(){return this._header}get isVertical(){return"vertical"===this.props.direction}renderToggleButton(){const{collapsed:e,dockSide:t,onChangeCollapsed:n}=this.props;if(!t)return null;const o=t===i.Left?"left":"right";return(0,r.jsx)("div",{className:`${a}__handle-btn ${a}__handle-btn-${o}`,onClick:()=>n(!e)})}render(){const{heading:e,bodyClassName:t,children:n,bodyRef:i,collapsed:o,size:l,direction:c,onBeginDragHandle:d,onDragHandle:u,onEndDragHandle:h,dockSide:p}=this.props,{resizing:g}=this.state,f=d&&u&&h,m=this.isVertical?{height:l}:{width:l},y=!(o&&p);return(0,r.jsxs)("div",{className:`${a} ${a}--${o?"collapsed":"expanded"} ${a}--${c}\n                    ${g?`${a}--resizing`:""}`,ref:e=>this._element=e,style:m,children:[(0,r.jsxs)("div",{className:`${a}__inner`,children:[e?(0,r.jsx)("div",{className:`${a}__header`,ref:e=>this._header=e,onClick:()=>this.props.onChangeCollapsed(!o),children:e}):null,(0,r.jsx)("div",{className:`${a}__body`,children:n&&y?n:(0,r.jsx)("div",{ref:i,className:`${t||""}`})})]}),f?(0,r.jsx)(s.DraggableHandle,{className:`${a}__handle ${a}__handle-${c}`,onBeginDragHandle:e=>{this.setState({resizing:!0}),d()},onDragHandle:(e,t,n)=>u(t,n),onEndDragHandle:e=>{this.setState({resizing:!1}),h()}}):null,this.renderToggleButton()]})}}},(e,t,n)=>{n.r(t),n.d(t,{WorkspaceRoot:()=>a});var i=n(102),r=n(106),o=n.n(r);const s="reactodia-workspace";function a(e){return(0,i.jsx)("div",{className:o()(s,e.className),style:e.style,children:e.children})}},(e,t,n)=>{n.r(t),n.d(t,{DefaultWorkspace:()=>x});var i=n(102),r=n(61),o=n(58),s=n(159),a=n(162),l=n(163),c=n(164),d=n(167),u=n(172),h=n(173),p=n(174),g=n(175),f=n(177),m=n(181),y=n(192),b=n(197);function x(e){const{canvas:t,canvasWidgets:n,connectionsMenu:x,dropOnCanvas:w,halo:v,haloLink:k,selection:S,navigator:L,visualAuthoring:_,zoomControl:M,menu:I,search:T,actions:E,mainToolbar:j,actionsToolbar:N,languages:C=[]}=e,[A]=r.useState((()=>e.searchCommands??new o.EventSource)),[D]=r.useState((()=>e.connectionsMenuCommands??new o.EventSource)),[P]=r.useState((()=>e.instancesSearchCommands??new o.EventSource)),O=null===I?null:I??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.ToolbarActionClearAll,{}),(0,i.jsx)(g.ToolbarActionExport,{kind:"exportRaster"}),(0,i.jsx)(g.ToolbarActionExport,{kind:"exportSvg"}),(0,i.jsx)(g.ToolbarActionExport,{kind:"print"})]}),R=null===E?null:E??(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.ToolbarActionUndo,{}),(0,i.jsx)(g.ToolbarActionRedo,{}),(0,i.jsx)(g.ToolbarActionLayout,{}),(0,i.jsx)(g.ToolbarLanguageSelector,{languages:C})]}),z=r.useMemo((()=>[{key:"elementTypes",label:"Types",component:(0,i.jsx)(f.SearchSectionElementTypes,{instancesSearchCommands:P})},{key:"entities",label:"Entities",component:(0,i.jsx)(f.SearchSectionEntities,{instancesSearchCommands:P})},{key:"linkTypes",label:"Links",component:(0,i.jsx)(f.SearchSectionLinkTypes,{instancesSearchCommands:P})}]),[P]);return(0,i.jsx)(b.WorkspaceRoot,{children:(0,i.jsxs)(s.Canvas,{...t,children:[(0,i.jsx)(m.VisualAuthoring,{..._}),null===x?null:(0,i.jsx)(a.ConnectionsMenu,{...x,commands:D,instancesSearchCommands:P}),null===w?null:(0,i.jsx)(l.DropOnCanvas,{...w}),null===v?null:(0,i.jsx)(c.Halo,{...v,instancesSearchCommands:P,connectionsMenuCommands:null===x?void 0:D}),null===k?null:(0,i.jsx)(d.HaloLink,{...k}),null===S?null:(0,i.jsx)(h.Selection,{...S,connectionsMenuCommands:null===x?void 0:D}),null===M?null:(0,i.jsx)(y.ZoomControl,{dock:"w",...M}),null===L?null:(0,i.jsx)(u.Navigator,{dock:"se",...L}),(0,i.jsx)(p.Toolbar,{...j,dock:j?.dock??"nw",menu:O,children:null===T?null:(0,i.jsx)(f.UnifiedSearch,{...T,sections:T?.sections??z,commands:A})}),null===R?null:(0,i.jsx)(p.Toolbar,{...N,dock:N?.dock??"sw",menu:null,children:R}),n]})})}},(e,t,n)=>{n.r(t),n.d(t,{Workspace:()=>M,useLoadedWorkspace:()=>T});var i=n(102),r=n(61),o=n(149),s=n(57),a=n(58),l=n(59),c=n(69),d=n(92),u=n(94),h=n(97),p=n(99),g=n(112),f=n(116),m=n(119),y=n(123),b=n(166),x=n(126),w=n(132),v=n(134),k=n(130),S=n(0);const L="en",_=e=>{};class M extends r.Component{listener=new a.EventObserver;cancellation=new AbortController;resolveTypeStyle;cachedTypeStyles;cachedGroupStyles;layoutTypeProvider;workspaceContext;constructor(e){super(e);const{history:t=new u.InMemoryHistory,metadataProvider:n,validationProvider:i,renameLinkProvider:r,authoringCommands:o=new a.EventSource,typeStyleResolver:s,selectLabelLanguage:l,defaultLanguage:c=L,defaultLayout:d,onWorkspaceEvent:h=(()=>{})}=this.props;this.resolveTypeStyle=s??_,this.cachedTypeStyles=new WeakMap,this.cachedGroupStyles=new WeakMap;const m=new f.DataDiagramModel({history:t,selectLabelLanguage:l});m.setLanguage(c);const b=new g.SharedCanvasState({defaultElementTemplate:v.StandardTemplate,defaultLinkTemplate:w.DefaultLinkTemplate,defaultLayout:d??p.blockingDefaultLayout,renameLinkProvider:r}),k=new y.EditorController({model:m,authoringCommands:o,metadataProvider:n,validationProvider:i}),M=new x.OverlayController({model:m,view:b});this.layoutTypeProvider={getElementTypes:e=>e instanceof S.EntityElement?e.data.types:[]},this.workspaceContext={model:m,view:b,editor:k,overlay:M,disposeSignal:this.cancellation.signal,getElementStyle:this.getElementStyle,getElementTypeStyle:this.getElementTypeStyle,performLayout:this.onPerformLayout,group:this.onGroup,ungroupAll:this.onUngroupAll,ungroupSome:this.onUngroupSome,triggerWorkspaceEvent:h},d||console.warn('Reactodia.Workspace: "defaultLayout" prop is not provided, using synchronous fallback which may freeze the execution for large diagrams. It is recommended to use layout worker via Reactodia.defineDefaultLayouts() and Reactodia.useWorker().')}getContext(){return this.workspaceContext}render(){const{children:e}=this.props;return(0,i.jsx)(k.WorkspaceContext.Provider,{value:this.workspaceContext,children:e})}componentDidMount(){const{onWorkspaceEvent:e}=this.props,{model:t,view:n,overlay:i}=this.workspaceContext;this.listener.listen(t.events,"loadingSuccess",(()=>{for(const e of n.findAllCanvases())e.renderingState.syncUpdate(),e.zoomToFit()})),this.listener.listen(n.events,"iriClick",(e=>{const{onIriClick:t}=this.props;t?.(e)})),e&&(this.listener.listen(t.events,"changeSelection",(()=>e(k.WorkspaceEventKey.editorChangeSelection))),this.listener.listen(i.events,"changeOpenedDialog",(()=>e(k.WorkspaceEventKey.editorToggleDialog))))}componentWillUnmount(){this.listener.stopListening();const{view:e,editor:t,overlay:n}=this.workspaceContext;e.dispose(),t.dispose(),n.dispose()}getElementStyle=e=>e instanceof S.EntityElement?this.getElementTypeStyle(e.data.types):e instanceof m.EntityGroup?this.getGroupTypeStyle(e):this.getElementTypeStyle([]);getElementTypeStyle=e=>{let t=this.cachedTypeStyles.get(e);if(!t){const n=this.resolveTypeStyle(e),i=n?n.icon:void 0;let r;if(n&&n.color)r=(0,o.hcl)(n.color).toString();else{const t=function(e,t){const n=I(e,t);return(void 0===n?0:n)/2147483647*360}(e,195935983);r=(0,o.hcl)(t,40,75).toString()}t={icon:i,color:r},this.cachedTypeStyles.set(e,t)}return t};getGroupTypeStyle(e){const{items:t}=e;let n=this.cachedGroupStyles.get(t);if(!n){const e=new l.HashMap(I,s.shallowArrayEqual);for(const n of t)e.set(n.data.types,(e.get(n.data.types)??0)+1);let i=0,r=[];for(const[t,n]of e)n>i&&(i=n,r=t);n=this.getElementTypeStyle(r),this.cachedGroupStyles.set(t,n)}return n}onPerformLayout=async e=>{const{canvas:t,layoutFunction:n,selectedElements:i,animate:r,signal:o,zoomToFit:s=!0}=e,{model:a,view:l,overlay:c,disposeSignal:u}=this.workspaceContext,p=t??l.findAnyCanvas();if(!p)throw new Error("Failed to find any canvas to perform layout");p.renderingState.syncUpdate();const g=c.startTask({title:"Computing graph layout",delay:200});let f;try{f=await(0,h.calculateLayout)({layoutFunction:n??l.defaultLayout,model:a,selectedElements:i,sizeProvider:p.renderingState,typeProvider:this.layoutTypeProvider,signal:o??u})}catch(y){return g.setError(y),void console.error("Failed to compute graph layout",y)}finally{g.end()}const m=a.history.startBatch("Graph layout");m.history.registerToUndo(d.RestoreGeometry.capture(a));for(const d of a.links)d.setVertices([]);m.history.registerToUndo((0,d.restoreViewport)(p)),r?await Promise.all([p.animateGraph((()=>{(0,h.applyLayout)(f,a),m.store()})),s?p.zoomToFit({animate:!0}):null]):((0,h.applyLayout)(f,a),m.store(),s&&p.zoomToFit())};onGroup=({elements:e,canvas:t})=>(0,b.groupEntitiesAnimated)(e,t,this.workspaceContext);onUngroupAll=({groups:e,canvas:t})=>(0,b.ungroupAllEntitiesAnimated)(e,t,this.workspaceContext);onUngroupSome=({group:e,entities:t,canvas:n})=>(0,b.ungroupSomeEntitiesAnimated)(e,t,n,this.workspaceContext)}function I(e,t=0){let n=0|t;for(const i of e)n=Math.imul(n,31)+(0|(0,c.hashFnv32a)(i,n));return 0|n}function T(e,t){const[n,i]=r.useState(),o=r.useRef();if(o.current)o.current.latestOnLoad=e;else{const t={latestOnLoad:e,context:void 0,loadedWorkspace:{getContext:()=>{if(!t.context)throw new Error("Cannot get Reactodia Workspace context: it is not mounted yet");return t.context},onMount:e=>{const n=e?.getContext();t.context=n,i(n)}}};o.current=t}return r.useEffect((()=>{if(n){const e=o.current.latestOnLoad,t=new AbortController;return(async()=>{const i=n.overlay.startTask();try{await e({context:n,signal:t.signal})}catch(r){t.signal.aborted||(i.setError(r),console.error("Reactodia: failed to load a workspace",r))}finally{i.end()}t.signal.aborted||n.model.history.reset()})(),()=>{t.abort(),n.model.discardLayout()}}}),[n,...t]),o.current.loadedWorkspace}}],Me={};function Ie(e){var t=Me[e];if(void 0!==t)return t.exports;var n=Me[e]={id:e,exports:{}};return _e[e](n,n.exports,Ie),n.exports}Ie.m=_e,Ie.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return Ie.d(t,{a:t}),t},Ie.d=(e,t)=>{for(var n in t)Ie.o(t,n)&&!Ie.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ie.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Ie.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Ie.b=document.baseURI||self.location.href,Ie.nc=void 0;var Te=Ie(0),Ee=Te.AbortScope,je=Te.AuthoringState,Ne=Te.BuiltinDialogType,Ce=Te.Canvas,Ae=Te.CanvasContext,De=Te.ClassTree,Pe=Te.ClassicTemplate,Oe=Te.ClassicToolbar,Re=Te.ClassicWorkspace,ze=Te.Command,$e=Te.CompositeDataProvider,Ue=Te.ConnectionsMenu,Be=Te.DBPediaSettings,We=Te.DIAGRAM_CONTEXT_URL_V1,Ye=Te.DataDiagramModel,Fe=Te.Debouncer,Qe=Te.DecoratedDataProvider,Ve=Te.DefaultLinkPathTemplate,Ge=Te.DefaultLinkTemplate,Ze=Te.DefaultWorkspace,He=Te.DraggableHandle,qe=Te.DropOnCanvas,Xe=Te.DropdownMenu,Je=Te.DropdownMenuItem,Ke=Te.EditorController,et=Te.Element,tt=Te.ElementType,nt=Te.EmptyDataProvider,it=Te.EntityElement,rt=Te.EntityGroup,ot=Te.EventObserver,st=Te.EventSource,at=Te.GroupPaginator,lt=Te.Halo,ct=Te.HaloLink,dt=Te.HashMap,ut=Te.HashSet,ht=Te.HtmlSpinner,pt=Te.InMemoryHistory,gt=Te.IndexQuadBy,ft=Te.IndexedDbCachedProvider,mt=Te.InstancesSearch,yt=Te.KeyedObserver,bt=Te.LINK_STYLE_SHOW_IRI,xt=Te.Link,wt=Te.LinkAction,vt=Te.LinkActionDelete,kt=Te.LinkActionEdit,St=Te.LinkActionMoveEndpoint,Lt=Te.LinkActionRename,_t=Te.LinkActionSpinner,Mt=Te.LinkLabel,It=Te.LinkPath,Tt=Te.LinkType,Et=Te.LinkTypesToolbox,jt=Te.LinkVertex,Nt=Te.LinkVertices,Ct=Te.ListElementView,At=Te.Navigator,Dt=Te.OntologyLinkTemplates,Pt=Te.OverlayController,Ot=Te.OwlRdfsSettings,Rt=Te.OwlStatsSettings,zt=Te.PLACEHOLDER_ELEMENT_TYPE,$t=Te.PLACEHOLDER_LINK_TYPE,Ut=Te.ProgressBar,Bt=Te.PropertyType,Wt=Te.Rdf,Yt=Te.RdfDataProvider,Ft=Te.RdfSettings,Qt=Te.Rect,Vt=Te.RelationGroup,Gt=Te.RelationLink,Zt=Te.RenameLinkToLinkStateProvider,Ht=Te.RenderingLayer,qt=Te.RestoreGeometry,Xt=Te.SearchResults,Jt=Te.SearchSectionElementTypes,Kt=Te.SearchSectionEntities,en=Te.SearchSectionLinkTypes,tn=Te.Selection,nn=Te.SelectionAction,rn=Te.SelectionActionAddToFilter,on=Te.SelectionActionAnchor,sn=Te.SelectionActionConnections,an=Te.SelectionActionEstablishLink,ln=Te.SelectionActionExpand,cn=Te.SelectionActionGroup,dn=Te.SelectionActionLayout,un=Te.SelectionActionRemove,hn=Te.SelectionActionSpinner,pn=Te.SelectionActionZoomToFit,gn=Te.SemanticTypeStyles,fn=Te.SparqlDataProvider,mn=Te.Spinner,yn=Te.StandardTemplate,bn=Te.TemplateProperties,xn=Te.TemporaryState,wn=Te.Toolbar,vn=Te.ToolbarAction,kn=Te.ToolbarActionClearAll,Sn=Te.ToolbarActionExport,Ln=Te.ToolbarActionLayout,_n=Te.ToolbarActionOpen,Mn=Te.ToolbarActionRedo,In=Te.ToolbarActionSave,Tn=Te.ToolbarActionUndo,En=Te.ToolbarLanguageSelector,jn=Te.TransformedSvgCanvas,Nn=Te.UnifiedSearch,Cn=Te.ValidationState,An=Te.Vector,Dn=Te.ViewportDock,Pn=Te.VisualAuthoring,On=Te.VoidElement,Rn=Te.WikidataSettings,zn=Te.WithFetchStatus,$n=Te.Workspace,Un=Te.WorkspaceContext,Bn=Te.WorkspaceEventKey,Wn=Te.WorkspaceLayoutColumn,Yn=Te.WorkspaceLayoutItem,Fn=Te.WorkspaceLayoutResizeContext,Qn=Te.WorkspaceLayoutRow,Vn=Te.WorkspaceRoot,Gn=Te.ZoomControl,Zn=Te.animateInterval,Hn=Te.applyLayout,qn=Te.blockingDefaultLayout,Xn=Te.boundsOf,Jn=Te.calculateAveragePosition,Kn=Te.calculateLayout,ei=Te.changeEntityData,ti=Te.changeLinkTypeVisibility,ni=Te.changeRelationData,ii=Te.colaFlowLayout,ri=Te.colaForceLayout,oi=Te.colaRemoveOverlaps,si=Te.computePolyline,ai=Te.computePolylineLength,li=Te.defineCanvasWidget,ci=Te.defineLayoutWorker,di=Te.defineWorker,ui=Te.delay,hi=Te.delayProviderDecorator,pi=Te.equalElements,gi=Te.equalLinks,fi=Te.equalProperties,mi=Te.equalSubtypeEdges,yi=Te.findElementAtPoint,bi=Te.findNearestSegmentIndex,xi=Te.getContentFittingBox,wi=Te.getContentFittingBoxForLayout,vi=Te.getPointAlongPolyline,ki=Te.hashLink,Si=Te.hashSubtypeEdge,Li=Te.highlightSubstring,_i=Te.indexedDataset,Mi=Te.isEncodedBlank,Ii=Te.isPolylineEqual,Ti=Te.iterateEntitiesOf,Ei=Te.iterateRelationsOf,ji=Te.layoutPadded,Ni=Te.layoutPaddedBiasFree,Ci=Te.mapAbortedToNull,Ai=Te.moveComparator,Di=Te.paneTopLeft,Pi=Te.pathFromPolyline,Oi=Te.placeElementsAroundTarget,Ri=Te.raceAbortSignal,zi=Te.requestElementData,$i=Te.restoreCapturedLinkGeometry,Ui=Te.restoreLinksBetweenElements,Bi=Te.restoreViewport,Wi=Te.setElementExpanded,Yi=Te.setElementState,Fi=Te.setEntityElementData,Qi=Te.setEntityGroupItems,Vi=Te.setLinkState,Gi=Te.setRelationGroupItems,Zi=Te.setRelationLinkData,Hi=Te.shallowArrayEqual,qi=Te.startDragElements,Xi=Te.subscribeElementTypes,Ji=Te.subscribeLinkTypes,Ki=Te.subscribePropertyTypes,er=Te.totalPaneSize,tr=Te.translateToPositiveQuadrant,nr=Te.uniformGrid,ir=Te.useAuthoredEntity,rr=Te.useCanvas,or=Te.useEventStore,sr=Te.useFrameDebouncedStore,ar=Te.useKeyedSyncStore,lr=Te.useLinkActionContext,cr=Te.useLoadedWorkspace,dr=Te.useObservedProperty,ur=Te.useSearchInputStore,hr=Te.useSyncStore,pr=Te.useSyncStoreWithComparator,gr=Te.useUnifiedSearchSection,fr=Te.useWorker,mr=Te.useWorkspace},25568:e=>{"use strict";const{AbortController:t,AbortSignal:n}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=n,e.exports.default=t},78478:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});n(96540);var i=n(92303),r=n(74848);function o(e){let{children:t,fallback:n}=e;return(0,i.A)()?(0,r.jsx)(r.Fragment,{children:t?.()}):n??null}},67526:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],l=o[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),d=0,u=l>0?s-4:s;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===l&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===l&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,o=[],s=16383,a=0,c=i-r;a<c;a+=s)o.push(l(e,a,a+s>c?c:a+s));1===r?(t=e[i-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,i){for(var r,o,s=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},48287:(e,t,n)=>{"use strict";const i=n(67526),r=n(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|f(e,t);let i=a(n);const r=i.write(e,t);r!==n&&(i=i.slice(0,r));return i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(H(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(H(e,ArrayBuffer)||e&&H(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(H(e,SharedArrayBuffer)||e&&H(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,n);const r=function(e){if(l.isBuffer(e)){const t=0|g(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||q(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),a(e<0?0:0|g(e))}function h(e){const t=e.length<0?0:0|g(e.length),n=a(t);for(let i=0;i<t;i+=1)n[i]=255&e[i];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(i,l.prototype),i}function g(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||H(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return i?-1:V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return _(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function b(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),q(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:x(e,t,n,i,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):x(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function x(e,t,n,i,r){let o,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){let i=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===i?0:o-i)){if(-1===i&&(i=o),o-i+1===l)return i*s}else-1!==i&&(o-=o-i),i=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){let n=!0;for(let i=0;i<l;i++)if(c(e,o+i)!==c(t,i)){n=!1;break}if(n)return o}return-1}function w(e,t,n,i){n=Number(n)||0;const r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;const o=t.length;let s;for(i>o/2&&(i=o/2),s=0;s<i;++s){const i=parseInt(t.substr(2*s,2),16);if(q(i))return s;e[n+s]=i}return s}function v(e,t,n,i){return Z(V(t,e.length-n),e,n,i)}function k(e,t,n,i){return Z(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function S(e,t,n,i){return Z(G(t),e,n,i)}function L(e,t,n,i){return Z(function(e,t){let n,i,r;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function _(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);const i=[];let r=t;for(;r<n;){const t=e[r];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(r+s<=n){let n,i,a,l;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[r+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[r+1],i=e[r+2],128==(192&n)&&128==(192&i)&&(l=(15&t)<<12|(63&n)<<6|63&i,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[r+1],i=e[r+2],a=e[r+3],128==(192&n)&&128==(192&i)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&i)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|1023&o),i.push(o),r+=s}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=I));return n}(i)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(H(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),H(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const i=l.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(H(t,Uint8Array))r+t.length>i.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(i,r)):Uint8Array.prototype.set.call(i,t,r);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,r)}r+=t.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?M(this,0,e):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,i,r){if(H(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),c=this.slice(i,r),d=e.slice(t,n);for(let l=0;l<a;++l)if(c[l]!==d[l]){o=c[l],s=d[l];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":case"latin1":case"binary":return k(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function E(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function j(e,t,n){const i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);let r="";for(let o=t;o<n;++o)r+=X[e[o]];return r}function N(e,t,n){const i=e.slice(t,n);let r="";for(let o=0;o<i.length-1;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function D(e,t,n,i,r){W(t,i,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function P(e,t,n,i,r){W(t,i,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function O(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(e,t,n,i,o){return t=+t,n>>>=0,o||O(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function z(e,t,n,i,o){return t=+t,n>>>=0,o||O(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e],r=1,o=0;for(;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e+--t],r=1;for(;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(i)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(i)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=this[e],r=1,o=0;for(;++o<t&&(r*=256);)i+=this[e+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let i=t,r=1,o=this[e+--i];for(;i>0&&(r*=256);)o+=this[e+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=J((function(e){Y(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t>>>=0,n>>>=0,!i){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t>>>=0,n>>>=0,!i){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}let r=0,o=1,s=0;for(this[t]=255&e;++r<n&&(o*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/o|0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}let r=n-1,o=1,s=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/o|0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return R(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return z(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return z(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);const r=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{const o=l.isBuffer(e)?e:l.from(e,i),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=o[r%s]}return this};const $={};function U(e,t,n){$[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function B(e){let t="",n=e.length;const i="-"===e[0]?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function W(e,t,n,i,r,o){if(e>n||e<t){const i="bigint"==typeof t?"n":"";let r;throw r=o>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(o+1)}${i}`:`>= -(2${i} ** ${8*(o+1)-1}${i}) and < 2 ** ${8*(o+1)-1}${i}`:`>= ${t}${i} and <= ${n}${i}`,new $.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){Y(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||F(t,e.length-(n+1))}(i,r,o)}function Y(e,t){if("number"!=typeof e)throw new $.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,n){if(Math.floor(e)!==e)throw Y(e,n),new $.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new $.ERR_BUFFER_OUT_OF_BOUNDS;throw new $.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){let i=`The value of "${e}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=B(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=B(r)),r+="n"),i+=` It must be ${t}. Received ${r}`,i}),RangeError);const Q=/[^+/0-9A-Za-z-_]/g;function V(e,t){let n;t=t||1/0;const i=e.length;let r=null;const o=[];for(let s=0;s<i;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Z(e,t,n,i){let r;for(r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function H(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const i=16*n;for(let r=0;r<16;++r)t[i+r]=e[n]+e[r]}return t}();function J(e){return"undefined"==typeof BigInt?K:e}function K(){throw new Error("BigInt not supported")}},37007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&f(e,"error",t,n)}(e,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,s,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=l(e))>0&&s.length>r&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,c=d,console&&console.warn&&console.warn(c)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function h(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):g(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var c=l.length,d=g(l,c);for(n=0;n<c;++n)i(d[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4213:function(e,t,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){l(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,t,n){var a=s.URL||s.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):r(l.href)?i(e,t,n):o(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),n);else if(r(e))i(e,n,s);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout((function(){o(a)}))}}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,n);var o="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&l||a)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=s.URL||s.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});s.saveAs=l.saveAs=l,e.exports=l})?i.apply(t,r):i)||(e.exports=o)},251:(e,t)=>{t.read=function(e,t,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,d=-7,u=n?r-1:0,h=n?-1:1,p=e[t+u];for(u+=h,o=p&(1<<-d)-1,p>>=-d,d+=a;d>0;o=256*o+e[t+u],u+=h,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=i;d>0;s=256*s+e[t+u],u+=h,d-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var s,a,l,c=8*o-r-1,d=(1<<c)-1,u=d>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,g=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(t*l-1)*Math.pow(2,r),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&a,p+=g,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;e[n+p]=255&s,p+=g,s/=256,c-=8);e[n+p-g]|=128*f}},30810:(e,t,n)=>{"use strict";const{SymbolDispose:i}=n(74641),{AbortError:r,codes:o}=n(68526),{isNodeStream:s,isWebStream:a,kControllerErrorFunction:l}=n(136),c=n(89365),{ERR_INVALID_ARG_TYPE:d}=o;let u;e.exports.addAbortSignal=function(t,n){if(((e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new d(t,"AbortSignal",e)})(t,"signal"),!s(n)&&!a(n))throw new d("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;const o=s(t)?()=>{t.destroy(new r(void 0,{cause:e.reason}))}:()=>{t[l](new r(void 0,{cause:e.reason}))};if(e.aborted)o();else{u=u||n(56017).addAbortListener;const r=u(e,o);c(t,r[i])}return t}},85586:(e,t,n)=>{"use strict";const{StringPrototypeSlice:i,SymbolIterator:r,TypedArrayPrototypeSet:o,Uint8Array:s}=n(74641),{Buffer:a}=n(48287),{inspect:l}=n(56017);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;for(;null!==(t=t.next);)n+=e+t.data;return n}concat(e){if(0===this.length)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let n=this.head,i=0;for(;n;)o(t,n.data,i),i+=n.data.length,n=n.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[r](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,r=0;do{const o=n.data;if(!(e>o.length)){e===o.length?(t+=o,++r,n.next?this.head=n.next:this.head=this.tail=null):(t+=i(o,0,e),this.head=n,n.data=i(o,e));break}t+=o,e-=o.length,++r}while(null!==(n=n.next));return this.length-=r,t}_getBuffer(e){const t=a.allocUnsafe(e),n=e;let i=this.head,r=0;do{const a=i.data;if(!(e>a.length)){e===a.length?(o(t,a,n-e),++r,i.next?this.head=i.next:this.head=this.tail=null):(o(t,new s(a.buffer,a.byteOffset,e),n-e),this.head=i,i.data=a.slice(e));break}o(t,a,n-e),e-=a.length,++r}while(null!==(i=i.next));return this.length-=r,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},8489:(e,t,n)=>{"use strict";const{pipeline:i}=n(28431),r=n(43559),{destroyer:o}=n(57647),{isNodeStream:s,isReadable:a,isWritable:l,isWebStream:c,isTransformStream:d,isWritableStream:u,isReadableStream:h}=n(136),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:g,ERR_MISSING_ARGS:f}}=n(68526),m=n(89365);e.exports=function(...e){if(0===e.length)throw new f("streams");if(1===e.length)return r.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=r.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=r.from(e[t])}for(let i=0;i<e.length;++i)if(s(e[i])||c(e[i])){if(i<e.length-1&&!(a(e[i])||h(e[i])||d(e[i])))throw new g(`streams[${i}]`,t[i],"must be readable");if(i>0&&!(l(e[i])||u(e[i])||d(e[i])))throw new g(`streams[${i}]`,t[i],"must be writable")}let n,y,b,x,w;const v=e[0],k=i(e,(function(e){const t=x;x=null,t?t(e):e?w.destroy(e):L||S||w.destroy()})),S=!!(l(v)||u(v)||d(v)),L=!!(a(k)||h(k)||d(k));if(w=new r({writableObjectMode:!(null==v||!v.writableObjectMode),readableObjectMode:!(null==k||!k.readableObjectMode),writable:S,readable:L}),S){if(s(v))w._write=function(e,t,i){v.write(e,t)?i():n=i},w._final=function(e){v.end(),y=e},v.on("drain",(function(){if(n){const e=n;n=null,e()}}));else if(c(v)){const e=(d(v)?v.writable:v).getWriter();w._write=async function(t,n,i){try{await e.ready,e.write(t).catch((()=>{})),i()}catch(r){i(r)}},w._final=async function(t){try{await e.ready,e.close().catch((()=>{})),y=t}catch(n){t(n)}}}const e=d(k)?k.readable:k;m(e,(()=>{if(y){const e=y;y=null,e()}}))}if(L)if(s(k))k.on("readable",(function(){if(b){const e=b;b=null,e()}})),k.on("end",(function(){w.push(null)})),w._read=function(){for(;;){const e=k.read();if(null===e)return void(b=w._read);if(!w.push(e))return}};else if(c(k)){const e=(d(k)?k.readable:k).getReader();w._read=async function(){for(;;)try{const{value:t,done:n}=await e.read();if(!w.push(t))return;if(n)return void w.push(null)}catch{return}}}return w._destroy=function(e,t){e||null===x||(e=new p),b=null,n=null,y=null,null===x?t(e):(x=t,s(k)&&o(k,e))},w}},57647:(e,t,n)=>{"use strict";const i=n(65606),{aggregateTwoErrors:r,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:s}=n(68526),{Symbol:a}=n(74641),{kIsDestroyed:l,isDestroyed:c,isFinished:d,isServerRequest:u}=n(136),h=a("kDestroy"),p=a("kConstruct");function g(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function f(e,t,n){let r=!1;function o(t){if(r)return;r=!0;const o=e._readableState,s=e._writableState;g(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(t),t?i.nextTick(m,e,t):i.nextTick(y,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function m(e,t){b(e,t),y(e)}function y(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=n&&n.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function b(e,t){const n=e._readableState,i=e._writableState;null!=i&&i.errorEmitted||null!=n&&n.errorEmitted||(i&&(i.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function x(e,t,n){const r=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=r&&r.destroyed)return this;null!=r&&r.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),r&&!r.errored&&(r.errored=t),n?i.nextTick(b,e,t):b(e,t))}function w(e){let t=!1;function n(n){if(t)return void x(e,null!=n?n:new o);t=!0;const r=e._readableState,s=e._writableState,a=s||r;r&&(r.constructed=!0),s&&(s.constructed=!0),a.destroyed?e.emit(h,n):n?x(e,n,!0):i.nextTick(v,e)}try{e._construct((e=>{i.nextTick(n,e)}))}catch(r){i.nextTick(n,r)}}function v(e){e.emit(p)}function k(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function S(e){e.emit("close")}function L(e,t){e.emit("error",t),i.nextTick(S,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(p,t),e.listenerCount(p)>1||i.nextTick(w,e)},destroyer:function(e,t){e&&!c(e)&&(t||d(e)||(t=new s),u(e)?(e.socket=null,e.destroy(t)):k(e)?e.abort():k(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?i.nextTick(L,e,t):i.nextTick(S,e),e.destroyed||(e[l]=!0))},destroy:function(e,t){const n=this._readableState,i=this._writableState,o=i||n;return null!=i&&i.destroyed||null!=n&&n.destroyed?("function"==typeof t&&t(),this):(g(e,i,n),i&&(i.destroyed=!0),n&&(n.destroyed=!0),o.constructed?f(this,e,t):this.once(h,(function(n){f(this,r(n,e),t)})),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:x}},43559:(e,t,n)=>{"use strict";const{ObjectDefineProperties:i,ObjectGetOwnPropertyDescriptor:r,ObjectKeys:o,ObjectSetPrototypeOf:s}=n(74641);e.exports=c;const a=n(23125),l=n(77221);s(c.prototype,a.prototype),s(c,a);{const e=o(l.prototype);for(let t=0;t<e.length;t++){const n=e[t];c.prototype[n]||(c.prototype[n]=l.prototype[n])}}function c(e){if(!(this instanceof c))return new c(e);a.call(this,e),l.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let d,u;function h(){return void 0===d&&(d={}),d}i(c.prototype,{writable:{__proto__:null,...r(l.prototype,"writable")},writableHighWaterMark:{__proto__:null,...r(l.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...r(l.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...r(l.prototype,"writableBuffer")},writableLength:{__proto__:null,...r(l.prototype,"writableLength")},writableFinished:{__proto__:null,...r(l.prototype,"writableFinished")},writableCorked:{__proto__:null,...r(l.prototype,"writableCorked")},writableEnded:{__proto__:null,...r(l.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...r(l.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),c.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},c.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},c.from=function(e){return u||(u=n(21973)),u(e,"body")}},21973:(e,t,n)=>{const i=n(65606),r=n(48287),{isReadable:o,isWritable:s,isIterable:a,isNodeStream:l,isReadableNodeStream:c,isWritableNodeStream:d,isDuplexNodeStream:u,isReadableStream:h,isWritableStream:p}=n(136),g=n(89365),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=n(68526),{destroyer:b}=n(57647),x=n(43559),w=n(23125),v=n(77221),{createDeferredPromise:k}=n(56017),S=n(40333),L=globalThis.Blob||r.Blob,_=void 0!==L?function(e){return e instanceof L}:function(e){return!1},M=globalThis.AbortController||n(25568).AbortController,{FunctionPrototypeCall:I}=n(74641);class T extends x{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function E(e){const t=e.readable&&"function"!=typeof e.readable.read?w.wrap(e.readable):e.readable,n=e.writable;let i,r,a,l,c,d=!!o(t),u=!!s(n);function h(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new T({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==n||!n.writableObjectMode),readable:d,writable:u}),u&&(g(n,(e=>{u=!1,e&&b(t,e),h(e)})),c._write=function(e,t,r){n.write(e,t)?r():i=r},c._final=function(e){n.end(),r=e},n.on("drain",(function(){if(i){const e=i;i=null,e()}})),n.on("finish",(function(){if(r){const e=r;r=null,e()}}))),d&&(g(t,(e=>{d=!1,e&&b(t,e),h(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){c.push(null)})),c._read=function(){for(;;){const e=t.read();if(null===e)return void(a=c._read);if(!c.push(e))return}}),c._destroy=function(e,o){e||null===l||(e=new f),a=null,i=null,r=null,null===l?o(e):(l=o,b(n,e),b(t,e))},c}e.exports=function e(t,n){if(u(t))return t;if(c(t))return E({readable:t});if(d(t))return E({writable:t});if(l(t))return E({writable:!1,readable:!1});if(h(t))return E({readable:w.fromWeb(t)});if(p(t))return E({writable:v.fromWeb(t)});if("function"==typeof t){const{value:e,write:r,final:o,destroy:s}=function(e){let{promise:t,resolve:n}=k();const r=new M,o=r.signal,s=e(async function*(){for(;;){const e=t;t=null;const{chunk:r,done:s,cb:a}=await e;if(i.nextTick(a),s)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:n}=k()),yield r}}(),{signal:o});return{value:s,write(e,t,i){const r=n;n=null,r({chunk:e,done:!1,cb:i})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){r.abort(),t(e)}}}(t);if(a(e))return S(T,e,{objectMode:!0,write:r,final:o,destroy:s});const l=null==e?void 0:e.then;if("function"==typeof l){let t;const n=I(l,e,(e=>{if(null!=e)throw new y("nully","body",e)}),(e=>{b(t,e)}));return t=new T({objectMode:!0,readable:!1,write:r,final(e){o((async()=>{try{await n,i.nextTick(e,null)}catch(t){i.nextTick(e,t)}}))},destroy:s})}throw new y("Iterable, AsyncIterable or AsyncFunction",n,e)}if(_(t))return e(t.arrayBuffer());if(a(t))return S(T,t,{objectMode:!0,writable:!1});if(h(null==t?void 0:t.readable)&&p(null==t?void 0:t.writable))return T.fromWeb(t);if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable)){return E({readable:null!=t&&t.readable?c(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?d(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0})}const r=null==t?void 0:t.then;if("function"==typeof r){let e;return I(r,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{b(e,t)})),e=new T({objectMode:!0,writable:!1,read(){}})}throw new m(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},89365:(e,t,n)=>{const i=n(65606),{AbortError:r,codes:o}=n(68526),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:a}=o,{kEmptyObject:l,once:c}=n(56017),{validateAbortSignal:d,validateFunction:u,validateObject:h,validateBoolean:p}=n(2224),{Promise:g,PromisePrototypeThen:f,SymbolDispose:m}=n(74641),{isClosed:y,isReadable:b,isReadableNodeStream:x,isReadableStream:w,isReadableFinished:v,isReadableErrored:k,isWritable:S,isWritableNodeStream:L,isWritableStream:_,isWritableFinished:M,isWritableErrored:I,isNodeStream:T,willEmitClose:E,kIsClosedPromise:j}=n(136);let N;const C=()=>{};function A(e,t,o){var p,g;if(2===arguments.length?(o=t,t=l):null==t?t=l:h(t,"options"),u(o,"callback"),d(t.signal,"options.signal"),o=c(o),w(e)||_(e))return function(e,t,o){let s=!1,a=C;if(t.signal)if(a=()=>{s=!0,o.call(e,new r(void 0,{cause:t.signal.reason}))},t.signal.aborted)i.nextTick(a);else{N=N||n(56017).addAbortListener;const i=N(t.signal,a),r=o;o=c(((...t)=>{i[m](),r.apply(e,t)}))}const l=(...t)=>{s||i.nextTick((()=>o.apply(e,t)))};return f(e[j].promise,l,l),C}(e,t,o);if(!T(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);const A=null!==(p=t.readable)&&void 0!==p?p:x(e),D=null!==(g=t.writable)&&void 0!==g?g:L(e),P=e._writableState,O=e._readableState,R=()=>{e.writable||U()};let z=E(e)&&x(e)===A&&L(e)===D,$=M(e,!1);const U=()=>{$=!0,e.destroyed&&(z=!1),(!z||e.readable&&!A)&&(A&&!B||o.call(e))};let B=v(e,!1);const W=()=>{B=!0,e.destroyed&&(z=!1),(!z||e.writable&&!D)&&(D&&!$||o.call(e))},Y=t=>{o.call(e,t)};let F=y(e);const Q=()=>{F=!0;const t=I(e)||k(e);return t&&"boolean"!=typeof t?o.call(e,t):A&&!B&&x(e,!0)&&!v(e,!1)?o.call(e,new a):!D||$||M(e,!1)?void o.call(e):o.call(e,new a)},V=()=>{F=!0;const t=I(e)||k(e);if(t&&"boolean"!=typeof t)return o.call(e,t);o.call(e)},G=()=>{e.req.on("finish",U)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?D&&!P&&(e.on("end",R),e.on("close",R)):(e.on("complete",U),z||e.on("abort",Q),e.req?G():e.on("request",G)),z||"boolean"!=typeof e.aborted||e.on("aborted",Q),e.on("end",W),e.on("finish",U),!1!==t.error&&e.on("error",Y),e.on("close",Q),F?i.nextTick(Q):null!=P&&P.errorEmitted||null!=O&&O.errorEmitted?z||i.nextTick(V):(A||z&&!b(e)||!$&&!1!==S(e))&&(D||z&&!S(e)||!B&&!1!==b(e))?O&&e.req&&e.aborted&&i.nextTick(V):i.nextTick(V);const Z=()=>{o=C,e.removeListener("aborted",Q),e.removeListener("complete",U),e.removeListener("abort",Q),e.removeListener("request",G),e.req&&e.req.removeListener("finish",U),e.removeListener("end",R),e.removeListener("close",R),e.removeListener("finish",U),e.removeListener("end",W),e.removeListener("error",Y),e.removeListener("close",Q)};if(t.signal&&!F){const s=()=>{const n=o;Z(),n.call(e,new r(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)i.nextTick(s);else{N=N||n(56017).addAbortListener;const i=N(t.signal,s),r=o;o=c(((...t)=>{i[m](),r.apply(e,t)}))}}return Z}e.exports=A,e.exports.finished=function(e,t){var n;let i=!1;return null===t&&(t=l),null!==(n=t)&&void 0!==n&&n.cleanup&&(p(t.cleanup,"cleanup"),i=t.cleanup),new g(((n,r)=>{const o=A(e,t,(e=>{i&&o(),e?r(e):n()}))}))}},40333:(e,t,n)=>{"use strict";const i=n(65606),{PromisePrototypeThen:r,SymbolAsyncIterator:o,SymbolIterator:s}=n(74641),{Buffer:a}=n(48287),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:c}=n(68526).codes;e.exports=function(e,t,n){let d,u;if("string"==typeof t||t instanceof a)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});if(t&&t[o])u=!0,d=t[o]();else{if(!t||!t[s])throw new l("iterable",["Iterable"],t);u=!1,d=t[s]()}const h=new e({objectMode:!0,highWaterMark:1,...n});let p=!1;return h._read=function(){p||(p=!0,async function(){for(;;){try{const{value:e,done:t}=u?await d.next():d.next();if(t)h.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw p=!1,new c;if(h.push(t))continue;p=!1}}catch(e){h.destroy(e)}break}}())},h._destroy=function(e,t){r(async function(e){const t=null!=e,n="function"==typeof d.throw;if(t&&n){const{value:t,done:n}=await d.throw(e);if(await t,n)return}if("function"==typeof d.return){const{value:e}=await d.return();await e}}(e),(()=>i.nextTick(t,e)),(n=>i.nextTick(t,n||e)))},h}},80334:(e,t,n)=>{"use strict";const{ArrayIsArray:i,ObjectSetPrototypeOf:r}=n(74641),{EventEmitter:o}=n(37007);function s(e){o.call(this,e)}function a(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}r(s.prototype,o.prototype),r(s,o),s.prototype.pipe=function(e,t){const n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function d(e){u(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function u(){n.removeListener("data",i),e.removeListener("drain",r),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",d),e.removeListener("error",d),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return a(n,"error",d),a(e,"error",d),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e},e.exports={Stream:s,prependListener:a}},1284:(e,t,n)=>{"use strict";const i=globalThis.AbortController||n(25568).AbortController,{codes:{ERR_INVALID_ARG_VALUE:r,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:s,ERR_OUT_OF_RANGE:a},AbortError:l}=n(68526),{validateAbortSignal:c,validateInteger:d,validateObject:u}=n(2224),h=n(74641).Symbol("kWeak"),p=n(74641).Symbol("kResistStopPropagation"),{finished:g}=n(89365),f=n(8489),{addAbortSignalNoValidate:m}=n(30810),{isWritable:y,isNodeStream:b}=n(136),{deprecate:x}=n(56017),{ArrayPrototypePush:w,Boolean:v,MathFloor:k,Number:S,NumberIsNaN:L,Promise:_,PromiseReject:M,PromiseResolve:I,PromisePrototypeThen:T,Symbol:E}=n(74641),j=E("kEmpty"),N=E("kEof");function C(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal");let i=1;null!=(null==t?void 0:t.concurrency)&&(i=k(t.concurrency));let r=i-1;return null!=(null==t?void 0:t.highWaterMark)&&(r=k(t.highWaterMark)),d(i,"options.concurrency",1),d(r,"options.highWaterMark",0),r+=i,async function*(){const o=n(56017).AbortSignalAny([null==t?void 0:t.signal].filter(v)),s=this,a=[],c={signal:o};let d,u,h=!1,p=0;function g(){h=!0,f()}function f(){p-=1,m()}function m(){u&&!h&&p<i&&a.length<r&&(u(),u=null)}!async function(){try{for await(let n of s){if(h)return;if(o.aborted)throw new l;try{if(n=e(n,c),n===j)continue;n=I(n)}catch(t){n=M(t)}p+=1,T(n,f,g),a.push(n),d&&(d(),d=null),!h&&(a.length>=r||p>=i)&&await new _((e=>{u=e}))}a.push(N)}catch(t){const e=M(t);T(e,f,g),a.push(e)}finally{h=!0,d&&(d(),d=null)}}();try{for(;;){for(;a.length>0;){const e=await a[0];if(e===N)return;if(o.aborted)throw new l;e!==j&&(yield e),a.shift(),m()}await new _((e=>{d=e}))}}finally{h=!0,u&&(u(),u=null)}}.call(this)}async function A(e,t=void 0){for await(const n of D.call(this,e,t))return!0;return!1}function D(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return C.call(this,(async function(t,n){return await e(t,n)?t:j}),t)}class P extends s{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function O(e){if(e=S(e),L(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:x((function(e=void 0){return null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&c(e.signal,"options.signal"),async function*(){let t=0;for await(const i of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l({cause:e.signal.reason});yield[t++,i]}}.call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const r of this){var i;if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;e--<=0&&(yield r)}}.call(this)},filter:D,flatMap:function(e,t){const n=C.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)},map:C,take:function(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const r of this){var i;if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;if(e-- >0&&(yield r),e<=0)return}}.call(this)},compose:function(e,t){if(null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&c(t.signal,"options.signal"),b(e)&&!y(e))throw new r("stream",e,"must be writable");const n=f(this,e);return null!=t&&t.signal&&m(t.signal,n),n}},e.exports.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await A.call(this,(async(...t)=>!await e(...t)),t)},forEach:async function(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);for await(const n of C.call(this,(async function(t,n){return await e(t,n),j}),t));},reduce:async function(e,t,n){var r;if("function"!=typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=n&&u(n,"options"),null!=(null==n?void 0:n.signal)&&c(n.signal,"options.signal");let s=arguments.length>1;if(null!=n&&null!==(r=n.signal)&&void 0!==r&&r.aborted){const e=new l(void 0,{cause:n.signal.reason});throw this.once("error",(()=>{})),await g(this.destroy(e)),e}const a=new i,d=a.signal;if(null!=n&&n.signal){const e={once:!0,[h]:this,[p]:!0};n.signal.addEventListener("abort",(()=>a.abort()),e)}let f=!1;try{for await(const i of this){var m;if(f=!0,null!=n&&null!==(m=n.signal)&&void 0!==m&&m.aborted)throw new l;s?t=await e(t,i,{signal:d}):(t=i,s=!0)}if(!f&&!s)throw new P}finally{a.abort()}return t},toArray:async function(e){null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&c(e.signal,"options.signal");const t=[];for await(const i of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l(void 0,{cause:e.signal.reason});w(t,i)}return t},some:A,find:async function(e,t){for await(const n of D.call(this,e,t))return n}}},62091:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:i}=n(74641);e.exports=o;const r=n(68649);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i(o.prototype,r.prototype),i(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},28431:(e,t,n)=>{const i=n(65606),{ArrayIsArray:r,Promise:o,SymbolAsyncIterator:s,SymbolDispose:a}=n(74641),l=n(89365),{once:c}=n(56017),d=n(57647),u=n(43559),{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:g,ERR_MISSING_ARGS:f,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=n(68526),{validateFunction:x,validateAbortSignal:w}=n(2224),{isIterable:v,isReadable:k,isReadableNodeStream:S,isNodeStream:L,isTransformStream:_,isWebStream:M,isReadableStream:I,isReadableFinished:T}=n(136),E=globalThis.AbortController||n(25568).AbortController;let j,N,C;function A(e,t,n){let i=!1;e.on("close",(()=>{i=!0}));return{destroy:t=>{i||(i=!0,d.destroyer(e,t||new m("pipe")))},cleanup:l(e,{readable:t,writable:n},(e=>{i=!e}))}}function D(e){if(v(e))return e;if(S(e))return async function*(e){N||(N=n(23125));yield*N.prototype[s].call(e)}(e);throw new p("val",["Readable","Iterable","AsyncIterable"],e)}async function P(e,t,n,{end:i}){let r,s=null;const a=e=>{if(e&&(r=e),s){const e=s;s=null,e()}},c=()=>new o(((e,t)=>{r?t(r):s=()=>{r?t(r):e()}}));t.on("drain",a);const d=l(t,{readable:!1},a);try{t.writableNeedDrain&&await c();for await(const n of e)t.write(n)||await c();i&&(t.end(),await c()),n()}catch(u){n(r!==u?h(r,u):u)}finally{d(),t.off("drain",a)}}async function O(e,t,n,{end:i}){_(t)&&(t=t.writable);const r=t.getWriter();try{for await(const t of e)await r.ready,r.write(t).catch((()=>{}));await r.ready,i&&await r.close(),n()}catch(o){try{await r.abort(o),n(o)}catch(o){n(o)}}}function R(e,t,o){if(1===e.length&&r(e[0])&&(e=e[0]),e.length<2)throw new f("streams");const s=new E,l=s.signal,c=null==o?void 0:o.signal,d=[];function h(){U(new b)}let m,y,x;w(c,"options.signal"),C=C||n(56017).addAbortListener,c&&(m=C(c,h));const T=[];let N,R=0;function $(e){U(e,0==--R)}function U(e,n){var r;if(!e||y&&"ERR_STREAM_PREMATURE_CLOSE"!==y.code||(y=e),y||n){for(;T.length;)T.shift()(y);null===(r=m)||void 0===r||r[a](),s.abort(),n&&(y||d.forEach((e=>e())),i.nextTick(t,y,x))}}for(let F=0;F<e.length;F++){const Q=e[F],V=F<e.length-1,G=F>0,Z=V||!1!==(null==o?void 0:o.end),H=F===e.length-1;if(L(Q)){if(Z){const{destroy:q,cleanup:X}=A(Q,V,G);T.push(q),k(Q)&&H&&d.push(X)}function B(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&$(e)}Q.on("error",B),k(Q)&&H&&d.push((()=>{Q.removeListener("error",B)}))}if(0===F)if("function"==typeof Q){if(N=Q({signal:l}),!v(N))throw new g("Iterable, AsyncIterable or Stream","source",N)}else N=v(Q)||S(Q)||_(Q)?Q:u.from(Q);else if("function"==typeof Q){var W;if(_(N))N=D(null===(W=N)||void 0===W?void 0:W.readable);else N=D(N);if(N=Q(N,{signal:l}),V){if(!v(N,!0))throw new g("AsyncIterable",`transform[${F-1}]`,N)}else{var Y;j||(j=n(62091));const J=new j({objectMode:!0}),K=null===(Y=N)||void 0===Y?void 0:Y.then;if("function"==typeof K)R++,K.call(N,(e=>{x=e,null!=e&&J.write(e),Z&&J.end(),i.nextTick($)}),(e=>{J.destroy(e),i.nextTick($,e)}));else if(v(N,!0))R++,P(N,J,$,{end:Z});else{if(!I(N)&&!_(N))throw new g("AsyncIterable or Promise","destination",N);{const ne=N.readable||N;R++,P(ne,J,$,{end:Z})}}N=J;const{destroy:ee,cleanup:te}=A(N,!1,!0);T.push(ee),H&&d.push(te)}}else if(L(Q)){if(S(N)){R+=2;const ie=z(N,Q,$,{end:Z});k(Q)&&H&&d.push(ie)}else if(_(N)||I(N)){const re=N.readable||N;R++,P(re,Q,$,{end:Z})}else{if(!v(N))throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],N);R++,P(N,Q,$,{end:Z})}N=Q}else if(M(Q)){if(S(N))R++,O(D(N),Q,$,{end:Z});else if(I(N)||v(N))R++,O(N,Q,$,{end:Z});else{if(!_(N))throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],N);R++,O(N.readable,Q,$,{end:Z})}N=Q}else N=u.from(Q)}return(null!=l&&l.aborted||null!=c&&c.aborted)&&i.nextTick(h),N}function z(e,t,n,{end:r}){let o=!1;if(t.on("close",(()=>{o||n(new y)})),e.pipe(t,{end:!1}),r){function s(){o=!0,t.end()}T(e)?i.nextTick(s):e.once("end",s)}else n();return l(e,{readable:!0,writable:!1},(t=>{const i=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&i&&i.ended&&!i.errored&&!i.errorEmitted?e.once("end",n).once("error",n):n(t)})),l(t,{readable:!1,writable:!0},n)}e.exports={pipelineImpl:R,pipeline:function(...e){return R(e,c(function(e){return x(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}},23125:(e,t,n)=>{const i=n(65606),{ArrayPrototypeIndexOf:r,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:a,ObjectDefineProperties:l,ObjectKeys:c,ObjectSetPrototypeOf:d,Promise:u,SafeSet:h,SymbolAsyncDispose:p,SymbolAsyncIterator:g,Symbol:f}=n(74641);e.exports=H,H.ReadableState=Z;const{EventEmitter:m}=n(37007),{Stream:y,prependListener:b}=n(80334),{Buffer:x}=n(48287),{addAbortSignal:w}=n(30810),v=n(89365);let k=n(56017).debuglog("stream",(e=>{k=e}));const S=n(85586),L=n(57647),{getHighWaterMark:_,getDefaultHighWaterMark:M}=n(13920),{aggregateTwoErrors:I,codes:{ERR_INVALID_ARG_TYPE:T,ERR_METHOD_NOT_IMPLEMENTED:E,ERR_OUT_OF_RANGE:j,ERR_STREAM_PUSH_AFTER_EOF:N,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:C},AbortError:A}=n(68526),{validateObject:D}=n(2224),P=f("kPaused"),{StringDecoder:O}=n(83141),R=n(40333);d(H.prototype,y.prototype),d(H,y);const z=()=>{},{errorOrDestroy:$}=L,U=1,B=16,W=32,Y=64,F=2048,Q=4096,V=65536;function G(e){return{enumerable:!1,get(){return!!(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function Z(e,t,i){"boolean"!=typeof i&&(i=t instanceof n(43559)),this.state=F|Q|B|W,e&&e.objectMode&&(this.state|=U),i&&e&&e.readableObjectMode&&(this.state|=U),this.highWaterMark=e?_(this,e,"readableHighWaterMark",i):M(!1),this.buffer=new S,this.length=0,this.pipes=[],this.flowing=null,this[P]=null,e&&!1===e.emitClose&&(this.state&=~F),e&&!1===e.autoDestroy&&(this.state&=~Q),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new O(e.encoding),this.encoding=e.encoding)}function H(e){if(!(this instanceof H))return new H(e);const t=this instanceof n(43559);this._readableState=new Z(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&w(e.signal,this)),y.call(this,e),L.construct(this,(()=>{this._readableState.needReadable&&te(this,this._readableState)}))}function q(e,t,n,i){k("readableAddChunk",t);const r=e._readableState;let o;if(r.state&U||("string"==typeof t?(n=n||r.defaultEncoding,r.encoding!==n&&(i&&r.encoding?t=x.from(t,n).toString(r.encoding):(t=x.from(t,n),n=""))):t instanceof x?n="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),n=""):null!=t&&(o=new T("chunk",["string","Buffer","Uint8Array"],t))),o)$(e,o);else if(null===t)r.state&=-9,function(e,t){if(k("onEofChunk"),t.ended)return;if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?K(e):(t.needReadable=!1,t.emittedReadable=!0,ee(e))}(e,r);else if(r.state&U||t&&t.length>0)if(i)if(4&r.state)$(e,new C);else{if(r.destroyed||r.errored)return!1;X(e,r,t,!0)}else if(r.ended)$(e,new N);else{if(r.destroyed||r.errored)return!1;r.state&=-9,r.decoder&&!n?(t=r.decoder.write(t),r.objectMode||0!==t.length?X(e,r,t,!1):te(e,r)):X(e,r,t,!1)}else i||(r.state&=-9,te(e,r));return!r.ended&&(r.length<r.highWaterMark||0===r.length)}function X(e,t,n,i){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.state&V?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.state&Y&&K(e)),te(e,t)}l(Z.prototype,{objectMode:G(U),ended:G(2),endEmitted:G(4),reading:G(8),constructed:G(B),sync:G(W),needReadable:G(Y),emittedReadable:G(128),readableListening:G(256),resumeScheduled:G(512),errorEmitted:G(1024),emitClose:G(F),autoDestroy:G(Q),destroyed:G(8192),closed:G(16384),closeEmitted:G(32768),multiAwaitDrain:G(V),readingMore:G(1<<17),dataEmitted:G(1<<18)}),H.prototype.destroy=L.destroy,H.prototype._undestroy=L.undestroy,H.prototype._destroy=function(e,t){t(e)},H.prototype[m.captureRejectionSymbol]=function(e){this.destroy(e)},H.prototype[p]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new A,this.destroy(e)),new u(((t,n)=>v(this,(i=>i&&i!==e?n(i):t(null)))))},H.prototype.push=function(e,t){return q(this,e,t,!1)},H.prototype.unshift=function(e,t){return q(this,e,t,!0)},H.prototype.isPaused=function(){const e=this._readableState;return!0===e[P]||!1===e.flowing},H.prototype.setEncoding=function(e){const t=new O(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let i="";for(const r of n)i+=t.write(r);return n.clear(),""!==i&&n.push(i),this._readableState.length=i.length,this};function J(e,t){return e<=0||0===t.length&&t.ended?0:t.state&U?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function K(e){const t=e._readableState;k("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(k("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(ee,e))}function ee(e){const t=e._readableState;k("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,se(e)}function te(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,i.nextTick(ne,e,t))}function ne(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const n=t.length;if(k("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function ie(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[P]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function re(e){k("readable nexttick read 0"),e.read(0)}function oe(e,t){k("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),se(e),t.flowing&&!t.reading&&e.read(0)}function se(e){const t=e._readableState;for(k("flow",t.flowing);t.flowing&&null!==e.read(););}function ae(e,t){"function"!=typeof e.read&&(e=H.wrap(e,{objectMode:!0}));const n=async function*(e,t){let n,i=z;function r(t){this===e?(i(),i=z):i=t}e.on("readable",r);const o=v(e,{writable:!1},(e=>{n=e?I(n,e):null,i(),i=z}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new u(r)}}}catch(s){throw n=I(n,s),n}finally{!n&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",r),o()):L.destroyer(e,null)}}(e,t);return n.stream=e,n}function le(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function ce(e){const t=e._readableState;k("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(de,t,e))}function de(e,t){if(k("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)i.nextTick(ue,t);else if(e.autoDestroy){const e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}function ue(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let he;function pe(){return void 0===he&&(he={}),he}H.prototype.read=function(e){k("read",e),void 0===e?e=NaN:o(e)||(e=a(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new j("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return k("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ce(this):K(this),null;if(0===(e=J(e,t))&&t.ended)return 0===t.length&&ce(this),null;let i,r=!!(t.state&Y);if(k("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,k("length less than watermark",r)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)r=!1,k("reading, ended or constructing",r);else if(r){k("do read"),t.state|=8|W,0===t.length&&(t.state|=Y);try{this._read(t.highWaterMark)}catch(s){$(this,s)}t.state&=~W,t.reading||(e=J(n,t))}return i=e>0?le(e,t):null,null===i?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&ce(this)),null===i||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",i)),i},H.prototype._read=function(e){throw new E("_read()")},H.prototype.pipe=function(e,t){const n=this,r=this._readableState;1===r.pipes.length&&(r.multiAwaitDrain||(r.multiAwaitDrain=!0,r.awaitDrainWriters=new h(r.awaitDrainWriters?[r.awaitDrainWriters]:[]))),r.pipes.push(e),k("pipe count=%d opts=%j",r.pipes.length,t);const o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?a:m;function s(t,i){k("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,function(){k("cleanup"),e.removeListener("close",g),e.removeListener("finish",f),l&&e.removeListener("drain",l);e.removeListener("error",p),e.removeListener("unpipe",s),n.removeListener("end",a),n.removeListener("end",m),n.removeListener("data",u),c=!0,l&&r.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&l()}())}function a(){k("onend"),e.end()}let l;r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);let c=!1;function d(){c||(1===r.pipes.length&&r.pipes[0]===e?(k("false write response, pause",0),r.awaitDrainWriters=e,r.multiAwaitDrain=!1):r.pipes.length>1&&r.pipes.includes(e)&&(k("false write response, pause",r.awaitDrainWriters.size),r.awaitDrainWriters.add(e)),n.pause()),l||(l=function(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(k("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(k("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,e),e.on("drain",l))}function u(t){k("ondata");const n=e.write(t);k("dest.write",n),!1===n&&d()}function p(t){if(k("onerror",t),m(),e.removeListener("error",p),0===e.listenerCount("error")){const n=e._writableState||e._readableState;n&&!n.errorEmitted?$(e,t):e.emit("error",t)}}function g(){e.removeListener("finish",f),m()}function f(){k("onfinish"),e.removeListener("close",g),m()}function m(){k("unpipe"),n.unpipe(e)}return n.on("data",u),b(e,"error",p),e.once("close",g),e.once("finish",f),e.emit("pipe",n),!0===e.writableNeedDrain?d():r.flowing||(k("pipe resume"),n.resume()),e},H.prototype.unpipe=function(e){const t=this._readableState;if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=r(t.pipes,e);return-1===n||(t.pipes.splice(n,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},H.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,k("on readable",r.length,r.reading),r.length?K(this):r.reading||i.nextTick(re,this))),n},H.prototype.addListener=H.prototype.on,H.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(ie,this),n},H.prototype.off=H.prototype.removeListener,H.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(ie,this),t},H.prototype.resume=function(){const e=this._readableState;return e.flowing||(k("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(oe,e,t))}(this,e)),e[P]=!1,this},H.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[P]=!0,this},H.prototype.wrap=function(e){let t=!1;e.on("data",(n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{$(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=c(e);for(let i=1;i<n.length;i++){const t=n[i];void 0===this[t]&&"function"==typeof e[t]&&(this[t]=e[t].bind(e))}return this},H.prototype[g]=function(){return ae(this)},H.prototype.iterator=function(e){return void 0!==e&&D(e,"options"),ae(this,e)},l(H.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),l(Z.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[P]},set(e){this[P]=!!e}}}),H._fromList=le,H.from=function(e,t){return R(H,e,t)},H.fromWeb=function(e,t){return pe().newStreamReadableFromReadableStream(e,t)},H.toWeb=function(e,t){return pe().newReadableStreamFromStreamReadable(e,t)},H.wrap=function(e,t){var n,i;return new H({objectMode:null===(n=null!==(i=e.readableObjectMode)&&void 0!==i?i:e.objectMode)||void 0===n||n,...t,destroy(t,n){L.destroyer(e,t),n(t)}}).wrap(e)}},13920:(e,t,n)=>{"use strict";const{MathFloor:i,NumberIsInteger:r}=n(74641),{validateInteger:o}=n(2224),{ERR_INVALID_ARG_VALUE:s}=n(68526).codes;let a=16384,l=16;function c(e){return e?l:a}e.exports={getHighWaterMark:function(e,t,n,o){const a=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,o,n);if(null!=a){if(!r(a)||a<0){throw new s(o?`options.${n}`:"options.highWaterMark",a)}return i(a)}return c(e.objectMode)},getDefaultHighWaterMark:c,setDefaultHighWaterMark:function(e,t){o(t,"value",0),e?l=t:a=t}}},68649:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:i,Symbol:r}=n(74641);e.exports=c;const{ERR_METHOD_NOT_IMPLEMENTED:o}=n(68526).codes,s=n(43559),{getHighWaterMark:a}=n(13920);i(c.prototype,s.prototype),i(c,s);const l=r("kCallback");function c(e){if(!(this instanceof c))return new c(e);const t=e?a(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),s.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function d(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())}))}function u(){this._final!==d&&d.call(this)}c.prototype._final=d,c.prototype._transform=function(e,t,n){throw new o("_transform()")},c.prototype._write=function(e,t,n){const i=this._readableState,r=this._writableState,o=i.length;this._transform(e,t,((e,t)=>{e?n(e):(null!=t&&this.push(t),r.ended||o===i.length||i.length<i.highWaterMark?n():this[l]=n)}))},c.prototype._read=function(){if(this[l]){const e=this[l];this[l]=null,e()}}},136:(e,t,n)=>{"use strict";const{SymbolAsyncIterator:i,SymbolIterator:r,SymbolFor:o}=n(74641),s=o("nodejs.stream.destroyed"),a=o("nodejs.stream.errored"),l=o("nodejs.stream.readable"),c=o("nodejs.stream.writable"),d=o("nodejs.stream.disturbed"),u=o("nodejs.webstream.isClosedPromise"),h=o("nodejs.webstream.controllerErrorFunction");function p(e,t=!1){var n;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function g(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function f(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function m(e){return!(!e||f(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function y(e){return!(!e||f(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function b(e){return!(!e||f(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function x(e){if(!f(e))return null;const t=e._writableState,n=e._readableState,i=t||n;return!!(e.destroyed||e[s]||null!=i&&i.destroyed)}function w(e){if(!g(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function v(e,t){if(!p(e))return null;const n=e._readableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function k(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!x(e)&&(p(e)&&e.readable&&!v(e))}function S(e){return e&&null!=e[c]?e[c]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!x(e)&&(g(e)&&e.writable&&!w(e))}function L(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function _(e){return"boolean"==typeof e._sent100&&L(e)}e.exports={isDestroyed:x,kIsDestroyed:s,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[d])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:d,isErrored:function(e){var t,n,i,r,o,s,l,c,d,u;return!(!e||!(null!==(t=null!==(n=null!==(i=null!==(r=null!==(o=null!==(s=e[a])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==r?r:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==i?i:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(d=e._readableState)||void 0===d?void 0:d.errored)&&void 0!==t?t:null===(u=e._writableState)||void 0===u?void 0:u.errored))},kIsErrored:a,isReadable:k,kIsReadable:l,kIsClosedPromise:u,kControllerErrorFunction:h,kIsWritable:c,isClosed:function(e){if(!f(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==n?void 0:n.closed)?(null==t?void 0:t.closed)||(null==n?void 0:n.closed):"boolean"==typeof e._closed&&L(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return f(e)?!!x(e)||(!1===(null==t?void 0:t.readable)||!k(e))&&(!1===(null==t?void 0:t.writable)||!S(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[i]:!1===t?"function"==typeof e[r]:"function"==typeof e[i]||"function"==typeof e[r])},isReadableNodeStream:p,isReadableStream:m,isReadableEnded:function(e){if(!p(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:v,isReadableErrored:function(e){var t,n;return f(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isNodeStream:f,isWebStream:function(e){return m(e)||y(e)||b(e)},isWritable:S,isWritableNodeStream:g,isWritableStream:y,isWritableEnded:w,isWritableFinished:function(e,t){if(!g(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))},isWritableErrored:function(e){var t,n;return f(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:_,willEmitClose:function(e){if(!f(e))return null;const t=e._writableState,n=e._readableState,i=t||n;return!i&&_(e)||!!(i&&i.autoDestroy&&i.emitClose&&!1===i.closed)},isTransformStream:b}},77221:(e,t,n)=>{const i=n(65606),{ArrayPrototypeSlice:r,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:a,ObjectDefineProperties:l,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:d,Symbol:u,SymbolHasInstance:h}=n(74641);e.exports=D,D.WritableState=C;const{EventEmitter:p}=n(37007),g=n(80334).Stream,{Buffer:f}=n(48287),m=n(57647),{addAbortSignal:y}=n(30810),{getHighWaterMark:b,getDefaultHighWaterMark:x}=n(13920),{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:v,ERR_MULTIPLE_CALLBACK:k,ERR_STREAM_CANNOT_PIPE:S,ERR_STREAM_DESTROYED:L,ERR_STREAM_ALREADY_FINISHED:_,ERR_STREAM_NULL_VALUES:M,ERR_STREAM_WRITE_AFTER_END:I,ERR_UNKNOWN_ENCODING:T}=n(68526).codes,{errorOrDestroy:E}=m;function j(){}c(D.prototype,g.prototype),c(D,g);const N=u("kOnFinished");function C(e,t,i){"boolean"!=typeof i&&(i=t instanceof n(43559)),this.objectMode=!(!e||!e.objectMode),i&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?b(this,e,"writableHighWaterMark",i):x(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const r=!(!e||!1!==e.decodeStrings);this.decodeStrings=!r,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=z.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,A(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[N]=[]}function A(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function D(e){const t=this instanceof n(43559);if(!t&&!s(D,this))return new D(e);this._writableState=new C(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&y(e.signal,this)),g.call(this,e),m.construct(this,(()=>{const e=this._writableState;e.writing||W(this,e),Q(this,e)}))}function P(e,t,n,r){const o=e._writableState;if("function"==typeof n)r=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!f.isEncoding(n))throw new T(n)}else n=o.defaultEncoding;"function"!=typeof r&&(r=j)}if(null===t)throw new M;if(!o.objectMode)if("string"==typeof t)!1!==o.decodeStrings&&(t=f.from(t,n),n="buffer");else if(t instanceof f)n="buffer";else{if(!g._isUint8Array(t))throw new w("chunk",["string","Buffer","Uint8Array"],t);t=g._uint8ArrayToBuffer(t),n="buffer"}let s;return o.ending?s=new I:o.destroyed&&(s=new L("write")),s?(i.nextTick(r,s),E(e,s,!0),s):(o.pendingcb++,function(e,t,n,i,r){const o=t.objectMode?1:n.length;t.length+=o;const s=t.length<t.highWaterMark;s||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:i,callback:r}),t.allBuffers&&"buffer"!==i&&(t.allBuffers=!1),t.allNoop&&r!==j&&(t.allNoop=!1)):(t.writelen=o,t.writecb=r,t.writing=!0,t.sync=!0,e._write(n,i,t.onwrite),t.sync=!1);return s&&!t.errored&&!t.destroyed}(e,o,t,n,r))}function O(e,t,n,i,r,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new L("write")):n?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function R(e,t,n,i){--t.pendingcb,i(n),B(t),E(e,n)}function z(e,t){const n=e._writableState,r=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),r?i.nextTick(R,e,n,t,o):R(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&W(e,n),r?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},i.nextTick($,n.afterWriteTickInfo)):U(e,n,1,o))):E(e,new k)}function $({stream:e,state:t,count:n,cb:i}){return t.afterWriteTickInfo=null,U(e,t,n,i)}function U(e,t,n,i){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));n-- >0;)t.pendingcb--,i();t.destroyed&&B(t),Q(e,t)}function B(e){if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new L("write"))}const n=e[N].splice(0);for(let r=0;r<n.length;r++){var i;n[r](null!==(i=e.errored)&&void 0!==i?i:new L("end"))}A(e)}function W(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:n,bufferedIndex:i,objectMode:o}=t,s=n.length-i;if(!s)return;let a=i;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;const i=t.allNoop?j:e=>{for(let t=a;t<n.length;++t)n[t].callback(e)},o=t.allNoop&&0===a?n:r(n,a);o.allBuffers=t.allBuffers,O(e,t,!0,t.length,o,"",i),A(t)}else{do{const{chunk:i,encoding:r,callback:s}=n[a];n[a++]=null;O(e,t,!1,o?1:i.length,i,r,s)}while(a<n.length&&!t.writing);a===n.length?A(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}function Y(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function F(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let n=!1;function r(r){if(n)E(e,null!=r?r:k());else if(n=!0,t.pendingcb--,r){const n=t[N].splice(0);for(let e=0;e<n.length;e++)n[e](r);E(e,r,t.sync)}else Y(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,i.nextTick(V,e,t))}t.sync=!0,t.pendingcb++;try{e._final(r)}catch(o){r(o)}t.sync=!1}(e,t)))}function Q(e,t,n){Y(t)&&(F(e,t),0===t.pendingcb&&(n?(t.pendingcb++,i.nextTick(((e,t)=>{Y(t)?V(e,t):t.pendingcb--}),e,t)):Y(t)&&(t.pendingcb++,V(e,t))))}function V(e,t){t.pendingcb--,t.finished=!0;const n=t[N].splice(0);for(let i=0;i<n.length;i++)n[i]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}C.prototype.getBuffer=function(){return r(this.buffered,this.bufferedIndex)},a(C.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),a(D,h,{__proto__:null,value:function(e){return!!s(this,e)||this===D&&(e&&e._writableState instanceof C)}}),D.prototype.pipe=function(){E(this,new S)},D.prototype.write=function(e,t,n){return!0===P(this,e,t,n)},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||W(this,e))},D.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=d(e)),!f.isEncoding(e))throw new T(e);return this._writableState.defaultEncoding=e,this},D.prototype._write=function(e,t,n){if(!this._writev)throw new v("_write()");this._writev([{chunk:e,encoding:t}],n)},D.prototype._writev=null,D.prototype.end=function(e,t,n){const r=this._writableState;let s;if("function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e){const n=P(this,e,t);n instanceof o&&(s=n)}return r.corked&&(r.corked=1,this.uncork()),s||(r.errored||r.ending?r.finished?s=new _("end"):r.destroyed&&(s=new L("end")):(r.ending=!0,Q(this,r,!0),r.ended=!0)),"function"==typeof n&&(s||r.finished?i.nextTick(n,s):r[N].push(n)),this},l(D.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const G=m.destroy;let Z;function H(){return void 0===Z&&(Z={}),Z}D.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[N].length)&&i.nextTick(B,n),G.call(this,e,t),this},D.prototype._undestroy=m.undestroy,D.prototype._destroy=function(e,t){t(e)},D.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},D.fromWeb=function(e,t){return H().newStreamWritableFromWritableStream(e,t)},D.toWeb=function(e){return H().newWritableStreamFromStreamWritable(e)}},2224:(e,t,n)=>{"use strict";const{ArrayIsArray:i,ArrayPrototypeIncludes:r,ArrayPrototypeJoin:o,ArrayPrototypeMap:s,NumberIsInteger:a,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:d,NumberParseInt:u,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:p,String:g,StringPrototypeToUpperCase:f,StringPrototypeTrim:m}=n(74641),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:x,ERR_INVALID_ARG_VALUE:w,ERR_OUT_OF_RANGE:v,ERR_UNKNOWN_SIGNAL:k}}=n(68526),{normalizeEncoding:S}=n(56017),{isAsyncFunction:L,isArrayBufferView:_}=n(56017).types,M={};const I=/^[0-7]+$/;const T=y(((e,t,n=d,i=c)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);if(e<n||e>i)throw new v(t,`>= ${n} && <= ${i}`,e)})),E=y(((e,t,n=-2147483648,i=2147483647)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);if(e<n||e>i)throw new v(t,`>= ${n} && <= ${i}`,e)})),j=y(((e,t,n=!1)=>{if("number"!=typeof e)throw new x(t,"number",e);if(!a(e))throw new v(t,"an integer",e);const i=n?1:0,r=4294967295;if(e<i||e>r)throw new v(t,`>= ${i} && <= ${r}`,e)}));function N(e,t){if("string"!=typeof e)throw new x(t,"string",e)}const C=y(((e,t,n)=>{if(!r(n,e)){const i=o(s(n,(e=>"string"==typeof e?`'${e}'`:g(e))),", ");throw new w(t,e,"must be one of: "+i)}}));function A(e,t){if("boolean"!=typeof e)throw new x(t,"boolean",e)}function D(e,t,n){return null!=e&&h(e,t)?e[t]:n}const P=y(((e,t,n=null)=>{const r=D(n,"allowArray",!1),o=D(n,"allowFunction",!1);if(!D(n,"nullable",!1)&&null===e||!r&&i(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new x(t,"Object",e)})),O=y(((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new x(t,"a dictionary",e)})),R=y(((e,t,n=0)=>{if(!i(e))throw new x(t,"Array",e);if(e.length<n){throw new w(t,e,`must be longer than ${n}`)}}));const z=y(((e,t="buffer")=>{if(!_(e))throw new x(t,["Buffer","TypedArray","DataView"],e)}));const $=y(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new x(t,"AbortSignal",e)})),U=y(((e,t)=>{if("function"!=typeof e)throw new x(t,"Function",e)})),B=y(((e,t)=>{if("function"!=typeof e||L(e))throw new x(t,"Function",e)})),W=y(((e,t)=>{if(void 0!==e)throw new x(t,"undefined",e)}));const Y=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function F(e,t){if(void 0===e||!p(Y,e))throw new w(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,n){if(void 0===e&&(e=n),"string"==typeof e){if(null===p(I,e))throw new w(t,e,"must be a 32-bit unsigned integer or an octal string");e=u(e,8)}return j(e,t),e},validateArray:R,validateStringArray:function(e,t){R(e,t);for(let n=0;n<e.length;n++)N(e[n],`${t}[${n}]`)},validateBooleanArray:function(e,t){R(e,t);for(let n=0;n<e.length;n++)A(e[n],`${t}[${n}]`)},validateAbortSignalArray:function(e,t){R(e,t);for(let n=0;n<e.length;n++){const i=e[n],r=`${t}[${n}]`;if(null==i)throw new x(r,"AbortSignal",i);$(i,r)}},validateBoolean:A,validateBuffer:z,validateDictionary:O,validateEncoding:function(e,t){const n=S(t),i=e.length;if("hex"===n&&i%2!=0)throw new w("encoding",t,`is invalid for data of length ${i}`)},validateFunction:U,validateInt32:E,validateInteger:T,validateNumber:function(e,t,n=void 0,i){if("number"!=typeof e)throw new x(t,"number",e);if(null!=n&&e<n||null!=i&&e>i||(null!=n||null!=i)&&l(e))throw new v(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=i?" && ":""}${null!=i?`<= ${i}`:""}`,e)},validateObject:P,validateOneOf:C,validatePlainFunction:B,validatePort:function(e,t="Port",n=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===m(e).length||+e!=+e>>>0||e>65535||0===e&&!n)throw new b(t,e,n);return 0|e},validateSignalName:function(e,t="signal"){if(N(e,t),void 0===M[e]){if(void 0!==M[f(e)])throw new k(e+" (signals must use all capital letters)");throw new k(e)}},validateString:N,validateUint32:j,validateUndefined:W,validateUnion:function(e,t,n){if(!r(n,e))throw new x(t,`('${o(n,"|")}')`,e)},validateAbortSignal:$,validateLinkHeaderValue:function(e){if("string"==typeof e)return F(e,"hints"),e;if(i(e)){const t=e.length;let n="";if(0===t)return n;for(let i=0;i<t;i++){const r=e[i];F(r,"hints"),n+=r,i!==t-1&&(n+=", ")}return n}throw new w("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},85721:(e,t,n)=>{"use strict";const i=n(42825),r=n(25018),o=i.Readable.destroy;e.exports=i.Readable,e.exports._uint8ArrayToBuffer=i._uint8ArrayToBuffer,e.exports._isUint8Array=i._isUint8Array,e.exports.isDisturbed=i.isDisturbed,e.exports.isErrored=i.isErrored,e.exports.isReadable=i.isReadable,e.exports.Readable=i.Readable,e.exports.Writable=i.Writable,e.exports.Duplex=i.Duplex,e.exports.Transform=i.Transform,e.exports.PassThrough=i.PassThrough,e.exports.addAbortSignal=i.addAbortSignal,e.exports.finished=i.finished,e.exports.destroy=i.destroy,e.exports.destroy=o,e.exports.pipeline=i.pipeline,e.exports.compose=i.compose,Object.defineProperty(i,"promises",{configurable:!0,enumerable:!0,get:()=>r}),e.exports.Stream=i.Stream,e.exports.default=e.exports},68526:(e,t,n)=>{"use strict";const{format:i,inspect:r,AggregateError:o}=n(56017),s=globalThis.AggregateError||o,a=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,d={};function u(e,t){if(!e)throw new d.ERR_INTERNAL_ASSERTION(t)}function h(e){let t="",n=e.length;const i="-"===e[0]?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function p(e,t,n){n||(n=Error);class r extends n{constructor(...n){super(function(e,t,n){if("function"==typeof t)return u(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return u(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),0===n.length?t:i(t,...n)}(e,t,n))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[a]=!0,d[e]=r}function g(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class f extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new d.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}p("ERR_ASSERTION","%s",Error),p("ERR_INVALID_ARG_TYPE",((e,t,n)=>{u("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let i="The ";e.endsWith(" argument")?i+=`${e} `:i+=`"${e}" ${e.includes(".")?"property":"argument"} `,i+="must be ";const o=[],s=[],a=[];for(const r of t)u("string"==typeof r,"All expected entries have to be of type string"),l.includes(r)?o.push(r.toLowerCase()):c.test(r)?s.push(r):(u("object"!==r,'The value "object" should be written as "Object"'),a.push(r));if(s.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:i+=`of type ${o[0]}`;break;case 2:i+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();i+=`one of type ${o.join(", ")}, or ${e}`}}(s.length>0||a.length>0)&&(i+=" or ")}if(s.length>0){switch(s.length){case 1:i+=`an instance of ${s[0]}`;break;case 2:i+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();i+=`an instance of ${s.join(", ")}, or ${e}`}}a.length>0&&(i+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(i+="an "),i+=`${a[0]}`;break;case 2:i+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();i+=`one of ${a.join(", ")}, or ${e}`}}if(null==n)i+=`. Received ${n}`;else if("function"==typeof n&&n.name)i+=`. Received function ${n.name}`;else if("object"==typeof n){var d;if(null!==(d=n.constructor)&&void 0!==d&&d.name)i+=`. Received an instance of ${n.constructor.name}`;else{i+=`. Received ${r(n,{depth:-1})}`}}else{let e=r(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),i+=`. Received type ${typeof n} (${e})`}return i}),TypeError),p("ERR_INVALID_ARG_VALUE",((e,t,n="is invalid")=>{let i=r(t);i.length>128&&(i=i.slice(0,128)+"...");return`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${i}`}),TypeError),p("ERR_INVALID_RETURN_VALUE",((e,t,n)=>{var i;return`Expected ${e} to be returned from the "${t}" function but got ${null!=n&&null!==(i=n.constructor)&&void 0!==i&&i.name?`instance of ${n.constructor.name}`:"type "+typeof n}.`}),TypeError),p("ERR_MISSING_ARGS",((...e)=>{let t;u(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}}return`${t} must be specified`}),TypeError),p("ERR_OUT_OF_RANGE",((e,t,n)=>{let i;return u(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32?i=h(String(n)):"bigint"==typeof n?(i=String(n),(n>2n**32n||n<-(2n**32n))&&(i=h(i)),i+="n"):i=r(n),`The value of "${e}" is out of range. It must be ${t}. Received ${i}`}),RangeError),p("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),p("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),p("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),p("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),p("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),p("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),p("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),p("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),p("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),p("ERR_STREAM_WRITE_AFTER_END","write after end",Error),p("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:f,aggregateTwoErrors:g((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new s([t,e],t.message);return n.code=t.code,n}return e||t})),hideStackFrames:g,codes:d}},74641:e=>{"use strict";e.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,n)=>e.slice(t,n),Error:Error,FunctionPrototypeCall:(e,t,...n)=>e.call(t,...n),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,n)=>Object.defineProperty(e,t,n),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,n)=>e.then(t,n),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,n)=>e.slice(t,n),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,n)=>e.set(t,n),Boolean:Boolean,Uint8Array:Uint8Array}},56017:(e,t,n)=>{"use strict";const i=n(48287),{kResistStopPropagation:r,SymbolDispose:o}=n(74641),s=globalThis.AbortSignal||n(25568).AbortSignal,a=globalThis.AbortController||n(25568).AbortController,l=Object.getPrototypeOf((async function(){})).constructor,c=globalThis.Blob||i.Blob,d=void 0!==c?function(e){return e instanceof c}:function(e){return!1},u=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new ERR_INVALID_ARG_TYPE(t,"AbortSignal",e)};class h extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:h,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((n,i)=>{e=n,t=i})),resolve:e,reject:t}},promisify:e=>new Promise(((t,n)=>{e(((e,...i)=>e?n(e):t(...i)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,n]){const i=t.shift();if("f"===n)return i.toFixed(6);if("j"===n)return JSON.stringify(i);if("s"===n&&"object"==typeof i){return`${i.constructor!==Object?i.constructor.name:""} {}`.trim()}return i.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof l,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:d,deprecate:(e,t)=>e,addAbortListener:n(37007).addAbortListener||function(e,t){if(void 0===e)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);let n;return u(e,"signal"),((e,t)=>{if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"Function",e)})(t,"listener"),e.aborted?queueMicrotask((()=>t())):(e.addEventListener("abort",t,{__proto__:null,once:!0,[r]:!0}),n=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[o](){var e;null===(e=n)||void 0===e||e()}}},AbortSignalAny:s.any||function(e){if(1===e.length)return e[0];const t=new a,n=()=>t.abort();return e.forEach((e=>{u(e,"signals"),e.addEventListener("abort",n,{once:!0})})),t.signal.addEventListener("abort",(()=>{e.forEach((e=>e.removeEventListener("abort",n)))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},42825:(e,t,n)=>{const{Buffer:i}=n(48287),{ObjectDefineProperty:r,ObjectKeys:o,ReflectApply:s}=n(74641),{promisify:{custom:a}}=n(56017),{streamReturningOperators:l,promiseReturningOperators:c}=n(1284),{codes:{ERR_ILLEGAL_CONSTRUCTOR:d}}=n(68526),u=n(8489),{setDefaultHighWaterMark:h,getDefaultHighWaterMark:p}=n(13920),{pipeline:g}=n(28431),{destroyer:f}=n(57647),m=n(89365),y=n(25018),b=n(136),x=e.exports=n(80334).Stream;x.isDestroyed=b.isDestroyed,x.isDisturbed=b.isDisturbed,x.isErrored=b.isErrored,x.isReadable=b.isReadable,x.isWritable=b.isWritable,x.Readable=n(23125);for(const k of o(l)){const S=l[k];function w(...e){if(new.target)throw d();return x.Readable.from(s(S,this,e))}r(w,"name",{__proto__:null,value:S.name}),r(w,"length",{__proto__:null,value:S.length}),r(x.Readable.prototype,k,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(const L of o(c)){const _=c[L];function w(...e){if(new.target)throw d();return s(_,this,e)}r(w,"name",{__proto__:null,value:_.name}),r(w,"length",{__proto__:null,value:_.length}),r(x.Readable.prototype,L,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}x.Writable=n(77221),x.Duplex=n(43559),x.Transform=n(68649),x.PassThrough=n(62091),x.pipeline=g;const{addAbortSignal:v}=n(30810);x.addAbortSignal=v,x.finished=m,x.destroy=f,x.compose=u,x.setDefaultHighWaterMark=h,x.getDefaultHighWaterMark=p,r(x,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>y}),r(g,a,{__proto__:null,enumerable:!0,get:()=>y.pipeline}),r(m,a,{__proto__:null,enumerable:!0,get:()=>y.finished}),x.Stream=x,x._isUint8Array=function(e){return e instanceof Uint8Array},x._uint8ArrayToBuffer=function(e){return i.from(e.buffer,e.byteOffset,e.byteLength)}},25018:(e,t,n)=>{"use strict";const{ArrayPrototypePop:i,Promise:r}=n(74641),{isIterable:o,isNodeStream:s,isWebStream:a}=n(136),{pipelineImpl:l}=n(28431),{finished:c}=n(89365);n(42825),e.exports={finished:c,pipeline:function(...e){return new r(((t,n)=>{let r,c;const d=e[e.length-1];if(d&&"object"==typeof d&&!s(d)&&!o(d)&&!a(d)){const t=i(e);r=t.signal,c=t.end}l(e,((e,i)=>{e?n(e):t(i)}),{signal:r,end:c})}))}}},65852:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});const i="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r="http://www.w3.org/2001/XMLSchema#",o="http://www.w3.org/2000/10/swap/",s={xsd:{decimal:`${r}decimal`,boolean:`${r}boolean`,double:`${r}double`,integer:`${r}integer`,string:`${r}string`},rdf:{type:`${i}type`,nil:`${i}nil`,first:`${i}first`,rest:`${i}rest`,langString:`${i}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${o}reify#forSome`,forAll:`${o}reify#forAll`},log:{implies:`${o}log#implies`}}},28612:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>d,FL:()=>b,PB:()=>g,Yo:()=>h,iN:()=>y,kO:()=>x,n7:()=>x,rT:()=>f,uS:()=>p,x1:()=>u,yV:()=>m});var i=n(65852),r=n(69980);const{rdf:o,xsd:s}=i.A;let a,l=0;const c={namedNode:function(e){return new h(e)},blankNode:function(e){return new g(e||"n3-"+l++)},variable:function(e){return new f(e)},literal:function(e,t){if("string"==typeof t)return new p(`"${e}"@${t.toLowerCase()}`);let n=t?t.value:"";""===n&&("boolean"==typeof e?n=s.boolean:"number"==typeof e&&(Number.isFinite(e)?n=Number.isInteger(e)?s.integer:s.double:(n=s.double,Number.isNaN(e)||(e=e>0?"INF":"-INF"))));return""===n||n===s.string?new p(`"${e}"`):new p(`"${e}"^^${n}`)},defaultGraph:function(){return a},quad:w,triple:w},d=c;class u{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof u?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class h extends u{get termType(){return"NamedNode"}}class p extends u{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new h(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?s.string:o.langString}equals(e){return e instanceof p?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class g extends u{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class f extends u{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class m extends u{constructor(){return super(""),a||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}function y(e,t,n){if(t=t||c,!e)return t.defaultGraph();switch(e[0]){case"?":return t.variable(e.substr(1));case"_":return t.blankNode(e.substr(2));case'"':if(t===c)return new p(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));const i=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,i-1),"@"===e[i+1]?e.substr(i+2):t.namedNode(e.substr(i+3)));case"[":e=JSON.parse(e);break;default:if(!n||!Array.isArray(e))return t.namedNode(e)}return t.quad(y(e[0],t,!0),y(e[1],t,!0),y(e[2],t,!0),e[3]&&y(e[3],t,!0))}function b(e,t){if("string"==typeof e)return e;if(e instanceof u&&"Quad"!==e.termType)return e.id;if(!e)return a.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==s.string?`^^${e.datatype.value}`:""}`;case"Quad":const n=[b(e.subject,!0),b(e.predicate,!0),b(e.object,!0)];return(0,r.isDefaultGraph)(e.graph)||n.push(b(e.graph,!0)),t?n:JSON.stringify(n);default:throw new Error(`Unexpected termType: ${e.termType}`)}}a=new m;class x extends u{constructor(e,t,n,i){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=i||a}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function w(e,t,n,i){return new x(e,t,n,i)}},3524:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(65852),r=n(79596),o=n.n(r);const{xsd:s}=i.A,a=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,l={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,d={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},u=/$0^/;class h{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in d)&&this[e]instanceof RegExp&&(this[e]=u)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input,i=n.length;for(;;){let e,a;for(;e=this._newline.exec(n);)this._comments&&(a=this._comment.exec(e[0]))&&r("comment",a[1],"",this._line,e[0].length),n=n.substr(e[0].length,n.length),i=n.length,this._line++;if(!e&&(e=this._whitespace.exec(n))&&(n=n.substr(e[0].length,n.length)),this._endOfFile.test(n))return t&&(this._comments&&(a=this._comment.exec(n))&&r("comment",a[1],"",this._line,n.length),n=null,r("eof","","",this._line,0)),this._input=n;const l=this._line,d=n[0];let u="",h="",p="",g=null,f=0,m=!1;switch(d){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(f=1,u="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){m=!0;break}case"<":if(g=this._unescapedIri.exec(n))u="IRI",h=g[1];else if(g=this._iri.exec(n)){if(h=this._unescape(g[1]),null===h||c.test(h))return o(this);u="IRI"}else n.length>1&&"<"===n[1]?(u="<<",f=2):this._n3Mode&&n.length>1&&"="===n[1]&&(u="inverse",f=2,h=">");break;case">":n.length>1&&">"===n[1]&&(u=">>",f=2);break;case"_":((g=this._blank.exec(n))||t&&(g=this._blank.exec(`${n} `)))&&(u="blank",p="_",h=g[1]);break;case'"':if(g=this._simpleQuotedString.exec(n))h=g[1];else if(({value:h,matchLength:f}=this._parseLiteral(n)),null===h)return o(this);null===g&&0===f||(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(g=this._simpleApostropheString.exec(n))h=g[1];else if(({value:h,matchLength:f}=this._parseLiteral(n)),null===h)return o(this);null===g&&0===f||(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(g=this._variable.exec(n))&&(u="var",h=g[0]);break;case"@":"literal"===this._previousMarker&&(g=this._langcode.exec(n))?(u="langcode",h=g[1]):(g=this._keyword.exec(n))&&(u=g[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){u=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(g=this._number.exec(n)||t&&(g=this._number.exec(`${n} `)))&&(u="literal",h=g[0],p="string"==typeof g[1]?s.double:"string"==typeof g[2]?s.decimal:s.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(g=this._sparqlKeyword.exec(n))?u=g[0].toUpperCase():m=!0;break;case"f":case"t":(g=this._boolean.exec(n))?(u="literal",h=g[0],p=s.boolean):m=!0;break;case"a":(g=this._shortPredicates.exec(n))?(u="abbreviation",h="a"):m=!0;break;case"=":this._n3Mode&&n.length>1&&(u="abbreviation",">"!==n[1]?(f=1,h="="):(f=2,h=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(f=1,u=d);break;case"{":!this._lineMode&&n.length>=2&&("|"===n[1]?(u="{|",f=2):(u=d,f=1));break;case"|":n.length>=2&&"}"===n[1]&&(u="|}",f=2);break;default:m=!0}if(m&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(g=this._prefix.exec(n))?((g=this._prefixed.exec(n))||t&&(g=this._prefixed.exec(`${n} `)))&&(u="prefixed",p=g[1]||"",h=this._unescape(g[2])):(u="prefix",h=g[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?o(this):this._input=n;const y=f||g[0].length,b=r(u,h,p,l,y);this.previousToken=b,this._previousMarker=u,n=n.substr(y,n.length)}function r(t,r,o,s,a){const l=n?i-n.length:i,c={type:t,value:r,prefix:o,line:s,start:l,end:l+a};return e(null,c),c}function o(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(a,((e,n,i,r)=>{if("string"==typeof n)return String.fromCharCode(Number.parseInt(n,16));if("string"==typeof i){let e=Number.parseInt(i,16);return e<=65535?String.fromCharCode(Number.parseInt(i,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return r in l?l[r]:(t=!0,"")}));return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let i=Math.max(this._literalClosingPos,n);for(;(i=e.indexOf(t,i))>0;){let t=0;for(;"\\"===e[i-t-1];)t++;if(t%2==0){const t=e.substring(n,i),r=t.split(/\r\n|\r|\n/).length-1,o=i+n;if(1===n&&0!==r||3===n&&this._lineMode)break;return this._line+=r,{value:this._unescape(t),matchLength:o}}i++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const e=[];let t;if(this._tokenizeToEnd(((n,i)=>n?t=n:e.push(i)),!0),t)throw t;return e}o()((()=>this._tokenizeToEnd(t,!0)))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=Buffer.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(t,!1)))})),e.on("end",(()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)})),e.on("error",t)}}},33291:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(3524),r=n(28612),o=n(65852);let s=0;class a{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&c(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),r=/trig/.test(t),o=/triple/.test(t),s=/quad/.test(t),a=this._n3Mode=/n3/.test(t),l=o||s;(this._supportsNamedGraphs=!(n||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||r||o||a),this._supportsRDFStar=""===t||/star|\*$/.test(t),l&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new i.A({lineMode:l,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){s=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,i,r){const o=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:i,object:r,graph:t,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);n=this._namedNode(t);break;case"type":case"prefixed":const i=this._prefixes[e.prefix];if(void 0===i)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._namedNode(i+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,i=this._readListItem;const r=this._subject,o=this._contextStack,s=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blankNode()),null===r?null===s.predicate?s.subject=n:s.object=n:this._emit(r,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._literal(this._literalValue,n),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const i=this._subject,r=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,r&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF* syntax",e);const o=this._predicate,s=this._object;this._subject=this._quad(i,o,s,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if("Quad"!==this._subject.termType)return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==i){const e=this._predicate,t=this._object;r?this._emit(t,e,i,n):this._emit(i,e,t,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const t=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const i=this._blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=i):(t=this._object,this._object=i),this._emit(t,n,i,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let n,i;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=t):(i=this._object,this._object=t),this._emit(t,n,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,i){this._callback(null,this._quad(e,t,n,i||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=l}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",i=-1,r=-1,o=0,s="/";for(;i<t;){switch(s){case":":if(r<0&&"/"===e[++i]&&"/"===e[++i])for(;(r=i+1)<t&&"/"!==e[r];)i=r;break;case"?":case"#":i=t;break;case"/":if("."===e[i+1])switch(s=e[1+ ++i],s){case"/":n+=e.substring(o,i-1),o=i+1;break;case void 0:case"?":case"#":return n+e.substring(o,i)+e.substr(i+1);case".":if(s=e[1+ ++i],void 0===s||"/"===s||"?"===s||"#"===s){if(n+=e.substring(o,i-2),(o=n.lastIndexOf("/"))>=r&&(n=n.substr(0,o)),"/"!==s)return`${n}/${e.substr(i+1)}`;o=i+1}}}s=e[++i]}return n+e.substring(o)}parse(e,t,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${s++}_`,this._prefixCallback=n||l,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let n;if(this._callback=(e,i)=>{e?n=e:i&&t.push(i)},this._lexer.tokenize(e).every((e=>this._readCallback=this._readCallback(e))),n)throw n;return t}this._callback=t,this._lexer.tokenize(e,((e,t)=>{null!==e?(this._callback(e),this._callback=l):this._readCallback&&(this._readCallback=this._readCallback(t))}))}}function l(){}function c(e,t){const n=t.namedNode;e._namedNode=n,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=n(o.A.rdf.first),e.RDF_REST=n(o.A.rdf.rest),e.RDF_NIL=n(o.A.rdf.nil),e.N3_FORALL=n(o.A.r.forAll),e.N3_FORSOME=n(o.A.r.forSome),e.ABBREVIATIONS={a:n(o.A.rdf.type),"=":n(o.A.owl.sameAs),">":n(o.A.log.implies)},e.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}c(a.prototype,r.Ay)},69980:(e,t,n)=>{"use strict";n.r(t),n.d(t,{inDefaultGraph:()=>c,isBlankNode:()=>o,isDefaultGraph:()=>l,isLiteral:()=>s,isNamedNode:()=>r,isVariable:()=>a,prefix:()=>d,prefixes:()=>u});var i=n(28612);function r(e){return!!e&&"NamedNode"===e.termType}function o(e){return!!e&&"BlankNode"===e.termType}function s(e){return!!e&&"Literal"===e.termType}function a(e){return!!e&&"Variable"===e.termType}function l(e){return!!e&&"DefaultGraph"===e.termType}function c(e){return l(e.graph)}function d(e,t){return u({"":e.value||e},t)("")}function u(e,t){const n=Object.create(null);for(const i in e)r(i,e[i]);function r(e,i){if("string"==typeof i){const r=Object.create(null);n[e]=e=>r[e]||(r[e]=t.namedNode(i+e))}else if(!(e in n))throw new Error(`Unknown prefix: ${e}`);return n[e]}return t=t||i.Ay,r}},48640:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BlankNode:()=>s.PB,DataFactory:()=>s.Ay,DefaultGraph:()=>s.yV,Lexer:()=>i.A,Literal:()=>s.uS,NamedNode:()=>s.Yo,Parser:()=>r.A,Quad:()=>s.kO,Store:()=>x,StreamParser:()=>v,StreamWriter:()=>k,Term:()=>s.x1,Triple:()=>s.n7,Util:()=>a,Variable:()=>s.rT,Writer:()=>f,default:()=>S,termFromId:()=>s.iN,termToId:()=>s.FL});var i=n(3524),r=n(33291),o=n(65852),s=n(28612),a=n(69980);const l=s.Ay.defaultGraph(),{rdf:c,xsd:d}=o.A,u=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,h=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,p={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class g extends s.x1{equals(e){return e===this}}class f{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,n,i){e+=t,i&&i()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=l,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),t.baseIRI&&(this._baseMatcher=new RegExp(`^${y(t.baseIRI)}${t.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=t.baseIRI.length))}get _inDefaultGraph(){return l.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,n,i,r){try{i.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(l.equals(i)?"":`${this._encodeIriOrBlank(i)} {\n`)),this._graph=i,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,r):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,r):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,r)}catch(o){r&&r(o)}}_writeQuadLine(e,t,n,i,r){delete this._prefixMatch,this._write(this.quadToString(e,t,n,i),r)}quadToString(e,t,n,i){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(n)}${i&&i.value?` ${this._encodeIriOrBlank(i)} .\n`:" .\n"}`}quadsToString(e){return e.map((e=>this.quadToString(e.subject,e.predicate,e.object,e.graph))).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseMatcher&&this._baseMatcher.test(t)&&(t=t.substr(this._baseLength)),u.test(t)&&(t=t.replace(h,m));const n=this._prefixRegex.exec(t);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(u.test(t)&&(t=t.replace(h,m)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===d.string)return`"${t}"`}else switch(e.datatype.value){case d.string:return`"${t}"`;case d.boolean:if("true"===t||"false"===t)return t;break;case d.integer:if(/^[+-]?\d+$/.test(t))return t;break;case d.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case d.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===c.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:n,graph:i}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(n)}${(0,a.isDefaultGraph)(i)?"":` ${this._encodeIriOrBlank(i)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,n,i,r){void 0===n?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof i?this._writeQuad(e,t,n,l,i):this._writeQuad(e,t,n,i||l,r)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,n){const i={};i[e]=t,this.addPrefixes(i,n)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let n=!1;for(let i in e){let t=e[i];"string"!=typeof t&&(t=t.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[t]=i+=":",this._write(`@prefix ${i} <${t}>.\n`)}if(n){let e="",t="";for(const n in this._prefixIRIs)e+=e?`|${n}`:n,t+=(t?"|":"")+this._prefixIRIs[n];e=y(e),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([_a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",t)}blank(e,t){let n,i,r=e;switch(void 0===e?r=[]:e.termType?r=[{predicate:e,object:t}]:"length"in e||(r=[e]),i=r.length){case 0:return new g("[]");case 1:if(n=r[0],!(n.object instanceof g))return new g(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let t="[";for(let o=0;o<i;o++)n=r[o],n.predicate.equals(e)?t+=`, ${this._encodeObject(n.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,e=n.predicate);return new g(`${t}\n]`)}}list(e){const t=e&&e.length||0,n=new Array(t);for(let i=0;i<t;i++)n[i]=this._encodeObject(e[i]);return new g(`(${n.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((n,i)=>{t=null,e(n,i)});if(this._endStream)try{return this._outputStream.end(t)}catch(n){}t&&t()}}function m(e){let t=p[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function y(e){return e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var b=n(85721);class x{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._factory=t.factory||s.Ay,e&&this.addQuads(e)}_termFromId(e,t){if("."===e[0]){const t=this._entities,n=e.split(".");return this._factory.quad(this._termFromId(t[n[1]]),this._termFromId(t[n[2]]),this._termFromId(t[n[3]]),n[4]&&this._termFromId(t[n[4]]))}return(0,s.iN)(e,t)}_termToNumericId(e){if("Quad"===e.termType){const t=this._termToNumericId(e.subject),n=this._termToNumericId(e.predicate),i=this._termToNumericId(e.object);let r;return t&&n&&i&&((0,a.isDefaultGraph)(e.graph)||(r=this._termToNumericId(e.graph)))&&this._ids[r?`.${t}.${n}.${i}.${r}`:`.${t}.${n}.${i}`]}return this._ids[(0,s.FL)(e)]}_termToNewNumericId(e){const t=e&&"Quad"===e.termType?`.${this._termToNewNumericId(e.subject)}.${this._termToNewNumericId(e.predicate)}.${this._termToNewNumericId(e.object)}${(0,a.isDefaultGraph)(e.graph)?"":`.${this._termToNewNumericId(e.graph)}`}`:(0,s.FL)(e);return this._ids[t]||(this._ids[this._entities[++this._id]=t]=this._id)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let n,i;for(const r in t)for(const o in n=t[r].subjects)for(const t in i=n[o])e+=Object.keys(i[t]).length;return this._size=e}_addToIndex(e,t,n,i){const r=e[t]||(e[t]={}),o=r[n]||(r[n]={}),s=i in o;return s||(o[i]=null),!s}_removeFromIndex(e,t,n,i){const r=e[t],o=r[n];delete o[i];for(const s in o)return;delete r[n];for(const s in r)return;delete e[t]}*_findInIndex(e,t,n,i,r,o,s,a){let l,c,d;const u=this._entities,h=this._termFromId(a,this._factory),p={subject:null,predicate:null,object:null};t&&((l=e,e={})[t]=l[t]);for(const g in e)if(c=e[g]){p[r]=this._termFromId(u[g],this._factory),n&&((l=c,c={})[n]=l[n]);for(const e in c)if(d=c[e]){p[o]=this._termFromId(u[e],this._factory);const t=i?i in d?[i]:[]:Object.keys(d);for(let e=0;e<t.length;e++)p[s]=this._termFromId(u[t[e]],this._factory),yield this._factory.quad(p.subject,p.predicate,p.object,h)}}}_loop(e,t){for(const n in e)t(n)}_loopByKey0(e,t,n){let i,r;if(i=e[t])for(r in i)n(r)}_loopByKey1(e,t,n){let i,r;for(i in e)r=e[i],r[t]&&n(i)}_loopBy2Keys(e,t,n,i){let r,o,s;if((r=e[t])&&(o=r[n]))for(s in o)i(s)}_countInIndex(e,t,n,i){let r,o,s,a=0;t&&((r=e,e={})[t]=r[t]);for(const l in e)if(o=e[l]){n&&((r=o,o={})[n]=r[n]);for(const e in o)(s=o[e])&&(i?i in s&&a++:a+=Object.keys(s).length)}return a}_getGraphs(e){if(!("string"==typeof(t=e)||t instanceof String))return this._graphs;var t;const n={};return n[e]=this._graphs[e],n}_uniqueEntities(e){const t=Object.create(null);return n=>{n in t||(t[n]=!0,e(this._termFromId(this._entities[n],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,n,i){t||(i=e.graph,n=e.object,t=e.predicate,e=e.subject),i=(0,s.FL)(i);let r=this._graphs[i];r||(r=this._graphs[i]={subjects:{},predicates:{},objects:{}},Object.freeze(r)),e=this._termToNewNumericId(e),t=this._termToNewNumericId(t),n=this._termToNewNumericId(n);const o=this._addToIndex(r.subjects,e,t,n);return this._addToIndex(r.predicates,t,n,e),this._addToIndex(r.objects,n,e,t),this._size=null,o}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e,t,n,i){return e&&e.subject&&({subject:e,predicate:t,object:n,graph:i}=e),!this.readQuads(e,t,n,i).next().done}import(e){return e.on("data",(e=>{this.addQuad(e)})),e}removeQuad(e,t,n,i){t||(i=e.graph,n=e.object,t=e.predicate,e=e.subject),i=(0,s.FL)(i);const r=this._graphs;let o,a,l;if(!((e=e&&this._termToNumericId(e))&&(t=t&&this._termToNumericId(t))&&(n=n&&this._termToNumericId(n))&&(o=r[i])&&(a=o.subjects[e])&&(l=a[t])&&n in l))return!1;for(e in this._removeFromIndex(o.subjects,e,t,n),this._removeFromIndex(o.predicates,t,n,e),this._removeFromIndex(o.objects,n,e,t),null!==this._size&&this._size--,o.subjects)return!0;return delete r[i],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",(e=>{this.removeQuad(e)})),e}removeMatches(e,t,n,i){const r=new b.Readable({objectMode:!0});return r._read=()=>{for(const o of this.readQuads(e,t,n,i))r.push(o);r.push(null)},this.remove(r)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,n,i){return[...this.readQuads(e,t,n,i)]}*readQuads(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l,c;if(!(e&&!(a=this._termToNumericId(e))||t&&!(l=this._termToNumericId(t))||n&&!(c=this._termToNumericId(n))))for(const s in r)(o=r[s])&&(a?c?yield*this._findInIndex(o.objects,c,a,l,"object","subject","predicate",s):yield*this._findInIndex(o.subjects,a,l,null,"subject","predicate","object",s):l?yield*this._findInIndex(o.predicates,l,c,null,"predicate","object","subject",s):c?yield*this._findInIndex(o.objects,c,null,null,"object","subject","predicate",s):yield*this._findInIndex(o.subjects,null,null,null,"subject","predicate","object",s))}match(e,t,n,i){return new w(this,e,t,n,i)}countQuads(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l,c,d=0;if(e&&!(a=this._termToNumericId(e))||t&&!(l=this._termToNumericId(t))||n&&!(c=this._termToNumericId(n)))return 0;for(const s in r)(o=r[s])&&(d+=e?n?this._countInIndex(o.objects,c,a,l):this._countInIndex(o.subjects,a,l,c):t?this._countInIndex(o.predicates,l,c,a):this._countInIndex(o.objects,c,a,l));return d}forEach(e,t,n,i,r){this.some((t=>(e(t),!1)),t,n,i,r)}every(e,t,n,i,r){let o=!1;const s=!this.some((t=>(o=!0,!e(t))),t,n,i,r);return o&&s}some(e,t,n,i,r){for(const o of this.readQuads(t,n,i,r))if(e(o))return!0;return!1}getSubjects(e,t,n){const i=[];return this.forSubjects((e=>{i.push(e)}),e,t,n),i}forSubjects(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.predicates,a,l,e):this._loopByKey1(o.subjects,a,e):l?this._loopByKey0(o.objects,l,e):this._loop(o.subjects,e))}getPredicates(e,t,n){const i=[];return this.forPredicates((e=>{i.push(e)}),e,t,n),i}forPredicates(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.objects,l,a,e):this._loopByKey0(o.subjects,a,e):l?this._loopByKey1(o.predicates,l,e):this._loop(o.predicates,e))}getObjects(e,t,n){const i=[];return this.forObjects((e=>{i.push(e)}),e,t,n),i}forObjects(e,t,n,i){i=i&&(0,s.FL)(i);const r=this._getGraphs(i);let o,a,l;if(e=this._uniqueEntities(e),!(t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(i in r)(o=r[i])&&(a?l?this._loopBy2Keys(o.subjects,a,l,e):this._loopByKey1(o.objects,a,e):l?this._loopByKey0(o.predicates,l,e):this._loop(o.objects,e))}getGraphs(e,t,n){const i=[];return this.forGraphs((e=>{i.push(e)}),e,t,n),i}forGraphs(e,t,n,i){for(const r in this._graphs)this.some((t=>(e(t.graph),!0)),t,n,i,r)}createBlankNode(e){let t,n;if(e)for(t=e=`_:${e}`,n=1;this._ids[t];)t=e+n++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const n={},i=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},r=this.getQuads(null,o.A.rdf.rest,o.A.rdf.nil,null),s=e?[...r]:[];return r.forEach((t=>{const r=[];let a,l,c=!1;const d=t.graph;let u=t.subject;for(;u&&!c;){const e=this.getQuads(null,null,u,null),t=this.getQuads(u,null,null,null);let n,h=null,p=null,g=null;for(let r=0;r<t.length&&!c;r++)n=t[r],n.graph.equals(d)?a?c=i(u,"has non-list arcs out"):n.predicate.value===o.A.rdf.first?h?c=i(u,"has multiple rdf:first arcs"):s.push(h=n):n.predicate.value===o.A.rdf.rest?p?c=i(u,"has multiple rdf:rest arcs"):s.push(p=n):e.length?c=i(u,"can't be subject and object"):(a=n,l="subject"):c=i(u,"not confined to single graph");for(let r=0;r<e.length&&!c;++r)n=e[r],a?c=i(u,"can't have coreferences"):n.predicate.value===o.A.rdf.rest?g?c=i(u,"has incoming rdf:rest arcs"):g=n:(a=n,l="object");h?r.unshift(h.object):c=i(u,"has no list head"),u=g&&g.subject}c?e=!1:a&&(n[a[l].value]=r)})),e&&this.removeQuads(s),n}*[Symbol.iterator](){yield*this.readQuads()}}class w extends b.Readable{constructor(e,t,n,i,r){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:n,object:i,graph:r})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:n,predicate:i,subject:r}=this,o=this._filtered=new x({factory:e._factory});for(const s of e.readQuads(r,i,n,t))o.addQuad(s)}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this)this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,n,i){return new w(this.filtered,e,t,n,i)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class v extends b.Transform{constructor(e){super({decodeStrings:!0}),this._readableState.objectMode=!0;let t,n;new r.A(e).parse({on:(e,i)=>{switch(e){case"data":t=i;break;case"end":n=i}}},((e,t)=>{e&&this.emit("error",e)||t&&this.push(t)}),((e,t)=>{this.emit("prefix",e,t)})),this._transform=(e,n,i)=>{t(e),i()},this._flush=e=>{n(),e()}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),this}}class k extends b.Transform{constructor(e){super({encoding:"utf8",writableObjectMode:!0});const t=this._writer=new f({write:(e,t,n)=>{this.push(e),n&&n()},end:e=>{this.push(null),e&&e()}},e);this._transform=(e,n,i)=>{t.addQuad(e,i)},this._flush=e=>{t.end(e)}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),e.on("prefix",((e,t)=>{this._writer.addPrefix(e,t)})),this}}const S={Lexer:i.A,Parser:r.A,Writer:f,Store:x,StreamParser:v,StreamWriter:k,Util:a,DataFactory:s.Ay,Term:s.x1,NamedNode:s.Yo,Literal:s.uS,BlankNode:s.PB,Variable:s.rT,DefaultGraph:s.yV,Quad:s.kO,Triple:s.n7,termFromId:s.iN,termToId:s.FL}},65606:e=>{var t,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,l=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?l=a.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=s(u);c=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},79596:(e,t,n)=>{let i;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(i||(i=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},92861:(e,t,n)=>{var i=n(48287),r=i.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=s),s.prototype=Object.create(r.prototype),o(r,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},83141:(e,t,n)=>{"use strict";var i=n(92861).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=d,this.end=u,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function d(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=s(t[i]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if(r=s(t[i]),r>=0)return r>0&&(e.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if(r=s(t[i]),r>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}}}]);